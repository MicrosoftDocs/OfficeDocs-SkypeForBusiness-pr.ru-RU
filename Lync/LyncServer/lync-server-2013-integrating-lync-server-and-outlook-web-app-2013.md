---
title: 'Lync Server 2013: интеграция Lync Server и Outlook Web App 2013'
description: 'Lync Server 2013: интеграция Lync Server и Outlook Web App 2013.'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Integrating Lync Server 2013 and Outlook Web App 2013
ms:assetid: 513d4cc7-aa87-4f68-b99d-d58b63bdf242
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ688055(v=OCS.15)
ms:contentKeyID: 49733649
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 0d9c7e91dba22f78325eaddc5b5d7469ccf4cc92
ms.sourcegitcommit: d42a21b194f4a45e828188e04b25c1ce28a5d1ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2020
ms.locfileid: "48567395"
---
# <a name="integrating-microsoft-lync-server-2013-and-microsoft-outlook-web-app-2013"></a>Интеграция Microsoft Lync Server 2013 и Microsoft Outlook Web App 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2013-02-03_

Помимо интеграции с Microsoft Outlook 2013, Microsoft Lync Server 2013 может быть полностью интегрирован с Microsoft Outlook Web App 2013. Помимо прочего, добавляется обмен мгновенными сообщениями и сведения о присутствии в Outlook Web App, а также обеспечивается совместный доступ к единому списку контактов между Outlook Web App и Microsoft Lync 2013. Чтобы интегрировать Lync Server 2013 и Outlook Web App, необходимо сначала убедиться в том, что на внутреннем сервере Microsoft Exchange Server 2013 установлена среда выполнения Unified Communications Managed API 4,0. Это можно сделать, просмотрев на наличие следующего раздела реестра:

\_Локальная \_ \\ система \\ CurrentControlSet \\ службы \\ MSExchange OWA \\ инстантмессагинг \\ имплементатиондллпас

Имплементатиондллпас должен указать расположение папки для файла Microsoft.Rtc.Internal.Ucweb.dll. Если это не так или если значение реестра не существует, то необходимо скачать и установить программу установки среды выполнения UCMA из центра загрузки Майкрософт по адресу <https://www.microsoft.com/download/details.aspx?id=34992> . Сведения о том, как установить среду выполнения UCMA, можно найти на той же веб-странице.

**Обратная совместимость**

Lync Server 2013 можно интегрировать с Microsoft Exchange Server 2010 версии единой системы обмена сообщениями и Outlook Web App. Для получения дополнительных сведений ознакомьтесь со статьей развертывание локальной единой системы обмена сообщениями Exchange для предоставления голосовой почты Lync Server 2010 по адресу [https://technet.microsoft.com/library/gg398768.aspx](lync-server-2013-deploying-on-premises-exchange-um-to-provide-lync-server-2013-voice-mail.md) . Если вы интегрируетесь с Exchange 2010, у вас не будет специальных функций Lync Server, таких как единое хранилище контактов и архивация по Lync в Exchange.

Microsoft Lync 2013 также можно использовать вместе с Exchange 2010 и Outlook 2010. Однако в этом случае новые функции, такие как единое хранилище контактов и фотографии с высоким разрешением, не будут доступны пользователям Lync 2013. Для этих новых возможностей требуется как Lync Server 2013, так и Exchange 2013.

**Создание пула доверенных приложений для Outlook Web App**

Если вы установили службу маршрутизатора вызовов единой системы обмена сообщениями Microsoft Exchange и службу единой системы обмена сообщениями Microsoft Exchange на том же компьютере, вам не нужно создавать пул доверенных приложений для Outlook Web App. (Предполагается, что на рассматриваемом сервере размещена абонентская группа единой системы обмена сообщениями SipName.) Если вы используете один компьютер для размещения обеих этих служб, вы можете перейти к разделу этого документа под названием **Включение функции обмена мгновенными сообщениями в Outlook Web App**.

Lync Server 2013 может выполнить автообнаружение серверов Exchange, на которых размещается абонентская группа единой системы обмена сообщениями SipName; Эти серверы автоматически добавляются в список известных серверов Lync Server. Нет необходимости создавать пул доверенных приложений и добавлять эти серверы в список известных серверов. На самом деле это приведет к прекращению работы интеграции Outlook Web App.

<div>


> [!NOTE]  
> Это связано с тем, что в топологии Lync Server теперь есть две записи для одного и того же компьютера: автоматически обнаруженная запись и запись, добавленная вручную. Чтобы устранить проблему и повторно запустить Outlook Web App, используйте Windows PowerShell для удаления доверенного пула и записей доверенных приложений для сервера. Для получения дополнительных сведений ознакомьтесь со статьями справки для командлетов <A href="https://docs.microsoft.com/powershell/module/skype/Remove-CsTrustedApplicationPool">Remove – кструстедаппликатионпул</A> и <A href="https://docs.microsoft.com/powershell/module/skype/Remove-CsTrustedApplication">Remove – кструстедаппликатион</A> .



</div>

Если эти две службы запущены на разных компьютерах, после проверки того, что установлена среда выполнения единой системы обмена сообщениями Managed API 4,0, необходимо создать пул доверенных приложений Lync Server и доверенное приложение, связанное с Outlook Web App; Это приведет к добавлению сервера в список известных серверов. Для этого сначала выполните следующую команду в командной консоли Lync Server:

    New-CsTrustedApplicationPool -Identity atl-owa-001.litwareinc.com -Registrar atl-cs-001.litwareinc.com -Site Redmond -RequiresReplication $False

В предыдущей команде atl-owa-001.litwareinc.com — полное доменное имя пула Outlook Web App; Это должно быть одно и то же имя, которое отображается в полях имя субъекта и альтернативное имя субъекта (SAN) сертификата, который предоставляет доступ к Outlook Web App. Аналогичным образом, atl-cs-001.litwareinc.com это полное доменное имя пула Lync Server 2013, в котором будет размещаться новый пул доверенных приложений. Обратите внимание, что указанный сайт, Redmond, представляет сайт сайта Lync Server. Имя сайта не обязательно должно совпадать с отображаемым именем сайта; Вы можете получить Ситеидс для сайтов Lync Server, выполнив следующую команду в командной консоли Lync Server:

    Get-CsSite | Select-Object DisplayName, SiteID

После создания пула доверенных приложений используйте команду, аналогичную приведенной ниже, для настройки удостоверения приложения и порта для Outlook Web App.

    New-CsTrustedApplication -ApplicationId OutlookWebApp -TrustedApplicationPoolFqdn atl-owa-001.litwareinc.com  -Port 5199

В предыдущей команде значение ApplicationID являлось простым и понятным идентификатором, используемым для разграничения доверенных приложений. Значением ApplicationID может являться любая текстовая строка, которая не содержит пробелов и других запрещенных символов. (Чтобы создать допустимый идентификатор, при определении ApplicationId рекомендуется использовать только буквы и цифры.) Значение, назначенное параметру порта, также оставляется на выбор администратора; может использоваться любой доступный сетевой порт.

После создания доверенного приложения необходимо выполнить следующую команду, чтобы включить изменения в топологии Lync Server:

    Enable-CsTopology

Обратите внимание на то, что необходимо также добавить сервер клиентского доступа и почтовых ящиков Exchange во все абонентские группы URI SIP. В свою очередь, эти серверы будут настроены как доверенные одноранговые узлы SIP с топологией ExUmRouting для Lync Server.

**Включение обмена мгновенными сообщениями в Outlook Web App**

После правильной настройки Lync Server вы можете начать настройку Outlook Web App. Первый этап этого процесса состоит в том, чтобы включить обмен мгновенными сообщениями для всех виртуальных каталогов Outlook Web App на серверах переднего плана. (Нет необходимости включать обмен мгновенными сообщениями для виртуальных каталогов на внутренних серверах. На самом деле не рекомендуется включать обмен мгновенными сообщениями на внутренних серверах.) На серверах клиентского доступа можно включить обмен мгновенными сообщениями, выполнив в командной консоли Exchange следующую команду:

    Get-OwaVirtualDirectory | Set-OwaVirtualDirectory -InstantMessagingEnabled $True -InstantMessagingType OCS

<div>


> [!NOTE]  
> По умолчанию при установке Outlook Web App включен обмен мгновенными сообщениями; то есть свойство InstantMessagingEnabled имеет значение true. Тем не менее необходимо выполнить предыдущую команду, чтобы установить для типа обмена мгновенными сообщениями значение OCS. По умолчанию для Инстантмессагингтипе задано значение None.



</div>

Затем необходимо добавить следующие две строки в файл Web.config Outlook Web App (этот файл обычно находится в папке C: \\ Program Files \\ Microsoft \\ Exchange Server \\ V15 \\ ClientAccess \\ OWA). Эти две строки следует добавить в \<AppSettings\> узел файла Web.config, и эта процедура должна выполняться только на внутренних серверах, где установлено приложение Outlook Web App:

    <add key="IMCertificateThumbprint" value="EA5A332496CC05DA69B75B66111C0F78A110D22d"/>
    <add key="IMServerName" value="atl-cs-001.litwareinc.com"/>

В предыдущем примере значение параметра Имцертификатесумбпринт должно быть отпечатком для сертификата Exchange 2013, установленного на внутренних серверах. Вы можете получить эти сведения, выполнив следующую команду в командной консоли Exchange:

    Get-ExchangeCertificate

Обратите внимание, что значение, назначенное для ServerName, является полным доменным именем пула Lync Server, в котором вы создали пул доверенных приложений для Outlook Web App.

Сертификат, используемый для Outlook Web App, должен быть сертификатом, который является доверенным для Lync Server. Один из способов удостовериться, что сертификат будет доверенным для Lync Server и Exchange, — использовать свой внутренний центр сертификации для создания сертификата на сервере почтовых ящиков, убедившись, что полное доменное имя сервера используется для имени субъекта и отображается в поле альтернативное имя сертификата. После создания сертификата его можно импортировать на внутренние серверы. В итоге это тот же сертификат, который используется для двух целей: 1) для обмена данными между единой системой обмена сообщениями Exchange и Lync Server; и 2) интеграция между Outlook Web App и Lync Server.

После того как вы обновите файл Web.config, выполните следующую команду на внутреннем сервере Exchange, чтобы перезапустить пул Outlook Web App:

    C:\Windows\System32\Inetsrv\Appcmd.exe recycle apppool /apppool.name:"MSExchangeOWAAppPool"

Если операция перезапуска успешно выполнена, в командной консоли Exchange появится следующее сообщение:

    "MSExchangeOWAAppPool" successfully recycled

**Настройка политик почтовых ящиков Outlook Web App**

На этом шаге можно использовать следующую команду для настройки обмена мгновенными сообщениями в соответствующей политике почтовых ящиков Outlook Web App (или политиках). Например, эта команда запускается на одном из серверов почтовых ящиков и включает обмен мгновенными сообщениями в политике по умолчанию:

    Set-OwaMailboxPolicy -Identity "Default" -InstantMessagingEnabled $True -InstantMessagingType "OCS"

Эта команда включает обмен мгновенными сообщениями для всех политик почтовых ящиков Outlook Web App.

    Get-OwaMailboxPolicy | Set-OwaMailboxPolicy -InstantMessagingEnabled $True -InstantMessagingType "OCS"

После включения политики почтовых ящиков все пользователи, которым управляет эта политика, будут иметь полную интеграцию между Lync Server и Outlook Web App при условии, что:

  - У пользователя есть почтовый ящик в Exchange 2013.

  - Для пользователя включена поддержка Lync Server 2013.

  - Пользователь имеет допустимый прокси-адрес SIP.

**Отключение обмена мгновенными сообщениями в Outlook Web App**

Как отмечалось ранее, Обмен мгновенными сообщениями по умолчанию включен в Outlook Web App. Это означает, что если вы не интегрирует Outlook Web App с Lync Server, пользователи увидят пустые значки присутствия и сообщение об ошибке каждый раз при входе в Outlook Web App. Чтобы предотвратить эту проблему, используйте следующую команду командной консоли Exchange для отключения обмена мгновенными сообщениями в Outlook Web App:

    Get-OwaVirtualDirectory | Set-OwaVirtualDirectory -InstantMessagingEnabled $False

**Проверка интеграции с Outlook Web App**

Чтобы убедиться, что обмен мгновенными сообщениями и сведения о присутствии интегрированы с Outlook Web App, войдите в Outlook Web App 2013. В верхнем правом углу экрана отображается отображаемое имя Exchange. Если рядом с именем есть значок присутствия (например, зеленый значок, указывающий на то, что текущее состояние доступно), что означает, что вы успешно интегрируете Lync Server и Outlook Web App.

После первого входа в Outlook Web App проверьте, записано ли в журнал событий на сервере почтовых ящиков событие с ИДЕНТИФИКАТОРом 112 (и исходным MSExchange OWA). Это событие указывает на то, что диспетчер конечной точки обмена мгновенными сообщениями успешно инициализирован. Если обмен мгновенными сообщениями не работает, то на сервере почтовых ящиков найдите файлы журнала в папке C: \\ Program Files \\ Microsoft \\ Exchange Server \\ V15 \\ Logging \\ инстантмессагинг для OWA \\ . Если папки "журнал" или "Инстантмессагинг" не существуют, что свидетельствует о неудачной интеграции. В этом случае вы можете использовать трассировку SIPStack на Lync Server (все уровни и все флажки), чтобы проверить, почему не удалось выполнить интеграцию.

</div>

<span> </span>

</div>

</div>

</div>

