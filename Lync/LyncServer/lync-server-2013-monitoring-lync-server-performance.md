---
title: 'Lync Server 2013: наблюдение за производительностью Lync Server'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
TOCTitle: Monitoring Lync Server 2013 performance
ms:assetid: 2acfd720-6120-4816-a2d4-30476bd5cd0e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn720910(v=OCS.15)
ms:contentKeyID: 63969592
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: a9610dddfa9748b7d28dfe040a36214f3f969826
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "34826747"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="monitoring-lync-server-2013-performance"></a>Мониторинг производительности Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-05-15_

Производительность Lync Server 2013 зависит от различных факторов, таких как профили пользователей, системная архитектура, программное обеспечение, аппаратные компоненты, сторонние точки интеграции, такие как шлюзы и оборудование телефонного соединения, сетевое подключение и производительность, Windows Настройка и производительность службы Active Directory в дополнение к функциональным возможностям операционной системы Windows.

В ядре сервера Lync Server 2013 для развертывания — серверное программное обеспечение и оборудование, на котором он реализован. В качестве примера сервер переднего плана должен иметь достаточные аппаратные ресурсы для работы с ожидаемой (краткосрочной) пользовательской загрузкой. Если соответствующий интерфейсный сервер необходим для предоставления услуг пользователям 10000, то сервер с надлежащим конфигурацией должен соответствовать ожидаемым требованиям к нагрузке, чтобы обеспечить максимально возможную эффективность работы пользователя.

Наблюдение за производительностью сервера, таким образом, очень важно, чтобы определить, имеют ли реализованную инфраструктуру сервера подходящие аппаратные ресурсы для требований к пиковой нагрузке за день. Наблюдение за производительностью сервера помогает выявить узкие места системы, позволяющие администраторам применять корректирующее действие до того, как это повлияет на работу пользователя. Данные о производительности следует использовать для долгосрочного планирования мощностей.

Несмотря на то, что подробные сведения обо всех объектах и счетчиках производительности, которые необходимо наблюдаются, связаны с [сервером Lync Server 2013 с помощью System Center Operations Manager](lync-server-2013-monitoring-lync-server-with-system-center-operations-manager.md), некоторые счетчики производительности, которые следует выполнить, могут предоставить администраторам краткий обзор. производительность системы:

  - Чтобы отслеживать общее состояние системы на сервере переднего плана, хорошей отправной точкой является проверка процессора\\% времени процессора. Значение всегда должно быть меньше 80 процента.

  - Для отслеживания производительности экземпляра программного обеспечения базы данных SQL Server, используемого пулом переднего плана, отслеживайте следующие счетчики производительности:
    
    LC: Усрв – 00 – Дбсторе\\усрв – 002 – задержка очереди (МС)
    
    LC: Усрв – 00 – Дбсторе\\усрв – 0 04 – спрок задержка (мсек)
    
    Работоспособный сервер в стабильном состоянии должен \<показывать значения задержки 100 MS. Механизм регулирования будет заключаться в том случае, если задержка займет 12 секунд, а это значит, что сервер переднего плана начинает запросы на прерывание на обратной стороне. Это приведет к тому, что клиенты начнут получать сообщение об ошибке "сервер 503 занят".

  - Для отслеживания времени обработки на сервере переднего плана следует наблюдать за следующим счетчиком:
    
    LC: SIP-07-Загрузи\\SIP – это 000, среднее время хранения входящих сообщений
    
    Это еще один механизм регулирования на серверах переднего плана, на этот раз начиная время обработки на внешнем интерфейсе. Если среднее время обработки составляет более шести секунд, сервер переходит в режим регулирования и допускает только одну незавершенную транзакцию для каждого клиентского соединения.

  - Для отслеживания проблем с памятью на сервере SQL Server можно наблюдать за следующим счетчиком:
    
    Ожидаемый жизненный цикл\\страницы диспетчера буферов SQL Server
    
    Низкое значение, которое меньше 3600 секунд (вместе с большим количеством задержек записи в секунду и страницами контрольных точек/сек), указывает на нехватку памяти.

<div>

## <a name="additional-counters-to-view"></a>Дополнительные счетчики для просмотра

Существует несколько ключевых счетчиков, которые являются хорошим индикатором общего функционирования сервера переднего плана. Этот список не является исчерпывающим и не предназначен для выявления корневой причины. Эти счетчики позволят вам быстро проверить работоспособность сервера. Мы рекомендуем проверять эти счетчики на каждом сервере в пуле. Важно понимать, что такое значения счетчиков, когда сервер исправен. Базовые показатели необходимы для понимания того, что изменилось, когда взаимодействие с пользователем будет снижено.

Сервер переднего плана может указывать на проблемы, которые могут быть вызваны узким местом в системе. Это значит, что лучше всего начать с того места, где вы видите общее состояние системы.

Ниже приведены два дополнительных счетчика для проверки.

LC: Усрв-00-Дбсторе\\усрв-002 — задержка очереди (МС)

LC: Усрв-00-Дбсторе\\усрв-004-спрок задержка (мсек)

Счетчик "Задержка очереди" представляет время, затраченное на ожидание запроса в очереди, и спрок задержку представляет время, затраченное на обработку запроса на обратной стороне. Если по какой – либо причине возникают проблемы с диском, памятью, сетью и процессором на серверной стороне, счетчик задержки очереди будет большим.

Это также может быть очень высокое при наличии высокой задержки сети между интерфейсом и серверной стороной. Итак, что такое задержка очереди?

Через 12 секунд сервер переднего плана начнет регулировать запросы к серверным серверам. Это означает, что серверы, которые начнут возвращать сервер, заняты, – 503 ошибки для клиентов. Работоспособный сервер должен иметь менее 100 мс задержки очереди в постоянном состоянии, но в то время, когда сервер только что выйдет из сети, а пользователи сразу же будут входить в сеть, этот счетчик может быть очень высоким, и вы даже увидите, что на него может быть достигнуто несколько секунд.

Возможно, у вас есть конфигурация балансировки нагрузки, на которой развернут пул с несколькими серверами переднего плана и подсистемой балансировки нагрузки, настроенной для "минимального количества подключений". В этом случае, если один сервер переднего плана перезапустится, то все пользователи, пытающиеся переподключиться, будут указывать на перезапускаемый сервер, так как на нем будет меньшее число подключений по сравнению с остальными участниками пула. В течение этого времени соответствующий сервер переднего плана может быть перегружен, а другие участники пула — нет.

Рекомендуется выполнять обслуживание в нерабочее время, чтобы снизить производительность, так как пользователи не могут присоединиться к серверу одновременно с тем, чтобы они не были конкурентными.

Если вы используете два предыдущих счетчика производительности, наиболее вероятно, что узким является сервер SQL Server. Ниже перечислены следующие компоненты для подтверждения.

  - Слишком высокий ли ЦП сервера SQL Server? Например, больше чем 80%?

  - Максимальная задержка диска?

В идеале объем оперативной памяти достаточно для того, чтобы иметь и базу данных RTC, и РТКДИН в памяти. Затем единственная причина, по которой сервер мог бы получить доступ к диску, — это записать файлы журнала и записать их в базу данных. В тестах показано, что для развертывания пользователей 100 000 достаточно 12 ГБ ОЗУ. Предполагается, что объем баз данных RTC и РТКДИН меньше 12 ГБ. Если размер ваших баз данных больше, вам может потребоваться дополнительная память.

Вы можете определить, требуется ли для вашего сервера SQL Server дополнительную память, изменив счетчик производительности "ожидаемый жизненный цикл" на странице диспетчера буферов SQL Server. Значение, меньшее 3 600, указывает на нехватку памяти. Кроме того, если у вас достаточно памяти, вы также можете бесплатно прочитать данные на диске с базой данных, так как SQL Server должен выполнять только запись в базу данных.

Дополнительный механизм регулирования на сервере Lync Server 2013, который запускается, если время обработки сервера велико. Регулировка задержки Дбсторе включается только в том случае, если задержка на SQL Server высока. Один пример, в котором включена регулировка регулирования, заключается в том, что сервер переднего плана имеет ограниченные ресурсы ЦП.

Если среднее время обработки **(LC: SIP — 07-для управления\\загрузкой — 000 часов для входящих сообщений)** на сервере превышает шесть секунд, сервер переходит в режим регулирования и предоставляет пользователям только одну незавершенную транзакцию на соединение с клиентом. После падения времени обработки на три секунды сервер удаляется из режима регулирования и дает пользователям до 20 незавершенных транзакций на клиентские соединения. Всякий раз, когда количество транзакций в конкретном соединении превышает пороговое значение, подключение помечается как управляемое потоком. В результате сервер не отправляет на него ни одного приема, а **аккредитив: Счетчик соединений с управляемым\\ПОТОКОМ данных "SIP-01-** одноранговый" увеличивается. Если подключение остается в состоянии, управляемом потоком, в течение более одной минуты, сервер закрывает его. Это происходит неактивно. Если у вас есть возможность проверить подключение, оно определяет, было ли оно слишком длинным, и закрывает его, если оно содержит более одной минуты.

Это два механизма регулирования и показан один счетчик производительности, обобщаются сведения о том, что происходит при регулировании работы сервера.

**LC: SIP-04-Responses\\sip-053-Local 503 ответы/сек**

  - Термин "локальный" в предыдущем счетчике указывает на локально сформированные ответы.

  - Код 503 соответствует серверу, на котором не должны отображаться коды 503 на рабочем сервере. В течение периода после того как сервер будет подключен к сети, вы можете увидеть некоторые коды 503. После того как все пользователи снова будут входить в стабильное состояние, сервер не должен иметь дополнительные коды 503.

**LC: SIP-04-Responses\\sip-074-Local 504 ответы/сек**

Этот счетчик производительности указывает на проблемы с подключением к другим серверам и может указывать на сбои при подключении или задержках. Если вы видите ошибки 504, должен быть установлен следующий счетчик производительности.

**LC: SIP-01-Peers\\SIP-017-отправка ожидающих**

Этот счетчик показывает количество запросов и ответов в очереди. Если значение этого счетчика велико, скорее всего, проблема не находится на локальном сервере. Обратите внимание, что этот счетчик может быть высоким в случае проблем с сетевой задержкой. Оно также может указывать на проблемы с локальным сетевым адаптером, но может быть вызвано проблемой на удаленном сервере. Этот счетчик, скорее всего, будет высок на сервере Director, когда пул, с которым он пытается связаться, перегружен. Ключ с этим счетчиком — это просмотр экземпляров, а не только итогового значения.

</div>

</div>

<span> </span>

</div>

</div>

</div>

