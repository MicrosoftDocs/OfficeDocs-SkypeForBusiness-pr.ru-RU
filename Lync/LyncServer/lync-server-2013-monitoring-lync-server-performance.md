---
title: 'Lync Server 2013: Мониторинг производительности Lync Server'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Monitoring Lync Server 2013 performance
ms:assetid: 2acfd720-6120-4816-a2d4-30476bd5cd0e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn720910(v=OCS.15)
ms:contentKeyID: 63969592
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: ee7fbb69583a62ac50548bdae11a1a5681398e98
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42048072"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="monitoring-lync-server-2013-performance"></a>Мониторинг производительности Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2014-05-15_

Производительность Lync Server 2013 зависит от различных факторов, таких как профили пользователей, системная архитектура, программное обеспечение, аппаратные компоненты, сторонние точки интеграции, такие как шлюзы и оборудование телефонии, сетевое подключение и производительность, Windows Настройка и производительность службы Active Directory в дополнение к функциональным возможностям операционной системы Windows.

В ядре Lync Server 2013 deployments Performance — программное обеспечение сервера и оборудование, на котором он реализован. Например, на внешнем сервере должны быть достаточно аппаратных ресурсов для работы с ожидаемой (краткосрочной) пользовательской нагрузкой. Если для предоставления услуг 10000 пользователям необходим соответствующий интерфейсный сервер, то соответствующий сервер должен удовлетворять ожидаемым требованиям к нагрузке, чтобы обеспечить максимально возможный опыт работы конечных пользователей.

Таким образом, для наблюдения за производительностью сервера очень важно определить, есть ли в реализованной серверной инфраструктуре аппаратные ресурсы в течение повседневных пиковых требований нагрузки. Мониторинг производительности сервера помогает определить узкие места системы, что позволяет администраторам применять корректирующие действия до того, как это повлияет на работу конечных пользователей. Данные о производительности следует использовать для долгосрочного планирования мощности.

Несмотря на то, что подробные сведения обо всех объектах и счетчиках производительности, которые необходимо отслеживать, связаны с [системой мониторинга Lync Server 2013 с помощью System Center Operations Manager](lync-server-2013-monitoring-lync-server-with-system-center-operations-manager.md), некоторые счетчики производительности, которые следует выполнить, могут предоставить администраторам краткий обзор производительности системы:

  - Чтобы отслеживать общую работоспособность системы на сервере переднего плана, хорошей отправной точкой является проверка\\процессорного времени процессора. Значение всегда должно быть меньше 80 процентов.

  - Чтобы отслеживать производительность экземпляра программного обеспечения базы данных SQL Server, используемого интерфейсным пулом, отслеживайте следующие счетчики производительности:
    
    LC: Усрв – 00 – Дбсторе\\усрв – 002 – задержка очереди (МС)
    
    LC: Усрв – 00 – Дбсторе\\усрв – 0 04 – спрок задержка (МС)
    
    Работоспособный сервер в стабильном состоянии должен \<отображать значения задержки 100 мс. Механизм регулирования будет действовать, когда задержка достигнет 12 секунд, а это означает, что сервер переднего плана начинает регулирование запросы к серверному концу. Это приводит к тому, что клиенты начинают получать сообщение об ошибке сервера 503.

  - Чтобы отслеживать время обработки на сервере переднего плана, следует наблюдать за следующим счетчиком:
    
    LC: SIP — 07 — SIP Management\\SIP — среднее время хранения для входящих сообщений
    
    Это еще один механизм регулирования на интерфейсных серверах, который запускается при высоком времени обработки на сервере переднего плана. Если среднее время обработки составляет более шести секунд, сервер переводится в режим регулирования и разрешает только одну незавершенную транзакцию для каждого клиентского подключения.

  - Чтобы отслеживать проблемы с памятью на внутреннем сервере SQL Server, следите за следующим счетчиком:
    
    Ожидаемый срок жизни\\страниц диспетчера буферов SQL Server
    
    Минимальное значение, которое меньше 3600 секунд (вместе с большим количеством операций записи/сек и страниц контрольных точек/сек), указывает на нехватку памяти.

<div>

## <a name="additional-counters-to-view"></a>Дополнительные счетчики для просмотра

Существует несколько ключевых счетчиков, которые являются хорошим индикатором общей работоспособности сервера переднего плана. Этот список не является исчерпывающим и не предназначен для определения основной причины. Эти счетчики позволяют выполнить быструю проверку работоспособности сервера. Мы рекомендуем проверить эти счетчики на каждом из серверов в пуле. Важно понимать, что такое значения счетчиков в работоспособности сервера. Базовый план необходим для того, чтобы узнать, какие изменения были внесены при снижении уровня взаимодействия с пользователем.

Сервер переднего плана может указывать на проблемы, которые могут быть вызваны узкими местами в системе. Это означает, что это лучшее место для запуска при просмотре общей работоспособности системы.

В первую очередь необходимо проверить два дополнительных счетчика:

LC: Усрв-00-Дбсторе\\усрв-002 — задержка очереди (МС)

LC: Усрв-00-Дбсторе\\усрв-004-спрок (МС)

Счетчик "Задержка очереди" представляет время, затраченное на выполнение запроса в очереди на серверный сервер, а задержка спрок — время, затраченное на обработку запроса в серверной части. Если по какой либо причине возникают проблемы с диском, памятью, сетью и процессором в серверном интерфейсе, счетчик задержки очереди будет большим.

Кроме того, это может быть высокая при наличии высокой сетевой задержки между интерфейсным сервером и серверным интерфейсом. Так какова допустимая задержка очереди?

На 12 секунд серверы переднего плана начинают регулировать запросы к внутренним серверам. Это означает, что серверы, которые начнут возвращать сервер, слишком заняты — 503 ошибок для клиентов. Работоспособный сервер должен иметь менее 100 мс задержки в очереди в стабильном состоянии, но в то время, когда сервер только что поступил в сеть и одновременно входит в сеть, этот счетчик может быть очень большим и может даже отображаться в течение нескольких секунд.

У вас может быть конфигурация балансировки нагрузки, в которой имеется пул, развернутый с несколькими серверами переднего плана, и подсистемой балансировки нагрузки, настроенной для "минимального числа подключений". В этом случае при перезапуске одного сервера переднего плана все пользователи, пытающиеся выполнить повторное подключение, будут указывать на перезапущенный сервер, так как этот сервер будет иметь меньше подключений по сравнению с другими участниками пула. В течение этого времени соответствующий интерфейсный сервер может быть перегружен, а другие участники пула — нет.

Рекомендуется выполнять обслуживание в нерабочее время, чтобы снизить производительность, так как пользователи не будут конкурировать за собой для одновременного подключения к серверу.

Если предыдущие два счетчика производительности высокие, скорее всего, узкое место является сервер переднего план SQL. Ниже приведены следующие компоненты для подтверждения.

  - Слишком высокий уровень использования ЦП SQL Server? Например, превышает 80 процентов?

  - Задается высокая задержка диска?

В идеальном мире достаточно оперативной памяти для хранения баз данных RTC и журнал RTCDYN в памяти. Затем единственная причина, по которой сервер будет получать доступ к диску, — запись в файлы журнала и сброс в базы данных. В тестах показано, что в 100 000 пользовательских развертываний достаточно 12 ГБ ОЗУ. Предполагается, что суммарный размер баз данных RTC и журнал RTCDYN не превышает 12 ГБ. Если размер баз данных превышает это, может потребоваться дополнительная память.

Чтобы определить, требуется ли серверу SQL Server дополнительную память, просмотрите счетчик производительности "ожидаемый срок службы" на странице диспетчера буферов SQL Server. Значение, меньшее 3 600, указывает на нехватку памяти. Кроме того, при наличии достаточного объема памяти для сервера SQL Server должна быть только запись в базу данных.

Существует дополнительный механизм регулирования на сервере переднего плана Lync Server 2013, который запускается, если время обработки сервера велико. Регулирование задержки Дбсторе включается только в том случае, если задержка на SQL Server высока. Один пример, в котором включена регулировка регулирования, заключается в том, что сервер переднего плана имеет ограниченный доступ к ЦП.

Если среднее время обработки **(LC: SIP-07-Load\\Management SIP-1000 – среднее время хранения для входящих сообщений)** на сервере превышает шесть секунд, сервер переводится в режим регулирования и предоставляет пользователям только одну незавершенную транзакцию для каждого клиентского подключения. Когда время обработки перепадает до трех секунд, сервер выходит из режима регулирования и предоставляет пользователям до 20 незавершенных транзакций на каждое клиентское подключение. Если количество транзакций в конкретном подключении превышает пороговое значение, то подключение помечается как управляемое системой управления версиями. В результате сервер не отправляет никаких почтовых получений, а **аккредитивы: Счетчик соединений с контролируемым числом\\подключений SIP-01-Peer** увеличивается. Если подключение остается в состоянии, управляемом с помощью нескольких минут, сервер закрывает его. Это происходит в неактивном случае. При наличии возможности проверки подключения он определяет, было ли оно отрегулировано слишком долго, и закрывает его, если он имеет более одной минуты.

Это два механизма регулирования и один счетчик производительности, который обобщает то, что, если выполняется регулирование сервера.

**LC: SIP-04-Responses\\sip-053-Local 503 Responses/sec**

  - Термин "Local" (локальный) в предыдущем счетчике относится к локально созданным ответам.

  - Код 503 соответствует серверу, на котором не должны отображаться коды 503 на работоспособном сервере. В течение периода после того как сервер будет просто подключен к сети, вы можете увидеть несколько кодов 503. После того как все пользователи снова подписываются и сервер возвращается в стабильное состояние, не должно быть дополнительных кодов 503.

**LC: SIP-04-Responses\\sip-074-Local 504 Responses/sec**

Этот счетчик производительности указывает на проблемы с подключением к другим серверам и может указывать на ошибки подключения или задержки при подключении. Если вы видите ошибки 504, то должен быть установлен следующий счетчик производительности.

**LC: SIP – 01 – Peers\\SIP — 017 — отправка ожидающих**

Этот счетчик показывает количество запросов в очереди и ответов в очереди. Если этот счетчик высок, то проблема, скорее всего, не на локальном сервере. Обратите внимание, что при наличии проблем с задержкой в сети этот счетчик может быть высоким. Оно также может указывать на проблемы с сетевым адаптером, но скорее всего вызвано неполадкой на удаленном сервере. Этот счетчик, скорее всего, будет высок на сервере директора при перегрузке пула, с которым он пытается общаться. Ключ с этим счетчиком предназначен для просмотра экземпляров, а не только для общего.

</div>

</div>

<span> </span>

</div>

</div>

</div>

