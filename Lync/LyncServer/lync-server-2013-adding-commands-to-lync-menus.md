---
title: Добавление команд в меню Lync
TOCTitle: Добавление команд в меню Lync
ms:assetid: a8443bc2-e234-4022-870a-00700f38b1ea
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg412788(v=OCS.15)
ms:contentKeyID: 52058313
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Добавление команд в меню Lync

 

_**Дата изменения раздела:** 2016-04-11_

Можно добавить настраиваемые команды в меню Lync 2013 и передать универсальный код ресурса (URI) SIP текущего пользователи и выбранные контакты в приложение, запускаемое настраиваемой командой.

Настраиваемые команды, доступные для добавления, могут отображаться в одном или нескольких следующих меню:

  - Меню "Сервис" на панели меню основного окна Lync

  - Меню ярлыков для контактов в списке контактов

  - Меню "Дополнительные параметры" в окне беседы

  - Меню ярлыков для пользователей, включенных в список участников в окне беседы

  - Меню функций в карточке контакта

Можно задавать настраиваемые команды для двух типов приложений, которые могут выполнять следующие действия:

  - Применяться только к текущему пользователю и запускаться на локальном компьютере.

  - Включать дополнительных пользователей (например, программа совместной сетевой работы) и запускаться на компьютере каждого пользователя.

Настраиваемая команда может вызываться следующими способами:

  - Выберите одного или нескольких пользователей, а затем выберите настраиваемую команду.

  - Запустите двустороннюю или многостороннюю беседу, а затем выберите настраиваемую команду.

## Порядок добавления настраиваемой команды

Используйте параметры реестра, представленные в следующей таблице, для добавления команды в меню. Эти записи помещаются в следующий раздел реестра:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Office\\15.0\\Lync\\CustomCommands

### Записи реестра для настраиваемых команд

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Имя</th>
<th>Тип</th>
<th>Данные</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя</p></td>
<td><p>REG_SZ</p></td>
<td><p>Имя приложения в том виде, в котором оно отображается в меню.</p></td>
</tr>
<tr class="even">
<td><p>ApplicationType</p></td>
<td><p>DWORD</p></td>
<td><p>0 = Исполняемый (по умолчанию)</p>

> [!NOTE]
> Требуется ApplicationInstallPath.

<p>1 = Протокол</p></td>
</tr>
<tr class="odd">
<td><p>ApplicationInstallPath</p></td>
<td><p>REG_SZ</p></td>
<td><p>Полный путь к исполняемому файлу.</p>

> [!NOTE]
> Необходимо указать, если для параметра ApplicationType установлено значение 0 (исполняемый).

</td>
</tr>
<tr class="even">
<td><p>Путь</p></td>
<td><p>REG_SZ</p></td>
<td><p>Полный путь для запуска, а также любые другие параметры, включая параметры по умолчанию <em>%user-id%</em> и <em>%contact-id%</em>.</p></td>
</tr>
<tr class="odd">
<td><p>SessionType</p></td>
<td><p>DWORD</p></td>
<td><p>0 = Локальный сеанс. Приложение запускается на локальном компьютере.</p>
<p>1 = Двусторонний сеанс (по умолчанию). Lync 2013 запускает приложение локально, а затем передает уведомление для отображения на рабочем столе другому пользователю. Другой пользователь щелкает уведомление, чтобы запустить приложение на своем компьютере.</p>
<p>2 = Многосторонний сеанс. Lync 2013 запускает приложение локально, а затем передает уведомления для отображения на рабочем столе другим пользователям. Другой пользователь щелкает уведомление, чтобы запустить указанное приложение на своем компьютере.</p></td>
</tr>
<tr class="even">
<td><p>ExtensibleMenu</p></td>
<td><p>REG_SZ</p></td>
<td><p>Список меню, где будет отображаться эта команда, с использованием точек с запятой в качестве разделителей. Возможные значения:</p>
<p>MainWindowActions</p>
<p>MainWindowRightClick</p>
<p>ConversationWindowActions</p>
<p>ConversationWindowRightClick</p>
<p>ContactCardMenu</p>
<p>Если параметр ExtensibleMenu не определен, используются значения по умолчанию MainWindowRightClick и ConversationWindowActions.</p></td>
</tr>
</tbody>
</table>


Например, следующий файл редактора реестра (.REG) показывает результаты добавления элемента меню диспетчера контактов отдела продаж Contoso в меню "Действия" окна "Беседа":

    Windows Registry Editor Version 5.00
    [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\15.0\Lync\CustomCommands\{1F9F07C6-7E0B-462B-AAD7-98C6DBEA8F69}]
    "Name"="Contoso Sales Contact Manager"
    "HelpMessage"="The Contoso Sales Contact Manager is not installed. Contact the Help Desk for more information."
    "ApplicationType"=dword:00000000
    "ApplicationInstallPath"="C:\\cscm.exe"
    "Path"="C:\\cscm.exe %user-id% %contact-id%"
    "SessionType"=dword:00000001
    "ExtensibleMenu"="ConversationWindowActions;MainWindowRightClick"

## Доступ к настраиваемой команде

Чтобы получить доступ к настраиваемой команде после ее добавления, выполните одно из следующих действий (в зависимости от заданных значений ExtensibleMenu):

  - **MainWindowActions**   В главном окне Lync щелкните **Сервис**, а затем щелкните настраиваемую команду.

  - MainWindowRightClick   В главном окне Lync щелкните контакт правой кнопкой мыши, а затем щелкните настраиваемую команду.

  - **ConversationWindowActions**   В окне "Беседа" щелкните значок **Дополнительные параметры**, а затем щелкните настраиваемую команду.

  - **ConversationWindowRightClick**   В окне "Беседа" щелкните правой кнопкой мыши имя контакта, а затем выберите настраиваемую команду.

  - **ContactCardMenu**   В карточке контакта пользователя щелкните значок функций, а затем щелкните настраиваемую команду.

