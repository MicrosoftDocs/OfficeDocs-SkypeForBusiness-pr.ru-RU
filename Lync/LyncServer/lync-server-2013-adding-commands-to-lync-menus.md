---
title: 'Lync Server 2013: Добавление команд в меню Lync'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Adding commands to Lync menus
ms:assetid: a8443bc2-e234-4022-870a-00700f38b1ea
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg412788(v=OCS.15)
ms:contentKeyID: 48185091
ms.date: 04/11/2016
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 738f745d4f91458b95e95e5cc5770c34ed4e8c88
ms.sourcegitcommit: 4d6bf5c58b2c553dc1df8375ede4a9cb9eaadff2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "48521356"
---
# <a name="adding-commands-to-lync-menus-in-lync-server-2013"></a>Добавление команд в меню Lync в Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2016-04-11_

Вы можете добавлять пользовательские команды в меню Lync 2013 и передавать универсальный код ресурса (URI) SIP текущего пользователя и выбранные контакты в приложение, с которого начинается пользовательская команда.

Настраиваемые команды, которые вы добавляете, могут отображаться в одном или нескольких из следующих меню:

  - Меню "Сервис" в строке меню в главном окне Lync

  - Контекстное меню контактов в списке контактов.

  - Меню дополнительных параметров в окне беседы

  - Контекстное меню для пользователей, перечисленных в списке участников окна беседы

  - Меню параметров в карточке контакта

Можно определить пользовательские команды для двух типов приложений — приложений, которые выполняют одно из следующих действий:

  - Применяется только к текущему пользователю и запускается на локальном компьютере.

  - Включение дополнительных пользователей, например программы для совместной работы, и их необходимо запускать на компьютере каждого пользователя.

Пользовательская команда может быть вызвана следующими способами:

  - Выберите одного или нескольких пользователей, а затем выберите команду Пользовательская.

  - Начните двустороннюю или многосторонний разговор, а затем выберите команду Пользовательская.

<div>

## <a name="to-add-a-custom-command"></a>Добавление настраиваемой команды

Используйте параметры реестра, указанные в приведенной ниже таблице, для добавления команды в меню. Эти записи размещаются в реестре в одном из следующих расположений:

  - Для 32 – 32 OS \_ : \_ программное обеспечение для ЛОКАЛЬНОГО компьютера hKey \\ \\ Microsoft \\ Office \\ 15,0 \\ Lync \\ сессионманажер \\ Apps

  - Для 64 64 OS: \_ \_ \\ программное обеспечение для локального компьютера \\ WOW6432Node \\ Microsoft \\ Office \\ 15,0 \\ Lync \\ сессионманажер \\ Apps

### <a name="custom-command-registry-entries"></a>Записи реестра настраиваемых команд

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Имя</th>
<th>Тип</th>
<th>Данные</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя</p></td>
<td><p>REG_SZ</p></td>
<td><p>Имя приложения в том виде, в котором оно отображается в меню.</p></td>
</tr>
<tr class="even">
<td><p>ApplicationType</p></td>
<td><p>DWORD</p></td>
<td><p>0 = исполняемый файл (по умолчанию)</p>
<div>

> [!NOTE]  
> Требуется Аппликатионинсталлпас.


</div>
<p>1 = протокол</p></td>
</tr>
<tr class="odd">
<td><p>аппликатионинсталлпас</p></td>
<td><p>REG_SZ</p></td>
<td><p>Полный путь к исполняемому файлу.</p>
<div>

> [!NOTE]  
> Должен быть указан, если Аппликатионтипе имеет значение 0 (исполняемый файл).


</div></td>
</tr>
<tr class="even">
<td><p>Path</p></td>
<td><p>REG_SZ</p></td>
<td><p>Полный путь, который необходимо запустить вместе с параметрами, включая параметры по умолчанию <em>% User/ID%</em> и <em>% Contact – ID%</em>.</p></td>
</tr>
<tr class="odd">
<td><p>сессионтипе</p></td>
<td><p>DWORD</p></td>
<td><p>0 = локальный сеанс. Приложение запускается на локальном компьютере.</p>
<p>1 = двусторонний сеанс (по умолчанию). Lync 2013 запускает приложение локально, а затем отправляет уведомление на Рабочий стол другому пользователю. Другой пользователь щелкает уведомление, чтобы запустить приложение на своем компьютере.</p>
<p>2 = многокомпонентный сеанс. Lync 2013 запускает приложение локально, а затем отправляет уведомления о рабочем столе другим пользователям. Другой пользователь щелкает уведомление, чтобы запустить указанное приложение на своем компьютере.</p></td>
</tr>
<tr class="even">
<td><p>екстенсиблемену</p></td>
<td><p>REG_SZ</p></td>
<td><p>Список меню, в котором будет отображаться эта команда, разделенных точкой с запятой. Возможные значения:</p>
<p>маинвиндовактионс</p>
<p>маинвиндовригхткликк</p>
<p>конверсатионвиндовактионс</p>
<p>конверсатионвиндовригхткликк</p>
<p>контакткардмену</p>
<p>Если Екстенсиблемену не определен, используются значения по умолчанию Маинвиндовригхткликк и Конверсатионвиндовактионс.</p></td>
</tr>
</tbody>
</table>


Например, в следующем редакторе реестра (. REG) в окне беседы отображаются результаты добавления пункта меню "Диспетчер контактов Contoso" в меню действий.

    Windows Registry Editor Version 5.00
    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\15.0\Lync\SessionManager\Apps\{1F9F07C6-7E0B-462B-AAD7-98C6DBEA8F69}]
    "Name"="Contoso Sales Contact Manager"
    "HelpMessage"="The Contoso Sales Contact Manager is not installed. Contact the Help Desk for more information."
    "ApplicationType"=dword:00000000
    "ApplicationInstallPath"="C:\\cscm.exe"
    "Path"="C:\\cscm.exe %user-id% %contact-id%"
    "SessionType"=dword:00000001
    "ExtensibleMenu"="ConversationWindowActions;MainWindowRightClick"

</div>

<div>

## <a name="to-access-a-custom-command"></a>Доступ к настраиваемой команде

Чтобы получить доступ к настраиваемой команде после ее добавления, выполните одно из следующих действий в зависимости от определяемых значений Екстенсиблемену:

  - **Маинвиндовактионс**     В главном окне Lync откройте меню **Сервис**и выберите команду Пользовательская.

  - **Маинвиндовригхткликк**     В главном окне Lync щелкните контакт правой кнопкой мыши и выберите пользовательскую команду.

  - **Конверсатионвиндовактионс**     В окне беседы щелкните значок **Дополнительные параметры** , а затем выберите пользовательскую команду.

  - **Конверсатионвиндовригхткликк**     В окне беседы щелкните правой кнопкой мыши имя контакта и выберите пользовательскую команду.

</div>

</div>

<span> </span>

</div>

</div>

</div>

