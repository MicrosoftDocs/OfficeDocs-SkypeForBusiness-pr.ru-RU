---
title: 'Lync Server 2013: изменение сертификатов для мобильной работы'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
TOCTitle: Modifying certificates for mobility
ms:assetid: 4e9107af-20f4-4c2a-8c98-ca35b39a4e2d
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Hh690015(v=OCS.15)
ms:contentKeyID: 48184120
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: bccb901f241089a21fd7428e28b005f46e157300
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "34826859"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="modifying-certificates-for-mobility-in-lync-server-2013"></a>Изменение сертификатов для мобильной работы в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-06-20_

Для обеспечения защищенных подключений между средой Lync и мобильными клиентами вы должны обновить сертификаты SSL для вашего пула, а также для пользовательского пула и обратного прокси-сервера с помощью дополнительного имени субъекта ( SAN). Если вам нужно получить дополнительные сведения о требованиях к сертификату для мобильных устройств, ознакомьтесь с разделом требования к сертификату в [технических требованиях для мобильных устройств в Lync Server 2013](lync-server-2013-technical-requirements-for-mobility.md), но, по сути, вам понадобится получать новые сертификаты из Центр сертификации с дополнительными записями SAN, а затем добавьте эти сертификаты, выполнив действия, описанные в этой статье.

Конечно, прежде чем приступить к работе, лучше узнать, какие другие имена уже есть у ваших сертификатов. Если вы не уверены в том, что уже настроено, вы можете узнать, как это сделать. Несмотря на то, что вы можете использовать команды **Get-ксцертификате** и других команд PowerShell для просмотра этих данных (что мы рассмотрим ниже) по умолчанию, что данные будут обрезаны, поэтому вам может не получиться Просмотреть все нужные свойства. Чтобы получить хорошее представление о сертификате и всех его свойствах, вы можете открыть консоль управления (MMC) и загрузить оснастку "сертификаты" (которую также можно проанализировать ниже) или просто установить мастер развертывания Lync Server.

Как указано выше, описанные выше действия помогут вам обновить сертификаты с помощью командной консоли Lync Server Management Shell и MMC. Если вы заинтересованы в использовании мастера сертификатов в мастере развертывания Lync Server, вы можете проверить [настройку сертификатов для режиссера в Lync server 2013](lync-server-2013-configure-certificates-for-the-director.md) для режиссера или режиссера, если вы настроили один из них (возможно, вы не есть). Для внешнего сервера или пула переднего плана вам потребуется [настроить сертификаты для серверов в Lync Server 2013](lync-server-2013-configure-certificates-for-servers.md).

Последнее, что следует помнить, — может иметься один сертификат по умолчанию в среде Lync Server 2013 или отдельные сертификаты для по умолчанию (все, кроме веб-служб), Вебсервицесекстернал и Вебсервицесинтернал. Если вы не хотите настраивать конфигурацию, вам помогут эти действия.

<div>

## <a name="to-update-certificates-with-new-subject-alternative-names-using-the-lync-server-management-shell"></a>Обновление сертификатов с использованием новых альтернативных имен для некоторых субъектов с помощью командной консоли Lync Server Management Shell

1.  Необходимо войти на сервер Lync Server 2013 с помощью учетной записи, обладающей правами и разрешениями локального администратора. Кроме того, если вы запускаете **запрос PowerShell — ксцертификате** на шагах 12 и более поздних, учетной записи должны быть предоставлены права на указанный центр сертификации (ЦС).

2.  Запустите командную консоль Lync Server Management Shell: нажмите кнопку **Пуск**, выберите **все программы**, а затем — **Microsoft Lync Server 2013**, а затем — **Командная консоль Lync Server Management Shell**.

3.  Прежде чем вы сможете назначить обновленный сертификат, вам нужно узнать, какие сертификаты были назначены серверу и для какого типа использования. В командной строке выполните следующую команду:
    
        Get-CsCertificate

4.  Просмотрите результаты предыдущего шага, чтобы узнать, назначен ли один сертификат для нескольких применений, или назначается ли другой сертификат для каждого использования. Чтобы узнать, как будет использоваться сертификат, найдите параметр Use. Сравните параметр отпечатка для выводимых сертификатов, чтобы узнать, используется ли один и тот же сертификат несколько. Проследите за параметром отпечатка.

5.  Обновите сертификат. В командной строке выполните следующую команду:
    
        Set-CsCertificate -Type <type of certificate as displayed in the Use parameter> -Thumbprint <unique identifier>
    
    Например, если командлет **Get-ксцертификате** показывает сертификат с использованием параметров по умолчанию, другой — с помощью вебсервицесинтернал, а другой — с помощью вебсервицесекстернал, и все они имеют одинаковое значение отпечатка в командной строке команду
    
        Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
    
    **Важно!**
    
    Если вы назначаете отдельный сертификат для каждого использования (поэтому значение отпечатка, которое вы проверили выше для каждого сертификата), крайне важно, чтобы вы **не** выполняли командлет **Set-ксцертификате** с несколькими типами, как в приведенном выше примере. В этом случае выполните командлет **Set-ксцертификате** отдельно для каждого использования. Например:
    
        Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>

6.  Чтобы просмотреть сертификат (или сертификаты), нажмите кнопку **Пуск**и выберите команду **выполнить...**. Введите MMC, чтобы открыть консоль управления MMC.

7.  В меню MMC выберите пункт **файл**, а затем — **Добавить или удалить оснастку...**, выберите пункт Сертификаты. Нажмите **Добавить**. При появлении соответствующего запроса выберите пункт **учетная запись компьютера**, а затем нажмите кнопку **Далее**.

8.  Если это сервер, на котором находится сертификат, выберите **локальный компьютер**. Если сертификат расположен на другом компьютере, выберите **другой компьютер**, а затем введите полное доменное имя компьютера или нажмите кнопку **Обзор** в поле **введите имя нужного объекта**и введите его имя. компьютер. Нажмите кнопку **Проверить имена**. После разрешения имени компьютера оно будет подчеркнуто. Нажмите кнопку **ОК**, а затем — **Готово**. Нажмите кнопку **ОК** , чтобы завершить выбор и закрыть диалоговое окно **Добавление и удаление оснасток** .

9.  Чтобы просмотреть свойства сертификата, разверните раздел **Сертификаты**и выберите пункт **Личные**, а затем — **Сертификаты**. Выберите сертификат для просмотра, щелкните сертификат правой кнопкой мыши и выберите команду **Открыть**.

10. В представлении **сертификата** выберите **сведения**. Здесь вы можете выбрать имя субъекта сертификата, выделив **тему** , а также отобразить назначенное имя субъекта и связанные свойства.

11. Чтобы просмотреть назначенные альтернативные имена для темы, выберите **дополнительное имя субъекта**. Здесь отображаются все назначенные альтернативные имена для темы. Поиск по умолчанию альтернативных имен для темы имеет тип **DNS-имя** . Должны отобразиться следующие участники (все должны быть полные доменные имена, представленные в DNS-адресах (а или, если записи IPv6 AAAA).
    
      - Имя пула для этого пула или имя отдельного сервера, если он не является пулом
    
      - Имя сервера, которому назначен сертификат
    
      - Простые URL-записи, обычно соответствующие требованиям и набору номера
    
      - Внутренние имена внутренних и веб-служб (например, webpool01.contoso.net, webpool01.contoso.com), основанные на вариантах, сделанных в построителе топологии, и переопределяемые выборы веб-служб.
    
      - Если уже назначено, lyncdiscover. \<сипдомаин\> и линкдисковеринтернал. \<сипдомаин\> записи.
    
    Последний элемент — это то, что вам интересно, если у тебя есть lyncdiscover и линкдисковеринтернал сеть SAN.
    
    Если вы хотите проверить несколько сертификатов, повторите эти действия. После получения этих сведений вы можете закрыть представление сертификата и MMC.

12. Если отсутствует альтернативное имя субъекта службы автообнаружения и используется один сертификат по умолчанию для типов по умолчанию, Вебсервицесинтернал и Вебсервицеекстернал, выполните указанные ниже действия.
    
      - В командной строке оболочки Lync Server Management Shell введите:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. Если вы используете параметр DomainName, вам нужно определить полное доменное имя для записей линкдисковеринтернал и lyncdiscover. Например:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - Чтобы назначить сертификат, введите следующее:
        
            Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где "отпечаток" — это отпечаток для нового выданного сертификата.

13. Для отсутствующей внутренней сети SAN для автообнаружения при использовании отдельных сертификатов для параметров по умолчанию, Вебсервицесинтернал и Вебсервицесекстернал выполните указанные ниже действия.
    
      - В командной строке оболочки Lync Server Management Shell введите:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. При использовании параметра DomainName вы можете использовать соответствующий префикс для доменного имени SIP domain. Например:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - Чтобы получить отсутствующее дополнительное имя для субъекта автообнаружения, в командной строке введите:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. При использовании параметра DomainName вы можете использовать соответствующий префикс для доменного имени SIP domain. Например:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -DomainName "Lyncdiscover.contoso.com, Lyncdiscover.contoso.net" -verbose
    
      - Чтобы назначить индивидуальные типы сертификатов, введите следующую команду:
        
            Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где "отпечаток" — это отпечаток для вновь выданных индивидуальных сертификатов.
    
    <div>
    

    > [!NOTE]  
    > Обратите внимание, что шаги 12 и 13 должны выполняться только в том случае, если у учетной записи, с которой они работают, есть доступ к центру сертификации с необходимыми разрешениями. Если вы не можете войти в систему с помощью учетной записи, для которой у вас есть такие разрешения, или если у вас есть общедоступный или удаленный центр сертификации для ваших сертификатов, вам потребуются мастер развертывания Lync Server, который был использован в верхней части данной.

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

