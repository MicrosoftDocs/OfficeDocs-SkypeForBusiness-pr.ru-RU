---
title: 'Lync Server 2013: изменение сертификатов для мобильной работы'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Modifying certificates for mobility
ms:assetid: 4e9107af-20f4-4c2a-8c98-ca35b39a4e2d
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Hh690015(v=OCS.15)
ms:contentKeyID: 48184120
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 54b42ba288c89f8735d3f7d13dee9a1944efe82b
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42048750"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="modifying-certificates-for-mobility-in-lync-server-2013"></a>Изменение сертификатов для мобильных устройств в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2014-06-20_

Для поддержки безопасных подключений между средой Lync и мобильными клиентами необходимо обновить сертификаты SSL для пула директоров, интерфейсного пула и обратного прокси-сервера с помощью дополнительного имени субъекта ( SAN). Если вам нужно узнать больше о требованиях к сертификатам для мобильных устройств, ознакомьтесь со статьей "требования к сертификату" в разделе [технические требования для мобильных устройств в Lync Server 2013](lync-server-2013-technical-requirements-for-mobility.md), но в основном вам потребуется получить новые сертификаты из центра сертификации с дополнительными записями San, а затем добавить их, выполнив действия, описанные в этой статье.

Конечно, прежде чем начать, рекомендуется знать, какие альтернативные имена субъектов уже имеют сертификаты. Если вы не уверены в том, что уже настроено, существует множество способов. В этом случае можно выполнить команды **Get-CsCertificate** и другие команды PowerShell для просмотра этих сведений (по умолчанию), чтобы эти данные были усечены, поэтому вы можете не увидеть все необходимые свойства. Чтобы получить хорошее представление о сертификате и всех его свойствах, перейдите в консоль управления (MMC) и загрузите оснастку "сертификаты" (Кроме того, вы также можете выполнить описанные ниже шаги) или просто проверьте мастер развертывания Lync Server.

Как отмечалось выше, приведенные выше действия позволят выполнить обновление сертификатов с помощью командной консоли Lync Server и консоли управления (MMC). Если вы заинтересованы в использовании мастера сертификатов в мастере развертывания Lync Server, то можно проверить [настройку сертификатов для директора в Lync server 2013](lync-server-2013-configure-certificates-for-the-director.md) для директории или пула директоров, если вы настроили один из них (возможно, у вас его нет). Для сервера переднего плана или интерфейсного пула необходимо ознакомиться с [настройками сертификатов для серверов в Lync Server 2013](lync-server-2013-configure-certificates-for-servers.md).

Последнее, что следует учитывать, это то, что у вас может быть один сертификат по умолчанию в среде Lync Server 2013, или вы можете использовать отдельные сертификаты для по умолчанию (все, кроме веб-служб), WebServicesExternal и WebServicesInternal. Как и в вашей конфигурации, эти действия должны помочь вам.

<div>

## <a name="to-update-certificates-with-new-subject-alternative-names-using-the-lync-server-management-shell"></a>Обновление сертификатов с использованием новых альтернативных имен субъектов с помощью командной консоли Lync Server

1.  Необходимо выполнить вход на сервер Lync Server 2013 с помощью учетной записи с правами и разрешениями локального администратора. Кроме того, если вы используете PowerShell **request-CsCertificate** в шагах 12 и более поздних, учетная запись должна иметь права на доступ к указанному центру сертификации (CA).

2.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

3.  Прежде чем назначать обновленный сертификат, вам необходимо узнать, какие сертификаты были назначены серверу и для какого типа использования. В командной строке введите следующую команду.
    
        Get-CsCertificate

4.  Просмотрите результаты предыдущего действия, чтобы узнать, был ли один сертификат назначен для нескольких вариантов использования или назначен ли другой сертификат для каждого использования. Просмотрите параметр Use, чтобы узнать, как используется сертификат. Сравните параметр  Thumbprint для отображаемых сертификатов, чтобы узнать, имеет ли один сертификат несколько использований. Следите за параметром Thumbprint.

5.  Обновите сертификат. Введите в командной строке следующее:
    
        Set-CsCertificate -Type <type of certificate as displayed in the Use parameter> -Thumbprint <unique identifier>
    
    Например, если командлет **Get – CsCertificate** показывает сертификат с использованием параметра Default, другой с использованием WebServicesInternal и другой с использованием WebServicesExternal, и все они имели одинаковое значение отпечатка, в командной строке введите:
    
        Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
    
    **Важно!**
    
    Если для каждого использования назначается отдельный сертификат (поэтому значение отпечатка, указанное выше для каждого сертификата), крайне важно, чтобы **не** выполнять командлет **Set-CsCertificate** с несколькими типами, как в приведенном выше примере. В данном случае отдельно запустите командлет **Set-CsCertificate** для каждого использования. Например:
    
        Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
        Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>

6.  Чтобы просмотреть сертификат (или сертификаты), нажмите кнопку **Пуск**, выберите пункт **выполнить...**. Введите MMC, чтобы открыть консоль управления (MMC).

7.  В меню консоли управления (MMC) выберите **Файл**, **Добавить или удалить оснастку…**, «Сертификаты». Нажмите кнопку **Добавить**. При отображении запроса выберите **учетной записи компьютера**, а затем нажмите кнопку **Далее**.

8.  Если это сервер, на котором расположен сертификат, выберите **локальный компьютер**. Если сертификат находится на другом компьютере, выберите **другой компьютер**, а затем введите полное доменное имя компьютера или нажмите кнопку **Обзор** в поле **введите имя объекта для выбора**и введите имя компьютера. Нажмите кнопку **Проверить имена**. Когда имя компьютера разрешается, оно будет подчеркиванием. Нажмите кнопку **ОК**, а затем кнопку **Готово**. Нажмите кнопку **ОК** для подтверждения выбора и закройте диалоговое окно **Добавление и удаление оснасток**.

9.  Чтобы просмотреть свойства сертификата, разверните узел **Сертификаты**, разверните узел **Личные** и выберите элемент **Сертификаты**. Выберите сертификат для просмотра, щелкните его правой кнопкой мыши и выберите пункт **Открыть**.

10. В представлении **Сертификат** выберите элемент **Сведения**. Здесь вы можете выбрать имя субъекта сертификата, выбрав элемент **Субъект**, после чего отображаются назначенное имя субъекта и связанные свойства.

11. Чтобы просмотреть назначенные альтернативные имена субъектов, выберите **Альтернативное имя субъекта**. Здесь отображаются все назначенные альтернативные имена субъектов. Альтернативные имена субъектов, найденные здесь, имеют тип **DNS-имени** по умолчанию. Вам следует просмотреть следующие элементы (в соответствии с записями DNS-узла (A либо AAAA для IPv6) все они должны быть полными доменными именами:
    
      - Имя пула для этого пула или имя отдельного сервера, если это не пул
    
      - Имя сервера, которому назначен сертификат
    
      - Записи простых URL-адресов (обычно meet и dialin)
    
      - Внутренние имена веб-служб и внешние имена веб-служб (например, webpool01.contoso.net, webpool01.contoso.com), основанные на вариантах, сделанных в построителе топологий и переопределенных на выборе веб-службах.
    
      - Если уже назначено, lyncdiscover. \<sipdomain\> и lyncdiscoverinternal. \<записи\> sipdomain.
    
    Последний элемент является наиболее подинтересующимся: при наличии записи SAN lyncdiscover и lyncdiscoverinternal.
    
    Повторите эти действия, если вы хотите проверить несколько сертификатов. После получения этой информации вы можете закрыть представление сертификата и консоль управления (MMC).

12. Если отсутствует альтернативное имя субъекта службы автообнаружения и вы используете один сертификат Default для типов Default, WebServicesInternal и WebServiceExternal, выполните следующие действия:
    
      - В командной строке командной строки командной консоли Lync Server введите:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. При использовании параметра имя_домена необходимо определить полное доменное имя для записей lyncdiscoverinternal и lyncdiscover. Например:
        
            Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - Чтобы назначить сертификат, введите следующее:
        
            Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где «Thumbprint» — это отпечаток, отображаемый для недавно выданного сертификата.

13. Для отсутствия внутренней сети хранения данных для автообнаружения при использовании отдельных сертификатов для значений по умолчанию, WebServicesInternal и WebServicesExternal выполните следующие действия:
    
      - В командной строке командной строки командной консоли Lync Server введите:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. При использовании параметра имя_домена необходимо использовать соответствующий префикс для полного доменного имени домена SIP. Например:
        
            Request-CsCertificate -New -Type WebServicesInternal -Ca dc\myca -DomainName "LyncdiscoverInternal.contoso.com, LyncdiscoverInternal.contoso.net" -verbose
    
      - В случае отсутствия внешнего альтернативного имени субъекта автообнаружения введите в командной строке следующее:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -AllSipDomain -verbose
        
        Если у вас много доменов SIP, вы не можете использовать новый параметр Аллсипдомаин. Вместо этого необходимо использовать параметр DomainName. При использовании параметра имя_домена необходимо использовать соответствующий префикс для полного доменного имени домена SIP. Например:
        
            Request-CsCertificate -New -Type WebServicesExternal -Ca dc\myca -DomainName "Lyncdiscover.contoso.com, Lyncdiscover.contoso.net" -verbose
    
      - Чтобы назначить индивидуальные типы сертификатов, введите следующее:
        
            Set-CsCertificate -Type Default -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesInternal -Thumbprint <Certificate Thumbprint>
            Set-CsCertificate -Type WebServicesExternal -Thumbprint <Certificate Thumbprint>
        
        Где «Thumbprint» — это отпечаток, отображаемый для недавно выданных индивидуальных сертификатов.
    
    <div>
    

    > [!NOTE]  
    > Обратите внимание, что шаги 12 и 13 следует выполнять только в том случае, если у учетной записи, выполняющей их, есть доступ к центру сертификации с соответствующими разрешениями. Если вы не можете войти в систему с помощью учетной записи, которой предоставлены эти разрешения, или если вы используете общедоступный или удаленный центр сертификации для ваших сертификатов, вам потребуется запросить их через мастер развертывания Lync Server, который был использован в начале настоящей.

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

