---
title: 'Lync Server 2013: Управление объявлениями во время аварийного восстановления'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Manage announcements during disaster recovery
ms:assetid: c33e51ea-421f-42d2-826b-b73968f6bd5b
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ721874(v=OCS.15)
ms:contentKeyID: 49733807
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 0f7c54293205ac9246db39950e701074b12a42a6
ms.sourcegitcommit: 33db8c7febd4cf1591e8dcbbdfd6fc8e8925896e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "42137638"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">

# <a name="manage-announcements-during-disaster-recovery-in-lync-server-2013"></a>Управление объявлениями во время аварийного восстановления в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2013-02-23_

Lync Server 2013 поддерживает извещения о вызовах неназначенных номеров во время простоев. Восстановление функциональности оповещений во время отказа не является обязательным. Если вы выбираете восстановление оповещений во время отказа, то необходимо пересоздать конфигурацию оповещений в резервном пуле. В этом разделе описываются действия, которые необходимо выполнить для восстановления оповещений при аварийном восстановлении.

Этот раздел относится к диапазонам неназначенных номеров, использующим приложение "извещения". Этот раздел не относится к диапазонам неназначенных номеров, использующим автосекретарь единой системы обмена сообщениями Exchange.

<div>

## <a name="before-an-outage"></a>До отказа

Независимо от того, хотите ли вы использовать объявления во время простоя, следует создать отдельные резервные копии всех настраиваемых звуковых файлов, настроенных для приложения оповещений. Не выполняется резервное копирование настраиваемых оповещений в рамках процесса аварийного восстановления Lync Server. Если не взять отдельные резервные копии файлов, и файлы, отправленные на сервер или в пул, будут повреждены, испорчены или очищены, то они будут потеряны.

Если у вас нет резервных копий настраиваемых звуковых файлов, а исходные аудиофайлы больше недоступны, вы можете найти звуковые файлы, настроенные для приложения оповещений, в хранилище файлов для сервера или пула, где вы изначально импортированы файлы. Вы можете скопировать все звуковые файлы, настроенные для приложения оповещений из хранилища файлов.

**Копирование звуковых файлов из хранилища файлов**

1.  В командной строке выполните следующую команду:
    
        Xcopy <Source: Pool Announcement Service File Store path> <Destination>
    
    Пример:
    
        Xcopy "<Pool File Store Path>\X-ApplicationServer-X\AppServerFiles\RGS\AS" "<Destination: Backup location>"
    
    Здесь X-ApplicationServer-X ссылается на идентификатор службы сервера приложений пула (например, 1-ApplicationServer-1")


</div>

<div>

## <a name="during-an-outage"></a>Во время отказа

Чтобы использовать приложение извещения во время сбоя, необходимо повторно создать конфигурацию объявлений в резервном пуле, выполнив действия, описанные в этом разделе.

<div>


> [!NOTE]  
> Рекомендуется выполнять эти задачи после перехода резервный пул при отказе, поскольку после выполнения действия 2 резервный пул становится владельцем диапазонов не назначенных номеров.



</div>

<div>


> [!NOTE]  
> Для диапазонов номеров, использующих телефонный номер автосекретаря единой системы обмена сообщениями Exchange, выполнение этих действий не требуется.



</div>

**Повторное создание конфигурации оповещений в резервном пуле**

1.  Пересоздайте в резервном пуле оповещения, развернутые в основном пуле, выполнив следующие действия.
    
    1.  Импортируйте все звуковые файлы, используемые в основном пуле, в резервный пул с помощью командлета **Import-CsAnnouncementFile**, указав резервный пул в параметре Parent.
    
    2.  Пересоздайте каждое оповещение с помощью командлета **New-CsAnnouncement**, указав резервный пул в параметре Parent.
    
    <div>
    

    > [!NOTE]  
    > Сведения о том, как использовать эти параметры для создания оповещений в резервном пуле, можно узнать <A href="lync-server-2013-create-an-announcement.md">в статье Create a извещения в Lync Server 2013</A>.

    
    </div>

2.  После пересоздания всех оповещений в резервном пуле перенаправьте все диапазоны не назначенных номеров, использующие оповещения в основном пуле, к пересозданным оповещениям в резервном пуле.
    
    Для каждого диапазона не назначенных номеров, использующего оповещение из основного пула, выполните следующую команду:
    
        Set-CsUnassignedNumber -Identity "<name of number range>" -AnnouncementService "<FQDN of backup pool>" -AnnouncementName "<announcement name in backup pool>"

</div>

<div>

## <a name="after-the-outage"></a>После отказа

Когда основной пул станет доступным, необходимо перенаправить диапазоны не назначенных номеров, измененные при отказе, обратно в основной пул.

<div>


> [!NOTE]  
> Для диапазонов номеров, использующих телефонный номер автосекретаря единой системы обмена сообщениями Exchange, выполнение этих действий не требуется.



</div>

**Восстановление объявлений в основном пуле**

1.  Если пришлось перестроить основной пул во время восстановления, то необходимо пересоздать оповещения в основном пуле, импортировав звуковые файлы и создав оповещения, как это делалось для резервного пула, только не нужно указывать основной пул в параметре Parent. Подробные сведения см. в разделе "Во время отказа" выше в этой статье.

2.  Для каждого диапазона не назначенных номеров, измененного во время отказа, выполните следующую команду:
    
        Set-CsUnassignedNumber [-Identity "<name of number range>"] -AnnouncementService "<FQDN of primary pool>" -AnnouncementName "<announcement name in primary pool>"

3.  Дополнительно можно удалить оповещения, пересозданные в резервном пуле. Получение списка извещений для приложения извещения о резервном копировании пула. В командной строке выполните следующую команду:
    
        Get-CsAnnouncement -Identity "<Service:service ID>"
    
    Пример:
    
        Get-CsAnnouncement -Identity "ApplicationServer:redmond.contoso.com
    
    В полученном списке найдите оповещения, которые требуется удалить, и скопируйте их GUID. Для каждого оповещения, которое требуется удалить, выполните следующую команду:
    
        Remove-CsAnnouncement -Identity "<Service:service ID/guid>"
    
    Пример:
    
        Remove-CsAnnouncement -Identity "ApplicationServer:redmond.contoso.com/1951f734-c80f-4fb2-965d-51807c792b90"


</div>

</div>

<span> </span>

</div>

</div>

</div>

