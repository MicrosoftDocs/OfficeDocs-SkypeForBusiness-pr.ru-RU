---
title: 'Lync Server 2013: тестирование push-уведомлений на Интеллектуальные телефоны'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Test push notifications to smart phones
ms:assetid: 8f5ca7d1-1ccb-4cb0-b417-730559e79b6e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn767948(v=OCS.15)
ms:contentKeyID: 63969626
ms.date: 03/15/2017
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 94daa288757e2a0af446b455b951af9a990147b3
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2020
ms.locfileid: "41746219"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="test-push-notifications-to-smart-phones-in-lync-server-2013"></a>Тестирование push-уведомлений на смартфоны в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2017-03-15_


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>Расписание проверки</p></td>
<td><p>Ежемесячно</p></td>
</tr>
<tr class="even">
<td><p>Средство тестирования</p></td>
<td><p>Windows PowerShell</p></td>
</tr>
<tr class="odd">
<td><p>Требуемые разрешения</p></td>
<td><p>При локальном запуске с помощью командной консоли Lync Server пользователи должны быть членами группы безопасности Рткуниверсалсерверадминс.</p>
<p>При запуске с помощью удаленного экземпляра Windows PowerShell пользователям должна быть назначена роль RBAC, имеющая разрешение на запуск командлета Test-Ксмккспушнотификатион. Чтобы просмотреть список всех ролей RBAC, которые могут использовать этот командлет, выполните в командной строке Windows PowerShell следующую команду:</p>
<pre><code>Get-CsAdminRole | Where-Object {$_.Cmdlets -match &quot;Test-CsMcxPushNotification&quot;}</code></pre></td>
</tr>
</tbody>
</table>


<div>

## <a name="description"></a>Описание

Служба push-уведомлений (службы push-уведомлений Apple и Служба push-уведомлений Майкрософт) может отправлять уведомления о событиях, например о новых мгновенных сообщениях и голосовой почте на мобильных устройствах, таких как iPhone и телефоны Windows, даже если клиент Lync на этих устройствах в настоящее время приостановлено или запущено в фоновом режиме. Служба push-уведомлений — это облачная служба, выполняемая на серверах Microsoft. Чтобы воспользоваться преимуществами push-уведомлений, вы должны иметь возможность подключения и проверки подлинности с помощью службы push-уведомлений. Командлет Test-Ксмккспушнотификатион позволяет администраторам проверять, можно ли перенаправлять запросы на push-уведомления через пограничный сервер в расчетную палату push-уведомлений.

</div>

<div>

## <a name="running-the-test"></a>Выполнение теста

Для проверки службы извещающих уведомлений вызовите командлет Test-Ксмккспушнотификатион. Убедитесь, что вы указали полное доменное имя пограничного сервера:

    Test-CsMcxPushNotification -AccessEdgeFqdn "atl-edge-001.litwareinc.com"

Дополнительные сведения можно найти в разделе справки по командлету [Test-ксмккспушнотификатион](https://docs.microsoft.com/powershell/module/skype/Test-CsMcxPushNotification) .

</div>

<div>

## <a name="determining-success-or-failure"></a>Определение успеха или сбоя

Если Test-Ксмккспушнотификатион завершается успешно, командлет вернет результат теста:

Таржетфкдн: atl-cs-001.litwareinc.com

Результат: успех

Задержка: 00:00:00

Ошибки

Диагностик

Если при тестировании Ксмккспушнотификатион не удается подключиться к расчетной палате push-уведомлений, этот командлет обычно не возвращает результат теста "сбой". Вместо этого, как правило, команда завершается сбоем. Например:

Test-Ксмккспушнотификатион: ответ 504 (время ожидания сервера), полученный от сети, не прошел операцию. Дополнительные сведения приведены в разделе сведения об исключении.

В строке: 1 символ: 27

\+Test-ксмккспушнотификатион \< \< \< \< -акцесседжефкдн lyncedge.mydomain.com

\+Категоринфо: Оператионстоппед: (:) \[Test-ксмккспушнотификатион\], фаилуререспонсиксцептион

\+Фулликуалифиедеррорид: Воркфловноткомплетед, Microsoft. RTC. Management. Синсетиктрансактионс. Тестмккспушнотификатионкмдлет

</div>

<div>

## <a name="reasons-why-the-test-might-have-failed"></a>Причины, по которым может произойти сбой теста

Если происходит сбой службы push-уведомлений, которая обычно указывает на наличие проблем с подключением пограничного сервера или проблем с подключением к клирингового отсоединению push-уведомлений. Если при выполнении теста-Ксмккспушнотификатион возникли проблемы, необходимо убедиться, что пограничный сервер работает правильно. Один из способов сделать это — воспользоваться командлетом Test-Ксаведжеконнективити:

    $credential = Get-Credential "litwareinc\kenmyer"
    
    Test-CsAVEdgeConnectivity -TargetFqdn "atl-cs-001.litwareinc.com" -UserSipAddress "sip:kenmyer@litwareinc.com" -UserCredential $credential

Эта проверка удостоверяет, что указанный пользователь может подключаться к пограничного сервера.

Если пограничный сервер работает правильно, это часто означает, что вы не можете подключиться к расчетной палате push-уведомлений. В свою очередь, обычно это означает, что вы неправильно настроили URI расчетной палаты или не обладаете DNS SRV-записью, указывающей на этот URL-адрес. Вы можете проверить, правильно ли задано значение универсального кода ресурса (sip:push@push.lync.com), выполнив следующую команду:

    Get-CsMcxConfiguration

Если для свойства Пушнотификатионпроксюри задано значение, отличное от sip:push@push.lync.com, то эту проблему можно устранить с помощью командлета Set-Мкксконфигуратион. Например, эта команда правильно задает универсальный код ресурса (URI) для всей Организации.

    Get-CsMcxConfiguration | Set-CsMcxConfiguration -PushNotificationProxyUri "sip:push@push.lync.com"

Дополнительные сведения можно найти в разделе справки по командлету [Set-ксмкксконфигуратион](https://docs.microsoft.com/powershell/module/skype/Set-CsMcxConfiguration) .

Если универсальный код ресурса (URI) настроен правильно, необходимо убедиться в том, что у вас есть DNS SRV-запись, которая разрешается для вашего домена SIP и пограничного сервера. Дополнительные сведения о том, как настроить эти записи, можно найти в разделе справки требования к DNS для мобильных устройств. Обратите внимание, что следующее сообщение об ошибке обычно указывает на проблему с DNS-записями.

Ответ 504 (время ожидания сервера), полученный от сети, не прошел операцию. Дополнительные сведения приведены в разделе сведения об исключении.

Кроме того, возможно, что тест-Ксмкксконфигуратион завершится сбоем с сообщением об ошибке:

Тест-Ксмккспушнотификатион: запрос на извещение об уведомлении отклонен.

В строке: 1 символ: 27

\+Test-Ксмккспушнотификатион\<\<\<\<

\+Категоринфо: Оператионстоппед: (:) \[Test-ксмккспушнотификатион\], синсетиктрансактионексцептион

\+Фулликуалифиедеррорид: Воркфловноткомплетед, Microsoft. RTC. Management. Синсетиктрансактионс. Тестмккспушнотификатионкмдлет

Сообщение "запрос push-уведомлений отвергнуто" обычно происходит, если включена фильтрация URL-адресов и вы блокируете префиксы http: и HTTPS:. Вы можете определить, какие префиксы блокируются, с помощью команды, подобной приведенной ниже:

```PowerShell 
 (Get-CsImFilterConfiguration -Identity Global).Prefixes
```

Если в результатах отображаются протоколы HTTP: или HTTPS, необходимо удалить их из списка блокируемых префиксов для использования push-уведомлений. Это можно сделать с помощью команд, сходных с приведенными ниже.

    Set-CsImFilterConfiguration -Identity site:Redmond -Prefixes @{remove="http:"}
    Set-CsImFilterConfiguration -Identity site:Redmond -Prefixes @{remove="https:"}

Дополнительные сведения можно найти в разделе справки по командлету [Set-ксимфилтерконфигуратион](https://docs.microsoft.com/powershell/module/skype/Set-CsImFilterConfiguration).

</div>

</div>

<span> </span>

</div>

</div>

</div>

