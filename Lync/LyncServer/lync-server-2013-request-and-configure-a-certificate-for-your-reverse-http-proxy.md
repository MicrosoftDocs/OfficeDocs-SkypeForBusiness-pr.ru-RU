---
title: Запрос и настройка сертификата для обратного HTTP-прокси
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Request and configure a certificate for your reverse HTTP proxy
ms:assetid: 4b70991e-5f10-40a3-b069-0b227c3a3a0a
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg429704(v=OCS.15)
ms:contentKeyID: 48184085
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 2597bf31c9f0cc9f4316f505811426f2c9948a6f
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2020
ms.locfileid: "41723858"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="request-and-configure-a-certificate-for-your-reverse-http-proxy-in-lync-server-2013"></a>Запрос и настройка сертификата для обратного HTTP-прокси в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-02-14_

Необходимо установить сертификат корневого центра сертификации (ЦС) на сервере под управлением Microsoft Forefront Threat Management Gateway 2010 или IIS ARR для инфраструктуры центра сертификации, выдавшего сертификаты сервера внутренним серверам, на которых запущено приложение Microsoft Lync. Сервер 2013.

Кроме того, необходимо установить общедоступный сертификат веб-сервера на обратном прокси-сервере. Дополнительные имена субъектов для этого сертификата должны содержать опубликованные внешние полные доменные имена для каждого пула, который является доменом для пользователей, для которых разрешен удаленный доступ, и внешнее FQDN для всех директоров и пулов, которые будут использоваться в течение Эта инфраструктура пограничного. Альтернативное имя темы также должно содержать простой URL-адрес для собрания, простой URL-адрес для телефонного подключения и, если вы развертываете мобильные приложения, и запланировать использование автоматического обнаружения, URL-адрес службы внешнего автообнаружения, как показано в приведенной ниже таблице.


<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Значение</th>
<th>Пример</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Имя субъекта</p></td>
<td><p>Полное доменное имя пула</p></td>
<td><p>webext.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Полное доменное имя пула</p></td>
<td><p>webext.contoso.com</p>



> [!IMPORTANT]
> Имя субъекта должно быть указано в альтернативном имени субъекта.

</td>
</tr>
<tr class="odd">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Необязательные веб-службы режиссера (если режиссер развернут)</p></td>
<td><p>webdirext.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Простой URL-адрес для собрания</p>



> [!NOTE]
> Все простые URL-адреса собраний должны находиться в альтернативном имени субъекта. У каждого домена SIP должен быть хотя бы один активный простой URL-адрес для собрания.

</td>
<td><p>meet.contoso.com</p></td>
</tr>
<tr class="odd">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Простой URL-адрес для телефонного подключения</p></td>
<td><p>dialin.contoso.com</p></td>
</tr>
<tr class="even">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Сервер Office Web Apps</p></td>
<td><p>officewebapps01.contoso.com</p></td>
</tr>
<tr class="odd">
<td><p>Альтернативное имя субъекта</p></td>
<td><p>Внешний URL-адрес службы автообнаружения</p></td>
<td><p>lyncdiscover.contoso.com</p>



> [!NOTE]
> Если вы также используете Microsoft Exchange Server, вам также потребуется настроить обратные правила прокси-сервера для URL-адресов автообнаружения Exchange и Web Services.

</td>
</tr>
</tbody>
</table>


<div>


> [!NOTE]
> Если внутреннее развертывание состоит из более чем одного стандартного сервера выпуска или пула переднего плана, необходимо настроить правила веб-публикации для каждого полного доменного имени внешней веб-фермы, и вам потребуется сертификат и веб-прослушиватель для каждого из них, или необходимо получить сертификат. , чье замещающее имя темы включает имена, используемые всеми пулами, назначение его веб-прослушивателю и предоставление общего доступа к нему из нескольких правил веб-публикации.



</div>

<div>

## <a name="create-a-certificate-request"></a>Создание запроса на сертификат

Вы создаете запрос на сертификат на обратном прокси-сервере. Вы создаете запрос на другом компьютере, но хотите экспортировать подписанный сертификат с закрытым ключом и импортировать его на обратный прокси-сервер после того, как вы получили его от общедоступного центра сертификации.

<div>


> [!NOTE]
> Запрос на сертификат или запрос подписи сертификата (CSR) — это запрос доверенного общедоступного центра сертификации (ЦС) для проверки и подписывания открытого ключа компьютера-запроса. При создании сертификата создается открытый ключ и закрытый ключ. Только открытый ключ является общим и подписанным. Как указано в имени, Открытый ключ предоставляется любому общедоступному запросу. Открытый ключ предназначен для использования клиентами, серверами и другими инициаторами запроса, которые должны безопасно обмениваться сведениями и проверять удостоверение компьютера. Закрытый ключ защищен и используется только компьютером, который создал пару ключей для расшифровки сообщений, зашифрованных с помощью открытого ключа. Закрытый ключ можно использовать для других целей. Для обратной идентификации прокси-сервера используется шифрование данных. Секондарили, проверка подлинности сертификата на уровне ключа сертификата является другой, и она ограничивается только подтверждением того, что у инициатора запроса есть открытый ключ компьютера, и что компьютер, на котором он открыт, действительно является компьютером, на котором он находится.



</div>

<div>


> [!TIP]
> Если вы планируете одновременное планирование сертификатов пограничного сервера и прокси-сертификатов, следует обратить внимание на то, что между двумя требованиями к сертификатам есть большое отношение. Если вы настраиваете и запрашиваете сертификат пограничного сервера, объедините пограничный сервер и альтернативные имена субъектов для обратного прокси-сервера. Вы можете использовать один и тот же сертификат для обратного прокси-сервера в случае экспорта сертификата и закрытого ключа и копирования экспортированного файла в обратный прокси и импорта сертификата или ключа и назначения его в соответствии с предстоящимй процедурой. Ознакомьтесь со сведениями о требованиях к сертификатам для плана пограничного сервера&nbsp;<A href="lync-server-2013-plan-for-edge-server-certificates.md">в Lync Server 2013</A> и обратной связи <A href="lync-server-2013-certificate-summary-reverse-proxy.md">сертификата прокси-сервера в Lync Server 2013</A>. Убедитесь, что вы создали сертификат с экспортируемым закрытым ключом. Создание сертификата и запроса на сертификат с экспортируемым закрытым ключом требуется для пограничного сервера пула, поэтому этот параметр является стандартным и мастером сертификатов в мастере развертывания Lync Server на пограничном сервере позволит вам установить флаг для <STRONG>экспорта закрытого ключа</STRONG> . После получения запроса на сертификат из общедоступного центра сертификации вы будете экспортировать сертификат и закрытый ключ. Сведения о том, как создать и экспортировать сертификат с закрытым ключом, можно найти в разделе "Экспорт сертификата с закрытым ключом для пограничных серверов в пуле" в разделе <A href="lync-server-2013-set-up-certificates-for-the-external-edge-interface.md">Настройка сертификатов для внешнего интерфейса Edge для Lync Server 2013</A> . Расширение сертификата должно иметь тип <STRONG>PFX</STRONG>.



</div>

Чтобы создать запрос на подписывание сертификата на компьютере, на котором будет назначаться сертификат и закрытый ключ, выполните указанные ниже действия.

**Создание запроса на подписывание сертификата**

1.  Откройте консоль управления (MMC) и добавьте оснастку "сертификаты" и выберите пункт " **Компьютеры**", а затем — " **Личные**". Подробнее о том, как создать консоль сертификатов в консоли управления Майкрософт (MMC), можно найти в [http://go.microsoft.com/fwlink/?LinkId=282616](http://go.microsoft.com/fwlink/?linkid=282616)разделе.

2.  Щелкните правой кнопкой мыши пункт **Сертификаты**, выберите **все задачи**, а затем **Дополнительные операции**, нажмите **создать настраиваемый запрос**.

3.  На странице " **регистрация сертификата** " нажмите кнопку **Далее**.

4.  На странице " **Выбор политики регистрации сертификатов** " в разделе **настраиваемый запрос**выберите вариант **Продолжить без политики регистрации**. Нажмите кнопку **Далее**.

5.  На странице " **настраиваемый запрос** " для **шаблона** выбор **устаревшего ключа (без шаблона)**. Если поставщик сертификата не направляет иное, оставьте флажок не проверять **расширения по умолчанию** и выберите **Формат запроса** в **PKCS \#10**. Нажмите кнопку **Далее**.

6.  На странице **сведения о сертификате** нажмите кнопку **сведения**и выберите пункт **Свойства**.

7.  На странице **Свойства сертификата** на вкладке **Общие** в поле **понятное имя** введите имя этого сертификата. При необходимости введите описание в поле **Описание** . Понятное имя и описание обычно используются администратором, чтобы определить назначение сертификата, например **обратный прослушиватель прокси-сервера для Lync Server**.

8.  Откройте вкладку **Тема** . В разделе **имя субъекта** для **типа**выберите пункт **Общее имя** для типа имени субъекта. В качестве **значения**введите имя субъекта, которое будет использоваться для обратного прокси-сервера, и нажмите кнопку **Добавить**. В примере, приведенном в таблице в этом разделе, имя субъекта — webext.contoso.com, и оно будет введено в поле Value (значение) для имени субъекта.

9.  На вкладке **Тема** в разделе **альтернативное имя**выберите **DNS** в раскрывающемся списке **тип**. Введите полное доменное имя для каждого определенного имени, которое требуется использовать в сертификате, и нажмите кнопку **Добавить**. Например, в таблице есть три альтернативных имени субъекта, meet.contoso.com, dialin.contoso.com и lyncdiscover.contoso.com. В поле " **значение** " введите Meet.contoso.com и нажмите кнопку " **Добавить**". Повторите эти действия для каждой темы, которую нужно определить.

10. На странице " **Свойства сертификата** " откройте вкладку " **расширения** ". На этой странице вы будете определять цели криптографических ключей в **использовании ключа** и использование расширенного ключа в **расширенном использовании ключа (политики приложений)**.

11. Щелкните стрелку " **Использование ключа** ", чтобы показать **Доступные параметры**. В разделе Доступные параметры выберите пункт **Цифровая подпись**и нажмите кнопку **Добавить**. Выберите **Шифрование ключей**и нажмите кнопку **Добавить**. Если флажок **установить критические данные об использовании ключа** не установлен, установите флажок.

12. Щелкните стрелку **расширенного использования ключа (политики применения)** , чтобы отобразить **Доступные параметры**. В разделе Доступные параметры выберите **Проверка подлинности сервера**и нажмите кнопку **Добавить**. Выберите **Проверка подлинности клиента**, а затем нажмите кнопку **Добавить**. Если флажок **сделать обязательным использование расширенных ключей** установлен, снимите флажок. Напротив, флажок использование ключа (должен быть установлен) необходимо убедиться, что флажок расширенного ключа использования не установлен.

13. На странице " **Свойства сертификата** " откройте вкладку **закрытые ключи** . Щелкните стрелку **Параметры ключа** . В раскрывающемся списке **Размер ключа**выберите **2048** . Если вы создаете пару ключей и CSR на компьютере, отличном от обратного прокси-сервера, для которого предназначен этот сертификат, установите флажок **сделать закрытым ключ экспортируемым**.
    
    <div>
    
    <table>
    <thead>
    <tr class="header">
    <th><img src="images/Gg398321.security(OCS.15).gif" title="разрешения" alt="security" />Примечание о безопасности:</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td>Выбор варианта <strong>экспорта закрытого ключа</strong> обычно рекомендуется использовать, если в ферме есть несколько обратных прокси-серверов, так как вы будете копировать сертификат и закрытый ключ на каждый компьютер в ферме. Если вы разрешены для экспортируемого закрытого ключа, вы должны уделять особой осторожности с сертификатом и компьютером, на котором он был создан. Закрытый ключ, если он скомпрометирован, будет вырисовывать бесполезный сертификат, а также может предоставить компьютеру или компьютерам внешний доступ и другие уязвимости системы безопасности.</td>
    </tr>
    </tbody>
    </table>
    
    </div>

14. На вкладке **закрытые ключи** щелкните стрелку **тип ключа** . Выберите параметр **Exchange** .

15. Нажмите кнопку **ОК** , чтобы сохранить заданные **Свойства сертификата** .

16. На странице " **регистрация сертификата** " нажмите кнопку **Далее**.

17. На странице **где вы хотите сохранить автономный запрос?** вам будет предложено указать **имя файла** и **Формат файла** для сохранения запроса подписи сертификата.

18. В поле **имя файла** введите путь и имя файла запроса или нажмите кнопку **Обзор** , чтобы выбрать расположение для файла, и введите имя файла для запроса.

19. В качестве **формата файла**выберите значение **base 64** или **binary**. Выберите **Base 64** , если вы не указали, что в противном случае поставщик для ваших сертификатов.

20. Найдите файл запроса, сохраненный на предыдущем шаге. Отправьте свой общедоступный центр сертификации.
    
    <div>
    

    > [!IMPORTANT]
    > Корпорация Майкрософт выявила общедоступные центры сертификации, удовлетворяющие требованиям для объединенных коммуникаций. Список сохранен в следующей статье базы знаний. <A href="http://go.microsoft.com/fwlink/?linkid=282625">http://go.microsoft.com/fwlink/?LinkId=282625</A>

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

