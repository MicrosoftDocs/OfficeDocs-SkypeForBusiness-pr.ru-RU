---
title: Перенос адресной книги
ms.reviewer: ''
ms.author: serdars
author: serdarsoysal
f1.keywords:
- NOCSH
TOCTitle: Migrate Address Book
ms:assetid: ac7f0f39-4c6d-4702-8e25-93a73e3d800f
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ205160(v=OCS.15)
ms:contentKeyID: 48185064
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: a3282315d50b0a5075afc380487fb9204d4285c8
ms.sourcegitcommit: 4d6bf5c58b2c553dc1df8375ede4a9cb9eaadff2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "48529906"
---
# <a name="migrate-address-book"></a>Перенос адресной книги

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2012-10-09_

Как правило, адресная книга Lync Server 2010 переносится вместе с остальной топологией. Тем не менее, если вы настроили следующие действия в среде Lync Server 2010, вам может потребоваться выполнить некоторые действия, выполняемые после миграции:

  - настроили свойство WMI **PartitionbyOU** для группировки записей адресной книги по подразделениям;

  - настроили правила нормализации адресной книги;

  - изменили значение по умолчанию параметра **UseNormalizationRules** на False.

**Сгруппированные записи адресной книги**

Если вы задали для свойства WMI **PartitionbyOU** значение True, чтобы создать адресные книги для каждого подразделения, вам нужно задать атрибут Active Directory **msRTCSIP-GroupingId** для пользователей и контактов, если вы хотите, чтобы записи адресной книги были по-прежнему сгруппированы. Группировка записей адресной книги может потребоваться для ограничения области поиска в адресной книге. Чтобы использовать атрибут **msRTCSIP-GroupingId**, создайте сценарий для его заполнения и присвойте одинаковое значение всем пользователям, которых необходимо объединить в одну группу. Например, присвойте одинаковое значение всем пользователям определенного подразделения.

**Правила нормализации адресной книги**

Если вы настроили правила нормализации адресной книги в среде Lync Server 2010, необходимо перенести эти правила в пилотный пул. Если вы не настраивали правила нормализации адресной книги, то ничего переносить не требуется. По умолчанию для Lync Server 2013 используются те же правила нормализации, что и для Lync Server 2010. Чтобы перенести настроенные правила нормализации, выполните инструкции, приведенные далее в этом разделе.

<div>


> [!NOTE]  
> Если в вашей организации используется удаленное управление звонками и вы настроили правила нормализации адресной книги, то прежде чем использовать удаленное управление звонками, вам нужно выполнить инструкции, приведенные в этом разделе. Для их выполнения необходимо быть членом группы RTCUniversalServerAdmins или иметь аналогичные права.



</div>

**Параметр UseNormalizationRules со значением False**

Если задать для параметра **UseNormalizationRules** значение false, чтобы пользователи могли использовать номера телефонов, как они определены в доменных службах Active Directory без применения правил нормализации Lync Server 2013, необходимо задать для параметров **UseNormalizationRules** и **IgnoreGenericRules** значение true. Для этого выполните инструкции, приведенные далее в этом разделе.

<div>

## <a name="to-migrate-address-book-customized-normalization-rules"></a>Перенос настроенных правил нормализации адресной книги

1.  Найдите \_ \_ \_Rules.txt файл нормализации номера телефона компании \_ в корне общей папки адресной книги и скопируйте его в корневую папку адресной книги в пилотном пуле Lync Server 2013.
    
    <div>
    

    > [!NOTE]  
    > Образцы правил нормализации адресной книги установлены в каталоге, содержащем файлы веб-компонента службы адресной книги. Путь — <STRONG>$installedDriveLetter:\Program Files\Microsoft Lync Server 2013\Web Components\Address Book Files\Files\ Sample_Company_Phone_Number_Normalization_Rules.txt,</STRONG>. Этот файл можно скопировать и переименовать как &nbsp; <STRONG>Company_Phone_Number_Normalization_Rules.txt</STRONG> &nbsp; в корневой каталог общей папки адресной книги. Например, адресная книга предоставляется в <STRONG>$serverX</STRONG>, &nbsp; путь будет выглядеть следующим образом: <STRONG> \\ $serverX \LyncFileShare\2-WebServices-1\ABFiles</STRONG>.

    
    </div>

2.  Используйте текстовый редактор, например "Блокнот", чтобы открыть \_ \_ \_Rules.txt файл нормализации номера телефона компании \_ .

3.  Некоторые типы записей не будут правильно работать в Lync Server 2013. Просмотрите файл, чтобы найти записи такого типа, измените их требуемым образом и сохраните изменения в общей папке адресной книги в пилотном пуле.
    
    Строки, содержащие обязательный пробел или знак пунктуации, приведут к сбою правила нормализации, поскольку эти символы удаляются из строки при ее вводе в правило. Если у вас есть строки с обязательным пробелом или знаком пунктуации, их нужно изменить. Например, следующая строка приведет к сбою правила нормализации.
    
        \s*\(\s*\d\d\d\s*\)\s*\-\s*\d\d\d\s*\-\s*\d\d\d\d
    
    Следующая строка не приведет к сбою правила нормализации.
    
        \s*\(?\s*\d\d\d\s*\)?\s*\-?\s*\d\d\d\s*\-?\s*\d\d\d\d

</div>

<div>

## <a name="to-set-usenormalizationrules-and-ignoregenericrules-to-true"></a>Задание значения True для параметров UseNormalizationRules и IgnoreGenericRules

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Выполните одно из указанных ниже действий.
    
      - Если развертывание включает только Lync Server 2013, выполните следующий командлет на глобальном уровне, чтобы изменить значения для **UseNormalizationRules** и **IgnoreGenericRules** на true:
        
            Set-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
    
      - Если в развертывании имеется сочетание Lync Server 2013 и Lync Server 2010 или Office Communications Server 2007 R2, выполните следующий командлет и назначьте его каждому пулу Lync Server 2013 в топологии:
        
            New-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true

3.  Дождитесь, пока репликация центрального хранилища управления не будет выполняться во всех пулах.

4.  Измените файл правил нормализации телефона в разделе " \_ \_ нормализация номера телефона компании \_ \_Rules.txt", чтобы развертывание было ясно на содержимое. Файл находится на общем файловом ресурсе каждого пула Lync Server 2013. Если файл отсутствует, создайте пустой файл с именем " \_ \_ нормализация номера телефона компании \_ \_Rules.txt".

5.  Подождите несколько минут, пока для всех интерфейсных пулов не будут прочитаны новые файлы.

6.  Выполните следующий командлет на каждом пуле Lync Server 2013 в развертывании:
    
        Update-CsAddressBook

</div>

</div>

<span> </span>

</div>

</div>

</div>

