---
title: Перенос адресной книги
TOCTitle: Перенос адресной книги
ms:assetid: ac7f0f39-4c6d-4702-8e25-93a73e3d800f
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ205160(v=OCS.15)
ms:contentKeyID: 49310825
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Перенос адресной книги

 

_**Дата изменения раздела:** 2012-10-09_

Как правило, адресная книга Lync Server 2010 переносится вместе с остальной топологией. Однако вам может потребоваться выполнить определенные действия после миграции, если вы произвели следующие настройки в среде Lync Server 2010:

  - настроили свойство WMI **PartitionbyOU** для группировки записей адресной книги по подразделениям;

  - настроили правила нормализации адресной книги;

  - изменили значение по умолчанию параметра **UseNormalizationRules** на False.

**Сгруппированные записи адресной книги**

Если вы задали для свойства WMI **PartitionbyOU** значение True, чтобы создать адресные книги для каждого подразделения, вам нужно задать атрибут Active Directory **msRTCSIP-GroupingId** для пользователей и контактов, если вы хотите, чтобы записи адресной книги были по-прежнему сгруппированы. Группировка записей адресной книги может потребоваться для ограничения области поиска в адресной книге. Чтобы использовать атрибут **msRTCSIP-GroupingId** , создайте сценарий для его заполнения и присвойте одинаковое значение всем пользователям, которых необходимо объединить в одну группу. Например, присвойте одинаковое значение всем пользователям определенного подразделения.

**Правила нормализации адресной книги**

Если вы настроили правила нормализации адресной книги в среде Lync Server 2010, вам нужно перенести эти правила в пилотный пул. Если вы не настраивали правила нормализации адресной книги, то ничего переносить не требуется. Правила нормализации по умолчанию для Lync Server 2013 аналогичны правилам по умолчанию для Lync Server 2010. Чтобы перенести настроенные правила нормализации, выполните инструкции, приведенные далее в этом разделе.

> [!NOTE]  
> Если в вашей организации используется удаленное управление звонками и вы настроили правила нормализации адресной книги, то прежде чем использовать удаленное управление звонками, вам нужно выполнить инструкции, приведенные в этом разделе. Для их выполнения необходимо быть членом группы RTCUniversalServerAdmins или иметь аналогичные права.

**Параметр UseNormalizationRules со значением False**

Если вы задали для параметра **UseNormalizationRules** значение False, чтобы пользователи могли использовать номера телефонов, определенные в Доменные службы Active Directory, без применения правил нормализации сервером Lync Server 2013, вам нужно задать для параметров **UseNormalizationRules** и **IgnoreGenericRules** значение True. Для этого выполните инструкции, приведенные далее в этом разделе.

## Перенос настроенных правил нормализации адресной книги

1.  Найдите файл Company\_Phone\_Number\_Normalization\_Rules.txt в корне общей папки адресной книги и скопируйте его в корень общей папки адресной книги в пилотном пуле Lync Server 2013.
    
    > [!NOTE]  
    > Образцы правил нормализации адресной книги установлены в каталоге, содержащем файлы веб-компонента службы адресной книги. Путь – <strong>$installedDriveLetter:\Program Files\Microsoft Lync Server 2013\Web Components\Address Book Files\Files\ Sample_Company_Phone_Number_Normalization_Rules.txt,</strong>. Этот файл можно скопировать в корневой каталог общей папки адресной книги и переименовать в <strong>Company_Phone_Number_Normalization_Rules.txt</strong>. Например, для общей адресной книги на сервере <strong>$serverX</strong> путь будет иметь следующий вид: <strong>\\$serverX \LyncFileShare\2-WebServices-1\ABFiles</strong>.

2.  Откройте файл Company\_Phone\_Number\_Normalization\_Rules.txt с помощью текстового редактора, например Блокнота.

3.  Некоторые типы записей будут работать в Lync Server 2013 неправильно. Просмотрите файл, чтобы найти записи такого типа, измените их требуемым образом и сохраните изменения в общей папке адресной книги в пилотном пуле.
    
    Строки, содержащие обязательный пробел или знак пунктуации, приведут к сбою правила нормализации, поскольку эти символы удаляются из строки при ее вводе в правило. Если у вас есть строки с обязательным пробелом или знаком пунктуации, их нужно изменить. Например, следующая строка приведет к сбою правила нормализации.
    
        \s*\(\s*\d\d\d\s*\)\s*\-\s*\d\d\d\s*\-\s*\d\d\d\d
    
    Следующая строка не приведет к сбою правила нормализации.
    
        \s*\(?\s*\d\d\d\s*\)?\s*\-?\s*\d\d\d\s*\-?\s*\d\d\d\d

## Задание значения True для параметров UseNormalizationRules и IgnoreGenericRules

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Выполните одно из указанных ниже действий.
    
      - Если в вашем развертывании используется только Lync Server 2013, выполните следующий командлет на глобальном уровне, чтобы изменить значения параметров **UseNormalizationRules** и **IgnoreGenericRules** на True.
        
            Set-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
    
      - Если в вашем развертывании используется сочетание Lync Server 2013 и Lync Server 2010 или Office Communications Server 2007 R2, выполните следующий командлет для каждого пула Lync Server 2013 в топологии.
        
            New-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true

3.  Дождитесь, пока репликация управления будет выполнена во всех пулах.

4.  Очистите содержимое файла правил нормализации телефонов (Company\_Phone\_Number\_Normalization\_Rules.txt) для развертывания. Этот файл находится в общей папке каждого пула Lync Server 2013. Если файл отсутствует, создайте пустой файл с именем Company\_Phone\_Number\_Normalization\_Rules.txt.

5.  Подождите несколько минут, пока все переднего плана прочтут содержимое новых файлов.

6.  Выполните следующий командлет для каждого пула Lync Server 2013 в развертывании.
    
        Update-CsAddressBook

