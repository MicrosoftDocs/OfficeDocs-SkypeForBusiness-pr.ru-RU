---
title: 'Lync Server 2013: использование расширенного ведения журнала для искусственных транзакций'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Using rich logging for synthetic transactions
ms:assetid: 32714a71-9f42-4d5b-a508-e176d8f08bbf
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ204798(v=OCS.15)
ms:contentKeyID: 48183812
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 1d73bfe085d34e536c5d3b44f1cacca8819de442
ms.sourcegitcommit: 4d6bf5c58b2c553dc1df8375ede4a9cb9eaadff2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "48518796"
---
# <a name="using-rich-logging-for-synthetic-transactions-in-lync-server-2013"></a>Использование расширенного ведения журнала для искусственных транзакций в Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2012-10-22_

Искусственные транзакции (представленные в Microsoft Lync Server 2010) позволяют администраторам проверить, могут ли пользователи успешно выполнять распространенные задачи, такие как вход в систему, Обмен мгновенными сообщениями и звонки на телефон, находящийся в телефонной сети общего пользования (PSTN). Эти тесты (которые упаковываются в виде набора командлетов Windows PowerShell для Lync Server) могут выполняться вручную администратором или могут быть автоматически запущены приложением, таким как System Center Operations Manager.

В Lync Server 2010 искусственные транзакции доказались очень полезной, чтобы помочь администраторам выявить проблемы с системой. Например, командлет **Test-CsRegistration** может оповещать администраторов о том, что некоторые пользователи столкнулись с трудностями при регистрации в Lync Server. Однако искусственные транзакции были несколько менее эффективными, помогая администраторам определить, почему эти пользователи столкнулись с трудностями при регистрации в Lync Server. Это вызвано тем, что искусственные транзакции не предоставили подробные сведения о ведении журнала, которые могут помочь администраторам устранять неполадки в Lync Server. Как правило, подробный вывод искусственной транзакции предоставляет пошаговые инструкции, которые могут позволить администратору выполнить обоснованное предположение, как в случае возникновения проблемы.

В Microsoft Lync Server 2013 искусственные транзакции были изменены для создания расширенного ведения журнала. «Расширенная регистрация» означает, что для каждой операции, выполняемого искусственной транзакцией, регистрируется следующая информация:

  - Время начала операции

  - Время завершения операции

  - Выполняемое действие (например, создание, присоединение или выход из конференции; вход в Lync Server; Отправка мгновенного сообщения и т. д.)

  - Информационные, подробные сообщения, предупреждения или сообщения об ошибках, которые были созданы при выполнении операции

  - Сообщения о регистрации SIP

  - Записи об исключениях или диагностические коды, созданные при выполнении операции

  - Итоговый результат выполнения операции

Эта информация создается автоматически при каждом запуске искусственной транзакции. Однако автоматическое отображение или сохранение сведений в файл журнала не выполняется. Вместо этого администраторы, выполняющие искусственную транзакцию вручную, могут использовать параметр OutLoggerVariable, чтобы указать переменную Windows PowerShell, в которой будут храниться данные. Затем администраторы смогут применять несколько методов, позволяющих сохранять и/или просматривать полный журнал в формате XML или HTML.

Например, в случае Lync Server 2010 администраторы могут запустить командлет **Test-CsRegistration** с помощью команды, аналогичной следующей:

    Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com

Администраторы могут включить параметр OutLoggerVariable с последующим именем переменной по своему выбору:

    Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com -OutLoggerVariable RegistrationTest

> [!NOTE]  
> Имени переменной не должен предшествовать символ $. Например, используйте имя переменной RegistrationTest, а не $RegistrationTest.

Предыдущая команда выводит содержимое, аналогичное следующему:

    Target Fqdn   : atl-cs-001.litwareinc.com
    Result        : Failure
    Latency       : 00:00:00
    Error Message : This machine does not have any assigned certificates.
    Diagnosis     :

Однако для данного сбоя доступна гораздо более подробная информация, а не только сообщение об ошибке, представленное выше. Для получения доступа к этой информации в формате HTML используйте команду, аналогичную этой, чтобы сохранить данные, хранящиеся в переменной RegistrationTest, в файл HTML:

    $RegistrationTest.ToHTML() | Out-File C:\Logs\Registration.html

Можно также использовать метод ToXML() для сохранения данных в файл XML:

    $RegistrationTest.ToXML() | Out-File C:\Logs\Registration.xml

Эти файлы можно просмотреть с помощью Internet Explorer, Visual Studio или любого другого приложения, способного открывать файлы HTML/XML.

Искусственные транзакции, выполняемые из System Center Operations Manager, будут автоматически создавать эти файлы журналов для сбоев. Однако эти журналы не будут создаваться в случае сбоя выполнения до того, как Windows PowerShell сможет загрузить и запустить искусственную транзакцию.

> [!IMPORTANT]  
> По умолчанию Lync Server 2013 сохраняет файлы журнала в папку, к которой не предоставлен общий доступ. Чтобы сделать эти журналы общедоступными, необходимо поделиться этой папкой (например, \\ \\ ATL-наблюдатель-001. litwareinc. ком\ватчерноде.


</div>

</div>

</div>

</div>

