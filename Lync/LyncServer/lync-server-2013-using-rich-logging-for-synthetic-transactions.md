---
title: 'Lync Server 2013: использование расширенного ведения журнала для искусственных транзакций'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
TOCTitle: Using rich logging for synthetic transactions
ms:assetid: 32714a71-9f42-4d5b-a508-e176d8f08bbf
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ204798(v=OCS.15)
ms:contentKeyID: 48183812
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 455d7bcdc14dd4d701d749407759cead0834906f
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "34849230"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="using-rich-logging-for-synthetic-transactions-in-lync-server-2013"></a>Использование расширенного ведения журнала для виртуальных транзакций в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2012-10-22_

Синтетические транзакции (введенные в Microsoft Lync Server 2010) предоставляют администраторам способ проверки того, что пользователи могут успешно выполнять типичные задачи, такие как вход в систему, Обмен мгновенными сообщениями и звонки на телефоны, находящиеся в сети в коммутируемой телефонной сети общего пользования (КТСОП). Эти тесты (которые упаковываются в набор командлетов Windows PowerShell для Lync Server) могут быть проведены вручную администратором или автоматически запускаться приложением, таким как System Center Operations Manager.

В Lync Server 2010 искусственные транзакции доносятся чрезвычайно полезными для облегчения администраторам выявления проблем системы. Например, командлет **Test-ксрегистратион** может оповещать администраторов о том, что некоторые пользователи столкнулись с проблемами при регистрации в Lync Server. Тем не менее, эти искусственные транзакции не помогают администраторам определить, почему пользователи столкнулись с проблемами при регистрации в Lync Server. Это произошло из-за того, что искусственные транзакции не предоставили подробные сведения для ведения журнала, которые могут помочь администраторам устранить проблемы с Lync Server. Лучше всего получить подробный вывод из искусственной транзакции с пошаговыми инструкциями, которые могут позволить администратору создать обоснованное предположение, в котором может возникнуть проблема.

В Microsoft Lync Server 2013 искусственные транзакции, созданные с богатым протоколированием, сконструированы заново. "Ведение подробного протоколирования" означает, что для каждого действия, которое занимает виртуальная транзакция, такие данные будут записаны следующим образом:

  - Время начала действия

  - Время завершения действия

  - Выполняемое действие (например, создание, присоединение или выход из конференции; вход на сервер Lync Server; Отправка мгновенного сообщения и т. д.)

  - Информационные, подробные сообщения, предупреждения или сообщения об ошибках, которые были созданы при выполнении операции

  - Сообщения регистрации SIP

  - Записи исключений или коды диагностики, созданные при выполнении действия

  - Итоговый результат выполнения действия

Эта информация создается автоматически каждый раз при выполнении искусственной транзакции. Однако эти сведения не отображаются и не сохраняются в файле журнала автоматически. Вместо этого администраторы, которые вручную загружают искусственную транзакцию, могут использовать параметр Аутлогжервариабле для указания переменной Windows PowerShell, в которой будут храниться данные. После этого администраторы могут использовать пару методов, которые позволяют им сохранять и (или) просматривать расширенный журнал в формате XML или HTML.

Например, для Lync Server 2010 администраторы могут выполнить командлет **Test-ксрегистратион** , выполнив команду, подобную следующей:

    Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com

Администраторы могут включить параметр Аутлогжервариабле, за которым следует имя переменной, выбирая указанные ниже значения.

    Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com -OutLoggerVariable RegistrationTest

> [!NOTE]  
> Не дополняйте перед именем переменной символа $. Используйте имя переменной, например Регистратионтест, а не $RegistrationTest.

Предыдущая команда выводит содержимое, подобное следующему:

    Target Fqdn   : atl-cs-001.litwareinc.com
    Result        : Failure
    Latency       : 00:00:00
    Error Message : This machine does not have any assigned certificates.
    Diagnosis     :

Тем не менее, в этой ошибке есть больше подробных сведений, чем просто сообщение об ошибке. Чтобы получить доступ к этим сведениям в формате HTML, используйте следующую команду для сохранения данных, сохраненных в переменной Регистратионтест, в HTML-файл.

    $RegistrationTest.ToHTML() | Out-File C:\Logs\Registration.html

Можно также использовать метод ToXML() для сохранения данных в файл XML:

    $RegistrationTest.ToXML() | Out-File C:\Logs\Registration.xml

Эти файлы можно будет просматривать с помощью Internet Explorer, Visual Studio или других приложений, которые могут открывать HTML-и XML-файлы.

Синтетические транзакции, выполненные из системы System Center Operations Manager, будут автоматически создавать эти файлы журнала для сбоев. Однако эти журналы не будут создаваться, если выполнение завершается сбоем до того, как Windows PowerShell сможет загрузить и выполнить виртуальную транзакцию.

> [!IMPORTANT]  
> По умолчанию Lync Server 2013 сохраняет файлы журнала в папке, к которой не предоставлен общий доступ. Чтобы сделать эти журналы общедоступными, нужно поделиться этой папкой (например, \\ \\ATL-наблюдатель-001. плана litwareinc. ком\ватчерноде.


</div>

</div>

</div>

</div>

