---
title: Специальные инструкции по установке для искусственных транзакций
TOCTitle: Специальные инструкции по установке для искусственных транзакций
ms:assetid: 694cbe05-5dba-4035-a01c-c87ebfb0478b
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ688080(v=OCS.15)
ms:contentKeyID: 49888029
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Специальные инструкции по установке для искусственных транзакций

 

_**Дата изменения раздела:** 2015-11-16_

Большинство искусственных транзакций может работать на узле-наблюдателе без изменений. То есть, как только искусственная транзакция добавляется в параметры конфигурации узла-наблюдателя, узел-наблюдатель может начать использовать эту искусственную транзакцию во время тестовых проходов. Однако это не относится ко всем искусственным транзакциям. Исключением являются искусственные транзакции, которые нуждаются в специальных инструкциях. Такие транзакции обсуждаются в следующих разделах.

## Искусственные транзакции в конференц-связи с передачей данных

Если компьютер узла-наблюдателя расположен за пределами сетевого периметра, скорее всего, невозможно будет запускать искусственные транзакции конференц-связи с передачей данных, если только не отключить сначала параметры прокси-сервера в Internet Explorer для учетной записи сетевой службы. Чтобы отключить параметры прокси-сервера для этой службы, выполните следующую процедуру:

1.  На компьютере узла-наблюдателя щелкните кнопку **Пуск**, последовательно щелкните пункты **Все программы**, **Стандартные**, щелкните правой кнопкой мыши значок **Командная строка** и в контекстном меню выберите пункт **Запуск от имени администратора**.

2.  В окне консоли введите следующую команду и нажмите клавишу ВВОД:
    
        bitsadmin /util /SetIEProxy NetworkService NO_PROXY

В окне командной строки отобразится следующее сообщение:

    BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows. Administration tools for the BITS service are now provided by BITS PowerShell cmdlets.
    
    Internet proxy settings for account NetworkService set to NO_PROXY. 
    (connection = default)

Это сообщение означает, что вы отключили параметры прокси-сервера Internet Explorer для учетной записи сетевой службы.

## Искусственные транзакции единой системы обмена сообщениями Exchange

Искусственная транзакция обмена сообщениями Exchange проверяет, что тестовые пользователи могут подключаться к учетным записям голосовой почты, которые размещаются в Exchange. Для этих тестовых пользователей должны быть предварительно настроены учетные записи голосовой почты, прежде чем можно будет применять тесты единой системы обмена сообщениями Exchange.

## Искусственные транзакции сохраняемого сеанса беседы

Чтобы воспользоваться искусственной транзакцией сохраняемого сеанса беседы, администраторы должны создать канал и предоставить тестовым пользователям права на его использование. Командлет [Test-CsPersistentChatMessage](https://docs.microsoft.com/en-us/powershell/module/skype/Test-CsPersistentChatMessage) может использоваться для правильной настройки этих пользователей:

    $cred1 = Get-Credential "litwareinc\kenmyer"
    $cred2 = Get-Credential "litwareinc\pilar"
    
    Test-CsPersistentChatMessage -TargetFqdn atl-cs-001.litwareinc.com -SenderSipAddress sip:kenmyer@litwareinc.com -SenderCredential $cred1 -ReceiverSipAddress sip:pilar@litwareinc.com -ReceiverCredential $cred2 -TestUser1SipAddress sip:kenmyer@litwareinc.com -TestUser2SipAddress sip:pilar@litwareinc.com -Setup $True

Эта задача настройки должна быть запущена изнутри предприятия:

  - Если запустить ее с компьютера, не являющегося сервером, пользователь, запустивший командлет должен являться членом роли PersistentChatAdministrators в соответствии с управлением доступом на основе ролей.

  - Если запустить непосредственно с самого сервера, пользователь, запустивший командлет, должен являться членом группы RTCUniversalServerAdmins.

В предыдущей команде параметр Setup был включен и задан как True ($True). Если включить параметр Setup, командлет Test-CsPersistentChatMessage создаст специальную комнату сохраняемого сеанса беседы и заполнит ее тестовыми пользователями. Это обеспечит доступность комнаты чата для тестирования. Обратите внимание, что параметр Setup должен использоваться только на интерфейсном сервере.

Комната чата, созданная командлетом Test-CsPersistentChatMessage, может быть удалена администратором.

## Искусственные транзакции одноранговых вызовов ТСОП

Искусственная транзакция [Test-CsPstnPeerToPeerCall](https://docs.microsoft.com/en-us/powershell/module/skype/Test-CsPstnPeerToPeerCall) проверяет возможность выполнять и принимать вызовы через телефонную сеть общего доступа (ТСОП).

Чтобы запустить искусственную транзакцию, администраторы должны настроить следующие элементы:

  - Двух тестовых пользователей (вызывающего и вызываемого абонента) для корпоративной голосовой связи.

  - Прямые входные номера для каждой учетной записи пользователя.

  - Политики голосовой связи и маршруты голосовой связи, которые позволяют получать вызовам уходить на шлюз ТСОП.

  - Шлюз ТСОП, который принимает вызовы и среда обратных вызовов в домашний пул получателя в зависимости от набранного номера.

## Искусственные транзакции единой системы обмена сообщениями

Искусственная транзакция единого хранилища контактов проверяет возможность получения контактов Lync Server 2013 от имени пользователя из Microsoft Exchange Server 2013.

Чтобы использовать эту искусственную транзакцию, следует выполнить следующие условия:

  - [Управление проверкой подлинности между серверами (OAuth) и партнерскими приложениями в Lync Server 2013](lync-server-2013-managing-server-to-server-authentication-oauth-and-partner-applications.md) следует настроить между Lync Server 2013 и Exchange 2013.

  - Тестовые пользователи должны иметь допустимые почтовые ящики Exchange 2013.

После выполнения этих требований администраторы могут запустить следующую команду для проверки возможности получения пользователем с SIP-адресом kenmyer@litwareinc.com своих контактов из единого хранилища контактов:

    Test-CsUnifiedContactStore -TargetFqdn atl-cs-001.litwareinc.com -UserSipAddress "sip:kenmyer@litwareinc.com" -RegistrarPort 5061 -Authentication TrustedServer -Setup

Обратите внимание на использование параметра Setup в предыдущей команде. Если параметр Setup включен при выполнении Test-CsUnifiedContactStore, то контакты указанного пользователя (в нашем случае sip:kenmyer@litwareinc.com) будут перемещены в единое хранилище контактов. (Конечно, если контакты пользователя уже находятся в едином хранилище, их не следует перемещать.) Как правило, параметр Setup используется только один раз (при первом запуске Test-CsUnifiedContactStore) и должен применяться только для тестовых пользователей, то есть для тех учетных записей, которые не будут впоследствии выполнять вход в Lync Server. После миграции тестового пользователя в единое хранилище контактов можно проверить возможность получения контактов пользователя, вызвав командлет Test-CsUnifiedContactStore без параметра Setup:

    Test-CsUnifiedContactStore -TargetFqdn atl-cs-001.litwareinc.com -UserSipAddress "sip:kenmyer@litwareinc.com" -RegistrarPort 5061 -Authentication TrustedServer

## Искусственные транзакции XMPP

Искусственная транзакция мгновенных сообщений XMPP нуждается в настройке компонента XMPP с указанием одного или нескольких федеративных доменов.

Чтобы включить искусственную транзакцию XMPP, необходимо предоставить параметр XmppTestReceiverMailAddress, используя учетную запись пользователя в домене XMPP с поддержкой маршрутизации. Пример:

    Set-CsWatcherNodeConfiguration -Identity pool0.contoso.com -Tests @{Add="XmppIM"} -XmppTestReceiverMailAddress user1@litwareinc.com

В этом примере должно существовать правило Lync Server 2013 для маршрутизации сообщений для домена litwareinc.com на шлюз XMPP.

