---
title: "Lync Server 2013: проверка и настройка пров. подл. и серт. для вирт. кат. IIS"
TOCTitle: Проверка и настройка проверки подлинности и сертификатов для виртуальных каталогов IIS
ms:assetid: 3ca90be0-1d64-447c-807a-3a2ee3bf625e
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg429702(v=OCS.15)
ms:contentKeyID: 49309524
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Проверка и настройка проверки подлинности и сертификатов для виртуальных каталогов IIS в Lync Server 2013

 

_**Дата изменения раздела:** 2012-05-25_

Используйте следующую процедуру, чтобы настроить сертификат в своих виртуальных каталогах служб Службы IIS или проверить правильность его настройки. Выполните описанную ниже процедуру на каждом сервере, где службы IIS выполняются во внутреннем пуле Lync Server и в дополнительном сервере Директор или на дополнительных серверах пула Директоров.

> [!NOTE]  
> Описанная ниже процедура определяет запрос комбинированного сертификата, который является универсальным для Lync Server, внутреннего веб-сайта и внешнего веб-сайта в службах IIS. В Lync Server 2010 представлен набор командлетов Windows PowerShell командной консоли Командная консоль Lync Server, предназначенных специально для запроса, импорта и назначения сертификатов, а также управления ими. В данной процедуре предполагается, что существует внутренний развернутый центр сертификации (ЦС), который может обработать данный запрос. Если вы используете для Lync Server общие сертификаты или вашему ЦС требуется автономный запрос, см. подробное описание синтаксиса в подразделе о параметре -Output . <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Request-CsCertificate">Request-CsCertificate</a>

## Настройка проверки подлинности и сертификатов для виртуальных каталогов служб IIS

1.  Чтобы успешно выполнить описанную ниже процедуру, вы должны войти на компьютер (сервер переднего плана или Директор), где установлены веб-службы, с правами локального администратора. Вам следует иметь разрешения **read** и **enroll** для центра сертификации, из которого вы будете запрашивать сертификаты, если этот центр сертификации принадлежит вашей организации. Разрешения для центра сертификации не требуются, если вы настроите и отправите автономный запрос на сертификат.

2.  Нажмите кнопку **Пуск** , выберите **Все программы** , **Администрирование** и затем **Диспетчер служб IIS** .

3.  В окне **Диспетчер служб IIS** выберите **Имя сервера** . В окне **Просмотр возможностей** выберите элемент **Сертификаты сервера** , щелкните правой кнопкой мыши и выберите пункт **Открытие функции** .
    

    > [!TIP]
    > Если имеются сертификаты, назначенные данному серверу, они отображаются в этом представлении компонента сертификатов сервера. Если имеется сертификат, соответствующий требованиям для внешнего веб-сайта в службах IIS, вы можете использовать его повторно. Чтобы просмотреть сертификат, щелкните его правой кнопкой мыши и выберите пункт <STRONG>Просмотреть…</STRONG>



4.  В переднего плана или Директор, для которых запрашивается сертификат, нажмите **Пуск**, выберите **Все программы**, **Microsoft Lync Server 2013** и нажмите **Командная консоль Lync Server**.

5.  В Командная консоль Lync Server введите:
    
        Get-CsCertificate
    
    выходные данные представляют собой список сертификатов, которые в данный момент находятся в хранилище личных сертификатов на компьютере. Обратите внимание на то, что в комбинированном сертификате (где компоненты по умолчанию, компоненты внутренних веб-служб и компоненты внешних веб-служб используют один и тот же сертификат) видно, что свойство Use заполняется значениями Default, WebServicesInternal и WebServicesExternal. Кроме того, свойство Thumbprint будет одинаковым для каждого из типов Use. Пример выходных данных Get-CsCertificate показан в следующем примере:
    
    ![Get-CsCertificate — информация о текущем состоянии сертификата](images/Gg429702.664f6326-6cd5-48e2-8235-fc3950ea43b4(OCS.15).jpg "Get-CsCertificate — информация о текущем состоянии сертификата")

6.  В Командная консоль Lync Server введите:
    
        Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -CA <CA Server FQDN\CA Instance> -Verbose -DomainName "<FQDN entries to be added to the Subject Alternative Name>"
    
    При этом полная команда выглядит следующим образом:
    
        Request-CsCertificate -New -Type Default,WebServicesInternal,WebServicesExternal -CA dc01.contoso.net\contoso-DC01-CA -Verbose -DomainName "LyncdiscoverInternal.Contoso.com,Lyncdiscover.Contoso.com"
    

    > [!TIP]
    > По умолчанию Request-CsCertificate заполняет имя субъекта именем сервера или пула, а записи в альтернативном имени субъекта – полным доменным именем сервера, полным доменным именем пула, полными доменными именами простых URL-адресов, а также полными доменными именами внутренних и внешних веб-служб. Для этого командлет ссылается на документ топологии в вашем развертывании. Если вы указали параметр -Verbose, то в случае отсутствия какого-либо значения вы получаете уведомление о том, что расчетные и фактические значения для альтернативных имен различаются, однако этот параметр не сообщает вам, какие именно значения отсутствуют. Он предоставляет вам полное вычисленное значение, на которое ссылается командлет. Используйте строку вычисленных альтернативных имен в выходных данных, чтобы повторно запросить новый сертификат, включающий в себя все значения.

    
    ![Результат запроса сертификата с использованием команды Request-CsCertifica](images/Gg429702.9e59a657-fa75-4454-8fd3-57c81e829f7b(OCS.15).jpg "Результат запроса сертификата с использованием команды Request-CsCertifica")

7.  В Командная консоль Lync Server введите:
    
        Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint <Thumbprint of certificate to use>
    
    При этом полная команда выглядит следующим образом:
    
        Set-CsCertificate -Type Default,WebServicesInternal,WebServicesExternal -Thumbprint 466D9BB0E8B928B65AF38FA2D9F41E1B301ECE9D
    
    Выходные данные командлета Set-CsCertificate покажут, что один сертификат (обозначенный отпечатком сертификата) назначается для использования Default, WebServicesExternal и WebServicesInternal.
    
    ![Результат выполнения команды Set-CsCertificate на IIS WebExt](images/Gg429702.dd451c9d-7b49-4408-8071-c868cb1e678c(OCS.15).jpg "Результат выполнения команды Set-CsCertificate на IIS WebExt")

## Настройка проверки подлинности и сертификатов для виртуальных каталогов служб IIS и подтверждение правильности такой настройки

1.  Нажмите кнопку **Пуск** , выберите **Все программы** , **Администрирование** и затем **Диспетчер служб IIS** .

2.  В окне **Диспетчер служб IIS** разверните узел **Имя сервера** и затем узел **Сайты** .

3.  Щелкните правой кнопкой мыши элемент **Lync Server External Web Site** (Внешний веб-сайт Lync Server) и выберите пункт **Изменить привязки**

4.  Убедитесь, что HTTPS сопоставлен с портом 4443, а затем щелкните элемент **HTTPS** .

5.  Выберите запись HTTPS, нажмите кнопку **Изменить** и затем убедитесь, что Lync Server WebServicesExternalCertificate привязан к данному протоколу. Сравните отпечаток из командлета Set-CsCertificate, чтобы убедиться, что ожидаемый сертификат правильно сопоставлен с привязкой HTTPS.

## См. также

#### Другие ресурсы

[Get-CsCertificate](https://docs.microsoft.com/en-us/powershell/module/skype/Get-CsCertificate)  
[Set-CsCertificate](https://docs.microsoft.com/en-us/powershell/module/skype/Set-CsCertificate)

