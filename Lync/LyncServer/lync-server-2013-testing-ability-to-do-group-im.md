---
title: 'Lync Server 2013: Проверка возможности группового обмена мгновенными сообщениями'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Testing ability to do group IM
ms:assetid: ca5545bc-51ac-490f-b96b-917bb742ad04
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn743839(v=OCS.15)
ms:contentKeyID: 63969652
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 8552d5caadf26d70265f5538f10c6152eb67dcc8
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2020
ms.locfileid: "41745989"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="testing-ability-to-do-group-im-in-lync-server-2013"></a>Тестирование возможности группового обмена мгновенными сообщениями в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-06-05_


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>Расписание проверки</p></td>
<td><p>Ежедневно</p></td>
</tr>
<tr class="even">
<td><p>Средство тестирования</p></td>
<td><p>Windows PowerShell</p></td>
</tr>
<tr class="odd">
<td><p>Требуемые разрешения</p></td>
<td><p>При локальном запуске с помощью командной консоли Lync Server пользователи должны быть членами группы безопасности Рткуниверсалсерверадминс.</p>
<p>При запуске с помощью удаленного экземпляра Windows PowerShell пользователям должна быть назначена роль RBAC, имеющая разрешение на запуск командлета Test-Ксграупим. Чтобы просмотреть список всех ролей RBAC, которые могут использовать этот командлет, выполните в командной строке Windows PowerShell следующую команду:</p>
<pre><code>Get-CsAdminRole | Where-Object {$_.Cmdlets -match &quot;Test-CsGroupIM&quot;}</code></pre></td>
</tr>
</tbody>
</table>


<div>

## <a name="description"></a>Описание

Командлет Test-Ксграупим удостоверяется в том, что пользователи в вашей организации могут проводить групповые сеансы обмена мгновенными сообщениями. При запуске test-Ксграупим командлет пытается войти в систему на сервере Lync Server в паре тестовых пользователей. При успешном выполнении команды Test-Ксграупим создает новую конференцию с помощью первого тестового пользователя, а затем приглашает второго пользователя присоединиться к Конференции. После обмена сообщениями оба пользователя отключаются от системы. Обратите внимание, что все это происходит без взаимодействия с пользователем и без воздействия каких – либо реальных пользователей. Например, предположим, что проверка учетной записи sip:kenmyer@litwareinc.comа с реальным пользователем, у которого есть учетная запись сервера Lync Server. В этом случае тест будет проводиться без перерывов в работе Кен мер. Например, даже когда Кен мер тестовая учетная запись выходит из системы, Кен мер человека останется на входе. Кроме того, мер Кен не получит приглашение присоединиться к Конференции. Это приглашение будет отправлено и принято для тестового счета.

Дополнительные сведения можно найти в справочной документации по командлету [Test-ксграупим](https://docs.microsoft.com/powershell/module/skype/Test-CsGroupIM) .

</div>

<div>

## <a name="running-the-test"></a>Выполнение теста

Командлет Test-Ксграупим можно выполнить с помощью пары предварительно настроенных тестовых учетных записей (см. раздел Настройка тестовых учетных записей для выполнения тестов Lync Server) или учетные записи любых двух пользователей, которые включены в Lync Server. Для выполнения этой проверки с помощью тестовых учетных записей нужно просто указать полное доменное имя для тестируемого пула Lync Server. Например:

    Test-CsGroupIM -TargetFqdn "atl-cs-001.litwareinc.com"

Для выполнения этой проверки с использованием фактических учетных записей пользователей необходимо создать два объекта учетных данных командной консоли Lync Server (объекты, содержащие имя и пароль учетной записи) для каждой учетной записи. После вызова Test-Ксграупим вы должны добавить эти объекты учетных данных и адреса SIP для двух учетных записей.

    $credential1 = Get-Credential "litwareinc\kenmyer"
    $credential2 = Get-Credential "litwareinc\davidlongmire"
    Test-CsGroupIm -TargetFqdn "atl-cs-001.litwareinc.com" -SenderSipAddress "sip:kenmyer@litwareinc.com" -SenderCredential $credential1 -ReceiverSipAddress "sip:davidlongmire@litwareinc.com" -ReceiverCredential $credential2

Дополнительные сведения можно найти в справочной документации по командлету [Test-ксграупим](https://docs.microsoft.com/powershell/module/skype/Test-CsGroupIM) .

</div>

<div>

## <a name="determining-success-or-failure"></a>Определение успеха или сбоя

Если два пользователя могут завершить сеанс обмена мгновенными сообщениями, вы получите вывод примерно так, чтобы свойство Result пометило **"успешно".**

Таржетфкдн: atl-cs-001.litwareinc.com

Результат: успех

Задержка: 00:00:06.3812203

Ошибки

Диагностик

Если два пользователя не могут завершить сеанс обмена мгновенными сообщениями, результат будет показан в виде ошибки, а дополнительные сведения будут записаны в свойствах Error и диагноз.

Таржетфкдн: atl-cs-001.litwareinc.com

Результат: сбой

Задержка: 00:00:00

Ошибка: 404, не найдена

Диагностика: ErrorCode = 4005, Source = ATL-CS-001.litwareinc.com,

Reason = универсальный код ресурса (URI) назначения не включен для SIP либо не

Существует.

Microsoft. RTC. SignalR. Диагностичеадер

В предыдущем выводе говорится, что тест завершился сбоем, так как по крайней мере одна из тестовых учетных записей была недействительной из-за отсутствия учетной записи или из-за того, что пользователь не включен в Lync Server. Вы можете проверить существование учетной записи, а также включить или отключить ее для NM-OCS-14-3, выполнив следующую команду:

    "Ken Myer", "David Longmire" | Get-CsUser | Select-Object SipAddress, Enabled

Если при выполнении теста-Ксграупим происходит сбой, может потребоваться повторный запуск теста, в том числе параметр подробно:

    Test-CsGroupIM -TargetFqdn "atl-cs-001.litwareinc.com" -Verbose

При включенном параметре "подробный" функция Test-Ксграупим будет возвращать пошаговые учетные записи для каждого действия, которое он пытался принять, когда вы проверили возможность участия указанных пользователей в сеансах группового обмена мгновенными сообщениями. Например, если при выполнении теста возникла ошибка, и вы сообщаете, что одна или несколько учетных записей пользователей не являются допустимыми, вы можете повторно запустить тест с помощью параметра подробный и определить, какая учетная запись пользователя недействительна.

Отправка запроса на регистрацию:

 Целевое полное доменное имя = atl-cs-001.litwareinc.com

 SIP адрес пользователя = sip:kenmyer@litwareinc.com

 Зарегистрировать порт = 5061

Выбран тип проверки подлинности "Ива".

Исключение "вход был отклонен". Убедитесь в том, что используются правильные учетные данные, а учетная запись активна.

Как видите, в этом примере пользователь, которому предоставлен адрес SIP sip:kenmyer@litwareinc.com, не смог войти в систему.

</div>

<div>

## <a name="reasons-why-the-test-might-have-failed"></a>Причины, по которым может произойти сбой теста

Ниже приведены некоторые распространенные причины, по которым может произойти сбой Test-Ксграупим:

  - Вы указали неверную учетную запись пользователя. Для проверки существования учетной записи пользователя можно выполнить следующую команду:
    
        Get-CsUser "sip:kenmyer@litwareinc.com"

  - Учетная запись пользователя верна, но в настоящее время учетная запись не включена для Lync Server. Чтобы убедиться в том, что учетная запись пользователя включена для Lync Server, выполните команду, подобную следующей:
    
    Get-CsUser "sip:kenmyer@litwareinc.com" | Выбор-объект включен
    
    Если для свойства Enabled задано значение false, это означает, что пользователь в настоящее время не поддерживает Lync Server.

  - Возможно, служба мгновенных сообщений недоступна. С помощью Lync Server вы можете настроить систему таким образом, чтобы мгновенные сообщения не были доступны, если не удается получить доступ к базе данных архивации. Это можно проверить, выполнив команду, подобную следующей:
    
        Get-CsArchivingConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object BlockOnArchiveFailure
    
    Если для Блокконарчивефаилуре задано значение "true", необходимо определить, доступна ли база данных архивации. Вы можете вернуть расположение баз данных архивации с помощью следующей команды:
    
        Get-CsService -ArchivingDatabase

  - Сервер архивации может быть недоступен. Вы можете получить полное доменное имя серверов архивации с помощью этой команды:
    
        Get-CsService -ArchivingServer
    
    Затем вы можете обратиться к соответствующему серверу, чтобы убедиться, что он доступен. Например:
    
        ping atl-archiving-001.litwareinc.com

</div>

</div>

<span> </span>

</div>

</div>

</div>

