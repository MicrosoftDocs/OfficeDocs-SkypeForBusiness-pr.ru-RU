---
title: 'Lync Server 2013: тестирование возможности группового обмена мгновенными сообщениями'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Testing ability to do group IM
ms:assetid: ca5545bc-51ac-490f-b96b-917bb742ad04
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn743839(v=OCS.15)
ms:contentKeyID: 63969652
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 97562d82f751280ec4d1a8f154af2b85ed2be128
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2020
ms.locfileid: "42008651"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="testing-ability-to-do-group-im-in-lync-server-2013"></a>Тестирование возможности группового обмена мгновенными сообщениями в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2014-06-05_


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>Расписание проверки</p></td>
<td><p>Daily (Ежедневный)</p></td>
</tr>
<tr class="even">
<td><p>Средство тестирования</p></td>
<td><p>Windows PowerShell</p></td>
</tr>
<tr class="odd">
<td><p>Необходимые разрешения</p></td>
<td><p>При локальном запуске с помощью командной консоли Lync Server пользователи должны быть членами группы безопасности RTCUniversalServerAdmins.</p>
<p>При выполнении с помощью удаленного экземпляра Windows PowerShell пользователям должна быть назначена роль RBAC, имеющая разрешение на запуск командлета Test-CsGroupIM. Чтобы просмотреть список всех ролей RBAC, которые могут использовать этот командлет, выполните следующую команду в командной консоли Windows PowerShell:</p>
<pre><code>Get-CsAdminRole | Where-Object {$_.Cmdlets -match &quot;Test-CsGroupIM&quot;}</code></pre></td>
</tr>
</tbody>
</table>


<div>

## <a name="description"></a>Описание

Командлет Test-CsGroupIM проверяет, могут ли пользователи в вашей организации выполнять сеансы группы обмена мгновенными сообщениями. При выполнении командлета Test-CsGroupIM командлет пытается войти в систему на сервере Lync Server в сочетании тестовых пользователей. При успешном входе Test-CsGroupIM создает конференцию с помощью первого тестового пользователя, а затем приглашает второго пользователя присоединиться к конференции. После обмена сообщениями оба пользователя отключаются от системы. Обратите внимание, что все это происходит без участия пользователя и не влияет на реальных пользователей. Например, предположим, что тестовая учетная запись sip:kenmyer@litwareinc.com соответствует реальному пользователю с действительной учетной записью Lync Server. В этом случае тест будет проведен без прерывания работы пользователя Кен Майер (Ken Myer). Например, даже если тестовая учетная запись Кена Майера выходит из системы, сам Кен Майер останется в системе. Аналогично, настоящие Myer не получат приглашение присоединиться к Конференции. Оно будет отправлено и принято тестовой учетной записью.

Дополнительные сведения можно найти в справочной документации по командлету [Test-CsGroupIM](https://docs.microsoft.com/powershell/module/skype/Test-CsGroupIM) .

</div>

<div>

## <a name="running-the-test"></a>Выполнение теста

Командлет Test-CsGroupIM можно выполнить с помощью одной из предварительно настроенных тестовых учетных записей (см. Настройка тестовых учетных записей для выполнения тестов Lync Server) или учетных записей двух пользователей с включенной поддержкой Lync Server. Чтобы выполнить эту проверку с помощью тестовых учетных записей, достаточно указать полное доменное имя тестируемого пула Lync Server. Пример:

    Test-CsGroupIM -TargetFqdn "atl-cs-001.litwareinc.com"

Чтобы выполнить эту проверку с использованием фактических учетных записей пользователей, необходимо создать два объекта учетных данных командной консоли Lync Server (объекты, содержащие имя и пароль учетной записи) для каждой учетной записи. Затем необходимо включить эти объекты учетных данных и SIP-адреса для двух учетных записей при вызове Test-CsGroupIM:

    $credential1 = Get-Credential "litwareinc\kenmyer"
    $credential2 = Get-Credential "litwareinc\davidlongmire"
    Test-CsGroupIm -TargetFqdn "atl-cs-001.litwareinc.com" -SenderSipAddress "sip:kenmyer@litwareinc.com" -SenderCredential $credential1 -ReceiverSipAddress "sip:davidlongmire@litwareinc.com" -ReceiverCredential $credential2

Дополнительные сведения можно найти в справочной документации по командлету [Test-CsGroupIM](https://docs.microsoft.com/powershell/module/skype/Test-CsGroupIM) .

</div>

<div>

## <a name="determining-success-or-failure"></a>Определение успешности или сбоя

Если два пользователя могут выполнить сеанс обмена мгновенными сообщениями, будет выведен результат, подобный следующему, с помощью свойства Result, помеченного как **успешное:**

TargetFqdn: atl-cs-001.litwareinc.com

Результат: успешное выполнение

Задержка: 00:00:06.3812203

Ошибкой

Диагност

Если двум пользователям не удается завершить сеанс обмена мгновенными сообщениями, результат будет отображаться как сбой, а дополнительные сведения будут записаны в свойствах Error и диагноз:

TargetFqdn: atl-cs-001.litwareinc.com

Результат: сбой

Задержка: 00:00:00

Ошибка: 404, не найдена

Диагностика: ErrorCode = 4005, Source = ATL – CS – 001.litwareinc.com,

Reason = конечный URI либо не включен для SIP, либо не

есть.

Microsoft. RTC. Signal. Диагностичеадер

Предыдущие выходные данные появлялись, что не удалось выполнить тест, так как по крайней мере одна из тестовых учетных записей была недействительной, так как учетная запись не существует или у пользователя не включена поддержка Lync Server. Вы можете проверить существование учетной записи, а также указать, включена ли учетная запись для NM-OCS-14-3, выполнив команду, аналогичную следующей:

    "Ken Myer", "David Longmire" | Get-CsUser | Select-Object SipAddress, Enabled

Если Test-CsGroupIM завершается с ошибкой, вам может потребоваться повторно выполнить проверку, включая параметр verbose:

    Test-CsGroupIM -TargetFqdn "atl-cs-001.litwareinc.com" -Verbose

Если включен параметр Verbose, Test-CsGroupIM будет возвращать пошаговые учетные записи каждого выполняемого действия, когда он проверил возможность участия указанных пользователей в сеансах группы обмена мгновенными сообщениями. Например, если тест завершается с ошибкой, и вы сообщаете, что одна или несколько учетных записей пользователей являются недопустимыми, вы можете повторно выполнить тест с параметром verbose и определить, какая учетная запись пользователя является недопустимой:

Отправка запроса на регистрацию:

 Целевое полное доменное имя = atl-cs-001.litwareinc.com

 SIP адрес пользователя = sip:kenmyer@litwareinc.com

 Зарегистрировать порт = 5061

Выбран тип проверки подлинности "Ива".

Исключение "при входе в систему было отклонено. Убедитесь, что используются правильные учетные данные, а учетная запись активна.

Как вы видите, в этом примере пользователь, у которого есть SIP Address sip:kenmyer@litwareinc.com, не смог выполнить вход.

</div>

<div>

## <a name="reasons-why-the-test-might-have-failed"></a>Причины, по которым может произойти сбой теста

Ниже приведены некоторые распространенные причины, по которым может произойти ошибка Test-CsGroupIM:

  - Вы указали неправильную учетную запись пользователя. Чтобы убедиться, что учетная запись пользователя существует, выполните следующую команду:
    
        Get-CsUser "sip:kenmyer@litwareinc.com"

  - Учетная запись пользователя действительна, но в настоящее время учетная запись не включена для Lync Server. Чтобы убедиться, что учетная запись пользователя была включена для Lync Server, выполните команду, аналогичную следующей:
    
    Get – CsUser "sip:kenmyer@litwareinc.com" | Select – объект включен
    
    Если свойство Enabled имеет значение false, это означает, что в настоящее время у пользователя не включена поддержка Lync Server.

  - Служба обмена мгновенными сообщениями может быть недоступна. С помощью Lync Server можно настроить систему таким образом, чтобы мгновенные сообщения не были доступны, если не удается получить доступ к базе данных архивации. Это можно проверить, выполнив команду, аналогичную следующей:
    
        Get-CsArchivingConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object BlockOnArchiveFailure
    
    Если для Блокконарчивефаилуре задано значение true, то следует определить, доступна ли база данных архивации. Вы можете вернуть расположения баз данных архивации с помощью следующей команды:
    
        Get-CsService -ArchivingDatabase

  - Сервер архивации может быть недоступен. С помощью этой команды можно получить полное доменное имя серверов архивации:
    
        Get-CsService -ArchivingServer
    
    После этого вы можете проверить связь с соответствующим сервером, чтобы убедиться, что он доступен. Пример:
    
        ping atl-archiving-001.litwareinc.com

</div>

</div>

<span> </span>

</div>

</div>

</div>

