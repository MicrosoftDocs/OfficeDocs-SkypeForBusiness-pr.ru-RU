---
title: 'Lync Server 2013: создание или изменения рабочего процесса сервисной группы'
TOCTitle: Создание или изменения рабочего процесса сервисной группы
ms:assetid: dcb9effb-5d12-4dee-80fc-ab9654222d5a
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ205321(v=OCS.15)
ms:contentKeyID: 49311382
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Создание или изменения рабочего процесса сервисной группы в Lync Server 2013

 

_**Дата изменения раздела:** 2013-09-11_

Используйте одну из следующих процедур для создания или изменения рабочего процесса сервисной группы.

> [!NOTE]  
> Можно использовать Командная консоль Lync Server или настройки группы ответа для создания или изменения рабочих процессов сервисной группы. Для получения доступа к настройки группы ответа можно использовать панель управления Lync Server или открыть веб-страницу непосредственно из веб-браузера; для этого введите следующий URL-адрес: <strong>https://</strong> <em>&lt;webPoolFqdn&gt;</em> <strong>/RgsConfig</strong> .

## Использование командлетов настройки группы ответа для создания или изменения рабочего процесса

1.  Выполните вход как член группы RTCUniversalServerAdmins или одной из предварительно заданных административных ролей, поддерживающих группу ответа.

2.  Откройте окно браузера и введите URL-адрес для администрирования, чтобы открыть панель управления Lync Server. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Lync Server см. в разделе [Открытие средств администрирования Lync Server](lync-server-2013-open-lync-server-administrative-tools.md).

3.  В левой области навигации щелкните элемент **Группы ответа** , а затем **Рабочий процесс** .

4.  На странице **Рабочий процесс** щелкните **Create or edit a workflow** (Создание или редактирование рабочего процесса).

5.  В поле поиска **Выберите службу** введите имя службы **ApplicationServer** (полностью или частично), в которой размещается создаваемый или изменяемый рабочий процесс. В итоговом списке служб щелкните необходимую службу, а затем щелкните **ОК** .
    
    > [!NOTE]  
    > Откроется страница настройки группы ответа. Можно также открыть настройки группы ответа непосредственно из веб-браузера; для этого введите следующий URL-адрес: <strong>https://</strong> <em>&lt;webPoolFqdn&gt;</em> <strong>/RgsConfig</strong> .

6.  Выполните одно из указанных ниже действий.
    
      - В разделе **Создание нового рабочего процесса** нажмите кнопку **Создать** для элемента **Сервисная группа** .
    
      - В области **Управление существующим рабочим процессом** найдите рабочий процесс, который нужно изменить, а затем в разделе **Действие** щелкните **Изменить** .

7.  Если все готово к тому, чтобы разрешить пользователям использовать этот рабочий процесс, установите флажок **Activate the workflow** (Активировать рабочий процесс).
    
    > [!NOTE]  
    > Если вы создаете управляемый рабочий процесс, необходимо выбрать функцию <strong>Активировать рабочий процесс</strong> . После сохранения активного управляемого рабочего процесс его можно изменить или отключить.

8.  Чтобы разрешить федеративным пользователям выполнять вызов группы, установите флажок **Включить для федерации** . Требуется также наличие политики внешнего доступа, которая применяется к приложению "Группа ответа", настроенному для федерации.
    
    > [!NOTE]  
    > Глобальная внешняя политика применяется к &quot;Группа ответа&quot;. Вы можете настроить глобальную политику для федерации группы ответа с помощью панели управления Lync Server или командлета <strong>Set-CsExternalAccessPolicy</strong> для установки значения «True» для параметра EnableOutsideAccess. Помните, что настройки глобальной политики применяются ко всем пользователям, если им не назначена политика на уровне сайта или пользователя. Поэтому перед изменением этого параметра для групп ответа убедитесь, что параметр федерации удовлетворяет требованиям организации. Для получения сведений о применении политик для пользователей см. <a href="lync-server-2013-manage-external-access-policy-for-your-organization.md">Управление политикой внешнего доступа в Lync Server 2013</a>. Для получения сведений о параметре федерации см. <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Set-CsExternalAccessPolicy">Set-CsExternalAccessPolicy</a>.    
    > [!NOTE]  
    > Пользователи, размещенные в Lync Online не могут совершать вызовы в группах ответа, размещенных в локальном развертывании. Это верно как для гибридных развертываний, так и для случаев, когда локальное развертывание находится в федерации с развертыванием Lync Online.

9.  Чтобы скрыть удостоверения пользователей при выполнении вызова, установите флажок **Разрешить анонимность агентов** .
    
    > [!NOTE]  
    > Анонимные вызовы не должны начинаться с сеанса видеосвязи или обмена мгновенными сообщениями (после начала сеанса вызова можно добавить видео и мгновенные сообщения). Анонимный агент также может поставить вызов на удержание, передать вызов (скрытая передача и передача после консультации), а также выполнять парковку и извлечение вызовов. Анонимные вызовы не поддерживают конференц-связь, совместный доступ к приложениям и рабочему столу, передачу файлов, работу с доской, совместную работу с данными и запись звонков. Агенты, использующие подключаемый модуль VDI Lync, могут анонимно получать входящие вызовы, но не отправлять исходящие вызовы.

10. В поле **Enter the address of the group that will receive the calls** (Введите адрес группы, которая будет получать вызовы) введите основной адрес универсального кода ресурса (URI) SIP группы, которая будет отвечать на вызовы рабочего процесса.
    
    > [!NOTE]  
    > Основной URI рабочего процесса определяет порядок идентификации рабочего процесса и ссылки на него. Вводимый URI SIP создается как контактный объект в Доменные службы Active Directory. Чтобы создать URI, объект должен быть уникальным в службах Active Directory.

11. В поле **Отображаемое имя** введите имя, которое должно отображаться для рабочего процесса (например, «Продажи ответа»).
    
    > [!NOTE]  
    > Не используйте в отображаемом имени символы «&lt;» или «&gt;». Не используйте следующие отображаемые имена, поскольку они зарезервированы: <strong>RGS Presence Watcher</strong> (Наблюдатель присутствия RGS) или <strong>Announcement Service</strong> (Служба оповещения).

12. В области **Номер телефона** введите URI линии для группы ответа (например, +14255550165).

13. В поле **Отображаемый номер** введите номер, который должен отображать для группы ответа (например, +1 (425) 555-0165).

14. (Дополнительно) В поле **Описание** введите описание рабочего процесса, которое должно отображаться в карточке контакта на клиенте Lync.

15. В поле **Тип рабочего процесса** выберите **Управляемый** , если этот рабочий процесс будет управляться менеджером группы ответа группы. Чтобы назначить менеджеров ответа рабочему процессу, выполните следующие действия.
    
    1.  Введите URI SIP менеджера данного рабочего процесса и нажмите кнопку **Добавить** .
    
    2.  Введите URI SIP дополнительных менеджеров, чтобы добавить их в рабочий процесс, и нажмите кнопку **Добавить** .
    
    > [!IMPORTANT]  
    > Каждому пользователю, который назначен менеджером группы ответа, необходимо присвоить роль CsResponseGroupManager. Если пользователям не назначена эта роль, они не могут управлять группами ответа.

16. В области **Шаг 2 – выбор языка** щелкните язык, который необходимо использовать для распознавания речи и преобразования текста в речь.

17. Если необходимо настроить приветственное сообщение, в области **Шаг 3 – настройка приветственного сообщения** установите флажок **Воспроизвести приветственное сообщение** , а затем выполните одно из следующих действий:
    
      - Чтобы ввести приветственное сообщение в виде текста с последующим преобразованием в речь для вызывающего абонента, щелкните **Преобразовать текст в речь** , а затем введите приветственное сообщение в текстовом поле.
        
        > [!NOTE]  
        > Не включайте в вводимый текст теги HTML. В случае добавления тегов HTML появится сообщение об ошибке.    
      - Чтобы использовать файл wave (.wav) или аудиофайл Windows Media (.wma) для воспроизведения в качестве приветственного сообщения, щелкните **Выбрать запись** . Если необходимо загрузить новый аудиофайл, щелкните ссылку **запись** . В новом окне браузера щелкните **Обзор** , выберите файл, который необходимо использовать, а затем щелкните **Открыть** . Щелкните **Загрузить** для загрузки аудиофайла.
        
        > [!NOTE]  
        > Все аудиофайлы, загружаемые пользователем, должны удовлетворять определенным требованиям. Для получения более подробных сведений о поддерживаемых форматах файлов см. <a href="lync-server-2013-technical-requirements-for-response-group.md">Технические требования для групп ответа в Lync Server 2013</a>.

18. В области **Шаг 4 – указание часов работы** выберите часовой пояс для рабочего процесса в поле **Ваш часовой пояс** .
    
    > [!NOTE]  
    > Часовой пояс – это пояс, к которому относятся вызывающие абоненты и агенты. Он используется для расчета часов открытия и закрытия. Например, если для рабочего процесса задано использование часового пояса «Североамериканское восточное стандартное время» и в качестве времени открытия указано 7:00, а в качестве времени закрытия – 23:00, предполагается, что офис открывается в 7:00 по восточному времени, а закрывается в 23:00 по восточному времени, соответственно. (Время необходимо вводить в 24-часовом формате.)

19. Выберите тип рабочего графика, который следует использовать. Для этого выполните одно из следующих действий:
    
      - Чтобы использовать предварительно определенный график рабочего времени, щелкните **Использовать предварительно заданный график** , а затем выберите необходимое расписание в раскрывающемся списке.
        
        > [!NOTE]  
        > Эта функция доступна для выбора только в том случае, если ранее было задано по крайней мере одно расписание. Для задания предустановленных графиков воспользуйтесь командлетом <strong>New-CSRgsHoursOfBusiness</strong>. Для получения более подробных сведений см. <a href="lync-server-2013-optional-define-response-group-business-hours.md">Определение рабочих часов для группы ответа в Lync Server 2013 (необязательно)</a>.        
        > [!NOTE]  
        > При выборе предварительно заданного расписания в полях <strong>День</strong> , <strong>Открытие</strong> и <strong>Закрытие</strong> автоматически указываются дни и часы работы группы ответа.    
      - Чтобы использовать пользовательское расписание, применяемое только к этому рабочему процессу, щелкните **Использовать пользовательское расписание** .

20. Если вы создаете индивидуальное расписание для данного рабочего процесса, установите флажки, чтобы выбрать дни недели, по которым группа ответа доступна.

21. Если вы создаете собственное расписание, введите часы **открытия** и **закрытия** для каждого дня недели, когда группа ответа доступна.
    
    > [!NOTE]  
    > Часы <strong>открытия</strong> и <strong>закрытия</strong> необходимо указывать в 24-часовом формате. Например, если ваш офис открыт с 9.00 до 17.00 с перерывом на обед, необходимо указать следующие часы работы: <strong>Открытие</strong> 9:00, <strong>Закрытие</strong> 12:00, <strong>Открытие</strong> 13:00 и <strong>Закрытие</strong> 17:00.

22. Если необходимо воспроизводить сообщение, когда офис закрыт, установите флажок **Воспроизводить сообщение в нерабочее время группы ответа** , а затем укажите сообщение, которое необходимо воспроизводить. Для этого выполните одно из следующих действий:
    
      - Чтобы ввести сообщение в виде текста с последующим преобразованием в речь для вызывающего абонента, щелкните **Преобразовать текст в речь** , а затем введите сообщение в текстовом поле.
        
        > [!NOTE]  
        > Не включайте в вводимый текст теги HTML. В случае добавления тегов HTML появится сообщение об ошибке.    
      - Чтобы использовать аудиофайл для воспроизведения сообщения, щелкните **Выбрать запись** . Если необходимо загрузить новый аудиофайл, щелкните ссылку **запись** . В новом окне браузера щелкните **Обзор** , выберите файл, который необходимо использовать, а затем щелкните **Открыть** . Щелкните **Загрузить** для загрузки аудиофайла.
        
        > [!NOTE]  
        > Все аудиофайлы, загружаемые пользователем, должны удовлетворять определенным требованиям. Для получения более подробных сведений о поддерживаемых форматах аудиофайлов см. <a href="lync-server-2013-technical-requirements-for-response-group.md">Технические требования для групп ответа в Lync Server 2013</a>.

23. Укажите способ обработки вызовов после воспроизведения сообщения (если оно настроено):
    
      - Чтобы прервать вызов, щелкните **Разъединить вызов** .
    
      - Чтобы перенаправить вызов на голосовую почту, щелкните **Отправить на голосовую почту** , а затем введите адрес голосовой почты. Следует использовать следующий формат адреса голосовой почты: *\<имя\_пользователя\>* @ *\<имя\_домена\>* (например, bob@contoso.com).
    
      - Что перенаправить вызов другому пользователю, щелкните **Отправить на SIP URI** , а затем введите адрес пользователя. Используйте следующий формат адреса пользователя: *\<имя\_пользователя\>* @ *\<имя\_домена\>* .
    
      - Чтобы перенаправить вызов на другой номер телефона, щелкните **Отправить на телефонный номер** , а затем введите номер телефона. Используйте следующий формат телефонного номера: *\<номер\>* @ *\<имя\_домена\>* (например, +14255550121@contoso.com). Имя домена используется для переадресации вызывающего абонента в необходимое целевое расположение.

24. В разделе **Шаг 5 – указание праздников и выходных** установите флажки для одного или нескольких наборов праздников, то есть дней, когда группа ответа не будет работать.
    
    > [!NOTE]  
    > Праздники и выходные необходимо указать перед настройкой рабочего процесс. Используйте командлеты <strong>New-CsRgsHoliday</strong> и <strong>New-CsRgsHolidaySet</strong>, чтобы указать праздники и выходные дни. Для получения более подробных сведений см. <a href="lync-server-2013-optional-define-response-group-holiday-sets.md">(Необязательно) определение набора праздников группы ответа в Lync Server 2013</a>.

25. Если в выходные необходимо воспроизводить сообщение, установите флажок **Воспроизводить сообщение на выходных** и укажите воспроизводимое сообщение, выполнив одно из следующих действий:
    
      - Чтобы ввести сообщение в виде текста с последующим преобразованием в речь для вызывающего абонента, щелкните **Преобразовать текст в речь** , а затем введите сообщение в текстовом поле.
        
        > [!NOTE]  
        > Не включайте в вводимый текст теги HTML. В случае добавления тегов HTML появится сообщение об ошибке.    
      - Чтобы использовать аудиофайл для воспроизведения сообщения, щелкните **Выбрать запись** . Если необходимо загрузить новый аудиофайл, щелкните ссылку **запись** . В новом окне браузера щелкните **Обзор** , выберите файл, который необходимо использовать, а затем щелкните **Открыть** . Щелкните **Загрузить** для загрузки аудиофайла.
        
        > [!NOTE]  
        > Все аудиофайлы, загружаемые пользователем, должны удовлетворять определенным требованиям. Для получения более подробных сведений о поддерживаемых форматах аудиофайлов см. <a href="lync-server-2013-technical-requirements-for-response-group.md">Технические требования для групп ответа в Lync Server 2013</a>.

26. Укажите способ обработки вызовов после воспроизведения сообщения (если оно настроено):
    
      - Чтобы прервать вызов, щелкните **Разъединить вызов** .
    
      - Чтобы перенаправить вызов на голосовую почту, щелкните **Отправить на голосовую почту** , а затем введите адрес голосовой почты. Следует использовать следующий формат адреса голосовой почты: *\<имя\_пользователя\>* @ *\<имя\_домена\>* (например, bob@contoso.com).
    
      - Что перенаправить вызов другому пользователю, щелкните **Отправить на SIP URI** , а затем введите адрес пользователя. Используйте следующий формат адреса пользователя: *\<имя\_пользователя\>* @ *\<имя\_домена\>* .
    
      - Чтобы перенаправить вызов на другой номер телефона, щелкните **Отправить на телефонный номер** , а затем введите номер телефона. Используйте следующий формат телефонного номера: *\<номер\>* @ *\<имя\_домена\>* (например, +14255550121@contoso.com). Имя домена используется для переадресации вызывающего абонента в необходимое целевое расположение.

27. В поле **Step 6 Configure a Queue** (Шаг 6. Настройка очереди) в поле **Select the queue that will receive the calls** (Выберите очередь, которая будет получать вызовы) выберите очередь, в которую будут помещаться абоненты на удержании, пока не освободится агент.

28. В области **Шаг 7 – настройка музыки, воспроизводимой при удержании** выберите музыку, которая должна воспроизводиться для вызывающих абонентов при ожидании ответа агента. Для этого выполните следующие действия:
    
      - Чтобы использовать стандартную запись для воспроизведения при удержании звонка, щелкните **Использовать запись по умолчанию** .
    
      - Чтобы использовать аудиофайл для воспроизведения при удержании звонка, щелкните **Выбрать аудиофайл** . Если необходимо загрузить новый аудиофайл, щелкните ссылку **аудиофайл** . В новом окне браузера щелкните **Обзор** , выберите файл, который необходимо использовать, а затем щелкните **Открыть** . Щелкните **Загрузить** для загрузки аудиофайла.
        
        > [!NOTE]  
        > Все аудиофайлы, предоставленные пользователям, должны удовлетворять определенным требованиям. Для получения более подробных сведений о поддерживаемых форматах аудиофайлов см. <a href="lync-server-2013-technical-requirements-for-response-group.md">Технические требования для групп ответа в Lync Server 2013</a>.

29. Нажмите кнопку **Развернуть** .

## Использование командлетов Windows PowerShell для создания или изменения рабочего процесса

1.  Выполните вход как член группы RTCUniversalServerAdmins или одной из предварительно заданных административных ролей, поддерживающих группу ответа.

2.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

3.  Создайте подсказку для воспроизведения в качестве приветственного сообщения и сохраните ее в качестве переменной. В командной строке выполните команду:
    
        $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "<text for TTS prompt>"
    
    Например:
    
        $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "Welcome to Contoso. Please wait for an available agent."
    
    > [!NOTE]  
    > Чтобы использовать аудиофайл для этой подсказки, воспользуйтесь командлетом <strong>Import-CsRgsAudioFile</strong>. Дополнительные сведения см. в разделе <a href="https://docs.microsoft.com/powershell/module/skype/Import-CsRgsAudioFile">Import-CsRgsAudioFile</a>.

4.  Получите идентификатор очереди или вопроса при перенаправлении вызовов. В командной строке выполните команду:
    
        $qid = (Get-CsRgsQueue -Name "Help Desk").Identity
    
    Для получения более подробных сведений о создании очереди см. [New-CsRgsQueue](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsQueue).

5.  Определите действие по умолчанию, которое будет выполняться при открытии рабочего процесса в рабочие часы, и сохраните его в качестве переменной. В командной строке выполните команду:
    
        $actionWM = New-CsRgsCallAction -Prompt <saved prompt from previous step> -Action <action to be taken> -QueueID $qid
    
    > [!NOTE]  
    > Для рабочих процессов сервисной группы действие по умолчанию должно перенаправлять вызов в очередь. Этот параметр требуется для активных рабочих процессов. Для неактивных рабочих процессов этот параметр указывать не нужно.    
    Например:
    
        $actionWM = New-CsRgsCallAction -Prompt $promptWM -Action TransferToQueue -QueueID $qid.Identity

6.  Если необходимо определить рабочие и выходные дни, следует создать их перед созданием или изменением рабочего процесса. Подробные сведения см. в документах [Определение рабочих часов для группы ответа в Lync Server 2013 (необязательно)](lync-server-2013-optional-define-response-group-business-hours.md) и [(Необязательно) определение набора праздников группы ответа в Lync Server 2013](lync-server-2013-optional-define-response-group-holiday-sets.md).

7.  Если требуется подсказка для вызовов, полученных в нерабочее время или в праздники, используйте командлет **New-CsRgsPrompt** для определения подсказки и воспользуйтесь командлетом **New-CsRgsCallAction**, чтобы определить действие, которое необходимо выполнить после появления подсказки. Подробные сведения см. в документах [New-CsRgsPrompt](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsPrompt) и [New-CsRgsCallAction](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsCallAction).

8.  Получите имя службы для группы ответа Lync Server и назначьте его переменной. В командной строке выполните следующую команду:
    
        $serviceId="service:"+(Get-CSService | ?{$_.Applications -like "*RGS*"}).ServiceId;

9.  Создайте или измените рабочий процесс. Чтобы создать рабочий процесс, используйте командлет **New-CsRgsWorkflow**. Чтобы изменить рабочий процесс, используйте командлет **Set-CsRgsWorkflow**. В командной строке введите следующую команду:
    
        $workflowHG = New-CsRgsWorkflow -Parent <service ID for the Response Group service> -Name "<hunt group name>" [-Description "<hunt group description>"] -PrimaryUri "<SIP address for the workflow>" [-LineUri "<Phone number for the workflow>"] [-DisplayNumber "<Phone number displayed in Lync>"] [-Active <$true | $false>] [-Anonymous <$true | $false>] [-DefaultAction <variable from preceding step>] [-EnabledForFederation <$true | $false>] [-Managed <$true | $false>] [-MangersByUri <SIP addresses for Response Group Managers who can manage the workflow>]
    
    Например:
    
        $workflowHG = New-CsRgsWorkflow -Parent $serviceID -Name "Human Resources" -Description "Human Resources workflow" -PrimaryUri "sip:humanresources@contoso.com" -LineUri "TEL:+14255551219" -DisplayNumber "555-1219" -Active $true -Anonymous $true -DefaultAction $actionWM -EnabledForFederation $false -Managed $true -ManagersByUri "sip:bob@contoso.com", "mindy@contoso.com"
    
    > [!IMPORTANT]  
    > Всем пользователям, которые назначены менеджерами рабочих процессов, необходимо присвоить роль CsResponseGroupManager.    
    > [!NOTE]  
    > Подробные сведения о других необязательных параметрах см. в документах <a href="https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsWorkflow">New-CsRgsWorkflow</a> и <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Set-CsRgsWorkflow">Set-CsRgsWorkflow</a>

## См. также

#### Задачи

[(Необязательно) определение набора праздников группы ответа в Lync Server 2013](lync-server-2013-optional-define-response-group-holiday-sets.md)  

#### Концепции

[Определение рабочих часов для группы ответа в Lync Server 2013 (необязательно)](lync-server-2013-optional-define-response-group-business-hours.md)  

#### Другие ресурсы

[New-CsRgsWorkflow](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsWorkflow)  
[Set-CsRgsWorkflow](https://docs.microsoft.com/en-us/powershell/module/skype/Set-CsRgsWorkflow)  
[New-CsRgsPrompt](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsPrompt)  
[New-CsRgsCallAction](https://docs.microsoft.com/en-us/powershell/module/skype/New-CsRgsCallAction)

