---
title: "Lync Server 2013: настр. дост. журн. SQL Server между осн. зеркалом и БД-получателем"
TOCTitle: Установка доставки журналов SQL Server между основным зеркалом и базой данных-получателем доставки журналов
ms:assetid: 4e8e9ce9-4301-47f2-a0c3-669afeb53295
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ204887(v=OCS.15)
ms:contentKeyID: 49309729
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Установка доставки журналов SQL Server между основным зеркалом и базой данных-получателем доставки журналов в Lync Server 2013

 

_**Дата изменения раздела:** 2013-02-21_

Выполните следующие действия, чтобы доставка журналов продолжалась в случае отработки отказа основной базы данных сохраняемых сеансов сохраняемый сеанс беседы в ее зеркальную базу данных.

1.  Вручную выполните отработку отказа основной базы данных сохраняемых сеансов сохраняемый сеанс беседы в зеркало. Это можно осуществить с помощью командной консоли Командная консоль Lync Server и командлета **Invoke-CsDatabaseFailover**. Дополнительные сведения см. в подразделе "Использование командлетов командной консоли Командная консоль Lync Server" раздела [Развертывание зеркального отображения SQL Server для обеспечения высокой доступности внутреннего сервера в Lync Server 2013](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md).

2.  Используя SQL Server Management Studio, подключитесь к основному экземпляру зеркала сервера сохраняемого сеанса беседы.

3.  Убедитесь, что запущен агент SQL Server.

4.  Щелкните базу данных mgc правой кнопкой мыши и выберите пункт **Свойства** .

5.  В области **Выбор страницы** щелкните элемент **Доставка журналов транзакций** .

6.  Установите флажок **Включить эту базу данных в качестве источника в конфигурацию доставки журналов** .

7.  В области **Резервные копии журналов транзакций** щелкните элемент **Параметры копирования** .

8.  В поле **Network path to the backup folder** (Сетевой путь к каталогу резервной копии) введите сетевой путь к общей папке, созданной для резервной копии журнала транзакций.

9.  Если резервная папка находится на основном сервере, введите локальный путь к этой резервной папке в поле **Если папка резервного копирования находится на сервере-источнике, укажите локальный путь к папке** . (Если резервная папка находится не на основном сервере, вы можете оставить это поле пустым.)
    
    > [!IMPORTANT]
    > Если учетная запись службы SQL Server на основном сервере выполняется с использованием учетной записи локальной системы, вам следует создать резервную папку на основном сервере и указать локальный путь к ней.


10. Настройте параметры **Удалить файлы, созданные ранее** и **Предупредить, если резервное копирование не произошло в течение** .

11. Просмотрите расписание резервного копирования, указанное в поле **Расписание** области **Задание резервного копирования** . Чтобы настроить это расписание для своей установки, щелкните элемент **Расписание** и требуемым образом настройте расписание агента SQL Server.
    
    > [!IMPORTANT]
    > Используйте те же параметры, которые применялись для основной базы данных.


12. В области **Сжатие** выберите **Использовать параметр сервера по умолчанию** и нажмите кнопку **ОК** .

13. В области **Экземпляры сервера-получателя и базы данных** нажмите кнопку **Добавить** .

14. Щелкните элемент **Подключение** и подключитесь к экземпляру SQL Server, настроенному вами в качестве сервера-получателя.

15. В поле **База данных-получатель** выберите в списке базу данных **mgc** .

16. На вкладке **Инициализация базы данных-получателя** выберите параметр **Нет, база данных-получатель инициализирована** .

17. В поле **Папка назначения для копирования** на вкладке **Копирование файлов** введите путь к папке, в которую следует копировать резервные копии журналов транзакций, и нажмите кнопку **ОК** . Часто эта папка расположена на сервере-получателе.

18. Откройте раскрывающийся список **Скрипт конфигурации** и выберите **Вывести конфигурацию в новое окно запроса** .

19. В разделе **Свойства базы данных** окна нового запроса нажмите кнопку **ОК** , чтобы начать процесс настройки.

20. Выберите и запустите первую половину запроса (см. шаг 18) до следующей строки: -- \*\*\*\*\*\* End: Script to be run at Primary: \*\*\*\*\*\* (Конец. Скрипт для выполнения в основной базе:).
    
    > [!IMPORTANT]
    > Ручное выполнение этого скрипта необходимо из-за того, что SQL Server Management Studio не поддерживает несколько основных баз данных в конфигурации доставки журналов SQL Server.


21. Выберите **Отмена** , чтобы закрыть панель конфигурации доставки журналов и создать рабочую программу установки, которая правильно внедряет доставку файлов журналов как для основной, так и для зеркальной базы данных (в случае отработки отказа).

22. Вручную выполните отработку отказа основной базы данных сохраняемых сеансов сохраняемый сеанс беседы в основную базу. Это можно осуществить с помощью командной консоли Командная консоль Lync Server и командлета **Invoke-CsDatabaseFailover**. Дополнительные сведения см. в подразделе "Использование командлетов командной консоли Командная консоль Lync Server" раздела [Развертывание зеркального отображения SQL Server для обеспечения высокой доступности внутреннего сервера в Lync Server 2013](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md).

## См. также

#### Концепции

[Развертывание зеркального отображения SQL Server для обеспечения высокой доступности внутреннего сервера в Lync Server 2013](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)  
[Развертывание зеркального отображения SQL Server для обеспечения высокой доступности внутреннего сервера в Lync Server 2013](lync-server-2013-deploying-sql-mirroring-for-back-end-server-high-availability.md)

