---
title: Назначение сертификата проверки подлинности серверов на сервер Lync Server 2013
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Assigning a server-to-server authentication certificate to Microsoft Lync Server 2013
ms:assetid: c7413954-2504-47f4-a073-44548aff1c0c
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ205253(v=OCS.15)
ms:contentKeyID: 48185367
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 06372be3808f3855bc0172cc408308a0c9c9cab2
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2020
ms.locfileid: "41734019"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="assigning-a-server-to-server-authentication-certificate-to-microsoft-lync-server-2013"></a>Назначение сертификата проверки подлинности сервера серверу Microsoft Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2013-10-24_

Чтобы определить, назначен ли сертификат проверки подлинности "сервер-сервер" для Microsoft Lync Server 2013, выполните следующую команду в командной консоли Lync Server 2013.

    Get-CsCertificate -Type OAuthTokenIssuer

Если сведения о сертификате не возвращаются, для проверки подлинности между серверами необходимо сначала назначить сертификат издателя маркеров. Как правило, любой сертификат Lync Server 2013 можно использовать в качестве сертификата Оаустокениссуер; Например, вы также можете использовать сертификат по умолчанию Lync Server 2013 в качестве сертификата Оаустокениссуер. (Сертификат Оаустокениссуер также может представлять собой любой сертификат веб-сервера, включающий имя вашего домена SIP в поле субъекта.) Ниже указаны основные требования к сертификату, используемому для проверки подлинности серверов и сервера: 1) один и тот же сертификат должен быть настроен как сертификат Оаустокениссуер на всех серверах переднего плана; и 2) сертификат должен составлять не менее 2048 бит.

При отсутствии сертификата, позволяющего проверять подлинность между серверами, можно получить новый сертификат, импортировать его и затем применять для проверки подлинности между серверами. После запроса и получения нового сертификата вы можете войти на любой из своих серверов переднего плана и с помощью команды Windows PowerShell, аналогичной этой, для импорта и назначения этого сертификата.

    Import-CsCertificate -Identity global -Type OAuthTokenIssuer -Path C:\Certificates\ServerToServerAuth.pfx  -Password "P@ssw0rd"

В предыдущей команде параметр Path представляет полный путь к файлу сертификата, а параметр Password – пароль, назначенный сертификату. Эту процедуру необходимо выполнить только один раз: служба репликации Lync Server автоматически создаст набор запланированных задач, которые будут расшифровывать и развертывать сертификат на всех серверах переднего плана.

Можно также задать в качестве сертификата проверки подлинности между серверами существующий сертификат. (Как отмечено, сертификат по умолчанию можно использовать в качестве сертификата для проверки подлинности сервера и сервера.) В следующей паре команд Windows PowerShell извлекается значение свойства Thumbprint сертификата по умолчанию, а затем используйте это значение, чтобы сделать сертификат по умолчанию сертификатом проверки подлинности сервера и сервера.

    $x = (Get-CsCertificate -Type Default).Thumbprint
    Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x

В предыдущей команде полученный сертификат настроен для функционирования глобального сертификата проверки подлинности серверов и серверов; Это означает, что сертификат будет реплицирован и использоваться всеми серверами переднего плана. Эту команду можно выполнить только один раз и только на одном из ваших серверов переднего плана. Несмотря на то, что все серверы переднего плана должны использовать один и тот же сертификат, не следует настраивать сертификат Оаустокениссуер на каждом сервере переднего плана. Вместо этого настройте сертификат один раз, а затем разрешите серверу репликации Lync Server скопировать этот сертификат на каждый сервер.

Командлет Set-Ксцертификате берет на вопрос сертификат и сразу же настраивает этот сертификат для использования в качестве текущего сертификата Оаустокениссуер. (Lync Server 2013 хранит две копии типа сертификата: текущий сертификат и предыдущий сертификат). Если вам нужно сразу же приступить к работе с новым сертификатом в качестве сертификата Оаустокениссуер, следует использовать командлет Set-Ксцертификате.

Можно также воспользоваться командлетом Set-CsCertificate, чтобы "накатить" новый сертификат. "Накат" означает, что новый сертификат станет текущим сертификатом OAuthTokenIssuer в некоторый определенный момент времени. Например, эта команда извлекает сертификат по умолчанию, а затем настраивает этот сертификат для использования в качестве текущего сертификата Оаустокениссуер на 1 июля 2012 г.:

    $x = (Get-CsCertificate -Type Default).Thumbprint
    Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x -EffectiveDate "7/1/2012" -Roll

На 1 июля 2012 новый сертификат будет настроен в качестве текущего сертификата Оаустокениссуер и сертификат Оаустокениссуер "старый" будет настроен как предыдущий сертификат.

Если вы не хотите использовать Windows PowerShell, вы также можете экспортировать сертификат с первого сервера переднего плана с помощью консоли MMC "сертификаты", а затем импортировать этот же сертификат на все другие серверы переднего плана. При этом вместе с сертификатом необходимо экспортировать закрытый ключ.

<div>


> [!WARNING]
> В этом случае процедура должна выполняться на каждом сервере переднего плана. При экспорте и импорте сертификатов таким образом, Lync Server 2013 не будет реплицировать этот сертификат на каждый сервер переднего плана.



</div>

После импорта сертификата на все серверы переднего плана этот сертификат может быть назначен с помощью мастера развертывания Lync Server, а не Windows PowerShell. Для назначения сертификата с помощью мастера развертывания выполните следующие действия на компьютере, где установлен мастер развертывания.

1.  Нажмите кнопку Пуск, выберите все программы, а затем — **Microsoft Lync server 2013**, а затем — **Мастер развертывания Lync Server**.

2.  В мастере развертывания нажмите кнопку **Установка или обновление системы Lync Server**.

3.  На странице Microsoft Lync Server 2013 нажмите кнопку **выполнить** под заголовком **Шаг 3: запрос, установка и назначение сертификатов**. (Примечание. Если вы уже установили сертификаты на этом компьютере, нажмите кнопку " **выполнить** ", чтобы пометить **ее.)**

4.  В мастере сертификатов выберите сертификат **OAuthTokenIssuer**, затем нажмите кнопку **Назначить**.

5.  В мастере назначения сертификатов на странице **Назначение сертификатов** нажмите кнопку **Далее**.

6.  На странице **Хранилище сертификатов** выберите сертификат для применения при проверке подлинности между серверами, затем нажмите кнопку **Далее**.

7.  На странице "Сводка по назначениям сертификатов" нажмите кнопку **Далее**.

8.  На странице "Выполнение команд" нажмите кнопку **Готово**.

9.  Закройте мастер сертификатов и мастер развертывания.

</div>

<span> </span>

</div>

</div>

</div>

