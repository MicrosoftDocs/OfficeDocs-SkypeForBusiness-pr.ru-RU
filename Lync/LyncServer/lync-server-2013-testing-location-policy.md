---
title: 'Lync Server 2013: проверка политики расположения'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Testing location policy
ms:assetid: 23d06fd3-31ee-4480-ba1e-d179a55b8b14
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Dn690127(v=OCS.15)
ms:contentKeyID: 63969591
ms.date: 01/27/2015
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 2a954405cb8dbba842250e0545ac8661d4f3795c
ms.sourcegitcommit: b693d5923d6240cbb865241a5750963423a4b33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2020
ms.locfileid: "41745779"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="testing-location-policy-in-lync-server-2013"></a>Проверка политики расположения в Lync Server 2013

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Тема последнего изменения:** 2014-06-05_


<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p>Расписание проверки</p></td>
<td><p>Ежедневно</p></td>
</tr>
<tr class="even">
<td><p>Средство тестирования</p></td>
<td><p>Windows PowerShell</p></td>
</tr>
<tr class="odd">
<td><p>Требуемые разрешения</p></td>
<td><p>При локальном запуске с помощью командной консоли Lync Server пользователи должны быть членами группы безопасности Рткуниверсалсерверадминс.</p>
<p>При запуске с помощью удаленного экземпляра Windows PowerShell пользователям должна быть назначена роль RBAC, имеющая разрешение на запуск командлета Test-Кслокатионполици. Чтобы просмотреть список всех ролей RBAC, которые могут использовать этот командлет, выполните в командной строке Windows PowerShell следующую команду:</p>
<pre><code>Get-CsAdminRole | Where-Object {$_.Cmdlets -match &quot;Test-CsLocationPolicy&quot;}</code></pre></td>
</tr>
</tbody>
</table>


<div>

## <a name="description"></a>Описание

Командлет Test-Кслокатионполици удостоверяет, что политика расположения назначена пользователю. Политика Location используется для применения параметров, которые связаны с функциональностью E9-1-1 и адресом клиента. Политика расположения определяет, разрешено ли пользователю E9-1-1, и, если вы ответили "Да", каково поведение вызова экстренной помощи. Например, вы можете использовать политику расположения, чтобы определить, какой номер является вызовом экстренной помощи (911 в США), следует ли автоматически уведомлять корпоративную безопасность, а также как перенаправлять этот звонок.

Вы можете проверить политики расположения для пользователей или подсетей сети. Если вы пропустили тест для подсети (указав значение параметра подсети), командлет попытается разрешить политику расположения для этой подсети. Если подсеть не назначена ни одной политики расположения, будет извлекаться политика расположения для настроенного пользователя. Если политика подсети получена успешно, выходные данные будут содержать значение Локатионполицитагид, которое начинается с подсети тагид. Если политика расположения для подсети не найдена, Локатионполицитагид будет начинаться с User-тагид.

</div>

<div>

## <a name="running-the-test"></a>Выполнение теста

Командлет Test-Кслокатионполици можно выполнить с помощью предварительно настроенной тестовой учетной записи (см. раздел Настройка тестовых учетных записей для выполнения тестов Lync Server) или учетной записи пользователя, который включен для Lync Server. Для выполнения этой проверки с помощью тестовой учетной записи нужно просто указать полное доменное имя для тестируемого пула Lync Server. Например:

    Test-CsLocationPolicy -TargetFqdn "atl-cs-001.litwareinc.com"

Чтобы выполнить эту проверку с использованием реальной учетной записи пользователя, необходимо сначала создать объект учетных данных Windows PowerShell, содержащий имя учетной записи и пароль. Затем необходимо добавить этот объект учетных данных и адрес SIP, назначенный учетной записи, при вызове Test-Кслокатионполици:

    $credential = Get-Credential "litwareinc\kenmyer"
    Test-CsLocationPolicy -TargetFqdn "atl-cs-001.litwareinc.com"-UserSipAddress "sip:kenmyer@litwareinc.com" -UserCredential $credential

Дополнительные сведения можно найти в справочной документации по командлету [Test-кслокатионполици](https://docs.microsoft.com/powershell/module/skype/Test-CsLocationPolicy) .

</div>

<div>

## <a name="determining-success-or-failure"></a>Определение успеха или сбоя

Если указанный пользователь имеет действующую политику расположения, вы получите вывод, как показано ниже, и свойство Result, помеченное как **успешно.**

Енханцедемерженцисервицесенаблед: true

Локатионполицитагид: User-тагид

Таржетфкдн: atl-cs-001.litwareinc.com

Результат: успех

Задержка: 00:00:06.8630376

Ошибки

Диагностик

Если для указанного пользователя не удается найти действующую политику расположения, результат будет отображаться как сбой, а дополнительные сведения будут записаны в свойствах Error и диагноз.

Таржетфкдн: atl-cs-001.litwareinc.com

Результат: сбой

Задержка: 00:00:00

Ошибка: 404, не найдена

Диагностика: ErrorCode = 4005, Source = ATL-CS-001.litwareinc.com,

Reason = универсальный код ресурса (URI) назначения не включен для SIP либо не

Существует.

Microsoft. RTC. SignalR. Диагностичеадер

В предыдущем выводе говорится, что тест завершился сбоем, так как указан недопустимый пользователь: учетная запись не существует или пользователь не включен для Lync Server. Вы можете проверить правильность учетной записи и определить, включена ли эта учетная запись для NM-OCS-14-3, выполнив следующую команду:

    Get-CsUser "sip:kenmyer@litwareinc.com" | Select-Object SipAddress, Enabled

Если при выполнении теста-Кслокатионполици происходит сбой, может потребоваться повторный запуск теста, в том числе параметр подробно:

    Test-CsLocationPolicy -TargetFqdn "atl-cs-001.litwareinc.com" -Verbose

При включенном параметре "подробный" тест-Кслокатионполици будет возвращать пошаговые учетные записи для каждого действия, которое он пытался проверить в политике расположения. Например, этот вывод указывает на то, что серверу Lync Server не удалось войти в тестовый пользователь, возможно, из-за того, что был введен недопустимый пароль.

Отправка запроса на регистрацию:

Целевое полное доменное имя = atl-cs-011.litwareinc.com

SIP адрес пользователя = sip:kenmyer@litwareinc.com

Порт регистратора = 5061

Выбран тип проверки подлинности "Ива".

Регистрация в соответствии с SIP/ATL-CS-001. плана litwareinc. com

Действие "регистрация" завершено в течение "0,0601795" сек.

Исключение "вход был отклонен". Убедитесь в том, что используются правильные учетные данные, а учетная запись активна. произошла ошибка рабочего процесса.

</div>

<div>

## <a name="reasons-why-the-test-might-have-failed"></a>Причины, по которым может произойти сбой теста

Ниже приведены некоторые распространенные причины, по которым может произойти сбой Test-Кслокатионполици:

  - Указана недействительная учетная запись пользователя. Для проверки существования учетной записи пользователя можно выполнить следующую команду:
    
        Get-CsUser "sip:kenmyer@litwareinc.com"

  - Учетная запись пользователя верна, но в настоящее время учетная запись не включена для Lync Server. Чтобы убедиться в том, что учетная запись пользователя включена для Lync Server, выполните команду, подобную следующей:
    
        Get-CsUser "sip:kenmyer@litwareinc.com" | Select-Object Enabled
    
    Если для свойства Enabled задано значение false, это означает, что пользователь в настоящее время не поддерживает Lync Server.

</div>

</div>

<span> </span>

</div>

</div>

</div>

