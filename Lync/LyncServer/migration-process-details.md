---
title: Процесс миграции — сведения
ms.reviewer: ''
ms.author: kenwith
author: kenwith
f1.keywords:
- NOCSH
TOCTitle: Migration process - details
ms:assetid: ca7e352c-9bde-47d9-8273-5cf2fdfdfe7e
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ205264(v=OCS.15)
ms:contentKeyID: 48185412
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: a8a5e0ec0ab94dcba48917338f130b5de1a98f91
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42030683"
---
<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/">

<div data-asp="http://msdn2.microsoft.com/asp">

# <a name="migration-process---details"></a>Процесс миграции — сведения

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2012-10-19_

Используйте следующие предварительные требования и подробное описание действий по переносу Lync Server 2010, Group Chat или Office Communications Server 2007 R2 Group Chat в Lync Server 2013, сервер сохраняемого чата.

<div>

## <a name="prerequisites-for-migration"></a>Необходимые компоненты для миграции

Перед переносом Lync Server 2010, группового чата или Office Communications Server 2007 R2 в Lync Server 2013 и сервер сохраняемого чата убедитесь, что выполнены следующие условия.

1.  Разверните по крайней мере один пул Lync Server 2013. Если у вас несколько пулов Lync Server 2013, решите, какой пул Lync Server 2013 будет домашним пулом для нового пула серверов сохраняемого чата Lync Server 2013.

2.  Установите сервер пула сервера сохраняемого чата Lync Server 2013. Он будет пустым (без категорий, комнат или надстроек). Прежде чем переносить старые категории, комнаты или надстройки, вы можете создавать комнаты, категории или надстройки в среде Lync Server 2013, сохраняемом сервере сохраняемого чата.
    
    <div>
    

    > [!IMPORTANT]  
    > Помните, что эти новые элементы могут конфликтовать со старыми переносимыми элементами. Избегайте конфликтов с именами, в противном случае элементы будут перезаписаны при миграции старых данных.

    
    </div>

</div>

<div>

## <a name="preparing-the-source-data-for-migration"></a>Подготовка исходных данных к миграции

Выполните следующие действия, чтобы должным образом подготовить исходные данные для миграции.

1.  Создайте резервную копию исходных баз данных для Lync Server 2010, группового чата или Office Communications Server 2007 R2 Group Chat. Подробные сведения о резервном копировании SQL Server можно найти в <http://go.microsoft.com/fwlink/p/?linkid=254851>разделе "Обзор резервного копирования (SQL Server)".
    
    <div>
    

    > [!IMPORTANT]  
    > Доменные службы Active Directory должны быть одинаковыми. В качестве условия миграции невозможно выполнить миграцию в пул в другом развертывании (в частности, в другом лесу Active Directory).

    
    </div>

2.  Изучите комнаты чата и Настройка категорий в Lync Server 2010, Group Chat или Office Communications Server 2007 R2 Group Chat. Все изменения в категориях, комнатах или надстройках в существующем развертывании прежних версий будут выполняться средством администрирования группового чата.
    
    <div>
    

    > [!TIP]  
    > Любые изменения, внесенные в категории, комнаты или надстройки в Lync Server 2013, развертывание сервера сохраняемого чата выполняются с помощью панели управления Lync Server или командлетов Windows PowerShell.

    
    </div>
    
    Выполните следующие действия, чтобы подготовить старую систему к миграции.
    
    1.  Сервер сохраняемого чата поддерживает один уровень категорий в отличие от детального иерархического набора категорий. После миграции к подкатегориям добавляются префиксы с полными именами родительских категорий. Возможно, вы захотите упростить существующую структуру категорий, чтобы полученная структура удовлетворяла вашим требованиям.
    
    2.  Проверьте **руководителей** в корневой категории.Если на этом уровне есть руководители, после миграции эти пользователи будут добавлены как **Руководители для всех комнат**. Если это не является обязательным для вашей организации, удалите этих руководителей из корневой категории.
    
    3.  Проверьте длину имен комнат. Если после миграции из-за упрощенной структуры категорий комнаты включены в дочернюю категорию, к ним добавляется префикс с полными именами родительской категории. Длина имен не может превышать 256 символов, включая имена родительских категорий. Необходимо проверить длину имен комнат и по возможности сократить их, если они слишком длинные.
    
    4.  В Lync Server 2013, если для параметров **приглашения** категории задано значение true, вы можете выбрать true или false для приглашений на комнаты в этой категории. Однако, если для настроек приглашений категории задано значение «False», приглашения для комнат в этой категории отключены. Перед переносом необходимо сбросить параметры приглашений в устаревшей версии сервера группы Lync Server Group Chat, если вы хотите, чтобы комнаты существовали в определенной категории. В противном случае в ходе миграции Lync Server 2013 отображает предупреждения и задает для комнат значение по умолчанию false.
    
    5.  Если вы использовали файлы в комнатах чата, то после миграции необходимо вручную выполнить XCOPY для файлов в новом хранилище файлов сохраняемого чата. Инструменты этого не делают.
    
    6.  Если у вас есть Федеративные пользователи и комнаты с федеративными пользователями, имейте в виду, что сервер сохраняемого чата не поддерживает федерацию. Комнаты с федеративными пользователями будут перенесены, но сами пользователи не смогут получить доступ к содержимому, так как федеративный доступ не поддерживается.
    
    7.  Определите комнаты, которые не требуется переносить, и отметьте их как отключенные.
    
    8.  Определите дату, после которой необходимо перенести содержимое комнаты чата. Например, вы можете не переносить сообщения старше 1 января 2010 г., так как они могут быть неактуальными или устаревшими.

</div>

<div>

## <a name="performing-the-migration"></a>Выполнение миграции

Выполните указанные ниже действия, чтобы перенести сервер группового чата прежних версий.

1.  Завершите работу Lync Server 2010, Group Chat, Office Communications Server 2007 R2 Group Chat или Lync Server 2013, службы сервера сохраняемого чата. Необходимо остановить все службы, поэтому запланируйте для этого время с достаточным периодом простоя. Как описывалось ранее, обязательно создайте резервную копию текущей базы данных для группового чата.

2.  Выполните командлет **Export-CsPersistentChatData** для Windows PowerShell в качестве члена роли администратора сохраняемого чата (CsPersistentChatAdministrator). Дополнительные сведения о командлетах экспорта и импорта приведены [в разделе Устранение неполадок конфигурации сервера сохраняемого чата с помощью командлетов Windows PowerShell в Lync Server 2013](lync-server-2013-troubleshooting-persistent-chat-server-configuration-using-windows-powershell-cmdlets.md).
    
    Изучите экспортированное содержимое.

3.  Прежде чем приступать к импорту, завершите работу сервера Lync Server 2013, службы сохраняемого чата. Необходимо остановить все службы, поэтому запланируйте для этого время с достаточным периодом простоя.

4.  Выполните резервное копирование базы данных сохраняемого чата, если вы создали категории, комнаты или надстройки в развертывании Lync Server 2013 до миграции. Процесс экспорта/импорта будет иметь возможность объединить устаревшие данные с развертыванием Lync Server 2013, но необходимо выполнить резервное копирование базы данных, если контент случайно перезаписывается (например, если существуют конфликты имен).

5.  Запустите командлет Windows PowerShell **Import-CsPersistentChatData** (средство импорта) с помощью команды **WhatIf** для заполнения фонового сервера пула сервера сохраняемого чата перенесенными данными. В процессе выполняются некоторые преобразования для применения упрощенной модели администрирования. При наличии ошибок или предупреждений устраните их.

6.  Запустите командлет **Import-CsPersistentChatData** Windows PowerShell для сервера сохраняемого чата в качестве члена роли администратора сохраняемого чата (CsPersistentChatAdministrator). Дополнительные сведения о командлетах экспорта и импорта приведены [в разделе Устранение неполадок конфигурации сервера сохраняемого чата с помощью командлетов Windows PowerShell в Lync Server 2013](lync-server-2013-troubleshooting-persistent-chat-server-configuration-using-windows-powershell-cmdlets.md).

7.  Необходимо выполнить XCOPY для всех загруженных файлов (всю папку) в новое хранилище файлов сохраняемого чата Lync Server 2013.
    
    <div>
    

    > [!IMPORTANT]  
    > Lync 2013 (клиент) не поддерживает отправку и просмотр файлов в комнатах чата. Вы все так же можете использовать старый клиент для публикации и просмотра файлов в комнате.

    
    </div>

8.  Попросите URI сервера Lync Server 2010, группового чата или Office Communications Server 2007 R2 на серверный объект Contact в Lync Server 2013, сохраняемый чат Server. Следующие действия необходимы, если пользователям Lync 2010 Group Chat или Office Communicator 2007 R2 требуется подключиться к последнему Lync 2013, сохраняемый чат (клиент) после миграции без каких-либо изменений конфигурации на стороне клиента:
    
      - Удалите учетную\<запись\>пользователя сервера поиска OCSChat@ имя_домена. com. Он использовался для ссылки на службу подстановки в Lync Server 2010, Group Chat. Удалить пул и доверенные записи можно позже.
    
      - Создайте конечную точку устаревшего (контактный объект сервера сохраняемого чата), выполнив командлет Windows PowerShell **New-CsPersistentChatEndpoint**с идентичным URI SIP, чтобы устаревший клиент работал эффективно при перезапуске службы.
    
    Обязательный процесс миграции в этот момент завершается. Lync 2010 Group Chat (клиенты) или Office Communicator 2007 R2 Group Chat (клиенты) могут подключаться к новому пулу серверов сохраняемого чата, а затем прозрачно.
    
    Выполните следующие дополнительные действия по списанию для Lync Server 2010, группового чата или Office Communications Server 2007 R2 Group Chat.

9.  Запустите службы сервера сохраняемого чата, включив все компьютеры в новом пуле серверов сохраняемого чата.

10. Используйте панель управления Lync Server и командлеты Windows PowerShell, чтобы убедиться, что данные успешно перенесены.

11. Удалите Lync 2010 Group Chat или Office Communicator 2007 R2 Group Chat с компьютеров в пуле серверов группового чата.

12. Удалите доверенное приложение и пул доверенных приложений с помощью командлетов Windows PowerShell. Это приведет к удалению этих элементов из центрального хранилища управления и связанных записей доверенной службы (Тсес) из Active Directory. Кроме того, этот шаг работает с помощью построителя топологий (Кроме того, у доверенных приложений и пулов есть выделенный узел).

13. Теперь вы можете включить функции сервера сохраняемого чата с помощью новых клиентов. Дополнительные сведения о том, как включать сервер сохраняемого чата, приведены [в статье Развертывание сервера сохраняемого чата в Lync server 2013](lync-server-2013-deploying-persistent-chat-server.md).
    
    <div>
    

    > [!IMPORTANT]  
    > Lync Server 2013 поддерживает несколько пулов серверов сохраняемого чата. Однако мы поддерживаем перенос группового чата в Lync 2010 или Office Communications Server 2007 R2&nbsp;в один пул серверов lync Server 2013, сохраняемого чата. В развертывание можно добавить новые пулы серверов сохраняемого чата в соответствии с нормативными требованиями (например, хранение данных в определенном географическом регионе).

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

