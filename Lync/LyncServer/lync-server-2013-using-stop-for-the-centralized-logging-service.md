---
title: Использование остановки службы централизованного ведения журналов
TOCTitle: Использование остановки службы централизованного ведения журналов
ms:assetid: 09ac093e-8f30-4874-84b4-12548ac8c898
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ687964(v=OCS.15)
ms:contentKeyID: 49887860
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Использование остановки службы централизованного ведения журналов

 

_**Дата изменения раздела:** 2012-11-01_

Остановить текущий работающий сеанс ведения журнала можно с помощью командлета Stop-CsClsLogging. Обычно ситуации, когда нужно остановить сеанс ведения журнала, возникают достаточно редко. Например, поиск в журналах и изменение конфигураций можно выполнять без обязательной предварительной остановки ведения журнала. Если выполняются два сценария, например AlwaysOn и UserReplicator, и нужно собирать сведения, связанные с проверкой подлинности (сценарий Authentication), понадобится остановить один из других сценариев (на глобальном уровне, уровне сайта, пула или компьютера), прежде чем можно будет запустить сценарий Authentication. Подробные сведения см. в статье [Stop-CsClsLogging](https://docs.microsoft.com/en-us/powershell/module/skype/Stop-CsClsLogging).

> [!NOTE]  
> При определении сценариев, которые можно выполнять для данного развертывания, пула или компьютера, нужно помнить, что можно выполнять не более двух сценариев <strong>на компьютер</strong>. При ведении журнала действий для пула следует считать пул единым объектом. В большинстве случаев бессмысленно выполнять разные сценарии на каждом компьютере пула. Стоит взглянуть на проблему, для которой собираются данные, и поискать сценарий, который даст максимальный эффект для данного компьютера в общей среде. Например, в случае сценария UserReplicator его запуск на сервер или пул дал бы минимальный эффект.<br />Разобравшись в проблеме и оценив масштаб влияния, следует аккуратно выбрать, какие сценарии будут выполняться и на каких компьютерах и пулах. Хотя сценарий AlwaysOn имеет смысл для широкой области применения, так как он собирает данные для широкого множества поставщиков, определенные сценарии целесообразно применять только на конкретных компьютерах и пулах. Кроме того, следует соблюдать осторожность и не запускать сеанс ведения журнала случайным образом, не разобравшись сначала в эффективности данного сценария в конкретном случае. Использование неправильного сценария или сценария, не соответствующего задаче, либо запуск сценария в неправильной области применения (будь это глобальный уровень, уровень площадки, пула или компьютера), может привести к получению сомнительных и не слишком полезных данных — как если бы никакой сценарий вообще не запускался.

Чтобы управлять функциями централизованная служба ведения журнала с помощью Командная консоль Lync Server, необходимо быть участником групп безопасности управления доступом на основе ролей (RBAC) CsAdministrator или CsServerAdministrator либо специализированной роли RBAC, содержащей любую из указанных двух групп. Чтобы получить список всех ролей управления доступом на основе ролей (RBAC), которые были назначены для этого командлета (включая все созданные вами роли RBAC), запустите следующую команду из командной строки Командная консоль Lync Server или Windows PowerShell:

    Get-CsAdminRole | Where-Object {$_.Cmdlets -match "Lync Server 2013 cmdlet"}

Пример:

    Get-CsAdminRole | Where-Object {$_.Cmdlets -match "Set-CsClsConfiguration"}

## Остановка текущего выполняемого сеанса централизованная служба ведения журнала

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Запросите централизованная служба ведения журнала, чтобы определить, какие сценарии выполняются в данный момент времени, введя следующую команду:
    
        Show-CsClsLogging
    
    ![Консоль Windows PowerShell после вызова Show-CsCl](images/JJ687964.eb190c32-529c-4277-a731-52c47d22d8fa(OCS.15).jpg "Консоль Windows PowerShell после вызова Show-CsCl")
    
    Результатом выполнения Show-CsClsLogging являются сводные данные обо всех выполняемых сценариях и областях их выполнения. Подробные сведения см. в статье [Show-CsClsLogging](https://docs.microsoft.com/en-us/powershell/module/skype/Show-CsClsLogging).

3.  Чтобы остановить выполняемый в данный момент сеанс ведения журнала, введите:
    
        Stop-CsClsLogging -Scenario <scenario name> -Computers <comma separated list of fully qualified computer names> -Pools <comma separated list of fully qualified pool names>
    
    Пример:
    
        Stop-CsClsLogging -Scenario UserReplicator -Pools pool01.contoso.net
    
    Эта команда остановит ведение журнала с помощью сценария UserReplicatior для pool01.contoso.net.
    
    > [!NOTE]  
    > Журналы, созданные в течение останавливаемого сеанса ведения журнала с помощью сценария UserReplicator, не удаляются. Журналы остаются доступными для выполнения поиска с помощью команды Search-CsClsLogging. Подробные сведения см. в статье <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Search-CsClsLogging">Search-CsClsLogging</a>.

Действуя в качестве команды-спутника для Start-CsClsLogging, командлет Stop-CsClsLogging завершает сеанс ведения журнала и сохраняет журналы, созданные в течение этого сеанса. Одновременно на данном компьютере может выполняться не более двух сценариев. Способ остановки одного сценария для сбора данных с помощью другого сценария является типовой задачей, часто выполняемой при устранении неполадок рабочих нагрузок.

## См. также

#### Задачи

[Использование запуска службы централизованного ведения журнала для записи журналов](lync-server-2013-using-start-for-the-centralized-logging-service-to-capture-logs.md)  

#### Концепции

[Обзор службы централизованного ведения журналов](lync-server-2013-overview-of-the-centralized-logging-service.md)  

#### Другие ресурсы

[Show-CsClsLogging](https://docs.microsoft.com/en-us/powershell/module/skype/Show-CsClsLogging)  
[Start-CsClsLogging](https://docs.microsoft.com/en-us/powershell/module/skype/Start-CsClsLogging)  
[Stop-CsClsLogging](https://docs.microsoft.com/en-us/powershell/module/skype/Stop-CsClsLogging)

