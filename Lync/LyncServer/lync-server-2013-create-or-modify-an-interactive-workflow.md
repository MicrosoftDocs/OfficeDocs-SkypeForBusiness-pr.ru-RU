---
title: 'Lync Server 2013: создание или изменение интерактивного рабочего процесса'
description: 'Lync Server 2013: создание или изменение интерактивного рабочего процесса.'
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Create or modify an interactive workflow
ms:assetid: bc7bb1bc-bf6a-4636-ae93-c56fa22613fa
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ205213(v=OCS.15)
ms:contentKeyID: 48185260
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: 470a073322c48c351dbfdfb24ce376731b3e7512
ms.sourcegitcommit: d42a21b194f4a45e828188e04b25c1ce28a5d1ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2020
ms.locfileid: "48546995"
---
# <a name="create-or-modify-an-interactive-workflow-in-lync-server-2013"></a>Создание или изменение интерактивного рабочего процесса в Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2013-09-11_

Для создания или изменения интерактивного рабочего процесса используйте одну из следующих процедур.

<div>


> [!NOTE]  
> Для создания и изменения интерактивных рабочих процессов можно использовать командную консоль Lync Server или средство настройки группы ответа. Для доступа к средству настройки группы ответа из панели управления Lync Server или открытия веб-страницы непосредственно из веб-браузера введите следующий URL-адрес: <STRONG>https://</STRONG> &lt; вебпулфкдн &gt; <STRONG>/ргсконфиг</STRONG>.



</div>

<div>

## <a name="to-use-response-group-configuration-tool-to-create-or-modify-an-interactive-workflow"></a>Использование средства настройки группы ответа для создания или изменения интерактивного рабочего процесса

1.  Выполните вход в качестве члена группы RTCUniversalServerAdmins или в качестве участника одной из предварительно заданных административных ролей, поддерживающих группу ответа.

2.  Откройте окно браузера и введите URL-адрес администрирования, чтобы открыть панель управления Lync Server. Для получения дополнительных сведений о различных методах, которые можно использовать для запуска панели управления Lync Server, ознакомьтесь со статьей [Open Lync server 2013 администрирование](lync-server-2013-open-lync-server-administrative-tools.md).

3.  В левой панели навигации щелкните **Response Groups** (Группы ответа), а затем **Workflow** (Рабочий процесс).

4.  На странице **Workflow** (Рабочий процесс) щелкните **Create or edit a workflow** (Создание или изменение рабочего процесса).

5.  В поле **выбора службы** введите полностью или частично имя службы **ApplicationServer**, размещающей рабочий процесс, который требуется создать или изменить. В полученном списке служб щелкните нужную службу и нажмите кнопку **ОК**.
    
    <div>
    

    > [!NOTE]  
    > Откроется средство настройки группы ответа. Средство настройки группы ответа также можно открыть непосредственно из веб-браузера, введя следующий URL-адрес: <STRONG>https://</STRONG> &lt; вебпулфкдн &gt; <STRONG>/ргсконфиг</STRONG>.

    
    </div>

6.  Выполните одно из следующих действий.
    
      - На странице **Create a New Workflow** (Создание нового рабочего процесса) напротив **Interactive** (Интерактивный) нажмите кнопку **Create** (Создать).
    
      - В разделе **Manage an Existing Workflow** (Управление существующим рабочим процессом) найдите рабочий процесс, который требуется изменить, а затем в меню **Action** (Действие) выберите команду **Edit** (Изменить).

7.  Если вы не готовы обрабатывать пользовательские вызовы рабочего процесса, снимите флажок **Activate the workflow** (Активировать рабочий процесс).
    
    <div>
    

    > [!NOTE]  
    > При создании управляемого рабочего процесса необходимо установить флажок <STRONG>Activate the workflow</STRONG> (Активировать рабочий процесс). После сохранения активного, управляемого рабочего процесса его можно изменять и отключать.

    
    </div>

8.  Чтобы разрешить федеративным пользователям звонки группе, установите флажок **Enable for federation** (Включить федерацию). Кроме того, необходимо иметь политику внешнего доступа, которая применяется к приложению группы ответа, настроенному для Федерации.
    
    <div>
    

    > [!NOTE]  
    > Глобальная политика внешнего доступа применяется к приложению группы ответа. Глобальную политику для Федерации группы ответа можно настроить с помощью панели управления Lync Server или с помощью командлета <STRONG>Set – CsExternalAccessPolicy</STRONG> , чтобы установить для параметра Енаблеаутсидеакцесс значение true. Обратите внимание, что параметры глобальной политики применяются ко всем пользователям, если им не назначена политика на уровне сайта или пользователя. Поэтому перед изменением этого параметра для групп ответа убедитесь, что параметры федерации соответствуют требованиям организации. Сведения о том, как политики применяются к пользователям, приведены <A href="lync-server-2013-manage-external-access-policy-for-your-organization.md">в статье Manage External Access Policy in Lync Server 2013</A>. Сведения о параметрах Федерации приведены в статье <STRONG>Set – CsExternalAccessPolicy</STRONG> in the Lync Server Management Shell.

    
    </div>
    
    <div>
    

    > [!NOTE]  
    > Пользователи, размещенные в Lync Online, не могут помещать вызовы в группы ответа, размещенные в локальном развертывании. Это справедливо и в гибридных развертываниях, и в случаях, когда локальное развертывание участвует в развертывании Lync Online.

    
    </div>

9.  Чтобы скрывать удостоверения агентов в ходе звонка, установите флажок **Enable agent anonymity** (Включить анонимность агента).
    
    <div>
    

    > [!NOTE]  
    > Для выполнения анонимных звонков нельзя использовать мгновенные сообщения или видеоконференции, однако агент или звонящий может добавить функцию обмена мгновенными сообщениями и видео после установления звонка. Анонимный агент также может помещать звонки на удержание, переводить звонки (с консультацией и без нее), а также парковать и извлекать звонки. Анонимные звонки не поддерживают конференции, общий доступ к приложениям, совместный доступ к рабочему столу, передачу файлов, доступ к доске и совместную работу с данными, а также запись звонков. Агенты, использующие подключаемый модуль VDI для Lync, могут принимать входящие вызовы анонимно, но они не могут выполнять анонимные вызовы.

    
    </div>

10. В поле **Enter the address of the group that will receive the calls** (Введите адрес группы, которая будет принимать звонки) введите основной URI SIP группы, которая принимать звонки для рабочего процесса.

11. В поле **Display name** (Отображаемое имя) введите отображаемое имя для рабочего процесса (например, группа ответа интерактивного автоответчика отдела продаж).
    
    <div>
    

    > [!NOTE]  
    > Не включайте &lt; &gt; в отображаемое имя символы "" или "". Не используйте имена "RGS Presence Watcher" или "Announcement Service", поскольку они зарезервированы.

    
    </div>

12. В поле **Telephone number** (Номер телефона) введите URI для группы ответа (например, +14255550165).

13. В поле **Display number** (Отображаемый номер) введите отображаемый номер для группы ответа (например, +1 (425) 555-0165).

14. Необязательно В поле **Описание**введите описание рабочего процесса, которое будет отображаться в карточке контакта в клиенте Lync.

15. В поле **Workflow Type** (Тип рабочего процесса) выберите **Managed** (Управляемый), если этот рабочий процесс будет управляться менеджером группы ответа. Чтобы назначить диспетчеров группы ответа для рабочего процесса, выполните следующие действия:
    
    1.  Введите URI SIP менеджера для этого рабочего процесса и нажмите кнопку **Добавить**.
    
    2.  Введите URI SIP дополнительных менеджеров для добавления к этому рабочему процессу и нажмите кнопку **Добавить**.
    
    <div>
    

    > [!IMPORTANT]  
    > Каждому пользователю, назначенному менеджером группы ответа, должна быть назначена роль CsResponseGroupManager. Если пользователям не назначить эту роль, то они не смогут управлять группами ответа.

    
    </div>

16. В разделе **Step 2 Select a Language** (Шаг 2. Выбор языка) выберите язык, используемый для распознавания речи и преобразования текста в речь.

17. Если требуется настроить приветственное сообщение, то в разделе **Step 3 Configure a Welcome Message** (Шаг  3. Настройка приветственного сообщения) установите флажок **Play a welcome message** (Воспроизводить приветственное сообщение) и затем выполните одно из следующих действий:
    
      - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите флажок **Use text-to-speech** (Использовать преобразование текста в речь), а затем введите в поле текст приветственного сообщения.
        
        <div>
        

        > [!NOTE]  
        > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

        
        </div>
    
      - Чтобы использовать звуковой WAV- или WMA-файл, установите флажок **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне браузера нажмите кнопку **Browse** (Обзор), выберите нужный звуковой файл и нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).
        
        <div>
        

        > [!NOTE]  
        > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов приведены <A href="lync-server-2013-technical-requirements-for-response-group.md">в статье технические требования для группы ответа в Lync Server 2013</A>.

        
        </div>

18. В разделе **Step 4 Specify Your Business Hours** (Шаг 4. Указание режима работы) выберите часовой пояс в списке **Your time zone** (Часовой пояс).
    
    <div>
    

    > [!NOTE]  
    > С помощью этого параметра задается часовой пояс, в котором расположены звонящие и агенты рабочего процесса. Он используется для определения времени открытия и закрытия. Например, если рабочий процесс настроен для использования североамериканского восточного часового пояса и задано время открытия и закрытия 7:00 A.M. и 11:00 P.M. соответственно, то по восточноевропейскому времени временем открытия и закрытия будет 7:00 и 11:00:00 соответственно. (Для ввода времени необходимо использовать 24-часовой формат.)

    
    </div>

19. Выберите тип расписания, выполнив одно из следующих действий:
    
      - Чтобы использовать предварительно заданное расписание, установите переключатель **Use a preset schedule** (Использовать предварительно заданное расписание) и затем выберите требуемое расписание в раскрывающемся списке.
        
        <div>
        

        > [!NOTE]  
        > Для выбора этого параметра необходимо создать как минимум одно предварительно заданное расписание. Для настройки предварительно заданных расписаний используется командлет <STRONG>New-CSRgsHoursOfBusiness</STRONG>. Дополнительные сведения см. <A href="lync-server-2013-optional-define-response-group-business-hours.md">в разделе (необязательно) определение рабочих часов для группы ответа в Lync Server 2013</A>. При выборе предварительно заданного расписания поля <STRONG>Day</STRONG> (День недели), <STRONG>Open</STRONG> (Время открытия) и <STRONG>Close</STRONG> (Время закрытия) будут заполнены автоматически.

        
        </div>
    
      - Чтобы использовать настраиваемое расписание, которое применяется только к этому рабочему процессу, установите переключатель **Use a custom schedule** (Использовать настраиваемое расписание).

20. Если вы создаете настраиваемое расписание для этого рабочего процесса, установите флажки для дней недели, по которым группа ответа будет доступна.

21. Если вы создаете настраиваемое расписание, задайте часы работы группы ответа с помощью полей **Open** (Время открытия) и **Close** (Время закрытия).
    
    <div>
    

    > [!NOTE]  
    > При вводе значений в поля <STRONG>Open</STRONG> (Время открытия) и <STRONG>Close</STRONG> (Время закрытия) используйте 24-часовой формат. Например, если организация работает с 09:00 до 17:00 с перерывом на обед, то в поле <STRONG>Open</STRONG> (Время открытия) укажите 09:00, в поле <STRONG>Close</STRONG> (Время закрытия) укажите 12:00, в поле <STRONG>Open</STRONG> (Время открытия) укажите 13:00 и в поле <STRONG>Close</STRONG> (Время закрытия) укажите 17:00.

    
    </div>

22. Если требуется воспроизводить сообщение в нерабочие дни, установите флажок **Play a message when the response group is outside of business hours** (Воспроизводить сообщение, если группа ответа не работает в это время) и затем укажите сообщение, выполнив одно из следующих действий:
    
      - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.
        
        <div>
        

        > [!NOTE]  
        > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

        
        </div>
    
      - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).
        
        <div>
        

        > [!NOTE]  
        > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов приведены <A href="lync-server-2013-technical-requirements-for-response-group.md">в статье технические требования для группы ответа в Lync Server 2013</A>.

        
        </div>

23. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):
    
      - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).
    
      - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты \<username\> @ \<domainname\> (например, Bob@contoso.com).
    
      - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. В качестве адреса пользователя используется формат \<username\> @ \<domainname\> .
    
      - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона \<number\> @ \<domainname\> (например, + 14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

24. В разделе **Step 5 Specify Your Holidays** (Шаг 5. Указание выходных дней) установите флажки для одного набора выходных дней или нескольких наборов.
    
    <div>
    

    > [!NOTE]  
    > Перед настройкой рабочего процесса необходимо задать выходные дни и наборы выходных дней. Чтобы задать выходные дни и наборы выходных дней, используйте командлеты <STRONG>New-CsRgsHoliday</STRONG> и <STRONG>New-CsRgsHolidaySet</STRONG>. Дополнительные сведения см. <A href="lync-server-2013-optional-define-response-group-holiday-sets.md">в разделе (необязательно) Определение наборов праздников группы ответа в Lync Server 2013</A>.

    
    </div>

25. Если требуется воспроизводить приветственное сообщение по выходным дням, установите флажок **Play a message during holidays** (Воспроизводить сообщение в выходные дни) и затем укажите сообщение, выполнив одно из следующих действий:
    
      - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.
        
        <div>
        

        > [!NOTE]  
        > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

        
        </div>
    
      - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).
        
        <div>
        

        > [!NOTE]  
        > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах аудио файлов приведены <A href="lync-server-2013-technical-requirements-for-response-group.md">в статье технические требования для группы ответа в Lync Server 2013</A>.

        
        </div>

26. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):
    
      - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).
    
      - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты \<username\> @ \<domainname\> (например, Bob@contoso.com).
    
      - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. В качестве адреса пользователя используется формат \<username\> @ \<domainname\> .
    
      - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона \<number\> @ \<domainname\> (например, + 14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

27. В разделе **Step 6 Configure Music on Hold** (Шаг 6. Настройка музыки при удержании звонка) выберите музыку, воспроизводимую для вызывающих при ожидании агента, выполнив одно из следующих действий:
    
      - Чтобы использовать музыку по умолчанию, установите переключатель **Use default** (Использовать по умолчанию).
    
      - Чтобы использовать звуковой файл, установите переключатель **Select a music file** (Выбор файла музыки). Чтобы загрузить новый звуковой файл, щелкните ссылку **a music file** (файл музыки). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).
        
        <div>
        

        > [!NOTE]  
        > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов приведены <A href="lync-server-2013-technical-requirements-for-response-group.md">в статье технические требования для группы ответа в Lync Server 2013</A>.

        
        </div>

28. В разделе **Step 7 Configure Interactive Voice Response** (Шаг 7. Настройка интерактивного автоответчика) под заголовком **The user will hear the following text or recorded message** (Пользователь услышит следующий текст или записанное сообщение) укажите вопрос, который будет задан звонящему:
    
      - Чтобы ввести вопрос в текстовом формате, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите вопрос в текстовом поле.
        
        <div>
        

        > [!NOTE]  
        > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

        
        </div>
        
        <div>
        

        > [!NOTE]  
        > Символ "#" интерпретируется модулем преобразования текста в речь как слово "номер". Если требуется указать клавишу #, то вместо символа используйте имя клавиши. Пример: Для связи с сотрудником отдела продаж нажмите кнопку с решеткой.

        
        </div>
    
      - Чтобы использовать предварительно записанный звуковой файл, содержащий вопрос, щелкните **Select a recording** (Выбор записи) и затем щелкните ссылку **a recording** (запись), чтобы загрузить файл. В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Щелкните **Upload** (Загрузить), чтобы загрузить файл, и затем введите вопрос в текстовом поле (это позволяет перенаправлять отвечающему агенту вопрос и ответ звонящего).
        
        <div>
        

        > [!NOTE]  
        > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов приведены <A href="lync-server-2013-technical-requirements-for-response-group.md">в статье технические требования для группы ответа в Lync Server 2013</A>.

        
        </div>

29. В разделе **Response 1** (1 ответ) укажите первый возможный ответ на вопрос, выполнив следующие действия:
    
    <div>
    

    > [!IMPORTANT]  
    > При указании голосовых ответов не используйте двойные кавычки ("). Это может привести к сбою интерактивного автоответчика.

    
    </div>
    
    <div>
    

    > [!NOTE]  
    > Для ответа звонящий может использовать речь или буквенно-цифровые клавиши либо и то, и другое.

    
    </div>
    
      - Чтобы выбрать речевой ответ, введите ответ в поле **Enter a voice response** (Введите голосовой ответ).
    
      - Чтобы выбрать ответ с помощью клавиш, введите требуемую цифру в поле **Digit** (Цифра).

30. Укажите, требуется ли перенаправлять звонящего в очередь или задать ему другой вопрос, выполнив следующие действия:
    
      - Чтобы перенаправить звонящего в очередь, щелкните **Send to a queue** (Отправить в очередь) и затем в списке **Select a queue** (Выбор очереди) выберите требуемую очередь.
    
      - Чтобы задать другой вопрос, щелкните **Ask another question** (Задать другой вопрос), затем щелкните **Use text-to-speech** (Использовать преобразование текста в речь) и введите вопрос либо щелкните **Select a recording** (Выбор записи). С помощью группировки ответов в этом разделе укажите до 4 возможных ответов на дополнительные вопросы и задайте очередность ответов. Чтобы указать 3 или 4 возможные ответы, установите флажки **Response 3** (3 ответ) или **Response 4** (4 ответ).

31. Укажите до трех других возможных ответов на исходный вопрос, повторив шаги 28 и 29, чтобы указать возможные ответы и действия, которые необходимо предпринять для каждого ответа. Чтобы указать 3 или 4 возможные ответы, установите флажки **Response 3** (3 ответ) или **Response 4** (4 ответ).

32. Щелкните **Deploy** (Развернуть).

</div>

<div>

## <a name="to-use-windows-powershell-to-create-or-modify-an-interactive-workflow"></a>Использование Windows PowerShell для создания или изменения интерактивного рабочего процесса

1.  Выполните вход в качестве члена группы RTCUniversalServerAdmins или в качестве участника одной из предварительно заданных административных ролей, поддерживающих группу ответа.

2.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

3.  Извлеките имя службы для службы группы ответа и назначьте его переменной. В командной строке введите следующую команду:
    
        $serviceId="service:"+(Get-CSService | ?{$_.Applications -like "*RGS*"}).ServiceId;

4.  Интерактивному рабочему процессу требуется как минимум 2 очереди и как минимум 2 группы агентов. Сначала создайте группы агентов. Выполните следующую команду:
    
        $AGSupport = New-CsRgsAgentGroup -Parent $serviceId -Name "Technical Support" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:agent1@contoso.com", "sip:agent2@contoso.com")]
        $AGSales = New-CsRgsAgentGroup -Parent $serviceId -Name "Sales Team" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:bob@contoso.com", "sip:alice@contoso.com")]

5.  Создайте очереди. Выполните следующую команду:
    
        $QSupport = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Support" -AgentGroupIDList($AG-Support.Identity)
        $QSales = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Sales" -AgentGroupIDList($AG-Sales.Identity)

6.  Создайте приглашение для первой группы ответа с помощью следующей команды:
    
        $SupportPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please be patient while we connect you with Contoso Technical Support."

7.  Теперь создайте действие, которое должно выполняться после приглашения, с помощью следующей команды:
    
        $SupportAction = New-CsRgsCallAction -Prompt $SupportPrompt -Action TransferToQueue -QueueID $QSupport.Identity

8.  Создайте ответ для первой группы ответа с помощью следующей команды:
    
        $SupportAnswer = New-CsRgsAnswer -Action $SupportAction [-DtmfResponse 1]

9.  Теперь создайте второе приглашение, действие вызова и ответ. Сначала создайте приглашение с помощью следующей команды:
    
        $SalesPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please hold while we connect you with Contoso Sales."

10. Создайте второе действие вызова с помощью следующей команды:
    
        $SalesAction = New-CsRgsCallAction -Prompt $SalesPrompt -Action TransferToQueue -QueueID $QSales.Identity

11. Создайте ответ для второй группы ответа с помощью следующей команды:
    
        $SalesAnswer = New-CsRgsAnswer -Action $SalesAction [-DtmfResponse 2]

12. Создайте приглашение верхнего уровня с помощью следующей команды:
    
        $TopLevelPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Thank you for calling Contoso. For Technical Support, press 1. For a Sales Representative, press 2."

13. Создайте вопрос верхнего уровня с помощью следующей команды:
    
        $TopLevelQuestion = New-CsRgsQuestion -Prompt $TopLevelPrompt [-AnswerList ($SupportAnswer, $SalesAnswer)]

14. Теперь создайте рабочий процесс с помощью следующей команды:
    
        $IVRAction = New-CsRgsCallAction -Action TransferToQuestion [-Question $Question]
        $IVRWorkflow = New-CsRgsWorkflow -Parent $ServiceId -Name "Contoso Helpdesk" [-Description "The Contoso Helpdesk line."] -PrimaryUri "sip:helpdesk@contoso.com" [-LineUri tel:+14255554321] [-DisplayNumber "+1 (425) 555-4321"] [-Active $true] [-Anonymous $true] [-DefaultAction $IVRAction] [-Managed $true] [-ManagersByURI ("sip:mindy@contoso.com", "sip:bob@contoso.com")]
    
    <div>
    

    > [!NOTE]  
    > Всем пользователям, назначенным менеджерами группы ответа, должна быть назначена роль CsResponseGroupManager. Если пользователям не назначить эту роль, то они не смогут управлять группами ответа.

    
    </div>

</div>

</div>

<span> </span>

</div>

</div>

</div>

