---
title: 'Lync Server 2013: абонентские группы и правила нормализации'
TOCTitle: Абонентские группы и правила нормализации
ms:assetid: fde45195-6eb4-403c-9094-57df7fc0bd2a
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/Gg413082(v=OCS.15)
ms:contentKeyID: 49311778
ms.date: 12/10/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Абонентские группы и правила нормализации в Lync Server 2013

 

_**Дата изменения раздела:** 2016-12-08_

Абонентская группа ? это именованный набор правил нормализации, которые преобразуют номера телефонов для именованного расположения, отдельного пользователя или контактного объекта в единый стандартный формат (E.164) для целей авторизации телефонов и маршрутизации вызовов.

Правила нормализации определяют, как номера телефонов, заданные в различных форматах, перенаправляются в требуемое расположение, требуемому пользователю или контактному объекту. Одна и та же строка набора номера может интерпретироваться и преобразовываться по-разному, в зависимости от расположения, в котором она была набрана, и лица или контактного объекта, разместившего вызов.

## Область абонентской группы

*Область* абонентской группы определяет иерархический уровень, на котором может применяться эта группа. В Lync Server пользователю может быть назначена определенная абонентская группа на пользователя. Если абонентская группа пользователя не назначена, применяется группа пула регистратора. Если абонентская группа пула регистратора также отсутствует, применяется группа уровня сайта. Наконец, если для пользователя не заданы никакие другие группы, применяется глобальная абонентская группа.

Клиенты получают уровни области абонентских групп посредством параметров подготовки штатного канала, предоставляемых при входе пользователя в Lync Server. Являясь администратором, вы можете управлять уровнями области абонентских групп и назначать их с помощью панели управления Lync Server.

> [!NOTE]  
> Абонентская группа шлюза телефонной сети общего пользования (ТСОП) уровня служб применяется к входящим звонкам с конкретного шлюза.

Уровни области абонентской группы определяются следующим образом.

  - **Абонентская группа пользователей :** может быть назначена отдельным пользователям, группам или контактным объектам. Голосовые приложения могут запрашивать абонентскую группу на уровне пользователей в случае получения звонка, для которого установлено пользовательское значение по умолчанию телефонного контекста. В рамках назначения абонентской группы контактный объект считается отдельным пользователем.

  - **Абонентская группа пула :** создается на уровне службы для любого шлюза ТСОП или пула регистратора в топологии организации. Для определения абонентской группы пула необходимо указать конкретную службу (шлюз ТСОП или пул регистратора), к которой применяется абонентская группа.

  - **Абонентская группа сайтов :** может создаваться для всего сайта за исключением пользователей, групп или контактных объектов, которым назначена абонентская группа пулов или абонентская группа пользователей. Чтобы определить абонентскую группу, следует указать сайт, к которому она применяется.

  - **Глобальная абонентская группа :** абонентская группа по умолчанию, установленная вместе с продуктом. Вы можете изменить глобальную абонентскую группу, но не можете удалить ее. Эта абонентская группа применяется ко всем пользователям, группам и контактным объектам системы корпоративной голосовой связи в развертывании, если только вы не настраиваете абонентскую группу с более узкой областью.

## Планирование абонентских групп

Для планирования абонентской группы выполните следующие действия:

  - Укажите все адреса, по которым у вашей организации есть офис.
    
    Этот список должен быть полным и актуальным. По мере роста и развития организации его следует пересматривать. В большой международной компании с большим количеством небольших филиалов эта задача может потребовать довольно много времени.

  - Укажите допустимые шаблоны номеров для каждого сайта.
    
    Наиболее трудоемкой частью планирования абонентские группы является определение допустимых шаблонов номеров для каждого сайта. В некоторых случаях, возможно, получится скопировать правила нормализации, созданные для одной абонентской группы, в другие группы (особенно если соответствующие сайты находятся в пределах той же страны или региона или даже континента). В других случаях внесение небольших изменений в номера одной абонентской группы может быть достаточным для их использования в других абонентских группах.

  - Разработайте схему для именования абонентских групп в рамках всей организации.
    
    Принятие стандартной схемы именования гарантирует согласованность данных в пределах организации и упрощает решение задач обслуживания и обновления.

  - Решите, требуется ли использовать несколько абонентских групп для одного расположения.
    
    Если ваша организация использует одну абонентскую группу для нескольких расположений, все равно может потребоваться создать отдельную абонентскую группу для пользователей системы корпоративной голосовой связи, которые переносятся с УАТС и нуждаются в сохранении имеющихся добавочных номеров.

  - Решите,требуются ли абонентские группы для индивидуальных пользователей. Например, если в филиале есть пользователи, которые зарегистрированы на центральном сайте, или имеются пользователи, зарегистрированные на устройстве для обеспечения связи в филиалах, вы можете рассмотреть для них специальные сценарии набора номера с использованием абонентских групп для индивидуальных пользователей и правил нормализации. Дополнительные сведения см. в разделе [Требования к устойчивости для сайтов филиала для Lync Server 2013](lync-server-2013-branch-site-resiliency-requirements.md).

  - Определите область абонентской группы (как описано выше в данном разделе).

Чтобы создать абонентскую группу, необходимо указать значения в следующих полях (при необходимости), используя управления Lync Server или Командная консоль Lync Server.

## Имя и простое имя

Для абонентских групп пользователей следует указать описательное имя, обозначающее пользователей, группы или контактные объекты, которым эта абонентская группа будет назначена. Для абонентских групп сайтов поле "Имя" предварительно заполняется именем сайта и не может быть изменено. Для абонентских групп пулов поле "Имя" предварительно заполняется полным доменным именем шлюза ТСОП или интерфейсного пула и не может быть изменено.

Абонентская группа *Простое имя* предварительно заполняется строкой, получаемой из имени абонентской группы. Поле "Простое имя" доступно для редактирования, что позволяет вам создать для абонентских групп более описательный контекст именования. Значение *Простое имя* не может быть пустым и должно быть уникальным. Рекомендуется разработать контекст именования для всей организации и последовательно использовать его для всех сайтов и пользователей.

## Описание

Рекомендуется вводить общеупотребительные узнаваемые имена географических расположений, к которым применяются соответствующие абонентские группы. Например, если имя абонентской группы – London.Contoso.com, рекомендуемым описанием будет "Лондон".

## Регион конференц-связи с телефонным подключением

Если выполняется развертывание конференц-связи с телефонным подключением, необходимо указать регион конференц-связи с телефонным подключением, чтобы связать соответствующие номера доступа с абонентской группой.

## Префикса внешнего доступа

Можно указать префикс внешнего доступа, состоящий максимум из четырех символов (\#, \* и 0-9), если пользователям требуется набирать одну или несколько дополнительных цифр в начале номера (например, 9) для получения доступа к внешней линии.

> [!NOTE]  
> Если указан префикс внешнего доступа, не требуется создавать дополнительное правило нормализации для обработки префикса.

## Правила нормализации

Правила нормализации определяют, как номера телефонов, заданные в различных форматах, перенаправляются в заданное расположение. Одна и та же строка номера может интерпретироваться и преобразовываться по-разному, в зависимости от адреса, в котором она была набрана. Правила нормализации необходимы для маршрутизации вызовов, так как пользователи могут использовать и используют различные форматы при вводе номеров телефонов в своих списках контактов.

Нормализация указанных пользователями номеров телефонов позволяет получить согласованный формат, облегчающий выполнение следующих задач:

  - Сравнение набранного номера с URI SIP требуемого получателя.

  - Применение правил авторизации набора номера к вызывающей стороне.

Следующие поля номера могут потребоваться правилу нормализации при обработке набираемого номера:

  - абонентская группа,

  - код страны,

  - код города,

  - длина расширения,

  - префикс сайта.

## Создание правил нормализации

Правила нормализации используют регулярные выражения .NET Framework для указания шаблонов совпадения номеров, используемых сервером для преобразования строк набора номера в формат E.164 с целью выполнения обратного поиска номеров. Вы создаете правила нормализации в панели управления Lync Server, вводя выражения вручную либо вводя начальные цифры и длину строк набора номера для сравнения и позволяя панели управления Lync Server самостоятельно создавать соответствующее регулярное выражение. В любом случае после завершения вы можете ввести тестовый номер, чтобы убедиться в правильной работе правил нормализации.

Дополнительные сведения об использовании регулярных выражений .NET Framework см. в статье «Регулярные выражения в .NET Framework» по адресу [http://go.microsoft.com/fwlink/p/?linkId=140927](http://go.microsoft.com/fwlink/p/?linkid=140927).

## Примеры правил нормализации

В следующей таблице приведены примеры правил нормализации, созданные как регулярные выражения .NET Framework. Они приводятся только для справки и не являются предписывающим эталоном для создания собственных правил нормализации.

### Таблица 1. Правила нормализации на основе регулярных выражений .NET Framework

<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="header">
<th>Имя правила</th>
<th>Описание</th>
<th>Шаблон номера</th>
<th>Преобразование</th>
<th>Пример</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>4digitExtension</p></td>
<td><p>Преобразование 4-значных расширений</p></td>
<td><p>^(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>0100 преобразуется в +14255550100</p></td>
</tr>
<tr class="even">
<td><p>5digitExtension</p></td>
<td><p>Преобразование 5-значных расширений</p></td>
<td><p>^5(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>50100 преобразуется в +14255550100</p></td>
</tr>
<tr class="odd">
<td><p>7digitcallingRedmond</p></td>
<td><p>Преобразование 7-значных номеров в локальные номера Редмонда</p></td>
<td><p>^(\d{7})$</p></td>
<td><p>+1425$1</p></td>
<td><p>5550100 преобразуется в +14255550100</p></td>
</tr>
<tr class="even">
<td><p>7digitcallingDallas</p></td>
<td><p>Преобразование 7-значных номеров в локальные номера Далласа</p></td>
<td><p>^(\d{7})$</p></td>
<td><p>+1972$1</p></td>
<td><p>5550100 преобразуется в +19725550100</p></td>
</tr>
<tr class="odd">
<td><p>10digitcallingUS</p></td>
<td><p>Преобразование 10-значных номеров в номера США</p></td>
<td><p>^(\d{10})$</p></td>
<td><p>+1$1</p></td>
<td><p>2065550100 преобразуется в +12065550100</p></td>
</tr>
<tr class="even">
<td><p>LDCallingUS</p></td>
<td><p>Преобразование номеров с междугородными префиксами в номера США</p></td>
<td><p>^1(\d{10})$</p></td>
<td><p>+$1</p></td>
<td><p>12145550100 преобразуется в +2145550100</p></td>
</tr>
<tr class="odd">
<td><p>IntlCallingUS</p></td>
<td><p>Преобразование номеров с международными префиксами в номера США</p></td>
<td><p>^011(\d*)$</p></td>
<td><p>+$1</p></td>
<td><p>01191445550100 преобразуется в +91445550100</p></td>
</tr>
<tr class="even">
<td><p>RedmondOperator</p></td>
<td><p>Преобразование 0 в оператора Редмонда</p></td>
<td><p>^0$</p></td>
<td><p>+14255550100</p></td>
<td><p>0 преобразуется в +14255550100</p></td>
</tr>
<tr class="odd">
<td><p>RedmondSitePrefix</p></td>
<td><p>Преобразование номеров с сетевым префиксом (6) и кодами сайта Редмонда (222)</p></td>
<td><p>^6222(\d{4})$</p></td>
<td><p>+1425555$1</p></td>
<td><p>62220100 преобразуется в +14255550100</p></td>
</tr>
<tr class="even">
<td><p>NYSitePrefix</p></td>
<td><p>Преобразование номеров с сетевым префиксом (6) и кодами сайта Нью-Йорка (333)</p></td>
<td><p>^6333(\d{4})$</p></td>
<td><p>+1202555$1</p></td>
<td><p>63330100 преобразуется в +12025550100</p></td>
</tr>
<tr class="odd">
<td><p>DallasSitePrefix</p></td>
<td><p>Преобразование номеров с сетевым префиксом (6) и кодами сайта Далласа (444)</p></td>
<td><p>^6444(\d{4})$</p></td>
<td><p>+1972555$1</p></td>
<td><p>64440100 преобразуется в +19725550100</p></td>
</tr>
</tbody>
</table>


В следующей таблице приводится пример абонентской группы для сайта Редмонда (шт. Вашингтон, США) на основе правил нормализации, приведенных в предыдущей таблице.

### Таблица 2. Абонентская группа Редмонда, основанная на правилах нормализации из таблицы 1

<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th>Redmond.forestFQDN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>5digitExtension</p></td>
</tr>
<tr class="even">
<td><p>7digitcallingRedmond</p></td>
</tr>
<tr class="odd">
<td><p>10digitcallingUS</p></td>
</tr>
<tr class="even">
<td><p>IntlCallingUS</p></td>
</tr>
<tr class="odd">
<td><p>RedmondSitePrefix</p></td>
</tr>
<tr class="even">
<td><p>NYSitePrefix</p></td>
</tr>
<tr class="odd">
<td><p>DallasSitePrefix</p></td>
</tr>
<tr class="even">
<td><p>RedmondOperator</p></td>
</tr>
</tbody>
</table>


> [!NOTE]  
> Имена правил нормализации, приведенные в предыдущей таблице, не включают пробелы, но это не является обязательным требованием. Например, первое имя в таблице можно записать как &quot;5 значное расширение&quot; или &quot;5-значное расширение&quot;, и оно будет допустимым.
