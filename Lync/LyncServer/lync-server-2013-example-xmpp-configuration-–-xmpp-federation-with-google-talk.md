---
title: 'Lync Server 2013: пример конфигурации XMPP – федерация XMPP с Google Talk'
TOCTitle: Пример конфигурации XMPP – федерация XMPP с Google Talk
ms:assetid: 360a2f7b-015b-4e93-ac67-0f609c21f1a2
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ204807(v=OCS.15)
ms:contentKeyID: 49309422
ms.date: 12/10/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Пример конфигурации XMPP в Lync Server 2013 — федерация XMPP с Google Talk

 

_**Дата изменения раздела:** 2016-12-08_

В примере конфигурации для развертывания прокси-сервера XMPP определяется федерация с Google Talk.

## Пример конфигурации XMPP – федерация XMPP с Google Talk

1.  Откройте в переднего плана средство развертывания Lync Server. Нажмите **Установить** или **Обновить систему Lync Server** , затем выберите **Установить** или **Удалить компоненты Lync Server** . Нажмите **Повторить**.

2.  В диалоговом окне **Установка компонентов Lync Server** нажмите кнопку **Далее** . В окне сводки будут показаны действия по мере их выполнения. После завершения развертывания нажмите кнопку **Просмотреть журнал** для просмотра доступных файлов журналов. Нажмите кнопку **Готово** , чтобы завершить развертывание.

3.  На пограничном сервере сервер откройте средство развертывания Lync Server. Щелкните **Установить** или **Обновить систему Lync Server** , затем щелкните **Установить** или **Удалить компоненты Lync Server** . Нажмите кнопку **Перезапуск** .

4.  Добавьте Google Talk в качестве разрешенного XMPP-партнера. В настоящее время Google Talk поддерживает только незашифрованные TCP-подключения для федерации между серверами и поддерживает только Server Dialback для проверки удостоверений. (См. статью <http://xmpp.org/extensions/xep-0220.html>).
    
        New-CsXmppAllowedPartner gmail.com -TlsNegotiation NotSupported -SaslNegotiation NotSupported -EnableKeepAlive $false -SupportDialbackNegotiation $true

5.  Чтобы включить федерацию пограничных серверов, введите следующую команду:
    
        Set-CsAccessEdgeConfiguration -AllowFederatedUsers $true

6.  В диалоговом окне **Установка компонентов Lync Server** нажмите кнопку **Далее** . В окне сводки будут показаны действия по мере их выполнения. После завершения развертывания нажмите кнопку **Просмотреть журнал** для просмотра доступных файлов журналов. Нажмите кнопку **Готово** , чтобы завершить развертывание.

7.  На пограничном сервере сервер в средстве развертывания Lync Server рядом с элементом **Шаг 3. Запрос, установка или назначение сертификатов** нажмите кнопку **Перезапуск** .
    

    > [!TIP]
    > Если развертывание пограничного сервера выполняется впервые, то вместо кнопки "Повторный запуск" будет отображаться кнопка "Запуск".



8.  На странице **Available Certificate Tasks** (Доступные задачи сертификатов) щелкните команду **Create a new certificate request** (Создать новый запрос сертификата).

9.  На странице **запроса сертификата** выберите пункт **External Edge Certificate** (Внешний сертификат пограничного сервера).

10. На странице **Отложенный или немедленный запрос** установите флажок **Подготовить запрос сейчас, чтобы отправить его позже** .

11. На странице **файла запроса сертификата** введите полный путь и имя файла, в который должен сохраняться запрос (например, c:\\cert\_exernal\_edge.cer).

12. На странице **указания альтернативного шаблона сертификата** для использования шаблона, отличного от шаблона WebServer по умолчанию, установите флажок **Use alternative certificate template for the selected certification authority** (Использовать альтернативный шаблон сертификата для выбранного центра сертификации).

13. На странице **настроек имени и безопасности** выполните следующие действия.
    
    1.  В поле **Понятное имя** введите отображаемое имя сертификата.
    
    2.  В поле **Длина бита** укажите длину в битах (по умолчанию – **2048** ).
    
    3.  Убедитесь, что установлен флажок **Пометить закрытый ключ сертификата как экспортируемый** .

14. На странице **Сведения об организации** введите название организации и подразделение (например, отдел или филиал).

15. На странице **Сведения о местоположении** укажите информацию о местонахождении.

16. На странице **Имя субъекта / альтернативные имена субъекта** отображаются сведения, которые автоматически заполняются мастером. Если требуются дополнительные альтернативные имена субъектов, их можно указать на следующих двух шагах.

17. На странице **SIP Domain Setting on Subject Alternate Names (SANs) (Настройка домена SIP в альтернативных именах субъектов (SAN))** установите флажок домена, чтобы добавить запись sip. *\<домен\_SIP\>* в список альтернативных имен субъектов.

18. На странице **Настройка дополнительных альтернативных имен субъекта** укажите все необходимые дополнительные альтернативные имена субъекта.
    

    > [!TIP]
    > Если устанавливается прокси-сервер XMPP, то по умолчанию в записях SAN заполняется имя домена (например, contoso.com). Если требуются дополнительные записи, добавьте их сейчас.



19. На странице **сводки по запросу** просмотрите сведения о сертификате, которые будут использоваться для создания запроса.

20. После выполнения всех команд можно **Просмотреть журнал** или нажать кнопку **Далее** для продолжения.

21. На странице **файла запроса сертификата** можно просмотреть созданный файл запроса подписи сертификата (CSR-файл), нажав кнопку **Просмотр** , или выйти из мастера сертификатов, нажав кнопку **Готово** .

22. Скопируйте файл запроса и отправьте его в ваш общедоступный центр сертификации.

23. После получения, импорта и назначения открытого сертификата необходимо остановить и перезапустить службы пограничного сервера. Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.. На командной консоли Командная консоль Lync Server введите:
    
```
              Stop-CsWindowsService
```
```
        Start-CsWindowsService
```
24. Чтобы настроить DNS для федерации XMPP, добавьте следующую запись SRV во внешнюю DNS:\_xmpp-server.\_tcp. *\<имя\_домена\>* . Запись SRV преобразуется в полное доменное имя пограничного сервера с портом 5269

25. Настройте новую внешнюю политику доступа, чтобы активировать всех пользователей, открыв командную консоль Командная консоль Lync Server на сервере переднего плана и введя следующую команду:
    
        New-CsExternalAccessPolicy -Identity FedPic -EnableFederationAccess $true -EnablePublicCloudAccess $true
        Get-CsUser | Grant-CsExternalAccessPolicy -PolicyName FedPic

