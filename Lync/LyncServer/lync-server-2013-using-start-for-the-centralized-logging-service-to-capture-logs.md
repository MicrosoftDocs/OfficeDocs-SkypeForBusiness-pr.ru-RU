---
title: "Lync Server 2013: запуск службы централизованного ведения журналов через Start"
TOCTitle: "Lync Server 2013: запуск службы централизованного ведения журналов через Start"
ms:assetid: 0512b9ce-7f5b-48eb-a79e-f3498bacf2de
ms:mtpsurl: https://technet.microsoft.com/ru-ru/library/JJ687958(v=OCS.15)
ms:contentKeyID: 49887852
ms.date: 05/19/2016
mtps_version: v=OCS.15
ms.translationtype: HT
---

# Использование запуска службы централизованного ведения журнала для записи журналов

 

_**Дата изменения раздела:** 2013-02-21_

Для получения журналов трассировки с помощью централизованная служба ведения журнала нужно выдать команду на начало ведения журнала для одного или нескольких компьютеров и пулов. При этом указываются параметры, определяющие на каких компьютерах и в каких пулах какие сценарии выполнять (например, AlwaysOn, другой предопределенный или созданный самостоятельно сценарий), а также какие компоненты Lync Server отслеживать (например, S4, SipStack).

Для получения правильных сведений нужно гарантировать использование правильного сценария сбора данных, связанного с проблемой. В централизованная служба ведения журнала сценарий — это понятие включения ведения журнала с помощью набора компонентов сервера, уровней ведения журнала и флагов, что намного эффективнее и полезнее определения этих элементов для каждого сервера в отдельности. Нужный сценарий определяется для всех серверов и пулов используемой области инфраструктуры и согласованно выполняется на них.

Сценарий по умолчанию называется **AlwaysOn**. Сценарий AlwaysOn, в соответствии со своим названием, предназначен для постоянного выполнения. Сценарий AlwaysOn собирает данные на уровне Info (обратите внимание, что помимо информационных сообщений при ведении журнала на уровне Info также регистрируются сообщения Fatal (неустранимо), Error (ошибка) и Warning (предупреждение)) для многих из наиболее типичных серверных компонентов. AlwaysOn собирает сведения до, во время и после возникновения проблемы. Это резко отличается от поведения предыдущих средств ведения журнала, таких как OCSLogger. OCSLogger запускается уже после появления проблемы, что затрудняет поиск и устранение неисправностей, так как данные собираются как реакция на событие, а не упреждающе. Если AlwaysOn не содержит данных, нужных для определения проблемного компонента, и не указывает направление действий для исправления проблемы (что, скорее всего, связано с недостаточной шириной и глубиной поставщиков в AlwaysOn), будет указан разумный уровень данных для определения дальнейших действий, таких как создание нового сценария, сбор других данных, выполнение другого поиска для сбора более подробных сведений и т. д.

централизованная служба ведения журнала предлагает два способа выдачи команд. В ряде разделов прямо описано использование Windows PowerShell с помощью Командная консоль Lync Server. Возможность использовать сложные конфигурации и команды стимулирует применение Windows PowerShell для централизованная служба ведения журнала. Так как использование Windows PowerShell с помощью Командная консоль Lync Server распространено практически для всех функций в Lync Server, рассматриваются только команды Windows PowerShell.

> [!NOTE]  
> Если решено использовать ограниченный набор команд, доступный из командной строки, справку для CLSController.exe можно вывести на экран, введя <code>ClsController.exe</code>. По умолчанию программа <strong>ClsController.exe</strong> устанавливается в каталог C:\Program Files\Microsoft Lync Server 2013\ClsAgent.

## Запуск Start-CsClsLogging в Windows PowerShell с помощью базовых команд

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Запустите сценарий ведения журнала с помощью централизованная служба ведения журнала, введя следующую команду:
    
        Start-CsClsLogging -Scenario <name of scenario>
    
    Например, для запуска сценария **AlwaysOn** введите:
    
        Start-CsClsLogging -Scenario AlwaysOn
    
    > [!NOTE]  
    > У сценария AlwaysOn нет длительности по умолчанию. Этот сценарий будет выполняться, пока он не будет явно остановлен с помощью командлета <strong>Stop-CsClsLogging</strong>. Подробные сведения см. в статье <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Stop-CsClsLogging">Stop-CsClsLogging</a>. Для всех остальных сценариев длительность по умолчанию составляет 4 часа.

3.  Для выполнения команды нажмите клавишу ВВОД.
    
    > [!NOTE]  
    > Для выполнения команд и возвращения состояния от компьютеров среды может потребоваться некоторое небольшое время (от 30 до 60 секунд).    
    
    ![Запуск Start-CsClsLogging.](images/JJ687958.c5be7413-8cef-4de7-9712-944d20cc2fa4(OCS.15).jpg "Запуск Start-CsClsLogging.")

4.  Чтобы выполнить другой сценарий, используйте командлет **Start-CsClsLogging** с именем выполняемого дополнительного сценария (например, сценария **Authentication**):
    
        Start-CsClsLogging -Scenario Authentication
    
    > [!IMPORTANT]  
    > В любой момент времени на любом конкретном компьютере может работать не более двух сценариев. Если область применения команды является глобальной, этот сценарий или сценарии будут выполняться на всех компьютерах среды. Для запуска третьего сценария необходимо остановить ведение журнала для области применения (компьютер, пул, сайт, глобальная), в которой нужно запустить новый сценарий. Если сценарии запущены в глобальной области применения, можно остановить ведение журнала в одном или обоих сценариях для одного или нескольких компьютеров и пулов. Подробные сведения об управлении выбором выполняемых сценариев см. в статье <a href="lync-server-2013-using-stop-for-the-centralized-logging-service.md">Использование остановки службы централизованного ведения журналов</a> и <a href="https://docs.microsoft.com/en-us/powershell/module/skype/Stop-CsClsLogging">Stop-CsClsLogging</a>.

## Запуск Start-CsClsLogging в Windows PowerShell с помощью расширенных команд

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Для управления командами ведения журнала доступны дополнительные параметры. Можно использовать параметр –Duration, чтобы задать длительность времени выполнения сценария. Также можно с помощью параметра –Computers определить разделяемый запятыми список полных доменных имен компьютеров, а с помощью параметра –Pools определить разделяемый запятыми список полных доменных имен пулов, на которых нужно вести журнал.
    
    Пусть нужно запустить сеанс ведения журнала с помощью сценария *UserReplicator* для пула "pool01.contoso.net". При этом длительность сеанса ведения журнала определяется равной 8 часам. Для этого введите следующую команду:
    
        Start-CsClsLogging -Scenario UserReplicator -Duration 8:00 -Pools "pool01.contoso.net"
    
    При успешном выполнении этого сценария возвращается результат, подобный следующему:
    
    ![Запуск Start-CsClsLogging.](images/JJ687958.399f0c2e-c08c-40ab-b6c6-381dddc12fe9(OCS.15).jpg "Запуск Start-CsClsLogging.")
    
    Обратите внимание, что в этом примере выполняются сценарий AlwaysOn и сценарий UserReplicator.

## См. также

#### Концепции

[Обзор службы централизованного ведения журналов](lync-server-2013-overview-of-the-centralized-logging-service.md)

