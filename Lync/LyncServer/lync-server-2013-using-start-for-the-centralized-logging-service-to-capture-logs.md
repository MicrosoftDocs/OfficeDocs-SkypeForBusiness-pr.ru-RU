---
title: Использование команды Start для централизованной службы ведения журналов для записи журналов
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
f1.keywords:
- NOCSH
TOCTitle: Using Start for the Centralized Logging Service to capture logs
ms:assetid: 0512b9ce-7f5b-48eb-a79e-f3498bacf2de
ms:mtpsurl: https://technet.microsoft.com/en-us/library/JJ687958(v=OCS.15)
ms:contentKeyID: 49733543
ms.date: 07/23/2014
manager: serdars
mtps_version: v=OCS.15
ms.openlocfilehash: f43a2c86dcbd88f8e9af4ae54f302b4abc943fc0
ms.sourcegitcommit: 4d6bf5c58b2c553dc1df8375ede4a9cb9eaadff2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "48529976"
---
# <a name="using-start-for-the-centralized-logging-service-to-capture-logs-in-lync-server-2013"></a>Использование Start для централизованной службы ведения журналов для захвата журналов в Lync Server 2013

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="https://msdn.microsoft.com/">

<div data-asp="https://msdn2.microsoft.com/asp">



</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Последнее изменение темы:** 2013-02-21_

Для записи журналов трассировки с помощью централизованной службы ведения журналов вы можете выполнить команду для начала ведения журнала на одном или нескольких компьютерах и в пулах. Кроме того, вы можете указать, какие компьютеры или пулы, какие сценарии следует запустить (например, AlwaysOn, другой предварительно определенный сценарий или созданный сценарий), какие компоненты Lync Server (например, S4, SipStack) будут трассироваться.

Для получения правильных сведений нужно гарантировать использование правильного сценария сбора данных, связанного с проблемой. В централизованной службе ведения журналов сценарий состоит в том, чтобы включать и отключать ведение журнала на основе коллекции серверных компонентов, уровней ведения журнала и флагов, что является гораздо более эффективным и эффективным, чем определять эти элементы на уровне сервера. Нужный сценарий определяется для всех серверов и пулов используемой области инфраструктуры и согласованно выполняется на них.

Сценарий по умолчанию называется **AlwaysOn**. Сценарий AlwaysOn, в соответствии со своим названием, предназначен для постоянного выполнения. Сценарий AlwaysOn собирает данные на уровне Info (обратите внимание, что помимо информационных сообщений при ведении журнала на уровне Info также регистрируются сообщения Fatal (неустранимо), Error (ошибка) и Warning (предупреждение)) для многих из наиболее типичных серверных компонентов. AlwaysOn собирает сведения до, во время и после возникновения проблемы. Это резко отличается от поведения предыдущих средств ведения журнала, таких как OCSLogger. OCSLogger запускается уже после появления проблемы, что затрудняет поиск и устранение неисправностей, так как данные собираются как реакция на событие, а не упреждающе. Если AlwaysOn не содержит данных, нужных для определения проблемного компонента, и не указывает направление действий для исправления проблемы (что, скорее всего, связано с недостаточной шириной и глубиной поставщиков в AlwaysOn), будет указан разумный уровень данных для определения дальнейших действий, таких как создание нового сценария, сбор других данных, выполнение другого поиска для сбора более подробных сведений и т. д.

Централизованная служба ведения журналов предоставляет два способа выполнения команд. Несколько разделов посвящены использованию Windows PowerShell с помощью командной консоли Lync Server. Возможность использования ряда сложных конфигураций и команд обеспечивает Windows PowerShell для централизованного использования службы ведения журнала. Так как Windows PowerShell с помощью командной консоли Lync Server является почти общедоступной для всех функций в Lync Server, обсуждаются только команды Windows PowerShell.

<div>


> [!NOTE]
> Если вы решили использовать ограниченный набор команд, доступный в командной строке, можно получить справку по CLSController.exe, введя команду <CODE>ClsController.exe</CODE> . По умолчанию <STRONG>ClsController.exe</STRONG> устанавливается в каталог C:\Program Files\Microsoft Lync Server 2013 \ ClsAgent.



</div>

<div>

## <a name="to-run-start-csclslogging-with-windows-powershell-using-basic-commands"></a>Запуск Start-CsClsLogging с помощью Windows PowerShell с помощью основных команд

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Запустите сценарий ведения журнала с помощью службы централизованного ведения журналов, введя следующую команду:
    
        Start-CsClsLogging -Scenario <name of scenario>
    
    Например, для запуска сценария **AlwaysOn** введите:
    
        Start-CsClsLogging -Scenario AlwaysOn
    
    <div>
    

    > [!NOTE]
    > У сценария AlwaysOn нет длительности по умолчанию. Этот сценарий будет выполняться, пока он не будет явно остановлен с помощью командлета <STRONG>Stop-CsClsLogging</STRONG>. Подробные сведения см. в статье <A href="https://technet.microsoft.com/library/JJ619180(v=OCS.15)">Stop-CsClsLogging</A>. Для всех остальных сценариев длительность по умолчанию составляет 4 часа.

    
    </div>

3.  Для выполнения команды нажмите клавишу ВВОД.
    
    <div>
    

    > [!NOTE]
    > Для выполнения команд и возвращения состояния от компьютеров среды может потребоваться некоторое небольшое время (от 30 до 60 секунд).

    
    </div>
    
    ![Запуск команды Start — CsClsLogging.](images/JJ687958.c5be7413-8cef-4de7-9712-944d20cc2fa4(OCS.15).jpg "Запуск команды Start — CsClsLogging.")

4.  Чтобы выполнить другой сценарий, используйте командлет **Start-CsClsLogging** с именем выполняемого дополнительного сценария (например, сценария **Authentication**):
    
        Start-CsClsLogging -Scenario Authentication
    
    <div>
    

    > [!IMPORTANT]
    > В любой момент времени на любом конкретном компьютере может работать не более двух сценариев. Если область применения команды является глобальной, этот сценарий или сценарии будут выполняться на всех компьютерах среды. Для запуска третьего сценария необходимо остановить ведение журнала для области применения (компьютер, пул, сайт, глобальная), в которой нужно запустить новый сценарий. Если сценарии запущены в глобальной области применения, можно остановить ведение журнала в одном или обоих сценариях для одного или нескольких компьютеров и пулов. Для получения дополнительных сведений об управлении выполняемыми сценариями обратитесь к разделу <A href="lync-server-2013-using-stop-for-the-centralized-logging-service.md">Использование команды Stop для службы централизованного ведения журналов в Lync Server 2013</A> и <A href="https://technet.microsoft.com/library/JJ619180(v=OCS.15)">Stop – CsClsLogging</A>.

    
    </div>

</div>

<div>

## <a name="to-run-start-csclslogging-with-windows-powershell-using-advanced-commands"></a>Запуск Start-CsClsLogging с помощью Windows PowerShell с помощью расширенных команд

1.  Запустите командную консоль Lync Server: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Microsoft Lync Server 2013** и щелкните элемент **Командная консоль Lync Server**.

2.  Для управления командами ведения журнала доступны дополнительные параметры. Можно использовать параметр –Duration, чтобы задать длительность времени выполнения сценария. Также можно с помощью параметра –Computers определить разделяемый запятыми список полных доменных имен компьютеров, а с помощью параметра –Pools определить разделяемый запятыми список полных доменных имен пулов, на которых нужно вести журнал.
    
    Вы запускаете сеанс ведения журнала для сценария *UserReplicator* в пуле "pool01.contoso.NET". При этом длительность сеанса ведения журнала определяется равной 8 часам. Для этого введите следующую команду:
    
        Start-CsClsLogging -Scenario UserReplicator -Duration 8:00 -Pools "pool01.contoso.net"
    
    При успешном выполнении этого сценария возвращается результат, подобный следующему:
    
    ![Запуск команды Start — CsClsLogging.](images/JJ687958.399f0c2e-c08c-40ab-b6c6-381dddc12fe9(OCS.15).jpg "Запуск команды Start — CsClsLogging.")
    
    Обратите внимание, что в этом примере выполняются сценарий AlwaysOn и сценарий UserReplicator.

</div>

<div>

## <a name="see-also"></a>См. также


[Обзор централизованной службы ведения журналов в Lync Server 2013](lync-server-2013-overview-of-the-centralized-logging-service.md)  
  

</div>

</div>

<span> </span>

</div>

</div>

</div>

