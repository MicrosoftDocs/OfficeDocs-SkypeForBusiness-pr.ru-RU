---
title: Настройка тестовых пользователей узла-наблюдателя и параметров
ms.reviewer: ''
ms.author: jambirk
author: jambirk
manager: serdars
ms.date: 2/13/2018
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
description: 'Сводка: Настройка тестовых учетных записей пользователей и узлов-наблюдателей для виртуальных транзакций в Skype для бизнеса Server.'
ms.openlocfilehash: 2e365e2212cd2ade76d02c878891e1bbfcfdc433
ms.sourcegitcommit: e64c50818cac37f3d6f0f96d0d4ff0f4bba24aef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2020
ms.locfileid: "41799659"
---
# <a name="configure-watcher-node-test-users-and-settings"></a>Настройка тестовых пользователей узла-наблюдателя и параметров
 
**Сводка:** Настройка тестовых учетных записей пользователей и узлов-наблюдателей для виртуальных транзакций в Skype для бизнеса Server.
  
Настроив компьютер, который будет выступать в качестве узла-наблюдателя, выполните следующие действия.
  
1. [Настройка тестовых учетных записей пользователей](test-users-and-settings-2019.md#testuser) для использования этими узлами-наблюдателями. Если вы используете проверку подлинности согласованием, вам также необходимо выполнить командлет **Set-CsTestUserCredential**, чтобы разрешить использование этих учетных записей узлом-наблюдателем.
    
2. Обновите параметры конфигурации узла-наблюдателя.
    
## <a name="configure-test-user-accounts"></a>Настройка тестовых учетных записей пользователей
<a name="testuser"> </a>

Проверочные учетные записи не должны представлять реальных пользователей, но они должны быть действительными учетными записями Active Directory. Кроме того, эти учетные записи должны быть активированы для Skype для бизнеса Server, они должны иметь действительные адреса SIP, и они должны быть включены для поддержки коммерческой голосовой связи (для использования виртуальной транзакции test-Кспстнпиртопиркалл). 
  
If you are using the TrustedServer authentication method, all you need to do is to make sure that these accounts exist and configure them as noted. You should assign at least three test users for each pool that you want to test. При использовании метода проверки подлинности согласования необходимо также использовать командлет Set-Кстестусеркредентиал и командную консоль управления Skype для бизнеса, чтобы включить эти тестовые учетные записи для работы с искусственными транзакциями. Для этого выполните следующую команду (в этой статье предполагается, что созданы три учетные записи пользователей Active Directory и что эти учетные записи включены для Skype для бизнеса Server):
  
```PowerShell
Set-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com" -UserName "litwareinc\watcher1" -Password "P@ssw0rd"
Set-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com" -UserName "litwareinc\watcher2" -Password "P@ssw0rd"
Set-CsTestUserCredential -SipAddress "sip:watcher3@litwareinc.com" -UserName "litwareinc\watcher3" -Password "P@ssw0rd"
```

Помимо SIP-адреса вам нужно также указать имя пользователя и пароль. Если вы не укажете пароль, командлет Set-CsTestUserCredential выведет соответствующий запрос. Имя пользователя можно указывать в формате "имя_домена\имя_пользователя", как показано выше.
  
Чтобы убедиться в том, что тестовые учетные данные были созданы, выполните эти команды в командной консоли управления Skype для бизнеса Server.
  
```PowerShell
Get-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com"
Get-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com"
Get-CsTestUserCredential -SipAddress "sip:watcher3@litwareinc.com"
```

Команды возвращают сведения о каждом пользователе, похожие на следующие.
  
|**Действительно**|**Защищен**|
|:-----|:-----|
|Litwareinc\watcher1  <br/> |System. Security. SecureString  <br/> |
   
### <a name="configure-a-basic-watcher-node-with-the-default-synthetic-transactions"></a>Настройка базового узла-наблюдателя, использующего искусственные транзакции по умолчанию

Создав тестовых пользователей, вы можете создать узел-наблюдатель с помощью следующей команды.
  
```PowerShell
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"}
```

Эта команда создает узел-наблюдатель с параметрами по умолчанию, который выполняет набор искусственных транзакций по умолчанию. Для нового узла-наблюдателя используются тестовые пользователи watcher1@litwareinc.com, watcher2@litwareinc.com и watcher3@litwareinc.com. Если узел-наблюдатель использует проверку подлинности TrustedServer, тестовые учетные записи могут представлять собой любые допустимые учетные записи, для которых включена поддержка Active Directory и Skype для бизнеса Server. Если узел-наблюдатель использует проверку подлинности согласованием, использование этих учетных записей пользователей также должно быть включено для узла-наблюдателя с помощью командлета Set-CsTestUserCredential.
  
Чтобы проверить правильность настройки автоматического обнаружения целевого пула для входа в систему вместо непосредственного определения пула, используйте следующие действия:
  
```PowerShell
New-CsWatcherNodeConfiguration -UseAutoDiscovery $true -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"}
```

### <a name="configuring-extended-tests"></a>Настройка расширенных тестов

Если вы хотите включить тест ТСОП, проверяющий подключение к телефонной сети общего пользования, вам потребуется произвести дополнительную настройку узла-наблюдателя. Во-первых, вам нужно связать тестовых пользователей с типом теста ТСОП, выполнив следующую команду командной консоли Skype для бизнеса Server.
  
```PowerShell
$pstnTest = New-CsExtendedTest -TestUsers "sip:watcher1@litwareinc.com", "sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"  -Name "Contoso Provider Test" -TestType PSTN
```

> [!NOTE]
> Результаты выполнения этой команды необходимо сохранить в переменной. В этом примере используется переменная $pstnTest. 
  
Затем можно использовать командлет **New-ксватчернодеконфигуратион** , чтобы связать тип теста (хранящийся в переменной $pstnTest) с пулом сервера Skype для бизнеса. Например, следующая команда создает конфигурацию узла-наблюдателя для пула atl-cs-001.litwareinc.com, добавляет трех тестовых пользователей, созданных ранее, а также тест ТСОП.
  
```PowerShell
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"} -ExtendedTests @{Add=$pstnTest}
```

Если вы не установили основные файлы Skype для бизнеса Server и базу данных RTCLocal на компьютере узла-наблюдателя, то предыдущая команда завершится с ошибкой. 
  
Чтобы протестировать несколько политик голосовой связи, вам нужно создать расширенный тест для каждой политики с помощью командлета **New-CsExtendedTest**. Для пользователей, назначенных этому тесту, следует настроить требуемые политики голосовой связи. После этого передайте расширенные тесты в командлет **New-CsWatcherNodeConfiguration** с помощью следующих команды с разделителями запятыми.
  
-Екстендедтестс @ {Add = $pstnTest 1, $pstnTest 2, $pstnTest 3}
  
Так как командлет **New-CsWatcherNodeConfiguration** был вызван без параметра Tests, то для нового узла-наблюдателя будут включены только искусственные транзакции по умолчанию и указанные расширенные искусственные транзакции. Это означает, что узел-наблюдатель будет тестировать следующие компоненты:
  
- Registration
    
- IM
    
- GroupIM (групповые мгновенные сообщения)
    
- P2PAV (одноранговые аудио- и видеосеансы)
    
- AvConference (аудио- и видеоконференции)
    
- Presence
    
- ABS (служба адресной книги)
    
- ABWQ (веб-служба адресной книги)
    
Следующие компоненты не будут тестироваться по умолчанию:
  
- ASConference
    
- AVEdgeConnectivity
    
- DataConference
    
- DialinConferencing
    
- ExumConnectivity (единая система обмена сообщениями Exchange)
    
- JoinLauncher
    
- MCXP2PIM (устаревший обмен мгновенными сообщениями с мобильными устройствами)
    
- P2PVideoInteropServerSipTrunkAV
    
- PersistentChatMessage
    
- ТСОП (вызовы шлюза ТСОП, указанные как расширенный тест)
    
- UcwaConference
    
- UnifiedContactStore
    
- XmppIM
    
### <a name="adding-and-removing-synthetic-transactions"></a>Добавление и удаление искусственных транзакций

После настройки узла-наблюдателя вы можете добавлять искусственные транзакции на узел-наблюдатель или удалять их с узла-наблюдателя с помощью командлета Set-CsWatcherNodeConfiguration. Например, чтобы добавить тест PersistentChatMessage на узел-наблюдатель, используйте следующую команду с методом Add.
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage"}
```

При указании нескольких тестов используйте запятые. Пример:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage","DataConference","UnifiedContactStore"}
```

Если один или несколько этих тестов (например, DataConference) уже были включены на узле-наблюдателе, произойдет ошибка. В этом случае вы получите следующее сообщение.
  
Set-CsWatcherNodeConfiguration : Существует повторяющаяся последовательность ключей 'DataConference' для ключа 'urn:schema:Microsoft.Rtc.Management.Settings.WatcherNode.2010:TestName' или ограничение по уникальному идентификатору.
  
Если произошла эта ошибка, изменения не применяются. Команду следует выполнить повторно, удалив повторяющийся тест.
  
Чтобы удалить искусственную транзакцию с узла-наблюдателя, используйте метод Remove. Например, следующая команда удаляет тест ABWQ с узла-наблюдателя.
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Remove="ABWQ"}
```

С помощью метода Replace вы можете заменить все тесты, включенные в настоящий момент, на один или несколько новых тестов. Например, если вы хотите, чтобы узел-наблюдатель только выполнял тест IM, вы можете использовать следующую команду.
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Replace="IM"}
```

При выполнении этой команды на указанном узле-наблюдателе отключаются все искусственные транзакции, кроме IM.
  
### <a name="viewing-and-testing-the-watcher-node-configuration"></a>Просмотр и тестирование конфигурации узла-наблюдателя

Чтобы просмотреть тесты, назначенные узлу-наблюдателю, используйте следующую команду.
  
```PowerShell
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests
```

Данная команда возвращает сведения, схожие со следующими (с учетом искусственных транзакций, назначенных узлу).
  
Обмен мгновенными сообщениями Граупим P2PAV Авконференце присутствия Персистентчатмессаже-конференций
> [!TIP]
> Чтобы просмотреть искусственные транзакции в алфавитном порядке, используйте следующую команду. 
  
```PowerShell
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests | Sort-Object
```

Чтобы проверить, был ли создан узел-наблюдатель, введите в командную консоль Skype для бизнеса Server следующую команду.
  
```PowerShell
Get-CsWatcherNodeConfiguration
```

Команда возвращает сведения, похожие на следующие.
  
Идентификация: atl-cs-001.litwareinc.com Тестусерс: {sip:watcher1@litwareinc.com, sip:watcher2@litwareinc.com...} ExtendedTests : {TestUsers=IList<System.String>;Name=PSTN Test; Te...} Таржетфкдн: atl-cs-001.litwareinc.com номер_порта: 5061To убедитесь, что узел наблюдателя настроен правильно, введите следующую команду в командной консоли управления Skype для бизнеса Server:
  
```PowerShell
Test-CsWatcherNodeConfiguration
```

Данная команда проверяет каждый узел-наблюдатель в развертывании и подтверждает выполнение следующих действий:
  
- установлена ли требуемая роль Регистратора;
    
- созданы ли требуемые разделы реестра (выполняется при запуске команды Set-CsWatcherNodeConfiguration);
    
- запущена ли на серверах требуемая версия Skype для бизнеса Server;
    
- правильно ли настроены порты;
    
- имеются ли у назначенных тестовых пользователей требуемые учетные данные.
    
## <a name="managing-watcher-nodes"></a>Управление узлами-наблюдателями
<a name="testuser"> </a>

В дополнение к изменению искусственных транзакций, выполняемых на узле-наблюдателе, вы можете также использовать командлет **Set-CsWatcherNodeConfiguration** для выполнения двух других важных задач: включение/отключение узла-наблюдателя и настройка узла-наблюдателя для использования внутренних URL-адресов или внешних URL-адресов при проведении тестирования.
  
По умолчанию узлы-наблюдатели периодически запускают все включенные искусственные транзакции. Однако иногда может потребоваться приостановка выполнения транзакций. Например, если узел-наблюдатель временно отключился от сети, у него больше нет причин запускать искусственные транзакции. Без сетевого подключения эти транзакции завершатся со сбоем. Для временного отключения узла-наблюдателя выполните команду, идентичную команде из командной консоли Skype для бизнеса Server:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $False
```

Эта команда приведет к отключению выполнения искусственных транзакций на узле-наблюдателе atl watcher 001.litwareinc.com. Чтобы возобновить выполнение искусственных транзакций, снова задайте для свойства Enabled значение True ($True):
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $True
```

> [!NOTE]
> Свойство Enabled может использоваться для включения или отключения узлов-наблюдателей. Если нет необходимости временно удалять узел-наблюдатель, используйте командлет **Remove-CsWatcherNodeConfiguration**:
  
```PowerShell
Remove-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com"
```

Эта команда удаляет с указанного компьютера все параметры конфигурации узла-наблюдателя, что препятствует автоматическому запуску на этом компьютере искусственных транзакций. Тем не менее, команда не удаляет файлы агента System Center и системные файлы Skype для бизнеса Server.
  
По умолчанию узлы-наблюдатели используют при проведении тестов внешние URL-адреса. Однако узлы-наблюдатели можно настроить для использования внутренних URL-адресов организации. Это позволит администраторам проверить доступ к URL-адресам тех пользователей, которые находятся внутри сети периметра. Чтобы настроить узел-наблюдатель для использования внутренних URL-адресов вместо внешних URL-адресов, задайте для свойства UseInternalWebURls значение True ($True):
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $True
```

Сброс этого свойства до значения по умолчанию False ($False) приведет к повторному использованию наблюдателем внешних URL-адресов:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $False
```

## <a name="special-setup-instructions-for-synthetic-transactions"></a>Специальные инструкции по установке для искусственных транзакций
<a name="special_synthetictrans"> </a>

Большинство искусственных транзакций может работать на узле-наблюдателе без изменений. То есть, как только искусственная транзакция добавляется в параметры конфигурации узла-наблюдателя, узел-наблюдатель может начать использовать эту искусственную транзакцию во время тестовых проходов. Однако существуют некоторые искусственные транзакции, которые нуждаются в специальных инструкциях. Такие транзакции обсуждаются в следующих разделах.
  
### <a name="data-conferencing-synthetic-transaction"></a>Искусственная транзакция в конференц-связи с передачей данных

Если компьютер узла-наблюдателя расположен за пределами сетевого периметра, скорее всего, невозможно будет запускать искусственные транзакции конференц-связи с передачей данных, если только не отключить сначала параметры прокси-сервера в интернет-браузере Windows Internet Explorer® для учетной записи сетевой службы, выполнив следующие действия.
  
1. На компьютере узла-наблюдателя щелкните кнопку **Пуск**, последовательно щелкните пункты **Все программы**, **Стандартные**, щелкните правой кнопкой мыши значок **Командная строка** и в контекстном меню выберите пункт **Запуск от имени администратора**.
    
2. В окне консоли введите следующую команду и нажмите клавишу ВВОД: 
    
```PowerShell
bitsadmin /util /SetIEProxy NetworkService NO_PROXY
```

В окне командной строки отобразится следующее сообщение:
  
BITSAdmin является устаревшей, доступность для использования в следующих версиях Windows не гарантируется. Средства администрирования для службы BITS теперь предоставляются командлетами BITS PowerShell.
  
Для параметров прокси-сервера интернет-службы учетной записи NetworkService установлено значение NO_PROXY. 
  
(подключение = по умолчанию)
  
Это сообщение означает, что вы отключили параметры прокси-сервера браузера Internet Explorer для учетной записи сетевой службы.
  
### <a name="exchange-unified-messaging-synthetic-transaction"></a>Искусственная транзакция единой системы обмена сообщениями Exchange

Искусственная транзакция обмена сообщениями Exchange (UM) проверяет, что тестовые пользователи могут подключаться к учетным записям голосовой почты, которые размещаются в Exchange.
  
Для этих тестовых пользователей должны быть предварительно настроены учетные записи голосовой почты. 
  
### <a name="persistent-chat-synthetic-transaction"></a>Искусственная транзакция сохраняемого чата

Чтобы воспользоваться искусственной транзакцией сохраняемого чата, необходимо сначала создать канал и предоставить тестовым пользователям разрешения для использования.
  
Искусственную транзакцию сохраняемого чата можно использовать для настройки следующего канала: 
  
```PowerShell
$cred1 = Get-Credential "contoso\testUser1"
$cred2 = Get-Credential "contoso\testUser2"

Test-CsPersistentChatMessage -TargetFqdn pool0.contoso.com -SenderSipAddress sip:testUser1@contoso.com -SenderCredential $cred1 -ReceiverSipAddress sip:testUser2@contoso.com -ReceiverCredential $cred2 -TestUser1SipAddress sip:testUser1@contoso.com -TestUser2SipAddress sip:testUser2@contoso.com -Setup $true
```

Эта задача настройки должна быть запущена изнутри предприятия:
  
- Если запустить ее с компьютера, не являющегося сервером, пользователь, запустивший командлет должен являться членом роли CsPersistentChatAdministrators в соответствии с управлением доступом на основе ролей.
    
- Если выполнить непосредственно с самого сервера, пользователь, запустивший командлет, должен являться членом группы RTCUniversalServerAdmins.
    
### <a name="pstn-peer-to-peer-call-synthetic-transaction"></a>Искусственная транзакция однорангового вызова ТСОП

Искусственная транзакция Test-CsPstnPeerToPeerCall проверяет возможность выполнять и принимать вызовы через телефонную сеть общего доступа (ТСОП).
  
Чтобы запустить искусственную транзакцию, вы должны настроить следующие элементы:
  
- Два тестовых пользователя с поддержкой UC (вызывающий и вызываемый абонент).
    
- Прямые входные номера для каждой учетной записи пользователя.
    
- Политики VoIP и голосовые маршруты, позволяющие звонить на номер получателя, чтобы получить доступ к шлюзу PSTN.
    
- Шлюз PSTN, принимающий звонки и мультимедийные параметры, которые будут перенаправлять вызовы обратно в пул домашнего пула получателя на основе номера набора.
    
### <a name="unified-contact-store-synthetic-transaction"></a>Искусственная транзакция единой системы хранилища контактов

Виртуальная транзакция в магазине единой системы обмена сообщениями — это проверка возможности Skype для бизнеса Server получать контакты от имени пользователя Exchange.
  
Чтобы использовать эту искусственную транзакцию, следует выполнить следующие условия:
  
- необходимо настроить проверку подлинности сервер-сервер Lyss-Exchange;
    
- тестовые пользователи должны иметь допустимые почтовые ящики Exchange.
    
После того как эти условия будут выполнены, вы можете выполнить следующий командлет Windows PowerShell для миграции списка контактов тестовых пользователей в Exchange:
  
```PowerShell
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer -Setup
```

Перенос списков контактов тестового пользователя в Exchange может занять некоторое время. Для наблюдения за ходом выполнения миграции одна и та же Командная строка может выполняться без флага-Setup.
  
```PowerShell
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer
```

Данная команда будет выполнена по завершении процесса миграции.
  
### <a name="xmpp-synthetic-transaction"></a>Искусственная транзакция XMPP

Искусственная транзакция мгновенных сообщений XMPP нуждается в настройке компонента XMPP с указанием одного или нескольких федеративных доменов.
  
Чтобы включить искусственную транзакцию XMPP, необходимо предоставить параметр XmppTestReceiverMailAddress, используя учетную запись пользователя в домене XMPP с поддержкой маршрутизации. Пример:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity pool0.contoso.com -Tests @{Add="XmppIM"} -XmppTestReceiverMailAddress user1@litwareinc.com
```

В этом примере для маршрутизации сообщений для litwareinc.com на шлюз КСМПП необходимо наличие правила Skype для бизнеса сервера.

> [!NOTE]
> Шлюзы и прокси-серверы КСМПП были доступны в Skype для бизнеса Server 2015, но больше не поддерживаются в Skype для бизнеса Server 2019. Дополнительные сведения см. в статье [Перенос федерации XMPP](../migration/migrating-xmpp-federation.md).
  
### <a name="video-interop-server-vis-synthetic-transaction"></a>Искусственная транзакция сервера видеовзаимодействия

Для использования виртуальной транзакции сервера видеовзаимодействия (ВИС) необходимо загрузить и установить файлы поддержки виртуальных транзакций ([висстсуппортпаккаже. msi](https://www.microsoft.com/en-us/download/details.aspx?id=46921)). 
  
Чтобы установить VISSTSupportPackage.msi убедитесь, что зависимости для msi уже установлены (вкладка системных требований). Запустите VISSTSupportPackage.msi для выполнения простой установки. Эти файлы устанавливаются по следующему пути: "пакет поддержки виртуальных транзакций%Програмфилес%\вис".
  
Дополнительные сведения о том, как выполнить синтетическую транзакцию ВИС, можно найти в документации по командлету [Test-CsP2PVideoInteropServerSipTrunkAV](https://technet.microsoft.com/en-us/library/dn985894.aspx) .
  
## <a name="changing-the-run-frequency-for-synthetic-transactions"></a>Изменение частоты запуска искусственных транзакций
<a name="special_synthetictrans"> </a>

По умолчанию искусственные транзакции будут выполнятся для настроенных пользователей каждые 15 минут. Искусственные транзакции выполняются последователь в пределах набора пользователей с целью предотвращения конфликтов между двумя искусственными транзакциями. Для выполнения всех искусственных транзакций необходимо указать более длительный интервал времени.
  
Если искусственные транзакции необходимо выполнять чаще, количество этих выполняемых для указанного набора пользователей транзакций необходимо уменьшить, чтобы тесты могли быть завершены в рамках требуемого периода времени с наличием небольшого запаса для случайных задержек в работе сети. При необходимости выполнения большего количества искусственных транзакций создайте больше наборов пользователей для выполнения дополнительных искусственных транзакций.
  
Чтобы изменить частоту выполнения искусственных транзакций, выполните следующие действия:
  
1. Откройте System Center Operations Manager. Нажмите раздел "Создание". Выберите раздел правил (в разделе "Создание")
    
2. В разделе rules (правила) Найдите правило с именем "правило сбора основных искусственных транзакций"
    
3. Щелкните правой кнопкой мыши правило и выберите пункт переопределения, щелкните Переопределить правило, а затем выберите пункт "для всех объектов класса:" наблюдатель пула ".
    
4. В окне Переопределение свойств выберите имя параметра "частота" и задайте для свойства override (переопределение) нужное значение.
    
5. В том же окне выберите пакет управления, к которому будет применено данное переопределение
    
## <a name="using-rich-logging-for-synthetic-transactions"></a>Использование подробного журнала для искусственных транзакций
<a name="special_synthetictrans"> </a>

Искусственные транзакции доказали свою огромную пользу в рамках помощи по определению неполадок в системе. Например, командлет Test-CsRegistration может оповестить администраторов о наличии затруднений у пользователей во время регистрации в Skype для бизнеса Server. Однако для определения фактической причины неполадки могут потребоваться дополнительные сведения.
  
По этой причине искусственные транзакции предоставляют широкий набор возможностей ведения журнала. Благодаря этим возможностям для каждого активного действия искусственной транзакции записывается следующая информация:
  
- Время начала операции
    
- Время завершения операции
    
- Действие, которое было выполнено (например, создание конференции, присоединение к ней или выход, вход в Skype для бизнеса Server; отправка мгновенного сообщения)
    
- Информационные, подробные сообщения, предупреждения или сообщения об ошибках, которые были созданы при выполнении операции
    
- Сообщения о регистрации SIP
    
- Записи об исключениях или диагностические коды, созданные при выполнении операции
    
- Итоговый результат выполнения операции
    
Эта информация создается автоматически при каждом запуске искусственной транзакции, но автоматическое отображение или сохранение сведений в файл журнала не выполняется. Если вы запустили искусственную транзакцию вручную, можно использовать параметр OutLoggerVariable для указания переменной Windows PowerShell, в которой будет сохраняться информация. Затем у вас есть возможность использования одного из двух методов, позволяющих сохранять и/или просматривать полный журнал сообщений об ошибках в формате XML или HTML. 
  
Чтобы извлечь информацию об устранении неполадки, укажите параметр OutLoggerVariable с последующим именем переменной по своему выбору:
  
```PowerShell
Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com -OutLoggerVariable RegistrationTest
```

> [!NOTE]
> : Не дополняйте перед именем переменной символа $. Например, используйте имя переменной RegistrationTest, а не $RegistrationTest. 
  
При выполнении данной команды будут отображены следующие выходные данные:
  
Целевое полное доменное имя: atl-cs-001.litwareinc.com: задержка сбоя: 00:00:00 сообщение об ошибке: у этого компьютера нет назначенных сертификатов. Диагностика: вы можете получить доступ к значительно более подробным сведениям об этой ошибке, чем сообщение об ошибке, показанное здесь. Для получения доступа к этой информации в формате HTML используйте команду, аналогичную этой, чтобы сохранить данные, хранящиеся в переменной RegistrationTest, в файл HTML:
  
```PowerShell
$RegistrationTest.ToHTML() | Out-File C:\Logs\Registration.html
```

Можно также использовать метод ToXML() для сохранения данных в файл XML:
  
```PowerShell
$RegistrationTest.ToXML() | Out-File C:\Logs\Registration.xml
```

Эти файлы затем можно просматривать с помощью Windows Internet Explorer, Microsoft Visual Studio или любого другого приложения, поддерживающего открытие файлов HTML/XML.
  
Синтетические транзакции, выполненные из системы System Center Operations Manager, будут автоматически создавать эти файлы журнала для сбоев. Эти журналы не будут созданы, если сбой выполнения произойдет до того, как PowerShell Skype для бизнеса Server загрузит и запустит искусственную транзакцию. 
  
> [!IMPORTANT]
> По умолчанию в Skype для бизнеса Server сохраняются файлы журнала в папке, к которой не предоставлен общий доступ. Чтобы сделать эти журналы общедоступными, вы должны поделиться этой папкой. Пример: \\ATL-Watch-001. плана litwareinc. ком\ватчерноде. 
