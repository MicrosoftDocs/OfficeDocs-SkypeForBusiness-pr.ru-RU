---
title: Настройка тестовых пользователей и параметров узлов просмотра
ms.reviewer: ''
ms.author: v-mahoffman
author: cichur
manager: serdars
ms.date: 2/13/2018
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
description: Настройка тестовых учетных записей пользователей и параметров узлов просмотра для Skype для бизнеса Server синтетических транзакций.
ms.openlocfilehash: f0f997ebcbb3c663fa9a63ac3060f476d627ef4f
ms.sourcegitcommit: 65a10f80e5dfd67b2778e09f5f92c21ef09ce36a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2021
ms.locfileid: "60746385"
---
# <a name="skype-for-business-server-configure-watcher-node-test-users-and-settings"></a>Skype для бизнеса Server: Настройка тестовых пользователей и параметров узла просмотра
 
**Сводка:** Настройка тестовых учетных записей пользователей и параметров узлов просмотра для Skype для бизнеса Server синтетических транзакций.
  
Настроив компьютер, который будет выступать в качестве узла-наблюдателя, выполните следующие действия.
  
1. [Настройте тестовые учетные записи](test-users-and-settings-2019.md#testuser) пользователей, которые будут использоваться этими узлами просмотра. Если вы используете проверку подлинности согласованием, вам также необходимо выполнить командлет **Set-CsTestUserCredential**, чтобы разрешить использование этих учетных записей узлом-наблюдателем.
    
2. Обновите параметры конфигурации узла-наблюдателя.
    
## <a name="configure-test-user-accounts"></a>Настройка учетных записей тестовых пользователей
<a name="testuser"> </a>

Тестовые учетные записи не должны представлять реальных людей, но они должны быть действительными учетными записями Active Directory. Кроме того, эти учетные записи должны быть включены для Skype для бизнеса Server, у них должны быть действительные SIP-адреса, и они должны быть включены для Корпоративная голосовая связь (для использования Test-CsPstnPeerToPeerCall синтетической транзакции). 
  
Если вы используете метод проверки подлинности TrustedServer, все, что вам нужно сделать, это убедиться, что эти учетные записи существуют и настроить их, как отмечено. Назначьте по крайней мере трех тестовых пользователей для каждого пула, который необходимо протестировать. Если используется метод проверки подлинности Negotiate, необходимо также использовать Set-CsTestUserCredential и Skype для бизнеса Server management Shell, чтобы эти тестовые учетные записи могли работать с синтетическими транзакциями. Делайте это, запуская команду, аналогичную следующей (эти команды предполагают, что были созданы три учетные записи пользователей Active Directory и что эти учетные записи включены для Skype для бизнеса Server):
  
```PowerShell
Set-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com" -UserName "litwareinc\watcher1" -Password "P@ssw0rd"
Set-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com" -UserName "litwareinc\watcher2" -Password "P@ssw0rd"
Set-CsTestUserCredential -SipAddress "sip:watcher3@litwareinc.com" -UserName "litwareinc\watcher3" -Password "P@ssw0rd"
```

Включайте не только SIP-адрес, но и имя пользователя и пароль. Если пароль не включен, Set-CsTestUserCredential будет предложено ввести эту информацию. Имя пользователя можно укаварить с помощью формата имя домена\имя пользователя, показанного в предыдущем блоке кода.
  
Чтобы убедиться в том, что тестовые учетные данные пользователей были созданы, запустите эти команды из Skype для бизнеса Server Командная оболочка:
  
```PowerShell
Get-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com"
Get-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com"
Get-CsTestUserCredential -SipAddress "sip:watcher3@litwareinc.com"
```

Сведения, аналогичные этому, будут возвращены каждому пользователю:
  
|**UserName**|**Password**|
|:-----|:-----|
|Litwareinc\watcher1  <br/> |System.Security.SecureString  <br/> |
   
### <a name="configure-a-basic-watcher-node-with-the-default-synthetic-transactions"></a>Настройка базового узла для просмотра с помощью синтетических транзакций по умолчанию

После создания тестовых пользователей можно создать узел просмотра с помощью команды, похожей на эту:
  
```PowerShell
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"}
```

Эта команда создает узел-наблюдатель с параметрами по умолчанию, который выполняет набор искусственных транзакций по умолчанию. Для нового узла-наблюдателя используются тестовые пользователи watcher1@litwareinc.com, watcher2@litwareinc.com и watcher3@litwareinc.com. Если узел просмотра использует проверку подлинности TrustedServer, эти три тестовые учетные записи могут быть любыми допустимой учетной записью пользователя, включенной для Active Directory и Skype для бизнеса Server. Если узел просмотра использует метод проверки подлинности Negotiate, эти учетные записи пользователей также должны быть включены для узла просмотра с помощью Set-CsTestUserCredential cmdlet.
  
Чтобы проверить, что автоматическое обнаружение целевого пула для регистрации настроено правильно, а не нацелившись непосредственно на пул, используйте следующие действия:
  
```PowerShell
New-CsWatcherNodeConfiguration -UseAutoDiscovery $true -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"}
```

### <a name="configuring-extended-tests"></a>Настройка расширенных тестов

Если вы хотите включить тест PSTN, который проверяет подключение к сети общедоступных телефонных подключений, необходимо сделать еще несколько конфигураций при настройке узла просмотра. Сначала необходимо связать тестовых пользователей с типом тестирования PSTN, запуская команду, аналогичную этой, из Skype для бизнеса Server management Shell:
  
```PowerShell
$pstnTest = New-CsExtendedTest -TestUsers "sip:watcher1@litwareinc.com", "sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"  -Name "Contoso Provider Test" -TestType PSTN
```

> [!NOTE]
> Результаты этой команды должны храниться в переменной. В этом примере переменная называется $pstnTest. 
  
Далее можно использовать комлет **New-CsWatcherNodeConfiguration,** чтобы связать тип теста (хранимый в переменной $pstnTest) с Skype для бизнеса Server пулом. Например, следующая команда создает новую конфигурацию узла просмотра для пула atl-cs-001.litwareinc.com, добавляя трех тестовых пользователей, созданных ранее, и добавляя тип теста PSTN:
  
```PowerShell
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com", "sip:watcher3@litwareinc.com"} -ExtendedTests @{Add=$pstnTest}
```

При не установке основных Skype для бизнеса Server и базы данных RTCLocal на компьютере узла просмотра предыдущей команды сбой. 
  
Чтобы протестировать несколько голосовых политик, можно создать расширенный тест для каждой политики с помощью cmdlet **New-CsExtendedTest.** Предоставленные пользователи должны быть настроены с помощью нужных голосовых политик. Расширенные тесты передаются в **cmdlet New-CsWatcherNodeConfiguration** с помощью запятой-делимитеров, таких как:
  
-ExtendedTests @{Add=$pstnTest 1,$pstnTest 2,$pstnTest 3}
  
Так как кодлет **New-CsWatcherNodeConfiguration** был вызван без использования параметра Tests, для нового узла просмотра будут включены только синтетические транзакции по умолчанию (и указанная расширенная синтетическая транзакция). Таким образом, узел просмотра будет тестировать следующие компоненты:
  
- Регистрация
    
- "IM" (Обмен мгновенными сообщениями);
    
- GroupIM
    
- P2PAV (одноранговые аудио- и видеосеансы)
    
- AvConference (аудио- и видеоконференции)
    
- Присутствие
    
- ABS (служба адресной книги)
    
- ABWQ (веб-служба адресной книги)
    
Следующие компоненты не будут протестироваться по умолчанию:
  
- ASConference
    
- AVEdgeConnectivity
    
- DataConference
    
- DialinConferencing
    
- ExumConnectivity (единая система обмена сообщениями Exchange)
    
- JoinLauncher
    
- MCXP2PIM (устаревший обмен мгновенными сообщениями на мобильных устройствах)
    
- P2PVideoInteropServerSipTrunkAV
    
- PersistentChatMessage
    
- PSTN (вызовы шлюза PSTN, указанные в качестве расширенного теста)
    
- UcwaConference
    
- UnifiedContactStore
    
- XmppIM
    
### <a name="adding-and-removing-synthetic-transactions"></a>Добавление и удаление искусственных транзакций

После настройки узла-наблюдателя вы можете добавлять искусственные транзакции на узел-наблюдатель или удалять их с узла-наблюдателя с помощью командлета Set-CsWatcherNodeConfiguration. Например, чтобы добавить тест PersistentChatMessage на узел-наблюдатель, используйте следующую команду с методом Add.
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage"}
```

При указании нескольких тестов используйте запятые. Пример:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage","DataConference","UnifiedContactStore"}
```

Ошибка будет возникать, если один или несколько из этих тестов (например, DataConference) уже включены в узел просмотра. В этом случае вы получите сообщение об ошибке, аналогичное следующему сообщению:
  
Set-CsWatcherNodeConfiguration. Существует дублирующая последовательность ключей "DataConference" для "urn:schema:Microsoft.Rtc.Management". Параметры. Клавиша WatcherNode.2010:TestName или уникальное ограничение удостоверений.
  
Если произошла эта ошибка, изменения не применяются. Команду следует выполнить повторно, удалив повторяющийся тест.
  
Чтобы удалить синтетическую транзакцию из узла просмотра, используйте метод Remove. Например, следующая команда удаляет тест ABWQ с узла-наблюдателя.
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Remove="ABWQ"}
```

Вы можете использовать метод Replace, чтобы заменить все тесты, включенные в настоящее время, одним или более новыми тестами. Например, если вы хотите, чтобы узел просмотра только запускал тест im, вы можете настроить его с помощью этой команды:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Replace="IM"}
```

При запуске этой команды все синтетические транзакции на указанном узле просмотра будут отключены, за исключением im.
  
### <a name="viewing-and-testing-the-watcher-node-configuration"></a>Просмотр и тестирование конфигурации узла-наблюдателя

Если необходимо просмотреть тесты, назначенные узлу просмотра, используйте команду, аналогичную этой:
  
```PowerShell
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests
```

Эта команда возвращает сведения, аналогичные следующей, в зависимости от синтетической транзакции, назначенной узлу:
  
Регистрация IM GroupIM P2PAV AvConference Presence PersistentChatMessage DataConference
> [!TIP]
> Чтобы просмотреть искусственные транзакции в алфавитном порядке, используйте следующую команду. 
  
```PowerShell
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests | Sort-Object
```

Чтобы убедиться в том, что узел просмотра создан, введите следующую команду из Skype для бизнеса Server Командная оболочка:
  
```PowerShell
Get-CsWatcherNodeConfiguration
```

Вы получите сведения, похожие на эту:
  
Identity : atl-cs-001.litwareinc.com TestUsers: {sip:watcher1@litwareinc.com, sip:watcher2@litwareinc.com...} ExtendedTests: {TestUsers=IList<System.String>; Тест Name=PSTN; Te...} TargetFqdn : atl-cs-001.litwareinc.com PortNumber : 5061To убедитесь, что узел просмотра был настроен правильно, введите следующую команду из Skype для бизнеса Server Командная оболочка:
  
```PowerShell
Test-CsWatcherNodeConfiguration
```

Эта команда протестировать каждый узел просмотра в развертывании и проверить, завершены ли следующие действия:
  
- Установлена роль обязательного регистратора
    
- Создается необходимый ключ реестра (завершаемая при Set-CsWatcherNodeConfiguration)
    
- На серверах запущена правильная версия Skype для бизнеса Server
    
- Порты настроены правильно
    
- Назначенные тестовые пользователи имеют необходимые учетные данные
    
## <a name="managing-watcher-nodes"></a>Управление узлами-наблюдателями
<a name="testuser"> </a>

Кроме изменения синтетических транзакций, которые выполняются на узле просмотра, вы также можете использовать комлет **Set-CsWatcherNodeConfiguration** для выполнения двух других важных задач: включения и отключения узла просмотра и настройки узла просмотра для использования внутренних URL-адресов веб-сайтов или внешних ВЕБ-адресов при выполнении тестов.
  
По умолчанию узлы-наблюдатели периодически запускают все включенные искусственные транзакции. Однако иногда может потребоваться приостановить эти транзакции. Например, если узел-наблюдатель временно отключился от сети, у него больше нет причин запускать искусственные транзакции. Без подключения к сети эти транзакции не будут работать. Чтобы временно отключить узел просмотра, запустите команду, аналогичную этой, из командной Skype для бизнеса Server:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $False
```

Эта команда отключит выполнение синтетических транзакций в сторожевом узле atl watcher 001.litwareinc.com. Чтобы возобновить выполнение искусственных транзакций, снова задайте для свойства Enabled значение True ($True):
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $True
```

> [!NOTE]
> Свойство Enabled может использоваться для включения или отключения узлов-наблюдателей. Если нет необходимости временно удалять узел-наблюдатель, используйте командлет **Remove-CsWatcherNodeConfiguration**:
  
```PowerShell
Remove-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com"
```

Эта команда удаляет все параметры конфигурации узла просмотра с указанного компьютера, что не позволяет компьютеру автоматически запускать синтетические транзакции. Однако команда не будет удалить файлы System Center агентов или Skype для бизнеса Server системных файлов.
  
По умолчанию узлы просмотра используют внешние веб-URL-адреса организации при проведении тестов. Однако узлы для просмотра также можно настроить для использования внутренних веб-URL-адресов организации. Это позволит администраторам проверить доступ к URL-адресам тех пользователей, которые находятся внутри сети периметра. Чтобы настроить узел просмотра для использования внутренних URL-адресов вместо внешних URL-адресов, установите свойство UseInternalWebURls true ($True):
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $True
```

Сброс этого свойства к значению false ($False) приведет к тому, что он снова будет использовать внешние URL-адреса:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $False
```

## <a name="special-setup-instructions-for-synthetic-transactions"></a>Специальные инструкции по установке для искусственных транзакций
<a name="special_synthetictrans"> </a>

Большинство синтетических транзакций может работать на узле просмотра как есть. В большинстве случаев, как только синтетическая транзакция добавляется в параметры конфигурации узла просмотра, узел просмотра может приступить к использованию этой синтетической транзакции во время ее тестовых пропусков. Однако существуют некоторые синтетические транзакции, которые требуют специальных инструкций по настройке, как это было рассмотрено в следующих разделах.
  
### <a name="data-conferencing-synthetic-transaction"></a>Синтетическая транзакция для конференций данных

Если ваш узел просмотра находится за пределами сети периметра, вы, вероятно, не сможете выполнить синтетическую транзакцию по конференции данных, если сначала не отключите параметры прокси-сервера Windows Internet Explorer® прокси-сервера интернет-браузера для учетной записи сетевой службы, завершив следующие действия:
  
1. На компьютере узла просмотра нажмите кнопку **Начните,** нажмите кнопку Все **программы,** щелкните Аксессуары, щелкните правой кнопкой **Командная** подсказка, а затем нажмите **кнопку Запустить в качестве администратора**.
    
2. В окне консоли введите следующую команду и нажмите кнопку ENTER. 
    
```PowerShell
bitsadmin /util /SetIEProxy NetworkService NO_PROXY
```

В окне команды отображается следующее сообщение:
  
BITSAdmin является обесценителем и не гарантируется, что будет доступен в будущих версиях Windows. Средства администрирования для службы BITS теперь предоставлены cmdlets BITS PowerShell.
  
Параметры прокси-сервера в Интернете для учетной записи NetworkService NO_PROXY. 
  
(подключение = по умолчанию)
  
В этом сообщении указывается, что вы отключили параметры прокси-сервера Internet Explorer для учетной записи сетевой службы.
  
### <a name="exchange-unified-messaging-synthetic-transaction"></a>Exchange Синтетическая транзакция единой системы обмена сообщениями

Синтетическая транзакция Exchange единой системы обмена сообщениями проверяет, что тестовые пользователи могут подключаться к учетным записям голосовой почты, которые Exchange.
  
Тестовые пользователи должны быть предварительно сконфигурированы с учетными записями голосовой почты. 
  
### <a name="persistent-chat-synthetic-transaction"></a>Сохраняемая синтетическая транзакция чата

Чтобы использовать синтетическую транзакцию Persistent Chat, сначала необходимо создать канал и предоставить тестующих пользователей разрешения на его использование.
  
Для настройки этого канала можно использовать синтетическую транзакцию Persistent Chat: 
  
```PowerShell
$cred1 = Get-Credential "contoso\testUser1"
$cred2 = Get-Credential "contoso\testUser2"

Test-CsPersistentChatMessage -TargetFqdn pool0.contoso.com -SenderSipAddress sip:testUser1@contoso.com -SenderCredential $cred1 -ReceiverSipAddress sip:testUser2@contoso.com -ReceiverCredential $cred2 -TestUser1SipAddress sip:testUser1@contoso.com -TestUser2SipAddress sip:testUser2@contoso.com -Setup $true
```

Запустите эту задачу установки изнутри предприятия:
  
- Если выполняется с несерверной машины, пользователь, который выполняет этот код, должен быть членом роли CsPersistentChatAdministrators для Role-Based управления доступом (RBAC).
    
- При запуске с самого сервера пользователь, который выполняет этот код, должен быть членом группы RTCUniversalServerAdmins.
    
### <a name="pstn-peer-to-peer-call-synthetic-transaction"></a>Синтетическая транзакция PSTN одноранговых вызовов

Синтетическая транзакция Test-CsPstnPeerToPeerCall проверяет возможность разместить и принимать вызовы через общедоступные телефонные сети с переключениями (PSTN).
  
Чтобы выполнить эту синтетическую транзакцию, необходимо настроить:
  
- Два тестовых пользователя с поддержкой UC (вызываемая и приемная).
    
- Прямые входные номера для каждой учетной записи пользователя.
    
- Политики VoIP и маршруты голосовой почты, позволяющие вызовам на номер приемного телефона достичь шлюза PSTN.
    
- Шлюз PSTN, который принимает вызовы и носители, которые будут маршрутить вызовы обратно в домашний пул приемник в зависимости от набраного номера.
    
### <a name="unified-contact-store-synthetic-transaction"></a>Синтетическая транзакция Единого магазина контактов

Синтетическая транзакция Единого магазина контактов проверяет возможность Skype для бизнеса Server для получения контактов от имени пользователя из Exchange.
  
Чтобы использовать эту искусственную транзакцию, следует выполнить следующие условия:
  
- Lyss-Exchange сервер для проверки подлинности сервера необходимо настроить.
    
- Тестовые пользователи должны иметь допустимый Exchange почтовый ящик.
    
После того как эти условия будут выполнены, можно выполнить следующий Windows PowerShell для переноса списков контактов тестовых пользователей на Exchange:
  
```PowerShell
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer -Setup
```

Может потребоваться некоторое время, чтобы списки контактов тестовых пользователей мигрировали в Exchange. Чтобы отслеживать ход миграции, можно выполнить ту же командную строку без флага -Setup:
  
```PowerShell
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer
```

Эта командная строка завершится успешно после завершения миграции.
  
### <a name="xmpp-synthetic-transaction"></a>Синтетическая транзакция XMPP

Синтетическая транзакция по синтетическому протоколу обмена сообщениями и присутствия (XMPP) требует настройки функции XMPP с одним или более федерационными доменами.
  
Чтобы включить синтетическую транзакцию XMPP, необходимо предоставить параметр XmppTestReceiverMailAddress с учетной записью пользователя в маршрутивом домене XMPP. Например:
  
```PowerShell
Set-CsWatcherNodeConfiguration -Identity pool0.contoso.com -Tests @{Add="XmppIM"} -XmppTestReceiverMailAddress user1@litwareinc.com
```

В этом примере необходимо Skype для бизнеса Server, чтобы маршрутить сообщения для litwareinc.com к шлюзу XMPP.

> [!NOTE]
> Шлюзы и прокси XMPP были доступны в Skype для бизнеса Server 2015 г., но больше не поддерживаются Skype для бизнеса Server 2019 г. Дополнительные сведения см. в дополнительных сведениях о переносе федерации [XMPP.](../migration/migrating-xmpp-federation.md)
  
### <a name="video-interop-server-vis-synthetic-transaction"></a>Синтетическая транзакция Video Interop Server (VIS)

Синтетическая транзакция Video Interop Server (VIS) требует скачивания и установки файлов поддержки синтетических[ транзакций (VISSTSupportPackage.msi). ](https://www.microsoft.com/download/details.aspx?id=46921) 
  
Чтобы установить VISSTSupportPackage.msi, убедитесь, что зависимости (в соответствии с требованиями системы) для msi уже установлены. Запустите VISSTSupportPackage.msi, чтобы выполнить простую установку. В .msi устанавливается все файлы в следующем пути: "%ProgramFiles%\VIS Пакет поддержки синтетических транзакций".
  
Дополнительные сведения о запуске синтетической транзакции VIS см. в документации для cmdlet [Test-CsP2PVideoInteropServerSipTrunkAV.](/powershell/module/skype/Test-CsP2PVideoInteropServerSipTrunkAV)
  
## <a name="changing-the-run-frequency-for-synthetic-transactions"></a>Изменение частоты запуска для синтетических транзакций
<a name="special_synthetictrans"> </a>

По умолчанию синтетические транзакции будут запускаться с настроенными пользователями каждые 15 минут. Синтетические транзакции последовательно запускаются в наборе пользователей, чтобы избежать конфликта двух синтетических транзакций друг с другом. Для обеспечения времени выполнения всех синтетических транзакций требуется более длительный интервал.
  
Если желательно чаще запускать синтетические транзакции, количество синтетических транзакций, запускаемых с заданным набором пользователей, должно быть уменьшено, чтобы тесты могли завершиться в нужном диапазоне времени с некоторым буфером для случайных задержек сети. Если желательно выполнить больше синтетических транзакций, создайте больше наборов пользователей, чтобы запускать больше синтетических транзакций.
  
Чтобы изменить частоту запуска синтетических транзакций, выполните следующие действия:
  
1. Откройте System Center диспетчер операций. Щелкните Раздел Авторинг. Щелкните раздел Правила (в разделе Авторство)
    
2. В разделе Правила найдите правило с именем "Главное правило сбора производительности бегуна синтетических транзакций"
    
3. Щелкните правой кнопкой мыши правило и выберите переопределения, выберите переопределять правило, а затем выберите "Для всех объектов класса: наблюдатель пула"
    
4. В окне Override Properties выберите имя параметра "Частота" и установите значение Переопределения к нужному.
    
5. В том же окне выберите пакет Управления, к которому необходимо применить этот переопределения
    
## <a name="using-rich-logging-for-synthetic-transactions"></a>Использование подробного журнала для искусственных транзакций
<a name="special_synthetictrans"> </a>

Синтетические транзакции полезны для выявления проблем с системой. Например, этот Test-CsRegistration может предупредить администраторов о том, что пользователям сложно зарегистрировать Skype для бизнеса Server. Однако для определения фактической причины сбоя могут потребоваться дополнительные сведения.
  
По этой причине синтетические транзакции обеспечивают богатый журнал. При богатом журнале для каждого действия, которое проводит синтетическая транзакция, записывают следующие сведения:
  
- Время начала действия.
    
- Время завершения действия.
    
- Выполненное действие (например, создание, присоединение или выход из конференции; вход в Skype для бизнеса Server; отправка мгновенных сообщений).
    
- Информационные, подробные сообщения, предупреждения или сообщения об ошибках, которые были созданы при выполнении операции
    
- Сообщения регистрации SIP.
    
- Записи исключений или диагностические коды, созданные при действии.
    
- Чистый результат запуска действия.
    
Эти сведения автоматически создаются при каждом запуске синтетической транзакции, но не отображаются автоматически и не сохраняются в файле журнала. При ручном управлении синтетической транзакцией можно использовать параметр OutLoggerVariable, чтобы указать переменную Windows PowerShell, в которой будут храниться сведения. Оттуда можно использовать один из двух методов для сохранения и/или просмотра сообщений об ошибках в богатом журнале в формате XML или HTML. 
  
Чтобы получить сведения о устранении неполадок, укажите параметр OutLoggerVariable, за которым следует переменное имя, которое вы выберете:
  
```PowerShell
Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com -OutLoggerVariable RegistrationTest
```

> [!NOTE]
> : Не предисловие переменного имени с символом $. Используйте переменное имя, например RegistrationTest (не $RegistrationTest). 
  
При запуске этой команды вы увидите выход, похожий на этот:
  
Целевой Fqdn : atl-cs-001.litwareinc.com результат : Задержка сбоя : 00:00:00 Сообщение об ошибке: эта машина не имеет никаких присвоенных сертификатов. Диагностика: Вы можете получить доступ к гораздо более подробным сведениям для этой ошибки, чем просто сообщение об ошибке, показанное здесь. Чтобы получить доступ к этим сведениям в формате HTML, используйте команду, аналогичную этой, чтобы сохранить сведения, хранимые в переменной RegistrationTest для HTML-файла:
  
```PowerShell
$RegistrationTest.ToHTML() | Out-File C:\Logs\Registration.html
```

Можно также использовать метод ToXML() для сохранения данных в файл XML:
  
```PowerShell
$RegistrationTest.ToXML() | Out-File C:\Logs\Registration.xml
```

Эти файлы можно просмотреть с помощью Windows Internet Explorer, Microsoft Visual Studio или любого другого приложения, способного открывать HTML/XML-файлы.
  
Синтетические транзакции, которые запускаются из System Center диспетчера операций, автоматически генерируют эти файлы журналов для сбоев. Эти журналы не будут созданы, если выполнение не удастся выполнить до Skype для бизнеса Server PowerShell сможет загрузить и запустить синтетическую транзакцию. 
  
> [!IMPORTANT]
> По умолчанию Skype для бизнеса Server сохраняет файлы журналов в папку, которая не является общей. Чтобы сделать эти журналы доступными, следует поделиться этой папкой. Например: \\ atl-watcher-001.litwareinc.com\WatcherNode.
