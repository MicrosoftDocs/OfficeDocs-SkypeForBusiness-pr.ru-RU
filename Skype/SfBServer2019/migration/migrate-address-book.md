---
title: Перенос адресной книги
ms.reviewer: ''
ms.author: serdars
author: serdarsoysal
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
description: 'В общем, адресная книга переносится вместе с остальной частью топологии. Однако вам может потребоваться выполнить некоторые действия после миграции, если вы настроили следующие действия в устаревшей среде:'
ms.openlocfilehash: 19ff3b0ca389832cfb2b1739aeb85738c30238576143d3542388fd1ef97a6498
ms.sourcegitcommit: a17ad3332ca5d2997f85db7835500d8190c34b2f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/05/2021
ms.locfileid: "54306222"
---
# <a name="migrate-address-book"></a>Перенос адресной книги

В общем, адресная книга переносится вместе с остальной частью топологии. Однако вам может потребоваться выполнить некоторые действия после миграции, если вы настроили следующие действия в устаревшей среде: 

- настроили правила нормализации адресной книги;

- изменили значение по умолчанию параметра **UseNormalizationRules** на False. 


 **Правила нормализации адресной книги**

Если вы настраивали правила нормализации адресной книги в устаревшей среде, необходимо перенести настроенные правила в пилотный пул. Если вы не настраивали правила нормализации адресной книги, то ничего переносить не требуется. Правила нормализации по умолчанию для Skype для бизнеса Server 2019 г. такие же, как и правила по умолчанию для устаревшей установки. Чтобы перенести настроенные правила нормализации, выполните инструкции, приведенные далее в этом разделе.

> [!NOTE]
> Если в вашей организации используется удаленное управление звонками и вы настроили правила нормализации адресной книги, то прежде чем использовать удаленное управление звонками, вам нужно выполнить инструкции, приведенные в этом разделе. Для их выполнения необходимо быть членом группы RTCUniversalServerAdmins или иметь аналогичные права. 

 **Параметр UseNormalizationRules со значением False**

Если для **UseNormalizationRules** задано значение False, чтобы пользователи могли использовать телефонные номера так, как они определены в службах домена Active Directory без применения правил нормализации Skype для бизнеса Server 2019 г., необходимо установить **параметры UseNormalizationRules** и **IgnoreGenericRules** для True. Для этого выполните инструкции, приведенные далее в этом разделе. 

## <a name="to-migrate-address-book-customized-normalization-rules"></a>Перенос настроенных правил нормализации адресной книги

1. Найдите файл Company_Phone_Number_Normalization_Rules.txt в корне общей папки адресной книги и скопируйте его в корне общей папки адресной книги в пилотном пуле Skype для бизнеса Server 2019 г.

    > [!NOTE]
    > Образцы правил нормализации адресной книги установлены в каталоге, содержащем файлы веб-компонента службы адресной книги. Путь **$installedDriveLetter:\Program Files\Microsoft Skype для бизнеса Server 2019\Web Components\Address Book Files\Files\Sample_Company_Phone_Number_Normalization_Rules.txt**. Этот файл можно скопировать и  переименоватьCompany_Phone_Number_Normalization_Rules.txtв корневой каталог общей папки адресной книги. Например, адресная книга, общая в **$serverX,** будет похожа на: **\\ $serverX \SkypeForBusiness-FileShare\2-WebServices-1\ABFiles**. 

2. Откройте файл Company_Phone_Number_Normalization_Rules.txt с помощью текстового редактора, например Блокнота.

3. Некоторые типы записей не будут работать правильно в Skype для бизнеса Server 2019 г. Просмотрите файл, чтобы найти записи такого типа, измените их требуемым образом и сохраните изменения в общей папке адресной книги в пилотном пуле.

    Строки, содержащие обязательный пробел или знак пунктуации, приведут к сбою правила нормализации, поскольку эти символы удаляются из строки при ее вводе в правило. Если у вас есть строки с обязательным пробелом или знаком пунктуации, их нужно изменить. Например, следующая строка приведет к сбою правила нормализации.

   ```console
   \s*\(\s*\d\d\d\s*\)\s*\-\s*\d\d\d\s*\-\s*\d\d\d\d
   ```

    Следующая строка не приведет к сбою правила нормализации.

   ```console
   \s*\(?\s*\d\d\d\s*\)?\s*\-?\s*\d\d\d\s*\-?\s*\d\d\d\d
   ```

## <a name="to-set-usenormalizationrules-and-ignoregenericrules-to-true"></a>Задание значения True для параметров UseNormalizationRules и IgnoreGenericRules

1. Запустите Skype для бизнеса Server: нажмите кнопку Начните, нажмите кнопку Все **программы,** нажмите **Microsoft Skype для бизнеса Server 2019,** а затем нажмите кнопку **Skype для бизнеса Server управленческой оболочки**.

2. Выполните одно из указанных ниже действий.

   - Если развертывание включает только Skype для бизнеса Server 2019 г., запустите следующий cmdlet на глобальном уровне, чтобы изменить значения **для UseNormalizationRules** и **IgnoreGenericRules** на True: 

   ```PowerShell
   Set-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
   ```

   - Если развертывание включает сочетание Skype для бизнеса Server 2019 и устаревшей установки, запустите следующий cmdlet и назначьте его каждому пулу Skype для бизнеса Server 2019 г. в топологии:

   ```PowerShell
   New-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
   ```

3. Подождите, пока репликация магазина центра управления будет происходить во всех пулах.

4. Очистите содержимое файла правил нормализации телефонов (Company_Phone_Number_Normalization_Rules.txt) для развертывания. Файл находится в файле каждого пула Skype для бизнеса Server 2019 года. Если файл отсутствует, создайте пустой файл с именем Company_Phone_Number_Normalization_Rules.txt.

5. Подождите несколько минут, пока для всех интерфейсных пулов не будут прочитаны новые файлы.

6. Запустите следующий cmdlet на каждом пуле Skype для бизнеса Server 2019 в развертывании:

   ```PowerShell
   Update-CsAddressBook
   ```


