---
title: Перенос адресной книги
ms.reviewer: ''
ms.author: kenwith
author: kenwith
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
localization_priority: Normal
description: В общем случае адресная книга переносится вместе с оставшейся частью вашей топологии. Однако вам может потребоваться выполнить некоторые действия после миграции, если в устаревшей среде были настроены указанные ниже компоненты.
ms.openlocfilehash: 8c8e66a8182890ee6e3673769ddc620bb04404c6
ms.sourcegitcommit: 2cc98fcecd753e6e8374fc1b5a78b8e3d61e0cf7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2020
ms.locfileid: "40990104"
---
# <a name="migrate-address-book"></a>Перенос адресной книги

В общем случае адресная книга переносится вместе с оставшейся частью вашей топологии. Однако вам может потребоваться выполнить некоторые действия после миграции, если в устаревшей среде были настроены указанные ниже компоненты. 

- Настроены правила нормализации адресных книг.

- Изменение значения по умолчанию для параметра **усенормализатионрулес** на false. 


 **Правила нормализации адресных книг**

Если вы настроили правила нормализации адресных книг в устаревшей среде, необходимо перенести настроенные правила в свой проект пилотного пула. Если вы не настраиваете правила нормализации адресных книг, вы не можете выполнить миграцию для службы адресной книги. Правила нормализации по умолчанию для Skype для бизнеса Server 2019 совпадают с правилами по умолчанию для установленной версии. Выполните действия, описанные ниже в этом разделе, чтобы перенести настраиваемые правила нормализации.

> [!NOTE]
> Если в вашей организации используется удаленное управление звонками и настроены правила нормализации адресных книг, необходимо выполнить описанные ниже действия, прежде чем можно будет использовать удаленное управление звонками. Процедура требует членства в группе Рткуниверсалсерверадминс или эквивалентных прав. 

 **Для Усенормализатионрулес задано значение false**

Если задать для **усенормализатионрулес** значение false, чтобы пользователи могли использовать номера телефонов, определенные в доменных службах Active Directory, не имея в Skype для бизнеса Server 2019 применение правил нормализации, необходимо задать для параметров **Усенормализатионрулес** и **игнореженерикрулес** значение true. Выполните действия, описанные ниже в этом разделе, чтобы установить для этих параметров значение true. 

## <a name="to-migrate-address-book-customized-normalization-rules"></a>Миграция настроенных правил нормализации в адресной книге

1. Найдите файл Company_Phone_Number_Normalization_Rules. txt в корне общей папки адресной книги и скопируйте его в корневой каталог общей папки адресной книги в корпоративном пуле Skype для бизнеса Server 2019.

    > [!NOTE]
    > Примеры правил нормализации адресных книг установлены в каталог файлов веб-компонентов ABS. Путь — это **$installedDriveLetter: \Program Files\Microsoft Skype для бизнеса Server 2019 \ Web Компонентс\аддресс Book филес\филес\ Sample_Company_Phone_Number_Normalization_Rules. txt**. Этот файл можно скопировать и переименовать как **Company_Phone_Number_Normalization_Rules. txt** в корневой каталог общей папки адресной книги. Например, адресная книга, доступная в **$serverX**, будет выглядеть примерно так: ** \\$serverX \SkypeForBusiness-FileShare\2-WebServices-1\ABFiles**. 

2. Откройте файл Company_Phone_Number_Normalization_Rules. txt с помощью текстового редактора, например Блокнота.

3. Некоторые типы записей не будут правильно работать в Skype для бизнеса Server 2019. Просмотрите файл на предмет типов записей, описанных в этом шаге, внесите необходимые изменения и сохраните изменения в общей папке адресной книги в вашем пилотном пуле.

    Строки, содержащие требуемый пробел или знаки препинания, приводят к сбою правил нормализации, так как эти символы удаляются из строки, вводимой в правила нормализации. Если у вас есть строки, содержащие необходимые пробелы или знаки препинания, необходимо изменить строки. Например, следующая строка может привести к сбою правила нормализации:

   ```
   \s*\(\s*\d\d\d\s*\)\s*\-\s*\d\d\d\s*\-\s*\d\d\d\d
   ```

    Следующая строка не приводила к сбою правила нормализации:

   ```
   \s*\(?\s*\d\d\d\s*\)?\s*\-?\s*\d\d\d\s*\-?\s*\d\d\d\d
   ```

## <a name="to-set-usenormalizationrules-and-ignoregenericrules-to-true"></a>Чтобы установить для Усенормализатионрулес и Игнореженерикрулес значение true,

1. Запустите консоль управления в Skype для бизнеса Server: нажмите кнопку **Пуск**, выберите пункт **все программы**, а затем — **Microsoft Skype для бизнеса Server 2019**, а затем — **Командная консоль управления Skype для бизнеса Server**.

2. Выполните одно из следующих действий:

   - Если в развертывании есть только Skype для бизнеса Server 2019, выполните следующий командлет на глобальном уровне, чтобы изменить значения **усенормализатионрулес** и **игнореженерикрулес** на true: 

   ```PowerShell
   Set-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
   ```

   - Если в развертывании есть сочетание Skype для бизнеса Server 2019 и устаревшая установка, запустите следующий командлет и назначьте его каждому из пулов Skype для Business Server 2019 в топологии.

   ```PowerShell
   New-CsAddressBookConfiguration -identity <XdsIdentity> -UseNormalizationRules=$true -IgnoreGenericRules=$true
   ```

3. Дождитесь, когда репликация хранилища центрального управления будет выполняться на всех пулах.

4. Измените файл правил нормализации телефона в разделе "Company_Phone_Number_Normalization_Rules. txt" для развертывания, чтобы очистить содержимое. Этот файл находится в общей папке каждого пула 2019 в Skype для бизнеса Server. Если файл не отображается, создайте пустой файл с именем "Company_Phone_Number_Normalization_Rules. txt".

5. Подождите несколько минут, пока все клиентские пулы смогут прочитать новые файлы.

6. Выполните следующий командлет на каждом пуле 2019 для Business Server в среде Skype.

   ```PowerShell
   Update-CsAddressBook
   ```


