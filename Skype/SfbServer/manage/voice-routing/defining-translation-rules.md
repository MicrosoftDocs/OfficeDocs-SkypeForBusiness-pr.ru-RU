---
title: Определение правил преобразования в Skype для бизнеса Server
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
description: Маршруты голосовой связи Skype для бизнеса Server Enterprise на основе номеров телефонов, нормализованных в формате E. 164. Это означает, что все набранные строки должны быть нормализованы до формата E. 164 для выполнения обратного просмотра номера (RNL), чтобы их можно было преобразовать в соответствующие URI SIP. Skype для бизнеса Server предоставляет возможность управлять вызываемым ИДЕНТИФИКАТОРом и представлением идентификатора абонента.
ms.openlocfilehash: dddeee5ef7784d9c2c433763da4c8b6145611e49
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42045071"
---
# <a name="defining-translation-rules-in-skype-for-business-server"></a>Определение правил преобразования в Skype для бизнеса Server

Маршруты голосовой связи Skype для бизнеса Server Enterprise на основе номеров телефонов, нормализованных в формате E. 164. Это означает, что все набранные строки должны быть нормализованы до формата E. 164 для выполнения обратного просмотра номера (RNL), чтобы их можно было преобразовать в соответствующие URI SIP. Skype для бизнеса Server предоставляет возможность управлять вызываемым ИДЕНТИФИКАТОРом и представлением идентификатора абонента.

В Skype для бизнеса Server телефонный номер вызываемого абонента (то есть номер телефона) можно перевести из формата E. 164 в местный формат набора номера, который требуется магистральным одноранговым узлом (то есть связанным шлюзом, УАТС или SIP). Магистральная линия связи). Для этого необходимо определить одно или несколько правил преобразования для преобразования URI запроса перед переадресованием на магистральный узел.

## <a name="caller-id-presentation"></a>Презентация идентификации звонящего

Skype для бизнеса Server позволяет также преобразовывать телефонный номер абонентского абонента (то есть номер телефона, с которого вызывается абонент) из формата E. 164 в местный формат набора номера, необходимый для магистрального узла. Например, можно написать правило преобразования для удаления +44 из начала строки набора и замены на 0144.

**Настройка идентификатора звонящего с помощью панели управления Skype для бизнеса Server**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Дополнительные сведения см. в разделе [Делегирование разрешений на установку](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).
2. Откройте окно браузера и введите URL-адрес администрирования, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, можно найти в [статье Установка и открытие средств администрирования](../../management-tools/install-and-open-administrative-tools.md).
3. В левой панели навигации щелкните **Маршрутизация голосовой связи**, а затем выберите **Настройка линии связи**.
4. На странице Конфигурация магистрали дважды щелкните существующую магистраль (например, **глобальную**), чтобы открыть диалоговое окно **Изменение конфигурации магистрали**.
5. Настройка представления идентификатора звонящего
    - Чтобы выбрать одно или несколько правил из списка всех правил трансляции, доступных в развертывании корпоративной голосовой связи, нажмите кнопку **выбрать**. В окне **Правила трансляции вызывающего номера** выберите правила, которые требуется сопоставить с магистральной линией связи, а затем нажмите кнопку **ОК**.
    - Чтобы определить новое правило преобразования и сопоставить его с магистральной линией связи, щелкните **Создать**. 
    - Чтобы изменить правило преобразования, которое уже сопоставлено с магистралью, щелкните имя правила, затем нажмите кнопку **Подробнее**.
    - Чтобы скопировать существующее правило преобразования, которое будет использоваться в качестве отправной точки для определения нового правила, щелкните имя правила, нажмите кнопку **Копировать**, а затем выберите команду **Вставить**.
    - Чтобы удалить правило преобразования из магистральной линии связи, выделите имя этого правила, а затем нажмите кнопку **Удалить**.

> [!Warning] 
> Не сопоставляйте правила преобразования с магистральной линией связи, если вы уже настроили их для связанной одноранговой магистральной линии связи, поскольку эти два правила могут конфликтовать друг с другом. 

## <a name="called-id-presentation"></a>Презентация с именем ID

> [!Important]
> Возможность связывания одного или нескольких правил преобразования с конфигурацией магистрали корпоративной голосовой связи предназначена для использования в качестве *альтернативы* настройке правил преобразования на одноранговом одноранговом узле. Не связывайте правила преобразования с конфигурацией магистрали корпоративной голосовой связи, если вы настроили правила преобразования на одноранговом одноранговом узле, так как эти два правила могут конфликтовать. 

Вы можете использовать один из следующих методов для создания или изменения правила преобразования:

- [Используйте средство создания правила преобразования](#create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool) , чтобы указать значения для начальных цифр, длины, цифр для удаления и цифр для добавления, а затем разрешите панели управления Skype для бизнеса Server создать соответствующий шаблон и правило преобразования.
- [Запишите регулярные выражения вручную](#create-or-modify-a-translation-rule-manually) , чтобы определить шаблон сравнения и правило преобразования.

> [!Note]
> Сведения о написании регулярных выражений можно найти в статье [регулярные выражения .NET Framework](http://go.microsoft.com/fwlink/p/?linkId=140927). 

### <a name="create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool"></a>Создание или изменение правила преобразования с помощью инструмента "Построение правила преобразования"

Выполните указанные ниже действия, чтобы определить правило преобразования, введя набор значений в инструменте создание правила преобразования и включите панель управления Skype для бизнеса Server, чтобы создать соответствующий шаблон и правило преобразования. 

**Создание правила с помощью средства Build a Translation Rule (Создание правила преобразования)**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Дополнительные сведения см. в разделе [Делегирование разрешений на установку](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).
2. Откройте окно браузера и введите URL-адрес администрирования, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, можно найти в [статье Установка и открытие средств администрирования](../../management-tools/install-and-open-administrative-tools.md).
3. Чтобы приступить к определению правила преобразования, выполните действия, описанные в разделе [Настройка магистрали с обходом](GET LINK AFTER MIGRATION)сервера, на шаге 10 или [Настройка магистрали без обхода](GET LINK AFTER MIGRATION) сервера с помощью шага 9.
4. На странице **New Translation Rule** (Создание правила преобразования) или **Edit Translation Rule** (Изменение правила преобразования) в поле **Name** (Имя) введите описательное имя правила преобразования.
5. Необязательно В разделе **Описание**введите описание правила преобразования — например, американский Международный междугородный **набор (США**).
6. В разделе **Build a Translation Rule** (Создание правила преобразования) введите следующие значения:
    - **Начальные цифры**: (необязательно) укажите начальные цифры чисел, которые должны сопоставляться с шаблоном. Например, введите в этом поле значение +, чтобы оно собирало числа в формате E. 164 (начинающиеся с +).
    - **Length** (Длина). Укажите число цифр шаблона и укажите, должны ли цифры номера соответствовать всему шаблону, минимальному числу цифр шаблона или любому числу цифр шаблона. Например, введите **11** и в раскрывающемся списке выберите **At least** (Минимум) для поиска номеров, состоящих как минимум из 11 цифр.
    - **Цифры для удаления**: (необязательно) укажите количество начальных цифр для удаления. Например, введите **1** , чтобы извлечь значение + из начала номера.
    - **Digits to add** (Число добавляемых цифр). Укажите цифры, добавляемые в начало преобразуемых номеров (необязательно). Например, если вы хотите, чтобы при применении правила преобразования в начало номеров добавлялись цифры 011, введите значение **011**.
    
    Значения, введенные в этих полях, отражаются в полях " **шаблон для сравнения** " и "правило **преобразования** ". Например, если указать значения из предыдущего примера, в поле **шаблон для МАТК**h задается регулярное выражение:
    
    **^\+(\d{9}\d +) $** 

    Поле **Translation rule** (Правило преобразования) задает шаблон для формата преобразованных номеров. Этот шаблон состоит из 2 частей:
    - Значение (например, **$1**), которое представляет число цифр в шаблоне соответствия
    - Значение, добавляемое перед номером, которое вводится в поле **Digits to add** (Число добавляемых цифр) (необязательно)

    Для значений предыдущего примера в поле **Translation rule** (Правило преобразования) будет отображаться **011$1**.
    
    После применения этого правила преобразования номер +441235551010 будет изменен на 011441235551010.
7. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
8. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
9. На странице **магистраль конфигуратио**n нажмите кнопку **зафиксировать**, а затем нажмите кнопку **сохранить все**. 

> [!Note]
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Дополнительные сведения см. в статье [Публикация ожидающих изменений в конфигурации маршрутизации голосовой связи](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx). 

### <a name="create-or-modify-a-translation-rule-manually"></a>Создание или изменение правила трансляции вручную

Если требуется задать правило преобразования путем создания регулярного выражения для шаблона соответствия и правила преобразования, выполните следующие действия. 

**Определение правила преобразования вручную**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Дополнительные сведения см. в разделе [Делегирование разрешений на установку](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx).
2. Откройте окно браузера и введите URL-адрес администрирования, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, можно найти в [статье Установка и открытие средств администрирования](../../management-tools/install-and-open-administrative-tools.md).
3. Чтобы приступить к определению правила преобразования, выполните действия, описанные в разделе [Настройка магистрали с обходом](GET LINK AFTER MIGRATION)сервера, на шаге 10 или [Настройка магистрали без обхода](GET LINK AFTER MIGRATION) сервера с помощью шага 9.
4. В поле **Имя** на странице **Создание правила преобразования** или  **Изменение правила преобразования** введите имя, описывающее шаблон номера для преобразования.
5. Необязательно В поле **Описание**введите описание правила преобразования; Например, **Американский международный**междугородный набор (США).
6. Внизу раздела **Построение правила преобразования** нажмите кнопку **Правка**.
7. В поле введите **регулярное выражение**введите следующее:
    - В поле **Сопоставить этот шаблон** укажите шаблон, который будет использоваться для сопоставления номеров для преобразования.
    - В поле **Правило преобразования** укажите шаблон для формата преобразованных номеров.

    Например, если ввести ** ^ \+{9}(\d \d +) $** в поле **сопоставить этот шаблон** и **011 $1** в **правиле преобразования**, то правило будет переводиться + 441235551010 на 011441235551010.
8. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
9. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
10. На странице **Trunk Configuration** (Конфигурация магистрали) щелкните **Commit** (Сохранить) и затем щелкните **Commit all** (Сохранить все). 

> [!Note] 
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Дополнительные сведения см. в статье [Публикация ожидающих изменений в конфигурации маршрутизации голосовой связи](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx). 
