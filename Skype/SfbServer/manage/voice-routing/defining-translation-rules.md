---
title: Определение правил перевода в Skype для бизнеса Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
description: Skype для бизнеса Server Корпоративная голосовая связь маршруты вызовов на основе номеров телефонов, нормализуемого до формата E.164. Это означает, что все набраные строки необходимо нормализовать до формата E.164 для выполнения обратного набора номеров (RNL), чтобы они могли быть переведены на их соответствие SIP URI. Skype для бизнеса Server предоставляет возможность манипулировать вызываемой и вызываемой презентацией.
ms.openlocfilehash: f3a37a48ec2e4497d644e2051a6e6d37ccef9707
ms.sourcegitcommit: 01087be29daa3abce7d3b03a55ba5ef8db4ca161
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2021
ms.locfileid: "51120911"
---
# <a name="defining-translation-rules-in-skype-for-business-server"></a>Определение правил перевода в Skype для бизнеса Server

Skype для бизнеса Server Корпоративная голосовая связь маршруты вызовов на основе номеров телефонов, нормализуемого до формата E.164. Это означает, что все набраные строки необходимо нормализовать до формата E.164 для выполнения обратного набора номеров (RNL), чтобы они могли быть переведены на их соответствие SIP URI. Skype для бизнеса Server предоставляет возможность манипулировать вызываемой и вызываемой презентацией.

С помощью Skype для бизнеса Server телефонный номер звонящей стороны (то есть телефонный номер) может быть переведен из формата E.164 в локальный формат набора, который необходим одноранговой магистрали (то есть связанному шлюзу, частному обмену филиалами (PBX) или магистралью SIP. Для этого необходимо определить одно или несколько правил преобразования для преобразования URI запроса перед переадресованием на магистральный узел.

## <a name="caller-id-presentation"></a>Презентация ИД вызываемой

Skype для бизнеса Server предлагает возможность также перевести телефонный номер вызываемой стороны (то есть номер телефона, из который вызывается звонящая) из формата E.164 в локальный формат набора, необходимый одноранговой магистрали. Например, можно написать правило преобразования для удаления +44 из начала строки набора и замены на 0144.

**Настройка ИД вызываемой группы с помощью панели управления Skype для бизнес-серверов**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. [в материале Уполномоченные разрешения на установку.](/previous-versions/office/lync-server-2013/lync-server-2013-delegate-setup-permissions)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, см. в материале [Install и open administrative tools.](../../management-tools/install-and-open-administrative-tools.md)
3. В левой панели навигации щелкните **Маршрутизация голосовой связи**, а затем выберите **Настройка линии связи**.
4. На странице Конфигурация магистрали дважды щелкните существующую магистраль (например, **глобальную**), чтобы открыть диалоговое окно **Изменение конфигурации магистрали**.
5. Настройка представления идентификатора звонящего
    - Чтобы выбрать одно или несколько правил из списка всех правил перевода, доступных в Корпоративная голосовая связь развертывания, нажмите **кнопку Выберите**. В окне **Правила трансляции вызывающего номера** выберите правила, которые требуется сопоставить с магистральной линией связи, а затем нажмите кнопку **ОК**.
    - Чтобы определить новое правило преобразования и сопоставить его с магистральной линией связи, щелкните **Создать**. 
    - Чтобы изменить правило преобразования, которое уже сопоставлено с магистралью, щелкните имя правила, затем нажмите кнопку **Подробнее**.
    - Чтобы скопировать существующее правило перевода для использования в качестве отправной точки для определения нового правила, щелкните имя правила, нажмите кнопку **Скопируйте** и нажмите **кнопку Вайт**.
    - Чтобы удалить правило преобразования из магистральной линии связи, выделите имя этого правила, а затем нажмите кнопку **Удалить**.

> [!Warning] 
> Не сопоставляйте правила преобразования с магистральной линией связи, если вы уже настроили их для связанной одноранговой магистральной линии связи, поскольку эти два правила могут конфликтовать друг с другом. 

## <a name="called-id-presentation"></a>Презентация called ID

> [!Important]
> Возможность связывать одно или несколько правил перевода с конфигурацией Корпоративная голосовая связь магистрали предназначена для использования в качестве альтернативы настройке правил перевода на одноранговом магистрали.  Не связывать правила перевода с конфигурацией Корпоративная голосовая связь магистрали, если вы настроили правила перевода на одноранговом магистрали, так как эти два правила могут противоречить. 

Вы можете использовать один из следующих методов для создания или изменения правила преобразования:

- Используйте средство Build [a Translation Rule](#create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool) для указания значений для начальных цифр, длины, цифр для удаления и добавления цифр, а затем позвольте панели управления Skype для бизнес-серверов создать соответствующий шаблон и правило перевода для вас.
- [Записывая регулярные выражения вручную](#create-or-modify-a-translation-rule-manually) для определения шаблона и правила перевода.

> [!Note]
> Сведения о записи регулярных выражений см. в платформа .NET Framework [Regular Expressions.](/dotnet/standard/base-types/regular-expressions) 

### <a name="create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool"></a>Создание или изменение правила перевода с помощью средства Build a Translation Rule

Следуйте этим шагам, если вы хотите определить правило перевода, введите набор значений в инструменте Build a Translation Rule и разрешив панели управления Skype для бизнес-серверов создать соответствующий шаблон и правило перевода для вас. 

**Создание правила с помощью средства Build a Translation Rule (Создание правила преобразования)**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. [в материале Уполномоченные разрешения на установку.](/previous-versions/office/lync-server-2013/lync-server-2013-delegate-setup-permissions)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, см. в материале [Install и open administrative tools.](../../management-tools/install-and-open-administrative-tools.md)
3. Чтобы приступить к определению правила перевода, выполните действия в [Настройка](GET LINK AFTER MIGRATION) [](GET LINK AFTER MIGRATION) магистрали с обходом мультимедиа с помощью шага 10 или настройка магистрали без обхода мультимедиа через шаг 9.
4. На странице **New Translation Rule** (Создание правила преобразования) или **Edit Translation Rule** (Изменение правила преобразования) в поле **Name** (Имя) введите описательное имя правила преобразования.
5. (Необязательный) В **описании** введите описание правила перевода , например, междугородние номера **US International.**
6. В разделе **Build a Translation Rule** (Создание правила преобразования) введите следующие значения:
    - **Начальные цифры.**(Необязательно) Укажите ведущие цифры чисел, которые должны соответствовать шаблону. Например, введите + в этом поле, чтобы соответствовать номерам в формате E.164 (которые начинаются с +).
    - **Length** (Длина). Укажите число цифр шаблона и укажите, должны ли цифры номера соответствовать всему шаблону, минимальному числу цифр шаблона или любому числу цифр шаблона. Например, введите **11** и в раскрывающемся списке выберите **At least** (Минимум) для поиска номеров, состоящих как минимум из 11 цифр.
    - **Цифры для удаления:**(Необязательный) Укажите количество начальных цифр, которые необходимо удалить. Например, введите **1,** чтобы вывести +с начала номера.
    - **Digits to add** (Число добавляемых цифр). Укажите цифры, добавляемые в начало преобразуемых номеров (необязательно). Например, если вы хотите, чтобы при применении правила преобразования в начало номеров добавлялись цифры 011, введите значение **011**.
    
    Значения, которые вы вводите в этих полях, отражаются в **полях Pattern для** совпадения и **правила** перевода. Например, если указать предшествующие значения примера, в результате регулярного выражения в поле **Pattern to matc** h будет:
    
    **^\+(\d {9} \d+)$** 

    Поле **Translation rule** (Правило преобразования) задает шаблон для формата преобразованных номеров. Этот шаблон состоит из 2 частей:
    - Значение (например, **$1**), которое представляет число цифр в шаблоне соответствия
    - Значение, добавляемое перед номером, которое вводится в поле **Digits to add** (Число добавляемых цифр) (необязательно)

    Для значений предыдущего примера в поле **Translation rule** (Правило преобразования) будет отображаться **011$1**.
    
    После применения этого правила преобразования номер +441235551010 будет изменен на 011441235551010.
7. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
8. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
9. На странице **Trunk Configuratio** n нажмите **кнопку Фиксация** и нажмите кнопку **Фиксация всех**. 

> [!Note]
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Подробнее см. в [материале Публикация ожидающих изменений конфигурации маршрутивки голосовой маршрутики.](/previous-versions/office/lync-server-2013/lync-server-2013-publish-pending-changes-to-the-voice-routing-configuration) 

### <a name="create-or-modify-a-translation-rule-manually"></a>Создание или изменение правила перевода вручную

Если требуется задать правило преобразования путем создания регулярного выражения для шаблона соответствия и правила преобразования, выполните следующие действия. 

**Определение правила преобразования вручную**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. [в материале Уполномоченные разрешения на установку.](/previous-versions/office/lync-server-2013/lync-server-2013-delegate-setup-permissions)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах, которые можно использовать для запуска панели управления Skype для бизнеса, см. в материале [Install и open administrative tools.](../../management-tools/install-and-open-administrative-tools.md)
3. Чтобы приступить к определению правила перевода, выполните действия в [Настройка](GET LINK AFTER MIGRATION) [](GET LINK AFTER MIGRATION) магистрали с обходом мультимедиа с помощью шага 10 или настройка магистрали без обхода мультимедиа через шаг 9.
4. В поле **Имя** на странице **Создание правила преобразования** или  **Изменение правила преобразования** введите имя, описывающее шаблон номера для преобразования.
5. (Необязательный) В **Описании** введите описание правила перевода; например, **междугородние** номера US International.
6. Внизу раздела **Построение правила преобразования** нажмите кнопку **Правка**.
7. Введите следующее в Type a **Regular Expression:**
    - В поле **Сопоставить этот шаблон** укажите шаблон, который будет использоваться для сопоставления номеров для преобразования.
    - В поле **Правило преобразования** укажите шаблон для формата преобразованных номеров.

    Например, если ввести **^ \+ (\d\d+)$ {9}** в соответствие этому шаблону и **011$1** в правиле **перевода,** правило будет переводить +44123555101010 на 011441235551010. 
8. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
9. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
10. На странице **Trunk Configuration** (Конфигурация магистрали) щелкните **Commit** (Сохранить) и затем щелкните **Commit all** (Сохранить все). 

> [!Note] 
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Подробнее см. в [материале Публикация ожидающих изменений конфигурации маршрутивки голосовой маршрутики.](/previous-versions/office/lync-server-2013/lync-server-2013-publish-pending-changes-to-the-voice-routing-configuration)