---
title: Определение правил трансляции в Skype для бизнеса Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
description: Skype для бизнеса Server Корпоративная голосовая связь маршрутизации вызовов на основе номеров телефонов, нормализованных в формат E.164. Это означает, что все набираемые строки должны быть нормализованы в формат E.164 для выполнения обратного подсмотра номера (RNL), чтобы их можно было перевести в совпадающий URI SIP. Skype для бизнеса Server позволяет управлять вызываемой и вызываемой презентацией.
ms.openlocfilehash: f4d0ab4fc30507fb5d247e072b3fdff8904f2ff3
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49823369"
---
# <a name="defining-translation-rules-in-skype-for-business-server"></a>Определение правил трансляции в Skype для бизнеса Server

Skype для бизнеса Server Корпоративная голосовая связь маршрутизации вызовов на основе номеров телефонов, нормализованных в формат E.164. Это означает, что все набираемые строки должны быть нормализованы в формат E.164 для выполнения обратного подбирания номеров (RNL), чтобы их можно было перевести в совпадающий URI SIP. Skype для бизнеса Server позволяет управлять вызываемой и вызываемой презентацией.

В Skype для бизнеса Server номер телефона звонящей стороны (то есть номер телефона) можно перевести из формата E.164 в локальный формат набора номера, требующийся магистральным одноранговом серверу (то есть связанному шлюзу, УАЧС или магистрали SIP). Для этого необходимо определить одно или несколько правил преобразования для преобразования URI запроса перед переадресованием на магистральный узел.

## <a name="caller-id-presentation"></a>Презентация С ИД звонячего

Skype для бизнеса Server также позволяет переводить номер телефона вызываемой стороны (то есть номер телефона, с который звонит звонящая) из формата E.164 в формат местного набора номера, который требуется магистральным одноранговике. Например, можно написать правило преобразования для удаления +44 из начала строки набора и замены на 0144.

**Настройка ИД вызываемой стороны с помощью панели управления Skype для бизнеса Server**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. в [делегирования разрешений на установку.](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах запуска панели управления Skype для бизнеса см. в сведениях [об установке и открытом администрировании.](../../management-tools/install-and-open-administrative-tools.md)
3. В левой панели навигации щелкните **Маршрутизация голосовой связи**, а затем выберите **Настройка линии связи**.
4. На странице Конфигурация магистрали дважды щелкните существующую магистраль (например, **глобальную**), чтобы открыть диалоговое окно **Изменение конфигурации магистрали**.
5. Настройка представления идентификатора звонящего
    - Чтобы выбрать одно или несколько правил из списка всех правил трансляции, доступных в развертывании Корпоративная голосовая связь, нажмите кнопку **"Выбрать".** В окне **Правила трансляции вызывающего номера** выберите правила, которые требуется сопоставить с магистральной линией связи, а затем нажмите кнопку **ОК**.
    - Чтобы определить новое правило преобразования и сопоставить его с магистральной линией связи, щелкните **Создать**. 
    - Чтобы изменить правило преобразования, которое уже сопоставлено с магистралью, щелкните имя правила, затем нажмите кнопку **Подробнее**.
    - Чтобы скопировать существующее правило трансляции, которое будет использовать в качестве отправной точки для определения нового правила, щелкните имя правила, нажмите кнопку "Копировать" и выберите **"В paste".**
    - Чтобы удалить правило преобразования из магистральной линии связи, выделите имя этого правила, а затем нажмите кнопку **Удалить**.

> [!Warning] 
> Не сопоставляйте правила преобразования с магистральной линией связи, если вы уже настроили их для связанной одноранговой магистральной линии связи, поскольку эти два правила могут конфликтовать друг с другом. 

## <a name="called-id-presentation"></a>Презентация с иным идом

> [!Important]
> Возможность связывания одного или более правил трансляции с конфигурацией магистрали  Корпоративная голосовая связь предназначена для использования в качестве альтернативы настройке правил трансляции на магистрали. Не связывать правила трансляции с Корпоративная голосовая связь магистрали, если вы настроили правила трансляции на магистрали, так как эти два правила могут конфликтовировать. 

Вы можете использовать один из следующих методов для создания или изменения правила преобразования:

- [](#create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool) Используйте средство создания правила трансляции, чтобы указать значения начальных цифр, длины, цифр, удаляемой и добавляемой цифр, а затем позвольте панели управления Skype для бизнеса Server создать соответствующий шаблон и правило трансляции.
- [Написание регулярных выражений вручную](#create-or-modify-a-translation-rule-manually) для определения шаблона совпадения и правила трансляции.

> [!Note]
> Сведения о написании регулярных выражений см. в [.NET Framework Regular Expressions.](https://go.microsoft.com/fwlink/p/?linkId=140927) 

### <a name="create-or-modify-a-translation-rule-by-using-the-build-a-translation-rule-tool"></a>Создание или изменение правила трансляции с помощью средства создания правила трансляции

Выполните следующие действия, чтобы определить правило трансляции, введите набор значений в средстве создания правила трансляции и разрешив панели управления Skype для бизнеса Server создать соответствующий шаблон и правило трансляции. 

**Создание правила с помощью средства Build a Translation Rule (Создание правила преобразования)**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. в [делегирования разрешений на установку.](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах запуска панели управления Skype для бизнеса см. в сведениях [об установке и открытом администрировании.](../../management-tools/install-and-open-administrative-tools.md)
3. Чтобы приступить к определению правила [](GET LINK AFTER MIGRATION)трансляции, выполните действия, которые [](GET LINK AFTER MIGRATION) необходимо предпринять в шаге 10 "Настройка магистрали с обходом мультимедиа" или "Настройка магистрали без обхода мультимедиа до шага 9".
4. На странице **New Translation Rule** (Создание правила преобразования) или **Edit Translation Rule** (Изменение правила преобразования) в поле **Name** (Имя) введите описательное имя правила преобразования.
5. (Необязательно) В **описании** введите описание правила трансляции, например международного телефонного набора **(US International).**
6. В разделе **Build a Translation Rule** (Создание правила преобразования) введите следующие значения:
    - **Начальные цифры:**(Необязательно) Укажите начальные цифры чисел, которые должны соответствовать шаблону. Например, введите +в это поле для совпадения чисел в формате E.164 (которые начинаются с +).
    - **Length** (Длина). Укажите число цифр шаблона и укажите, должны ли цифры номера соответствовать всему шаблону, минимальному числу цифр шаблона или любому числу цифр шаблона. Например, введите **11** и в раскрывающемся списке выберите **At least** (Минимум) для поиска номеров, состоящих как минимум из 11 цифр.
    - **Цифры, которые необходимо** удалить: (необязательно) Укажите количество начальных цифр, которые необходимо удалить. Например, введите **1,** чтобы вывести +из начала номера.
    - **Digits to add** (Число добавляемых цифр). Укажите цифры, добавляемые в начало преобразуемых номеров (необязательно). Например, если вы хотите, чтобы при применении правила преобразования в начало номеров добавлялись цифры 011, введите значение **011**.
    
    Значения, которые вы вводите в этих полях, отражаются в **шаблоне** для совпадения и **полей правила** трансляции. Например, если указать значения предыдущего примера, результатом регулярного выражения в поле **Pattern to matc** h будет:
    
    **^\+(\d {9} \d+)$** 

    Поле **Translation rule** (Правило преобразования) задает шаблон для формата преобразованных номеров. Этот шаблон состоит из 2 частей:
    - Значение (например, **$1**), которое представляет число цифр в шаблоне соответствия
    - Значение, добавляемое перед номером, которое вводится в поле **Digits to add** (Число добавляемых цифр) (необязательно)

    Для значений предыдущего примера в поле **Translation rule** (Правило преобразования) будет отображаться **011$1**.
    
    После применения этого правила преобразования номер +441235551010 будет изменен на 011441235551010.
7. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
8. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
9. На странице **Configuratio** n магистрали щелкните **"Зафиксировать",** а затем щелкните **"Зафиксировать все".** 

> [!Note]
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Подробные сведения см. в подстановке ["Публикация ожидающих изменений в конфигурации маршрутации голосовой почты".](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx) 

### <a name="create-or-modify-a-translation-rule-manually"></a>Создание или изменение правила трансляции вручную

Если требуется задать правило преобразования путем создания регулярного выражения для шаблона соответствия и правила преобразования, выполните следующие действия. 

**Определение правила преобразования вручную**

1. Войдите на компьютер как член группы RTCUniversalServerAdmins или роли CsVoiceAdministrator, CsServerAdministrator или CsAdministrator. Подробные сведения см. в [делегирования разрешений на установку.](https://technet.microsoft.com/library/gg412735(v=ocs.15).aspx)
2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления. Дополнительные сведения о различных методах запуска панели управления Skype для бизнеса см. в сведениях [об установке и открытом администрировании.](../../management-tools/install-and-open-administrative-tools.md)
3. Чтобы приступить к определению правила [](GET LINK AFTER MIGRATION)трансляции, выполните действия, которые [](GET LINK AFTER MIGRATION) необходимо предпринять в шаге 10 "Настройка магистрали с обходом мультимедиа" или "Настройка магистрали без обхода мультимедиа до шага 9".
4. В поле **Имя** на странице **Создание правила преобразования** или  **Изменение правила преобразования** введите имя, описывающее шаблон номера для преобразования.
5. (Необязательно) В **описании** введите описание правила трансляции; например, **междугородный** набор в США.
6. Внизу раздела **Построение правила преобразования** нажмите кнопку **Правка**.
7. Введите следующее введите **регулярное выражение:**
    - В поле **Сопоставить этот шаблон** укажите шаблон, который будет использоваться для сопоставления номеров для преобразования.
    - В поле **Правило преобразования** укажите шаблон для формата преобразованных номеров.

    Например, если ввести **^ \+ (\d {9} \d+)$** в соответствие этому шаблону и  **011$1** в правиле трансляции, правило переведет +441235551010 в 011441235551010. 
8. Чтобы сохранить правило преобразования, нажмите кнопку **ОК**.
9. Чтобы сохранить конфигурацию магистрали, нажмите кнопку **ОК**.
10. На странице **Trunk Configuration** (Конфигурация магистрали) щелкните **Commit** (Сохранить) и затем щелкните **Commit all** (Сохранить все). 

> [!Note] 
> Всякий раз при создании или изменении правила преобразования необходимо выполнять команду **Commit all** (Сохранить все), чтобы опубликовать изменение конфигурации. Подробные сведения см. в подстановке ["Публикация ожидающих изменений в конфигурации маршрутации голосовой почты".](https://technet.microsoft.com/library/gg413088(v=ocs.15).aspx) 
