---
title: Использование средства Modern Authentication (ADAL) со Skype для бизнеса
ms.author: heidip
author: microsoftheidi
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 5ca71746-ead6-4e8c-90b1-461e846d1f4a
description: В этой статье рассматривается порядок использования современных проверки подлинности (полученный на основе библиотеки проверки подлинности Active Directory (ADAL) и OAuth 2.0), который можно найти в 2016 марта накопительный пакет обновлений за Скайп для бизнеса для Скайп для Business Server 2015.
ms.openlocfilehash: 4bf802d2710c9c271c54cf2e127cf51b24875db1
ms.sourcegitcommit: e9f277dc96265a193c6298c3556ef16ff640071d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2018
ms.locfileid: "20966575"
---
# <a name="how-to-use-modern-authentication-adal-with-skype-for-business"></a>Использование средства Modern Authentication (ADAL) со Skype для бизнеса
 
В этой статье рассматривается порядок использования современных проверки подлинности (полученный на основе библиотеки проверки подлинности Active Directory (ADAL) и OAuth 2.0), который можно найти в 2016 марта накопительный пакет обновлений за Скайп для бизнеса для Скайп для Business Server 2015.
  
## <a name="whats-in-this-article"></a>В этой статье

[Что такое ADAL?](use-adal.md#BKMK_ADAL)
  
[Настройка ADAL в пуле и настройка ADFS в качестве сервера маркеров безопасности](use-adal.md#BKMK_Config)
  
[Другие варианты включения входа ADAL (например, в клиентских приложениях Office)](use-adal.md#BKMK_Options)
  
[Клиенты, на которых служба Modern Authentication или ADAL не поддерживается](use-adal.md#BKMK_Support)
  
## <a name="what-is-adal"></a>Что такое ADAL?
<a name="BKMK_ADAL"> </a>

ADAL сокращение для «Active Directory проверки подлинности библиотеки», и, вместе с OAuth 2.0, это является основой для современных проверки подлинности. Эта библиотека кода позволяет сделать доступным для клиентских приложений (например, Скайп для бизнеса) с помощью маркеров безопасности защищенным ресурсам в каталоге. ADAL для работы с OAuth 2.0, чтобы включить дополнительные сценарии проверки подлинности и авторизации, таких как многофакторной многофакторной проверки подлинности проверкой (Подлинности) и другие формы проверки подлинности SAML
  
Служба современной проверки подлинности может использоваться для получения доступа к защищенным ресурсам широким спектром приложений, которые выступают в качестве клиентов. В Скайп для Business Server этой технологии используется между клиентами в локальной и локальные серверы для выдачи пользователям должного уровня авторизации на ресурсы.
  
Для подключения с применением средства Modern Authentication (на основе ADAL и OAuth 2.0) характерны некоторые стандартные элементы.
  
- Клиент, запрос для ресурса, в этом случае клиент Скайп для бизнеса.
    
- Есть ресурс, к которому клиент должен конкретный уровень доступа, и этот ресурс обеспечивается службой каталогов, в данном случае ресурса Скайп для Business Server.
    
- Нет подключения к OAuth, иными словами, подключения, который является выделенным для *авторизации* пользователя для доступа к ресурсу. (OAuth также известные с более подробными описаниями имя проверки подлинности «Сервер-сервер» и часто сокращается как S2S).
    
В Скайп для бесед современных проверки подлинности Business Server (ADAL) Скайп для Business Server обменивается данными через службы федерации Active Directory (ADFS 3.0 в Windows Server 2012 R2). Проверка подлинности может произойти с помощью другого поставщика удостоверений (IdP), но Скайп для Business server должна быть настроена для взаимодействия с AD FS, напрямую. Если вы еще не настроили службы федерации Active Directory для работы с Скайп для Business Server заполните [установки службы федерации Active Directory](https://technet.microsoft.com/en-us/library/adfs2-step-by-step-guides%28v=ws.10%29.aspx).
  
ADAL включен в 2016 марта накопительный пакет обновлений за Скайп для Business Server 2015 и 2016 марта накопительный пакет обновлений за Скайп для бизнеса, **должны** быть установлены и необходимые для успешной настройки.
  
> [!NOTE]
> Во время первоначального выпуска современных проверки подлинности в локальной среде поддерживается только в том случае, если отсутствует участвующие смешанная топология Скайп. Например, если среда находится Скайп исключительно для Business Server. Этот оператор может быть изменена. 
  
Для успешной настройки необходимо загрузить пакет PowerShell, содержащий файлы .ps1 с командами, которые используются в ADAL.
  
### <a name="configure-adal-in-your-pool-and-set-adfs-as-security-token-server"></a>Настройка ADAL в пуле и настройка ADFS в качестве сервера маркеров безопасности
<a name="BKMK_Config"> </a>

В этом процессе Скайп для пула Business Server, которые настроены для ADAL подключения установку службы федерации Active Directory.
  
1. Установка 2016 марта накопительный пакет обновлений за Скайп для 2015 сервера Business для вашей Скайп для пула сервера или сервера Standard Edition. (Планирование обслуживания windows, необходимые для запуска центра обновления Windows для автоматической установки.)
    
2. В вашей локальной службы федерации Active Directory серверов, [Загрузите](https://aka.ms/sfbadalscripts) программы установки-AdfsOAuthTrustForSfB скрипта. (Это необходимо сделать на ферме службы федерации Active Directory или независимых серверов служб ADFS. Он не требуется выполнить на прокси-сервер службы федерации Active Directory или прокси-серверы).
    
3. Запишите внутренних и внешних веб-службы полные доменные имена (FQDN) для вашей Скайп Business Server пула или сервера Standard Edition. Это необходимо сделать для всех Скайп для пулов бизнеса.
    
4. В PowerShell на серверах ADFS выполните сценарий Setup-AdfsOAuthTrustForSfB. Для этого потребуется ввести правильные URL-адреса внутреннего и внешнего полного доменного имени веб-службы. Ниже приводится пример.
    
     `Setup-AdfsOAuthTrustForSfB.ps1 -poolIDs https://contosoSkype.contoso.com,https://contoso01Skype.contosoIn.com`
    
    Для любого дополнительных пулов необходимо вручную добавить URL-адреса пула Web Services в Скайп для Business Server доверия с проверяющей стороной в службы федерации Active Directory.
    
    > [!IMPORTANT]
    > Невозможно использовать пассивную проверку подлинности для пула одновременно с ADAL. Чтобы использовать ADAL, сначала отключите пассивную проверку подлинности. [Командлеты PowerShell по настройке проверки подлинности для пула см.](https://technet.microsoft.com/en-us/library/gg398396.aspx)
  
    > [!TIP]
    > Если у вас есть дополнительные пулы необходимо добавить их как [идентификаторы](https://technet.microsoft.com/en-us/library/gg557759%28v=ws.10%29.aspx) доверия с проверяющей стороной в службы федерации Active Directory. > перейдите к серверу службы федерации Active Directory и откройте управления службы федерации Active Directory. Разверните узел отношения доверия между \> отношения доверия проверяющей стороны. Щелкните правой кнопкой мыши доверия с проверяющей стороной, который указан и щелкните правой кнопкой мыши для свойства \> идентификаторы \> введите дополнительные URL-адреса пула \> нажмите кнопку Добавить. 
  
5. Вернуться к вашей Скайп для бизнеса сервера переднего плана или сервере Standard Edition server. Здесь необходимо выполнить командлеты, которые создать сервер OAuth и изменять конфигурации OAuth для работы с Скайп для бизнеса. Необходимо выполнить это действие один раз в Скайп для развертывания Business Server. Ниже приводится пример:
    
     `New-CsOAuthServer -Identity sts.contosoIn.com -Type ADFS -MetadataURL https://sts.contosoIn.com/FederationMetadata/2007-06/FederationMetadata.xml`
    
    > [!TIP]
    > «Удостоверения» URL-адрес, см в этой команде является фактически службы федерации Active Directory Federation имя службы можно определить в управлении службы федерации Active Directory, когда щелкните правой кнопкой мыши службу \> свойства. «Тип» всегда службы федерации Active Directory, а «MetadataURL» — это всегда \<имя службы Your ADFS\> + «/ FederationMetadata/2007-06/FederationMetadata.xml». 
  
     `Set-CsOAuthConfiguration -ClientAuthorizationOAuthServerIdentity sts.contosoIn.com`
    
6. По-прежнему на вашей Скайп для бизнеса сервера переднего плана или сервере Standard Edition проверьте новую конфигурацию, введя адрес SIP пользователя и полное доменное имя пула. Необходимо выполнить это действие один раз в Скайп для развертывания Business Server. Далее приведен пример:
    
     `Test-CsRegistration -UserSipAddress AyakaY@contosoIns.com -TargetFqdn Pool1.contoso.com -Authentication OAuthInteractive`
    
7. При появлении запроса введите учетные данные тестового пользователя. Убедитесь, что тест завершен успешно.
    
    > [!NOTE]
    > Если URL-адрес службы маркеров безопасности разрешается в службы федерации Active Directory *во внутренней сети* , строки, которое будут видеть будет запрос **Безопасности Windows** . Если он разрешается внешне, будет отображаться подсказка **Вход**. Обычно рекомендуется выполнить действия, которые приведут к отображению подсказки **Безопасность Windows**. Обратите внимание, что это поведение изменяется, особенно при реализации проверки подлинности по формам форм (FBA).
  
Также помните, что если URL-адрес STS разрешается во внутреннем сервере ADFS, а в веб-браузерах включена встроенная проверка подлинности Windows, на компьютерах, на которых много разных пользователей входят в клиентские приложения, будут возникать ошибки проверки подлинности, если в веб-браузере не настроено явным образом предлагать пользователям вводить учетные данные в определенной зоне безопасности. В качестве примера можно представить киоск. Учетная запись, под которой выполнен вход в операционную систему, может отличаться от учетной записи пользователя, под которой выполнен вход в клиент Skype для бизнеса. В этом случае могут возникнуть описанные здесь ошибки.
    
Можно просмотреть и изменить этот параметр браузера в Internet Explorer, нажав кнопку \> средства (или шестеренки) \> свойства обозревателя \> вкладку Безопасность \> и зоны безопасности (например, Местная интрасеть). В этом диалоговом окне нажмите кнопку "Другой" и прокрутите до конца списка в диалоговом окне "Параметры". В разделе Проверка подлинности пользователя \> входа в систему \> вы увидите параметр «Запрашивать имя пользователя и пароль». Если у вас есть киоски, где пользователь, запускающий клиент Skype для бизнеса, отличается (имеет другую учетную запись) от пользователя, вошедшего в компьютер, можно для таких компьютеров в целях тестирования установить для этого параметра значение "ВКЛ." в групповой политике.
    
Наконец, может отображаться несколько подсказок, так как система безопасности собирает данные, необходимые для проверки подлинности или авторизации вашей учетной записи.
    
### <a name="other-options-for-enabling-adal-sign-in-like-office-client-apps"></a>Другие варианты включения входа ADAL (например, в клиентских приложениях Office)
<a name="BKMK_Options"> </a>

Теперь, когда ADAL настроен для вашей Скайп для бизнеса и (автоматически) для клиентских приложений Office 2016 платформ, можно использовать его для Exchange Online (где он не «На» по умолчанию) или в клиентах Office 2013.
  
> [!IMPORTANT]
> Необходимо знать, чего следует ожидать от проверки подлинности на современном войти в систему из клиентских приложений? Рассмотрим [того, как современные выполняется проверка подлинности для Office 2013 и Office 2016 клиентских приложений](https://support.office.com/en-us/article/How-modern-authentication-works-for-Office-2013-and-Office-2016-client-apps-e4c45989-4b1a-462e-a81b-2a13191cf517?ui=en-US&amp;rs=en-US&amp;ad=US). 
  
Для включения проверки подлинности на современном на Exchange Online, необходимо выполнить некоторые командлеты PowerShell. В случае клиентских приложений Office 2013 необходимо изменить некоторые разделы реестра на клиентских компьютерах.
  
- Подключение к Exchange Online и выполните следующие командлеты:
    
     `Set-OrganizationConfig -OAuth2ClientProfileEnabled:$true`
    
     `Get-OrganizationConfig | ft name, *OAuth*`
    
- Настройте эти разделы реестра для каждого устройства и компьютера, на котором необходимо включить современную проверку подлинности. В крупных организациях необходимо использовать объекты групповой политики. Сведения о том, как сделать объект групповой Политики можно «Создать объект групповой политики для изменения реестра на компьютеров, входящих в домен» [этой ](https://support.office.com/en-us/article/Switching-between-the-Skype-for-Business-and-the-Lync-client-user-interfaces-a2394a4c-7522-484c-a047-7b3289742be0)статьи.
    
|Параметр реестра  <br/> |Тип  <br/> |Значение  <br/> |
|:-----|:-----|:-----|
|HKCU\SOFTWARE\Microsoft\Office\15.0\Common\Identity\EnableADAL  <br/> |REG_DWORD  <br/> |1  <br/> |
|HKCU\SOFTWARE\Microsoft\Office\15.0\Common\Identity\Version  <br/> |REG_DWORD  <br/> |1  <br/> |
   
После настройки этих разделов задайте приложений Office для [использования Multifactor проверки подлинности (многофакторной проверкой Подлинности) с помощью Office 365](https://support.office.com/en-us/article/Set-up-multi-factor-authentication-for-Office-365-8f0454b2-f51a-4d9c-bcde-2c48e41621c6?ui=en-US&amp;rs=en-US&amp;ad=US).
  
> [!TIP]
> Чтобы отключить современных проверки подлинности на устройствах для Office 2013, значение раздела реестра HKCU\SOFTWARE\Microsoft\Office\15.0\Common\Identity\EnableADAL нулевое значение. Обратите внимание, что следующий раздел реестра (HKCU\SOFTWARE\Microsoft\Office\ **16.0** \Common\Identity\EnableADAL) можно использовать также для отключения проверки подлинности на современном на устройствах 2016 Office.
  
### <a name="clients-where-modern-authentication--adal-isnt-supported"></a>Клиенты, на которых служба Modern Authentication или ADAL не поддерживается
<a name="BKMK_Support"> </a>

Некоторые версии клиентов не поддерживают протокол OAuth. Проверьте вашу версию клиента Office в разделе "Установка и удаление программ" панели управления и сравните с приведенными ниже номерами (и диапазоном) версий:
  
- Клиент Office 15.0. [0000-4766].\*
    
- Клиент Office 16.0. [0000-4293].\*
    
- Клиент Office 16.0.6001.[0000–1032]
    
- Клиент Office 16.0. [6000-6224].\*
    

