---
title: Этап AV и OAuth сертификаты в Скайп для сервера с использованием - Roll in Set-CsCertificate
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: 'Сводка: Рабочей области AV и OAuth сертификаты для Скайп для Business Server.'
ms.openlocfilehash: 793791ad882171e381eff751a6f57425de0c8ca7
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "33919397"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-using--roll-in-set-cscertificate"></a>Этап AV и OAuth сертификаты в Скайп для сервера с использованием - Roll in Set-CsCertificate
 
**Сводка:** Сертификаты рабочей области AV и OAuth для Скайп для Business Server.
  
Аудио/видео (A / V) коммуникации — это основной компонент Скайп для Business Server. Компонентов, таких как приложения общего доступа и аудио- и видеоконференций полагаться на сертификаты, назначенный A / видеоконференций, а именно A / V проверки подлинности службы.
  
> [!IMPORTANT]
> Этот новый компонент предназначен для работы для A / V Edge службы и сертификат OAuthTokenIssuer. Другие типы сертификатов можно подготовить к работе с вместе с A аудио- и видеоконференций и OAuth тип сертификата, но не будет пользоваться совместной работы, который A / V Edge сертификат службы будет.
  
Скайп по командлетам PowerShell командной консоли управления Business Server используется для управления Скайп сертификатов Business Server относится к A / V Edge службы в поле Тип AudioVideoAuthentication сертификат и сертификат OAuthServer как typeOAuthTokenIssuer. В оставшейся части этого раздела и для уникальной идентификации сертификаты они будут перенаправляться в с того же идентификатор типа AudioVideoAuthentication andOAuthTokenIssuer.
  
A / служба проверки подлинности аудио отвечает за помощью маркеров, используемых клиентами и другими A / V потребителей. Маркеры создаются из атрибутов в сертификате, а при истечении срока действия сертификата, приведет к потере подключения и требования для повторного подключения с помощью нового маркера, созданных функцией новый сертификат. Новая функция в Скайп для Business Server приведет к устранению этой проблемы — возможность этап новый сертификат до старый истечение срока действия и позволяет обоих сертификаты, чтобы продолжить использовать для периода времени. Эта функция использует обновленные возможности Скайп Set-CsCertificate для командлета консоли Business Server. Новый параметр-восстановить, с параметром существующих - EffectiveDate, будут помещены новый сертификат AudioVideoAuthentication в хранилище сертификатов. Старые сертификат AudioVideoAuthentication по-прежнему остается для выпущенные маркеры для. Приступая к работе с размещением новый сертификат AudioVideoAuthentication на месте, может возникнуть следующая последовательность событий:
  
> [!TIP]
> Командлеты командную консоль Business Server для управления сертификатами с помощью Скайп, можно запросить отличный сертификаты для каждой цели на пограничном сервере. С помощью мастера сертификатов в Скайп мастер развертывания Business Server упрощает создание сертификатов, но обычно типа по **умолчанию** , какие couples все сертификат используется для пограничного сервера на один сертификат. Если вы собираетесь использовать функцию динамическое сертификат рекомендуется для отделения сертификат AudioVideoAuthentication из назначения сертификатов. Можно подготовить и промежуточные сертификат типа по умолчанию, но только AudioVideoAuthentication часть объединенный сертификат выиграют от промежуточного хранения. Пользователь, к примеру, задействованных в сеанс обмена мгновенными сообщениями при истечении срока действия сертификата потребуется выйдите из системы и войдите снова, чтобы сделать использование нового сертификата, связанных со службой пограничного доступа. Аналогичное поведение для пользователя, участвующего в веб-конференции с помощью службы пограничного сервера Web конференц-связи. Сертификат OAuthTokenIssuer является определенного типа, которая совместно используется на всех серверах. Создание и управление ими в одном месте сертификат и сертификат хранится в центральное хранилище управления для всех других серверов.
  
Подробные необходим для полного понимания параметры и требования, когда с помощью командлета Set-CsCertificate и использование для стадии сертификаты до текущего сертификата истечение срока действия. -Откат параметр важно, но по сути единый назначения. Если вы определяете как параметр, вы указываете Set-CsCertificate, который будет предоставлять сведения о сертификате, который затрагиваются определяется - тип (например AudioVideoAuthentication и OAuthTokenIssuer), вступления сертификата эффективного определяется - EffectiveDate.
  
 **-Отката**: - откат параметр является обязательным и не имеет зависимости, которые должен задаваться вместе с ней. Обязательные параметры полное определение сертификатов, которые будут затронуты и как они будут применяться.
  
 **-EffectiveDate**: параметр - EffectiveDate определяет, когда новый сертификат становится co-active с текущего сертификата. -EffectiveDate может быть времени истечения срока действия текущего сертификата, или она может быть длительный период времени. Рекомендуемая Минимальная - EffectiveDate для сертификат AudioVideoAuthentication бы 8 часов, которая является срока жизни маркера по умолчанию для службы маркеров Аудио-и видеоданных, выдается сертификат AudioVideoAuthentication с помощью.
  
Промежуточные сертификаты OAuthTokenIssuer при разных требования для времени перед сертификат вступают в силу. Минимальное время, который должен иметь сертификат OAuthTokenIssuer для времени ожидания — 24 часов до время истечения срока действия текущего сертификата. Из-за других ролей сервера, зависящие от сертификат OAuthTokenIssuer (например, Exchange Server), который имеет больше времени хранения для проверки подлинности и шифрования ключом сертификата, созданного — расширенные времени для совместной работы материалы.
  
 **-Отпечаток**: отпечаток является атрибутом в сертификате, который является уникальным для этого сертификата. -Отпечаток параметр используется для идентификации сертификата, который будут затронуты при выполнении действий в командлет Set-CsCertificate.
  
 **-Тип**: - возможные значения параметра тип использования одного сертификата или запятыми список типов использования сертификата. Типы сертификатов — это списки, чтобы указать в командлет и к серверу возможности назначение сертификата. Например, тип AudioVideoAuthentication предназначен для использования с A / V Edge служба и служба проверки подлинности аудио/видео. Если вы решили рабочей области и подготовки сертификатов другого типа в то же время, необходимо учесть длинным необходимые эффективных мин для сертификатов. Например необходимо сертификаты рабочей области типа AudioVideoAuthentication и OAuthTokenIssuer. Ваше минимальные - EffectiveDate должно быть больше двух сертификатов, в данном случае OAuthTokenIssuer, насчитывающей мин 24 часов. Если не требуется этап сертификат AudioVideoAuthentication с временем производства 24 часов, включить его отдельно с EffectiveDate, который является более в ваши требования.
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a>Обновление или продление A / V Edge службы сертификата с помощью параметров - Roll и - EffectiveDate

1. Войдите на локальный компьютер как член группы "Администраторы".
    
2. Запросите Продление сертификата или новый сертификат AudioVideoAuthentication с экспортируемым закрытым ключом для текущего сертификата на A / V Edge службы.
    
3. Импортируйте новый сертификат AudioVideoAuthentication пограничного сервера и всех других пограничного сервера в пуле (при наличии развернутого пула).
    
4. Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate. Дата вступления в силу должны быть определены как текущего сертификата истек времени (14: 00:00 или 2:00:00 PM) минус срока жизни маркера (по умолчанию 8 часов). Это дает времени, сертификат должен иметь значение активный и - EffectiveDate \<строка\>: «7/22/2015 6:00:00 AM». 
    
    > [!IMPORTANT]
    > Для пограничного пула, необходимо иметь все сертификаты AudioVideoAuthentication развернута и подготовить к работе по дате и времени, определенного параметром - EffectiveDate первого сертификата развернут, чтобы избежать возможных A / V нарушения связи из-за более старый сертификат, срок действия перед всех маркеров клиента и потребитель был обновлен с помощью нового сертификата. 
  
    Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
   ```

    Пример команды Set-CsCertificate:
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
   ```

    > [!IMPORTANT]
    > EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры. В примере используется "мне Нравится" английский язык и региональные параметры 
  
Для дальнейшей ознакомиться с процессом, Set-CsCertificate, - Roll и - EffectiveDate используется для размещения нового сертификата создавать новые маркеры AudioVideoAuthentication во время по-прежнему использования существующего сертификата для проверки AudioVideoAuthentication, используемых по потребителям visual временной шкалы не эффективных способов основные сведения о процессе. В следующем примере администратор определяет, что A / V Edge сертификата службы из-за истечения срока действия с 2:00:00 в 07/22/2015. Он запрашивает и получает новый сертификат и импортирует каждый из пограничных серверов в пуле, его. В 02: 00 в 07/22/2015, он запускает командлет Get-CsCertificate с - Roll, - отпечаток, равное строка отпечаток нового сертификата и - EffectiveTime значение 07/22/2015 6:00:00 AM. Он запускает эту команду на каждом пограничном сервере.
  
![Использование параметров Roll и EffectiveDate.](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|**Выноска**|**Стадии**|
|:-----|:-----|
|1  <br/> |Начало: 7/22/2015 12:00:00 AM  <br/> Текущий сертификат AudioVideoAuthentication из-за истечения срока действия с 2:00:00 на 7/22/2015. Это определяется ограничивается отметкой времени в сертификате. Планирование замены сертификата и продолжения с учетом наложение 8 часов (срока жизни маркера по умолчанию) до существующего сертификата достигает истечения времени. Время ожидания 2:00:00 AM используется в данном примере для разрешения администратора достаточно времени для помещения и подготовка новых сертификатов до 6:00:00 AM время начала.  <br/> |
|2  <br/> |7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM  <br/> Установка сертификатов на пограничных серверах с время начала 6:00:00 AM (4 часов периода ожидания — в этом примере, но может быть больше) с помощью Set-CsCertificate-тип \<сертификата тип использования\> -отпечаток \<отпечаток нового сертификата\> - Развертывание - EffectiveDate \<строку даты и времени время начала для нового сертификата\>  <br/> |
|3  <br/> |7/22/2015 6:00:00 - 7/22/2015 2:00 PM  <br/> Для проверки маркеров, сначала производится попытка новый сертификат, а в случае сбоя новый сертификат для проверки маркера производится попытка старый сертификат. Этот процесс используется для всех маркеров во время периода обновления 8 часов (срока жизни маркера по умолчанию).  <br/> |
|4  <br/> |Конец: 7/22/2015 2:00:01 PM  <br/> Истек срок действия сертификата старый и новый сертификат обработан. Старый сертификат можно удалить с помощью Remove-CsCertificate-тип \<сертификата тип использования\> -предыдущей  <br/> |
   
При достижении время начала (7/22/2015 6:00:00: 00), все новые маркеры выданных новый сертификат. При проверке маркеры маркеры сначала быть проверен новый сертификат. Если не удается выполнить проверку, производится попытка старый сертификат. Процесс ознакомления с новые и уменьшение назад к старый сертификат будет предоставляться до времени истечения срока действия сертификата, старый. После истечения срока действия сертификата старый (7/22/2015 2:00:00 PM), маркеры проверяются только с новый сертификат. Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a>Обновление или продление OAuthTokenIssuer сертификата с помощью параметров - Roll и - EffectiveDate

1. Войдите на локальный компьютер как член группы "Администраторы".
    
2. Запросите Продление сертификата или новый сертификат OAuthTokenIssuer с экспортируемым закрытым ключом для текущего сертификата на сервере переднего плана.
    
3. Импортируйте новый сертификат OAuthTokenIssuer на сервере переднего плана в пуле (при наличии развернутого пула). Сертификат OAuthTokenIssuer глобально репликации и только для обновления и обновленной панели мониторинга на любом сервере в развертывании. Сервер переднего плана используется в качестве примера.
    
4. Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate. Дата вступления в силу должны быть определены как текущего сертификата истек времени (14: 00:00 или 2:00:00 PM) минус не менее 24 часов. 
    
    Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:
    
   ```
   Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
   ```

Пример команды Set-CsCertificate:
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры. В примере используется "мне Нравится" английский язык и региональные параметры 
  
При достижении время начала (7/21/2015 1:00:00 AM), все новые маркеры выданных новый сертификат. При проверке маркеры маркеры сначала быть проверен новый сертификат. Если не удается выполнить проверку, производится попытка старый сертификат. Процесс ознакомления с новые и уменьшение назад к старый сертификат будет предоставляться до времени истечения срока действия сертификата, старый. После истечения срока действия сертификата старый (7/22/2015 2:00:00 PM), маркеры проверяются только с новый сертификат. Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a>См. также

[Управление проверки подлинности сервер сервер (OAuth) и партнерских приложений в Скайп для Business Server](server-to-server-and-partner-applications.md)

[Set-CsCertificate](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[Remove-CsCertificate](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)
