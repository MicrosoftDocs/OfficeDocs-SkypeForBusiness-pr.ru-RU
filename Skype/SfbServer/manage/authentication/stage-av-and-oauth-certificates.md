---
title: Этап AV и OAuth сертификаты в Скайп для сервера с использованием - Roll in Set-CsCertificate
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: 'Сводка: Рабочей области AV и OAuth сертификаты для Скайп для Business Server.'
ms.openlocfilehash: 793791ad882171e381eff751a6f57425de0c8ca7
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "33919397"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-using--roll-in-set-cscertificate"></a><span data-ttu-id="d33b0-103">Этап AV и OAuth сертификаты в Скайп для сервера с использованием - Roll in Set-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="d33b0-103">Stage AV and OAuth certificates in Skype for Business Server using -Roll in Set-CsCertificate</span></span>
 
<span data-ttu-id="d33b0-104">**Сводка:** Сертификаты рабочей области AV и OAuth для Скайп для Business Server.</span><span class="sxs-lookup"><span data-stu-id="d33b0-104">**Summary:** Stage AV and OAuth certificates for Skype for Business Server.</span></span>
  
<span data-ttu-id="d33b0-105">Аудио/видео (A / V) коммуникации — это основной компонент Скайп для Business Server.</span><span class="sxs-lookup"><span data-stu-id="d33b0-105">Audio/Video (A/V) communications is a key component of Skype for Business Server.</span></span> <span data-ttu-id="d33b0-106">Компонентов, таких как приложения общего доступа и аудио- и видеоконференций полагаться на сертификаты, назначенный A / видеоконференций, а именно A / V проверки подлинности службы.</span><span class="sxs-lookup"><span data-stu-id="d33b0-106">Features such as application sharing and audio and video conferencing rely on the certificates assigned to the A/V Edge service, specifically the A/V Authentication service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="d33b0-107">Этот новый компонент предназначен для работы для A / V Edge службы и сертификат OAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="d33b0-107">This new feature is designed to work for the A/V Edge service and the OAuthTokenIssuer certificate.</span></span> <span data-ttu-id="d33b0-108">Другие типы сертификатов можно подготовить к работе с вместе с A аудио- и видеоконференций и OAuth тип сертификата, но не будет пользоваться совместной работы, который A / V Edge сертификат службы будет.</span><span class="sxs-lookup"><span data-stu-id="d33b0-108">Other certificate types can be provisioned along with the A/V Edge service and OAuth certificate type, but will not benefit from the coexistence behavior that the A/V Edge service certificate will.</span></span>
  
<span data-ttu-id="d33b0-109">Скайп по командлетам PowerShell командной консоли управления Business Server используется для управления Скайп сертификатов Business Server относится к A / V Edge службы в поле Тип AudioVideoAuthentication сертификат и сертификат OAuthServer как typeOAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="d33b0-109">The Skype for Business Server Management Shell PowerShell cmdlets used to manage Skype for Business Server certificates refers to the A/V Edge service certificate as the AudioVideoAuthentication certificate type and the OAuthServer certificate as typeOAuthTokenIssuer.</span></span> <span data-ttu-id="d33b0-110">В оставшейся части этого раздела и для уникальной идентификации сертификаты они будут перенаправляться в с того же идентификатор типа AudioVideoAuthentication andOAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="d33b0-110">For the rest of this topic and to uniquely identify the certificates, they will be referred to by the same identifier type, AudioVideoAuthentication andOAuthTokenIssuer.</span></span>
  
<span data-ttu-id="d33b0-111">A / служба проверки подлинности аудио отвечает за помощью маркеров, используемых клиентами и другими A / V потребителей.</span><span class="sxs-lookup"><span data-stu-id="d33b0-111">The A/V Authentication service is responsible for issuing tokens that are used by clients and other A/V consumers.</span></span> <span data-ttu-id="d33b0-112">Маркеры создаются из атрибутов в сертификате, а при истечении срока действия сертификата, приведет к потере подключения и требования для повторного подключения с помощью нового маркера, созданных функцией новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-112">The tokens are generated from attributes on the certificate, and when the certificate expires, loss of connection and requirement to rejoin with a new token generated by the new certificate will result.</span></span> <span data-ttu-id="d33b0-113">Новая функция в Скайп для Business Server приведет к устранению этой проблемы — возможность этап новый сертификат до старый истечение срока действия и позволяет обоих сертификаты, чтобы продолжить использовать для периода времени.</span><span class="sxs-lookup"><span data-stu-id="d33b0-113">A new feature in Skype for Business Server will alleviate this problem - the ability to stage a new certificate in advance of the old one expiring and allowing both certificates to continue to function for a period of time.</span></span> <span data-ttu-id="d33b0-114">Эта функция использует обновленные возможности Скайп Set-CsCertificate для командлета консоли Business Server.</span><span class="sxs-lookup"><span data-stu-id="d33b0-114">This feature uses updated functionality in the Set-CsCertificate Skype for Business Server Management Shell cmdlet.</span></span> <span data-ttu-id="d33b0-115">Новый параметр-восстановить, с параметром существующих - EffectiveDate, будут помещены новый сертификат AudioVideoAuthentication в хранилище сертификатов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-115">The new parameter -Roll, with the existing parameter -EffectiveDate, will place the new AudioVideoAuthentication certificate in the certificate store.</span></span> <span data-ttu-id="d33b0-116">Старые сертификат AudioVideoAuthentication по-прежнему остается для выпущенные маркеры для.</span><span class="sxs-lookup"><span data-stu-id="d33b0-116">The older AudioVideoAuthentication certificate will still remain for issued tokens to be validated against.</span></span> <span data-ttu-id="d33b0-117">Приступая к работе с размещением новый сертификат AudioVideoAuthentication на месте, может возникнуть следующая последовательность событий:</span><span class="sxs-lookup"><span data-stu-id="d33b0-117">Beginning with putting the new AudioVideoAuthentication certificate in place, the following series of events will occur:</span></span>
  
> [!TIP]
> <span data-ttu-id="d33b0-118">Командлеты командную консоль Business Server для управления сертификатами с помощью Скайп, можно запросить отличный сертификаты для каждой цели на пограничном сервере.</span><span class="sxs-lookup"><span data-stu-id="d33b0-118">Using the Skype for Business Server Management Shell cmdlets for managing certificates, you can request separate and distinct certificates for each purpose on the Edge Server.</span></span> <span data-ttu-id="d33b0-119">С помощью мастера сертификатов в Скайп мастер развертывания Business Server упрощает создание сертификатов, но обычно типа по **умолчанию** , какие couples все сертификат используется для пограничного сервера на один сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-119">Using the Certificate Wizard in the Skype for Business Server Deployment Wizard assists you in creating certificates, but is typically of the **default** type which couples all certificate uses for the Edge Server onto a single certificate.</span></span> <span data-ttu-id="d33b0-120">Если вы собираетесь использовать функцию динамическое сертификат рекомендуется для отделения сертификат AudioVideoAuthentication из назначения сертификатов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-120">The recommended practice if you are going to use the rolling certificate feature is to decouple the AudioVideoAuthentication certificate from the other certificate purposes.</span></span> <span data-ttu-id="d33b0-121">Можно подготовить и промежуточные сертификат типа по умолчанию, но только AudioVideoAuthentication часть объединенный сертификат выиграют от промежуточного хранения.</span><span class="sxs-lookup"><span data-stu-id="d33b0-121">You can provision and stage a certificate of the Default type, but only the AudioVideoAuthentication portion of the combined certificate will benefit from the staging.</span></span> <span data-ttu-id="d33b0-122">Пользователь, к примеру, задействованных в сеанс обмена мгновенными сообщениями при истечении срока действия сертификата потребуется выйдите из системы и войдите снова, чтобы сделать использование нового сертификата, связанных со службой пограничного доступа.</span><span class="sxs-lookup"><span data-stu-id="d33b0-122">A user involved in (for example) an instant messaging conversation when the certificate expires will need to log out and log back in to make use of the new certificate associated with the Access Edge service.</span></span> <span data-ttu-id="d33b0-123">Аналогичное поведение для пользователя, участвующего в веб-конференции с помощью службы пограничного сервера Web конференц-связи.</span><span class="sxs-lookup"><span data-stu-id="d33b0-123">Similar behavior will occur for a user involved in a Web conference using the Web Conferencing Edge service.</span></span> <span data-ttu-id="d33b0-124">Сертификат OAuthTokenIssuer является определенного типа, которая совместно используется на всех серверах.</span><span class="sxs-lookup"><span data-stu-id="d33b0-124">The OAuthTokenIssuer certificate is a specific type that is shared across all servers.</span></span> <span data-ttu-id="d33b0-125">Создание и управление ими в одном месте сертификат и сертификат хранится в центральное хранилище управления для всех других серверов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-125">You create and manage the certificate in one place and the certificate is stored in the Central Management store for all other servers.</span></span>
  
<span data-ttu-id="d33b0-126">Подробные необходим для полного понимания параметры и требования, когда с помощью командлета Set-CsCertificate и использование для стадии сертификаты до текущего сертификата истечение срока действия.</span><span class="sxs-lookup"><span data-stu-id="d33b0-126">Additional detail is needed to fully understand your options and requirements when using the Set-CsCertificate cmdlet and using it to stage certificates prior to the current certificate expiring.</span></span> <span data-ttu-id="d33b0-127">-Откат параметр важно, но по сути единый назначения.</span><span class="sxs-lookup"><span data-stu-id="d33b0-127">The -Roll parameter is important, but essentially single purpose.</span></span> <span data-ttu-id="d33b0-128">Если вы определяете как параметр, вы указываете Set-CsCertificate, который будет предоставлять сведения о сертификате, который затрагиваются определяется - тип (например AudioVideoAuthentication и OAuthTokenIssuer), вступления сертификата эффективного определяется - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="d33b0-128">If you define it as a parameter, you are telling Set-CsCertificate that you will be providing information about the certificate that will be affected defined by -Type (for example AudioVideoAuthentication and OAuthTokenIssuer), when the certificate will become effective defined by -EffectiveDate.</span></span>
  
 <span data-ttu-id="d33b0-129">**-Отката**: - откат параметр является обязательным и не имеет зависимости, которые должен задаваться вместе с ней.</span><span class="sxs-lookup"><span data-stu-id="d33b0-129">**-Roll**: The -Roll parameter is required and has dependencies that must be supplied along with it.</span></span> <span data-ttu-id="d33b0-130">Обязательные параметры полное определение сертификатов, которые будут затронуты и как они будут применяться.</span><span class="sxs-lookup"><span data-stu-id="d33b0-130">Required parameters to fully define which certificates will be affected and how they will be applied:</span></span>
  
 <span data-ttu-id="d33b0-131">**-EffectiveDate**: параметр - EffectiveDate определяет, когда новый сертификат становится co-active с текущего сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-131">**-EffectiveDate**: The parameter -EffectiveDate defines when the new certificate will become co-active with the current certificate.</span></span> <span data-ttu-id="d33b0-132">-EffectiveDate может быть времени истечения срока действия текущего сертификата, или она может быть длительный период времени.</span><span class="sxs-lookup"><span data-stu-id="d33b0-132">The -EffectiveDate can be close to the expiry time of the current certificate, or it can be a longer period of time.</span></span> <span data-ttu-id="d33b0-133">Рекомендуемая Минимальная - EffectiveDate для сертификат AudioVideoAuthentication бы 8 часов, которая является срока жизни маркера по умолчанию для службы маркеров Аудио-и видеоданных, выдается сертификат AudioVideoAuthentication с помощью.</span><span class="sxs-lookup"><span data-stu-id="d33b0-133">A recommended minimum -EffectiveDate for the AudioVideoAuthentication certificate would be 8 hours, which is the default token lifetime for AV Edge service tokens issued using the AudioVideoAuthentication certificate.</span></span>
  
<span data-ttu-id="d33b0-134">Промежуточные сертификаты OAuthTokenIssuer при разных требования для времени перед сертификат вступают в силу.</span><span class="sxs-lookup"><span data-stu-id="d33b0-134">When staging OAuthTokenIssuer certificates, there are different requirements for the lead time before the certificate can become effective.</span></span> <span data-ttu-id="d33b0-135">Минимальное время, который должен иметь сертификат OAuthTokenIssuer для времени ожидания — 24 часов до время истечения срока действия текущего сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-135">The minimum time that the OAuthTokenIssuer certificate should have for its lead time is 24 hours before the expiration time of the current certificate.</span></span> <span data-ttu-id="d33b0-136">Из-за других ролей сервера, зависящие от сертификат OAuthTokenIssuer (например, Exchange Server), который имеет больше времени хранения для проверки подлинности и шифрования ключом сертификата, созданного — расширенные времени для совместной работы материалы.</span><span class="sxs-lookup"><span data-stu-id="d33b0-136">The extended lead time for the coexistence is because of other server roles that are dependent on the OAuthTokenIssuer certificate (Exchange Server, for example) which has a longer retention time for certificate created authentication and encryption key materials.</span></span>
  
 <span data-ttu-id="d33b0-137">**-Отпечаток**: отпечаток является атрибутом в сертификате, который является уникальным для этого сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-137">**-Thumbprint**: The thumbprint is an attribute on the certificate that is unique to that certificate.</span></span> <span data-ttu-id="d33b0-138">-Отпечаток параметр используется для идентификации сертификата, который будут затронуты при выполнении действий в командлет Set-CsCertificate.</span><span class="sxs-lookup"><span data-stu-id="d33b0-138">The -Thumbprint parameter is used to identify the certificate that will be affected by the actions of the Set-CsCertificate cmdlet.</span></span>
  
 <span data-ttu-id="d33b0-139">**-Тип**: - возможные значения параметра тип использования одного сертификата или запятыми список типов использования сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-139">**-Type**: The -Type parameter can accept a single certificate usage type or a comma separated list of certificate usage types.</span></span> <span data-ttu-id="d33b0-140">Типы сертификатов — это списки, чтобы указать в командлет и к серверу возможности назначение сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-140">The certificate types are those that identify to the cmdlet and to the server what the purpose of the certificate is.</span></span> <span data-ttu-id="d33b0-141">Например, тип AudioVideoAuthentication предназначен для использования с A / V Edge служба и служба проверки подлинности аудио/видео.</span><span class="sxs-lookup"><span data-stu-id="d33b0-141">For example, type AudioVideoAuthentication is for use by the A/V Edge service and the AV Authentication service.</span></span> <span data-ttu-id="d33b0-142">Если вы решили рабочей области и подготовки сертификатов другого типа в то же время, необходимо учесть длинным необходимые эффективных мин для сертификатов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-142">If you decide to stage and provision certificates of a different type at the same time, you must consider the longest required minimum effective lead time for the certificates.</span></span> <span data-ttu-id="d33b0-143">Например необходимо сертификаты рабочей области типа AudioVideoAuthentication и OAuthTokenIssuer.</span><span class="sxs-lookup"><span data-stu-id="d33b0-143">For example, you need to stage certificates of type AudioVideoAuthentication and OAuthTokenIssuer.</span></span> <span data-ttu-id="d33b0-144">Ваше минимальные - EffectiveDate должно быть больше двух сертификатов, в данном случае OAuthTokenIssuer, насчитывающей мин 24 часов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-144">Your minimum -EffectiveDate must be the greater of the two certificates, in this case the OAuthTokenIssuer, which has a minimum lead time of 24 hours.</span></span> <span data-ttu-id="d33b0-145">Если не требуется этап сертификат AudioVideoAuthentication с временем производства 24 часов, включить его отдельно с EffectiveDate, который является более в ваши требования.</span><span class="sxs-lookup"><span data-stu-id="d33b0-145">If you do not want to stage the AudioVideoAuthentication certificate with a lead time of 24 hours, stage it separately with an EffectiveDate that is more to your requirements.</span></span>
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="d33b0-146">Обновление или продление A / V Edge службы сертификата с помощью параметров - Roll и - EffectiveDate</span><span class="sxs-lookup"><span data-stu-id="d33b0-146">To update or renew an A/V Edge service certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="d33b0-147">Войдите на локальный компьютер как член группы "Администраторы".</span><span class="sxs-lookup"><span data-stu-id="d33b0-147">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="d33b0-148">Запросите Продление сертификата или новый сертификат AudioVideoAuthentication с экспортируемым закрытым ключом для текущего сертификата на A / V Edge службы.</span><span class="sxs-lookup"><span data-stu-id="d33b0-148">Request a renewal or new AudioVideoAuthentication certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>
    
3. <span data-ttu-id="d33b0-149">Импортируйте новый сертификат AudioVideoAuthentication пограничного сервера и всех других пограничного сервера в пуле (при наличии развернутого пула).</span><span class="sxs-lookup"><span data-stu-id="d33b0-149">Import the new AudioVideoAuthentication certificate to the Edge Server and all other Edge Server in your pool (if you have a pool deployed).</span></span>
    
4. <span data-ttu-id="d33b0-150">Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="d33b0-150">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="d33b0-151">Дата вступления в силу должны быть определены как текущего сертификата истек времени (14: 00:00 или 2:00:00 PM) минус срока жизни маркера (по умолчанию 8 часов).</span><span class="sxs-lookup"><span data-stu-id="d33b0-151">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus token lifetime (by default eight hours).</span></span> <span data-ttu-id="d33b0-152">Это дает времени, сертификат должен иметь значение активный и - EffectiveDate \<строка\>: «7/22/2015 6:00:00 AM».</span><span class="sxs-lookup"><span data-stu-id="d33b0-152">This gives us a time that the certificate must be set to active, and is the -EffectiveDate \<string\>: "7/22/2015 6:00:00 AM".</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="d33b0-153">Для пограничного пула, необходимо иметь все сертификаты AudioVideoAuthentication развернута и подготовить к работе по дате и времени, определенного параметром - EffectiveDate первого сертификата развернут, чтобы избежать возможных A / V нарушения связи из-за более старый сертификат, срок действия перед всех маркеров клиента и потребитель был обновлен с помощью нового сертификата.</span><span class="sxs-lookup"><span data-stu-id="d33b0-153">For an Edge pool, you must have all AudioVideoAuthentication certificates deployed and provisioned by the date and time defined by the -EffectiveDate parameter of the first certificate deployed to avoid possible A/V communications disruption due to the older certificate expiring before all client and consumer tokens have been renewed using the new certificate.</span></span> 
  
    <span data-ttu-id="d33b0-154">Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:</span><span class="sxs-lookup"><span data-stu-id="d33b0-154">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
   ```

    <span data-ttu-id="d33b0-155">Пример команды Set-CsCertificate:</span><span class="sxs-lookup"><span data-stu-id="d33b0-155">An example Set-CsCertificate command:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
   ```

    > [!IMPORTANT]
    > <span data-ttu-id="d33b0-156">EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры.</span><span class="sxs-lookup"><span data-stu-id="d33b0-156">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="d33b0-157">В примере используется "мне Нравится" английский язык и региональные параметры</span><span class="sxs-lookup"><span data-stu-id="d33b0-157">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="d33b0-158">Для дальнейшей ознакомиться с процессом, Set-CsCertificate, - Roll и - EffectiveDate используется для размещения нового сертификата создавать новые маркеры AudioVideoAuthentication во время по-прежнему использования существующего сертификата для проверки AudioVideoAuthentication, используемых по потребителям visual временной шкалы не эффективных способов основные сведения о процессе.</span><span class="sxs-lookup"><span data-stu-id="d33b0-158">To further understand the process that Set-CsCertificate, -Roll, and -EffectiveDate use to stage a new certificate for issuing new AudioVideoAuthentication tokens while still using an existing certificate to validate AudioVideoAuthentication that are in use by consumers, a visual timeline is an effective means of understanding the process.</span></span> <span data-ttu-id="d33b0-159">В следующем примере администратор определяет, что A / V Edge сертификата службы из-за истечения срока действия с 2:00:00 в 07/22/2015.</span><span class="sxs-lookup"><span data-stu-id="d33b0-159">In the following example, the administrator determines that the A/V Edge service certificate is due to expire at 2:00:00 PM on 07/22/2015.</span></span> <span data-ttu-id="d33b0-160">Он запрашивает и получает новый сертификат и импортирует каждый из пограничных серверов в пуле, его.</span><span class="sxs-lookup"><span data-stu-id="d33b0-160">He requests and receives a new certificate and imports it to each Edge Server in his pool.</span></span> <span data-ttu-id="d33b0-161">В 02: 00 в 07/22/2015, он запускает командлет Get-CsCertificate с - Roll, - отпечаток, равное строка отпечаток нового сертификата и - EffectiveTime значение 07/22/2015 6:00:00 AM.</span><span class="sxs-lookup"><span data-stu-id="d33b0-161">At 2 AM on 07/22/2015, he begins running Get-CsCertificate with -Roll, -Thumbprint equal to the thumbprint string of the new certificate, and -EffectiveTime set to 07/22/2015 6:00:00 AM.</span></span> <span data-ttu-id="d33b0-162">Он запускает эту команду на каждом пограничном сервере.</span><span class="sxs-lookup"><span data-stu-id="d33b0-162">He runs this command on each Edge Server.</span></span>
  
![Использование параметров Roll и EffectiveDate.](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|<span data-ttu-id="d33b0-164">**Выноска**</span><span class="sxs-lookup"><span data-stu-id="d33b0-164">**Callout**</span></span>|<span data-ttu-id="d33b0-165">**Стадии**</span><span class="sxs-lookup"><span data-stu-id="d33b0-165">**Stage**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d33b0-166">1</span><span class="sxs-lookup"><span data-stu-id="d33b0-166">1</span></span>  <br/> |<span data-ttu-id="d33b0-167">Начало: 7/22/2015 12:00:00 AM</span><span class="sxs-lookup"><span data-stu-id="d33b0-167">Start: 7/22/2015 12:00:00 AM</span></span>  <br/> <span data-ttu-id="d33b0-168">Текущий сертификат AudioVideoAuthentication из-за истечения срока действия с 2:00:00 на 7/22/2015.</span><span class="sxs-lookup"><span data-stu-id="d33b0-168">The current AudioVideoAuthentication certificate is due to expire at 2:00:00 PM on 7/22/2015.</span></span> <span data-ttu-id="d33b0-169">Это определяется ограничивается отметкой времени в сертификате.</span><span class="sxs-lookup"><span data-stu-id="d33b0-169">This is determined by the expires time stamp on the certificate.</span></span> <span data-ttu-id="d33b0-170">Планирование замены сертификата и продолжения с учетом наложение 8 часов (срока жизни маркера по умолчанию) до существующего сертификата достигает истечения времени.</span><span class="sxs-lookup"><span data-stu-id="d33b0-170">Plan your certificate replacement and rollover to account for an 8 hour overlap (default token lifetime) before the existing certificate reaches the expire time.</span></span> <span data-ttu-id="d33b0-171">Время ожидания 2:00:00 AM используется в данном примере для разрешения администратора достаточно времени для помещения и подготовка новых сертификатов до 6:00:00 AM время начала.</span><span class="sxs-lookup"><span data-stu-id="d33b0-171">The 2:00:00 AM lead time is used in this example to allow the administrator adequate time to place and provision the new certificates in advance of the 6:00:00 AM effective time.</span></span>  <br/> |
|<span data-ttu-id="d33b0-172">2</span><span class="sxs-lookup"><span data-stu-id="d33b0-172">2</span></span>  <br/> |<span data-ttu-id="d33b0-173">7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM</span><span class="sxs-lookup"><span data-stu-id="d33b0-173">7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM</span></span>  <br/> <span data-ttu-id="d33b0-174">Установка сертификатов на пограничных серверах с время начала 6:00:00 AM (4 часов периода ожидания — в этом примере, но может быть больше) с помощью Set-CsCertificate-тип \<сертификата тип использования\> -отпечаток \<отпечаток нового сертификата\> - Развертывание - EffectiveDate \<строку даты и времени время начала для нового сертификата\></span><span class="sxs-lookup"><span data-stu-id="d33b0-174">Set Certificates on Edge Servers with effective time of 6:00:00 AM (4 hour lead time is for this example, but can be longer) using Set-CsCertificate -Type \<certificate usage type\> -Thumbprint \<thumbprint of new certificate\> -Roll -EffectiveDate \<datetime string of the effective time for new certificate\></span></span>  <br/> |
|<span data-ttu-id="d33b0-175">3</span><span class="sxs-lookup"><span data-stu-id="d33b0-175">3</span></span>  <br/> |<span data-ttu-id="d33b0-176">7/22/2015 6:00:00 - 7/22/2015 2:00 PM</span><span class="sxs-lookup"><span data-stu-id="d33b0-176">7/22/2015 6:00 AM - 7/22/2015 2:00 PM</span></span>  <br/> <span data-ttu-id="d33b0-177">Для проверки маркеров, сначала производится попытка новый сертификат, а в случае сбоя новый сертификат для проверки маркера производится попытка старый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-177">To validate tokens, the new certificate is tried first, and if the new certificate fails to validate the token, the old certificate is tried.</span></span> <span data-ttu-id="d33b0-178">Этот процесс используется для всех маркеров во время периода обновления 8 часов (срока жизни маркера по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="d33b0-178">This process is used for all tokens during the 8 hour (default token lifetime) overlap period.</span></span>  <br/> |
|<span data-ttu-id="d33b0-179">4</span><span class="sxs-lookup"><span data-stu-id="d33b0-179">4</span></span>  <br/> |<span data-ttu-id="d33b0-180">Конец: 7/22/2015 2:00:01 PM</span><span class="sxs-lookup"><span data-stu-id="d33b0-180">End: 7/22/2015 2:00:01 PM</span></span>  <br/> <span data-ttu-id="d33b0-181">Истек срок действия сертификата старый и новый сертификат обработан.</span><span class="sxs-lookup"><span data-stu-id="d33b0-181">Old certificate has expired and the new certificate has taken over.</span></span> <span data-ttu-id="d33b0-182">Старый сертификат можно удалить с помощью Remove-CsCertificate-тип \<сертификата тип использования\> -предыдущей</span><span class="sxs-lookup"><span data-stu-id="d33b0-182">Old certificate can be safely removed with Remove-CsCertificate -Type \<certificate usage type\> -Previous</span></span>  <br/> |
   
<span data-ttu-id="d33b0-183">При достижении время начала (7/22/2015 6:00:00: 00), все новые маркеры выданных новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-183">When the effective time is reached (7/22/2015 6:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="d33b0-184">При проверке маркеры маркеры сначала быть проверен новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-184">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="d33b0-185">Если не удается выполнить проверку, производится попытка старый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-185">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="d33b0-186">Процесс ознакомления с новые и уменьшение назад к старый сертификат будет предоставляться до времени истечения срока действия сертификата, старый.</span><span class="sxs-lookup"><span data-stu-id="d33b0-186">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="d33b0-187">После истечения срока действия сертификата старый (7/22/2015 2:00:00 PM), маркеры проверяются только с новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-187">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="d33b0-188">Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.</span><span class="sxs-lookup"><span data-stu-id="d33b0-188">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="d33b0-189">Обновление или продление OAuthTokenIssuer сертификата с помощью параметров - Roll и - EffectiveDate</span><span class="sxs-lookup"><span data-stu-id="d33b0-189">To update or renew an OAuthTokenIssuer certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="d33b0-190">Войдите на локальный компьютер как член группы "Администраторы".</span><span class="sxs-lookup"><span data-stu-id="d33b0-190">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="d33b0-191">Запросите Продление сертификата или новый сертификат OAuthTokenIssuer с экспортируемым закрытым ключом для текущего сертификата на сервере переднего плана.</span><span class="sxs-lookup"><span data-stu-id="d33b0-191">Request a renewal or new OAuthTokenIssuer certificate with exportable private key for the existing certificate on the Front End Server.</span></span>
    
3. <span data-ttu-id="d33b0-192">Импортируйте новый сертификат OAuthTokenIssuer на сервере переднего плана в пуле (при наличии развернутого пула).</span><span class="sxs-lookup"><span data-stu-id="d33b0-192">Import the new OAuthTokenIssuer certificate to a Front End Server in your pool (if you have a pool deployed).</span></span> <span data-ttu-id="d33b0-193">Сертификат OAuthTokenIssuer глобально репликации и только для обновления и обновленной панели мониторинга на любом сервере в развертывании.</span><span class="sxs-lookup"><span data-stu-id="d33b0-193">The OAuthTokenIssuer certificate is replicated globally and only needs to be updated and renewed at any server in your deployment.</span></span> <span data-ttu-id="d33b0-194">Сервер переднего плана используется в качестве примера.</span><span class="sxs-lookup"><span data-stu-id="d33b0-194">The Front End Server is used as an example.</span></span>
    
4. <span data-ttu-id="d33b0-195">Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate.</span><span class="sxs-lookup"><span data-stu-id="d33b0-195">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="d33b0-196">Дата вступления в силу должны быть определены как текущего сертификата истек времени (14: 00:00 или 2:00:00 PM) минус не менее 24 часов.</span><span class="sxs-lookup"><span data-stu-id="d33b0-196">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus a minimum of 24 hours.</span></span> 
    
    <span data-ttu-id="d33b0-197">Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:</span><span class="sxs-lookup"><span data-stu-id="d33b0-197">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
   ```

<span data-ttu-id="d33b0-198">Пример команды Set-CsCertificate:</span><span class="sxs-lookup"><span data-stu-id="d33b0-198">An example Set-CsCertificate command:</span></span>
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> <span data-ttu-id="d33b0-199">EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры.</span><span class="sxs-lookup"><span data-stu-id="d33b0-199">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="d33b0-200">В примере используется "мне Нравится" английский язык и региональные параметры</span><span class="sxs-lookup"><span data-stu-id="d33b0-200">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="d33b0-201">При достижении время начала (7/21/2015 1:00:00 AM), все новые маркеры выданных новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-201">When the effective time is reached (7/21/2015 1:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="d33b0-202">При проверке маркеры маркеры сначала быть проверен новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-202">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="d33b0-203">Если не удается выполнить проверку, производится попытка старый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-203">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="d33b0-204">Процесс ознакомления с новые и уменьшение назад к старый сертификат будет предоставляться до времени истечения срока действия сертификата, старый.</span><span class="sxs-lookup"><span data-stu-id="d33b0-204">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="d33b0-205">После истечения срока действия сертификата старый (7/22/2015 2:00:00 PM), маркеры проверяются только с новый сертификат.</span><span class="sxs-lookup"><span data-stu-id="d33b0-205">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="d33b0-206">Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.</span><span class="sxs-lookup"><span data-stu-id="d33b0-206">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a><span data-ttu-id="d33b0-207">См. также</span><span class="sxs-lookup"><span data-stu-id="d33b0-207">See also</span></span>

[<span data-ttu-id="d33b0-208">Управление проверки подлинности сервер сервер (OAuth) и партнерских приложений в Скайп для Business Server</span><span class="sxs-lookup"><span data-stu-id="d33b0-208">Manage server-to-server authentication (OAuth) and partner applications in Skype for Business Server</span></span>](server-to-server-and-partner-applications.md)

[<span data-ttu-id="d33b0-209">Set-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="d33b0-209">Set-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[<span data-ttu-id="d33b0-210">Remove-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="d33b0-210">Remove-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)
