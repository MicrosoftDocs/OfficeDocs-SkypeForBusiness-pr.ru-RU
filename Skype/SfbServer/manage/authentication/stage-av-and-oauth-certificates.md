---
title: Этапы сертифицирования AV и OAuth в Skype для бизнеса Server 2015 с использованием -Roll in Set-CsCertificate
ms.author: heidip
author: microsoftheidi
manager: serdars
ms.date: 1/31/2018
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: 'Сводка: Рабочей области AV и OAuth сертификаты для Скайп для Business Server 2015.'
ms.openlocfilehash: 8d13a2e647861fadcc89c0a95442a79fe45c6124
ms.sourcegitcommit: a5b8b0a1e5ae5eb718e296ca6df6687368ee9174
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2018
ms.locfileid: "19504917"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-2015-using--roll-in-set-cscertificate"></a>Этапы сертифицирования AV и OAuth в Skype для бизнеса Server 2015 с использованием -Roll in Set-CsCertificate
 
**Сводка:** Сертификаты рабочей области AV и OAuth для Скайп для Business Server 2015.
  
Аудио/видео (A / V) коммуникации — это основной компонент Скайп для Business Server 2015. Компонентов, таких как приложения общего доступа и аудио- и видеоконференций полагаться на сертификаты, назначенный A / видеоконференций, а именно A / V проверки подлинности службы.
  
> [!IMPORTANT]
> Этот новый компонент предназначен для работы для A / V Edge службы и сертификат OAuthTokenIssuer. Другие типы сертификатов можно подготовить к работе с вместе с A аудио- и видеоконференций и OAuth тип сертификата, но не будет пользоваться совместной работы, который A / V Edge сертификат службы будет.
  
Скайп по командлетам PowerShell командной консоли управления Business Server используется для управления Скайп сертификатов Business Server 2015 относится к A / V Edge службы в поле Тип AudioVideoAuthentication сертификат и сертификат OAuthServer как typeOAuthTokenIssuer. В оставшейся части этого раздела и для уникальной идентификации сертификаты они будут перенаправляться в с того же идентификатор типа AudioVideoAuthentication andOAuthTokenIssuer.
  
Служба проверки подлинности аудио- и видеоконференций отвечает за выдачу маркеров, используемых клиентами и другими пользователями аудио- и видеоконференций. Маркеры создаются на основе атрибутов сертификата, и по истечении срока действия сертификата, происходит разрыв соединения или отображается запрос на повторное подключение с использованием нового маркера, созданного новым сертификатом. Новая функция в Скайп для Business Server 2015 приведет к устранению этой проблемы — возможность этап новый сертификат до старый истечение срока действия и позволяет обоих сертификаты, чтобы продолжить использовать для периода времени. Эта функция использует обновленные возможности Скайп Set-CsCertificate для командлета консоли Business Server. Новый параметр-восстановить, с параметром существующих - EffectiveDate, будут помещены новый сертификат AudioVideoAuthentication в хранилище сертификатов. Предыдущий сертификат AudioVideoAuthentication по-прежнему действует для проверки выданных маркеров. С момента размещения нового сертификата AudioVideoAuthentication возникают следующие наборы событий:
  
> [!TIP]
> Командлеты командную консоль Business Server для управления сертификатами с помощью Скайп, можно запросить отличный сертификаты для каждой цели на пограничном сервере. С помощью мастера сертификатов в Скайп мастер развертывания Business Server упрощает создание сертификатов, но обычно типа по **умолчанию** , какие couples все сертификат используется для пограничного сервера на один сертификат. Если вы собираетесь использовать функцию динамическое сертификат рекомендуется для отделения сертификат AudioVideoAuthentication из назначения сертификатов. Можно подготовить и промежуточные сертификат типа по умолчанию, но только AudioVideoAuthentication часть объединенный сертификат выиграют от промежуточного хранения. Пользователь, к примеру, задействованных в сеанс обмена мгновенными сообщениями при истечении срока действия сертификата потребуется выйдите из системы и войдите снова, чтобы сделать использование нового сертификата, связанных со службой пограничного доступа. Аналогичное поведение для пользователя, участвующего в веб-конференции с помощью службы пограничного сервера Web конференц-связи. Сертификат OAuthTokenIssuer является определенного типа, которая совместно используется на всех серверах. Создание и управление ими в одном месте сертификат и сертификат хранится в центральное хранилище управления для всех других серверов.
  
Для полного понимания возможностей и условий использования командлета Set-CsCertificate и использования его для промежуточного хранения сертификатов до истечения срока действия текущего сертификата требуются дополнительные данные. -Откат параметр важно, но по сути единый назначения. Если вы определяете как параметр, вы указываете Set-CsCertificate, который будет предоставлять сведения о сертификате, который затрагиваются определяется - тип (например AudioVideoAuthentication и OAuthTokenIssuer), вступления сертификата эффективного определяется - EffectiveDate.
  
 **-Отката**: - откат параметр является обязательным и не имеет зависимости, которые должен задаваться вместе с ней. Обязательные параметры полное определение сертификатов, которые будут затронуты и как они будут применяться.
  
 **-EffectiveDate**: параметр - EffectiveDate определяет, когда новый сертификат становится co-active с текущего сертификата. -EffectiveDate может быть времени истечения срока действия текущего сертификата, или она может быть длительный период времени. Рекомендуемая Минимальная - EffectiveDate для сертификат AudioVideoAuthentication бы 8 часов, которая является срока жизни маркера по умолчанию для службы маркеров Аудио-и видеоданных, выдается сертификат AudioVideoAuthentication с помощью.
  
При размещении сертификатов OAuthTokenIssuer для промежуточного хранения действуют различные требования в отношении времени упреждения, прежде чем действие сертификата вступит в силу. Минимальное время упреждения для сертификата OAuthTokenIssuer составляет 24 часа до истечения срока действия текущего сертификата. Увеличение времени упреждения для совместной работы применяется в связи с тем, что другие роли сервера, зависимые от сертификата OAuthTokenIssuer (например, Exchange Server), для которых предусматривается более продолжительный срок хранения сертификатов, создают данные проверки подлинности и ключа шифрования.
  
 **-Отпечаток**: отпечаток является атрибутом в сертификате, который является уникальным для этого сертификата. -Отпечаток параметр используется для идентификации сертификата, который будут затронуты при выполнении действий в командлет Set-CsCertificate.
  
 **-Тип**: - возможные значения параметра тип использования одного сертификата или запятыми список типов использования сертификата. Типы сертификатов — это списки, чтобы указать в командлет и к серверу возможности назначение сертификата. Например, тип AudioVideoAuthentication предназначен для использования с A / V Edge служба и служба проверки подлинности аудио/видео. Если вы решили рабочей области и подготовки сертификатов другого типа в то же время, необходимо учесть длинным необходимые эффективных мин для сертификатов. Например необходимо сертификаты рабочей области типа AudioVideoAuthentication и OAuthTokenIssuer. Ваше минимальные - EffectiveDate должно быть больше двух сертификатов, в данном случае OAuthTokenIssuer, насчитывающей мин 24 часов. Если не требуется этап сертификат AudioVideoAuthentication с временем производства 24 часов, включить его отдельно с EffectiveDate, который является более в ваши требования.
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a>Обновление или продление A / V Edge службы сертификата с помощью параметров - Roll и - EffectiveDate

1. Войдите на локальный компьютер как член группы "Администраторы".
    
2. Запросите Продление сертификата или новый сертификат AudioVideoAuthentication с экспортируемым закрытым ключом для текущего сертификата на A / V Edge службы.
    
3. Импортируйте новый сертификат AudioVideoAuthentication пограничного сервера и всех других пограничного сервера в пуле (при наличии развернутого пула).
    
4. Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate. Дата вступления в силу определяется как время истечения срока действия текущего сертификата (14:00:00) за вычетом срока действия маркера (по умолчанию — восемь часов). Это дает времени, сертификат должен иметь значение активный и - EffectiveDate \<строка\>: «7/22/2015 6:00:00 AM». 
    
    > [!IMPORTANT]
    > Для пограничного пула, необходимо иметь все сертификаты AudioVideoAuthentication развернута и подготовить к работе по дате и времени, определенного параметром - EffectiveDate первого сертификата развернут, чтобы избежать возможных A / V нарушения связи из-за более старый сертификат, срок действия перед всех маркеров клиента и потребитель был обновлен с помощью нового сертификата. 
  
    Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:
    
  ```
  Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
  ```

    Пример команды Set-CsCertificate:
    
  ```
  Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
  ```

    > [!IMPORTANT]
    > EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры. В примере используется "мне Нравится" английский язык и региональные параметры 
  
Для дальнейшей ознакомиться с процессом, Set-CsCertificate, - Roll и - EffectiveDate используется для размещения нового сертификата создавать новые маркеры AudioVideoAuthentication во время по-прежнему использования существующего сертификата для проверки AudioVideoAuthentication, используемых по потребителям visual временной шкалы не эффективных способов основные сведения о процессе. В следующем примере администратор определяет, что A / V Edge сертификата службы из-за истечения срока действия с 2:00:00 в 07/22/2015. Он запрашивает и получает новый сертификат и импортирует каждый из пограничных серверов в пуле, его. В 02: 00 в 07/22/2015, он запускает командлет Get-CsCertificate с - Roll, - отпечаток, равное строка отпечаток нового сертификата и - EffectiveTime значение 07/22/2015 6:00:00 AM. Он запускает эту команду на каждом пограничном сервере.
  
![Использование параметров Roll и EffectiveDate.](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|**Выноски**|**Стадии**|
|:-----|:-----|
|1  <br/> |Начало: 22/7/2015 12:00:00  <br/> Срок действия текущего сертификата AudioVideoAuthentication истекает в 14:00:00 22/7/2015. Это определяется меткой времени в сертификате. Запланируйте замену и переключение своего сертификата с учетом 8-часового перекрытия (срок действия маркера по умолчанию) до истечения срока действия существующего сертификата. Использованное в этом примере время опережения (02:00:00) предоставляет администратору достаточно времени для размещения и выделения новых сертификатов до наступления фактического времени 06:00:00.  <br/> |
|2  <br/> |22/7/2015 02:00:00 - 22/7/2015 05:59:59  <br/> Установка сертификатов на пограничных серверах с время начала 6:00:00 AM (4 часов периода ожидания — в этом примере, но может быть больше) с помощью Set-CsCertificate-тип \<сертификата тип использования\> -отпечаток \<отпечаток нового сертификата\> - Развертывание - EffectiveDate \<строку даты и времени время начала для нового сертификата\>  <br/> |
|3  <br/> |22/7/2015 06:00 - 22/7/2015 14:00  <br/> При проверке маркеров сначала применяется новый сертификат. Если маркер не удается проверить с помощью нового сертификата, используется старый сертификат. Этот процесс применяется ко всем маркерам в течение 8 часов (срок действия маркера по умолчанию) периода перекрытия.  <br/> |
|4  <br/> |Окончание: 7/22/2015 2:00:01 PM  <br/> Истекает срок действия старого сертификата и начинает действовать новый сертификат. Старый сертификат можно удалить с помощью Remove-CsCertificate-тип \<сертификата тип использования\> -предыдущей  <br/> |
   
По достижении заданного времени (22/7/2015 6:00:00 утра) все новые маркеры выпускаются новым сертификатом. Сначала выполняется проверка маркеров новым сертификатом. Если проверка не пройдена, маркеры проверяются старым сертификатом. Процедура проверки новым сертификатом и возврат к старому продолжается до тех пор, пока не истечет срок действия старого сертификата. По истечении срока действия старого сертификата (22/7/2015 14:00:00) маркеры будут проверяться только новым сертификатом. Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a>Обновление или продление OAuthTokenIssuer сертификата с помощью параметров - Roll и - EffectiveDate

1. Войдите на локальный компьютер как член группы "Администраторы".
    
2. Запросите Продление сертификата или новый сертификат OAuthTokenIssuer с экспортируемым закрытым ключом для текущего сертификата на сервере переднего плана.
    
3. Импортируйте новый сертификат OAuthTokenIssuer на сервере переднего плана в пуле (при наличии развернутого пула). Сертификат OAuthTokenIssuer глобально репликации и только для обновления и обновленной панели мониторинга на любом сервере в развертывании. Сервер переднего плана используется в качестве примера.
    
4. Настройка импортированный сертификат с помощью командлета Set-CsCertificate и использовать параметр - Roll совместно с параметром - EffectiveDate. Дата вступления в силу определяется как время истечения срока действия текущего сертификата (14:00:00 или 2:00:00 дня) за вычетом не менее 24 часов. 
    
    Команда Set-CsCertificate с параметром - Roll и - EffectiveTime:
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
  ```

Пример команды Set-CsCertificate:
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> EffectiveDate должен иметь формат в соответствии с регион вашего сервера и языковые параметры. В примере используется "мне Нравится" английский язык и региональные параметры 
  
По достижении заданного времени (22/7/2015 1:00:00 утра) все новые маркеры выпускаются новым сертификатом. Сначала выполняется проверка маркеров новым сертификатом. Если проверка не пройдена, маркеры проверяются старым сертификатом. Процедура проверки новым сертификатом и возврат к старому продолжается до тех пор, пока не истечет срок действия старого сертификата. По истечении срока действия старого сертификата (22/7/2015 14:00:00) маркеры будут проверяться только новым сертификатом. Старый сертификат можно удалить с помощью командлета Remove-CsCertificate с предыдущей параметр-.
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a>См. также

[Управление проверки подлинности сервер сервер (OAuth) и партнерских приложений в Скайп для Business Server 2015](server-to-server-and-partner-applications.md)

[Командлет Set-CsCertificate](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[Командлет remove-CsCertificate](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)