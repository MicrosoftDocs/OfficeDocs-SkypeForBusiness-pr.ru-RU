---
title: Stage и сертификаты OAuth в Skype для бизнеса Server с помощью Set-Ксцертификате
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 22dec3cc-4b6b-4df2-b269-5b35df4731a7
description: 'Сводка: стадия действия (AV) и сертификаты OAuth для сервера Skype для бизнеса Server.'
ms.openlocfilehash: 6a2e851aac8aae9aaecac424290195270415706c
ms.sourcegitcommit: ab47ff88f51a96aaf8bc99a6303e114d41ca5c2f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/20/2019
ms.locfileid: "34286132"
---
# <a name="stage-av-and-oauth-certificates-in-skype-for-business-server-using--roll-in-set-cscertificate"></a><span data-ttu-id="8256e-103">Stage и сертификаты OAuth в Skype для бизнеса Server с помощью Set-Ксцертификате</span><span class="sxs-lookup"><span data-stu-id="8256e-103">Stage AV and OAuth certificates in Skype for Business Server using -Roll in Set-CsCertificate</span></span>
 
<span data-ttu-id="8256e-104">**Сводка:** Stage (AV) и сертификаты OAuth для сервера Skype для бизнеса Server.</span><span class="sxs-lookup"><span data-stu-id="8256e-104">**Summary:** Stage AV and OAuth certificates for Skype for Business Server.</span></span>
  
<span data-ttu-id="8256e-105">Голосовая связь/видеосвязь (A/V) — это ключевой компонент Skype для бизнеса Server.</span><span class="sxs-lookup"><span data-stu-id="8256e-105">Audio/Video (A/V) communications is a key component of Skype for Business Server.</span></span> <span data-ttu-id="8256e-106">Такие функции, как общий доступ к приложениям, а также аудио-и видеоконференции, основываются на сертификатах, назначенных службе EDGE (a/V), а именно службе проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="8256e-106">Features such as application sharing and audio and video conferencing rely on the certificates assigned to the A/V Edge service, specifically the A/V Authentication service.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="8256e-107">Эта новая функция разработана для работы со службой EDGE (A/V) и сертификатом Оаустокениссуер.</span><span class="sxs-lookup"><span data-stu-id="8256e-107">This new feature is designed to work for the A/V Edge service and the OAuthTokenIssuer certificate.</span></span> <span data-ttu-id="8256e-108">Другие типы сертификатов могут быть предоставлены вместе со службой EDGE (A/V) и типом сертификата OAuth, но это не выгодно из-за сосуществования сертификата службы Edge.</span><span class="sxs-lookup"><span data-stu-id="8256e-108">Other certificate types can be provisioned along with the A/V Edge service and OAuth certificate type, but will not benefit from the coexistence behavior that the A/V Edge service certificate will.</span></span>
  
<span data-ttu-id="8256e-109">Командлеты PowerShell для Windows для бизнеса Server Management Shell, используемые для управления сертификатами Skype для бизнеса Server, относятся к сертификату службы EDGE в качестве типа сертификата Аудиовидеоаусентикатион и сертификата Оауссервер. Типеоаустокениссуер.</span><span class="sxs-lookup"><span data-stu-id="8256e-109">The Skype for Business Server Management Shell PowerShell cmdlets used to manage Skype for Business Server certificates refers to the A/V Edge service certificate as the AudioVideoAuthentication certificate type and the OAuthServer certificate as typeOAuthTokenIssuer.</span></span> <span data-ttu-id="8256e-110">Для оставшейся части этого раздела и уникальной идентификации сертификатов они будут обращаться к одному и тому же типу идентификатора Аудиовидеоаусентикатион Андоаустокениссуер.</span><span class="sxs-lookup"><span data-stu-id="8256e-110">For the rest of this topic and to uniquely identify the certificates, they will be referred to by the same identifier type, AudioVideoAuthentication andOAuthTokenIssuer.</span></span>
  
<span data-ttu-id="8256e-111">Служба проверки подлинности A/V отвечает за выдачу маркеров, используемых клиентами и другими пользователями/V.</span><span class="sxs-lookup"><span data-stu-id="8256e-111">The A/V Authentication service is responsible for issuing tokens that are used by clients and other A/V consumers.</span></span> <span data-ttu-id="8256e-112">Маркеры генерируются из атрибутов сертификата, и при истечении срока действия сертификата теряется соединение и требование для повторного присоединения с новым маркером, созданным новым сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-112">The tokens are generated from attributes on the certificate, and when the certificate expires, loss of connection and requirement to rejoin with a new token generated by the new certificate will result.</span></span> <span data-ttu-id="8256e-113">Новая функция в Skype для бизнеса Server поможет решить эту проблему — возможность размещения нового сертификата в начале срока действия старого и предоставление обоих сертификатов для продолжения работы в течение определенного периода времени.</span><span class="sxs-lookup"><span data-stu-id="8256e-113">A new feature in Skype for Business Server will alleviate this problem - the ability to stage a new certificate in advance of the old one expiring and allowing both certificates to continue to function for a period of time.</span></span> <span data-ttu-id="8256e-114">Эта функция использует обновленные функции командлета Set-Ксцертификате Skype для Business Server Shell.</span><span class="sxs-lookup"><span data-stu-id="8256e-114">This feature uses updated functionality in the Set-CsCertificate Skype for Business Server Management Shell cmdlet.</span></span> <span data-ttu-id="8256e-115">Новая параметр-рулон с существующим параметром-Еффективедате будет размещать новый сертификат Аудиовидеоаусентикатион в хранилище сертификатов.</span><span class="sxs-lookup"><span data-stu-id="8256e-115">The new parameter -Roll, with the existing parameter -EffectiveDate, will place the new AudioVideoAuthentication certificate in the certificate store.</span></span> <span data-ttu-id="8256e-116">Старый сертификат Аудиовидеоаусентикатион останется для проверки выпущенных маркеров.</span><span class="sxs-lookup"><span data-stu-id="8256e-116">The older AudioVideoAuthentication certificate will still remain for issued tokens to be validated against.</span></span> <span data-ttu-id="8256e-117">Начиная с размещения нового сертификата Аудиовидеоаусентикатион, произойдет следующая серия событий:</span><span class="sxs-lookup"><span data-stu-id="8256e-117">Beginning with putting the new AudioVideoAuthentication certificate in place, the following series of events will occur:</span></span>
  
> [!TIP]
> <span data-ttu-id="8256e-118">С помощью командлетов командной консоли Skype для бизнеса Server для управления сертификатами вы можете запросить отдельные и разные сертификаты для каждой цели на пограничном сервере.</span><span class="sxs-lookup"><span data-stu-id="8256e-118">Using the Skype for Business Server Management Shell cmdlets for managing certificates, you can request separate and distinct certificates for each purpose on the Edge Server.</span></span> <span data-ttu-id="8256e-119">Использование мастера сертификатов в мастере развертывания Skype для бизнеса Server помогает создавать сертификаты, но обычно используется тип **по умолчанию** , который прикрепляет все сертификаты для пограничного сервера к одному сертификату.</span><span class="sxs-lookup"><span data-stu-id="8256e-119">Using the Certificate Wizard in the Skype for Business Server Deployment Wizard assists you in creating certificates, but is typically of the **default** type which couples all certificate uses for the Edge Server onto a single certificate.</span></span> <span data-ttu-id="8256e-120">Если вы собираетесь использовать функцию межсертификатного сертификата, рекомендуется отключать сертификат Аудиовидеоаусентикатион из других целей сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-120">The recommended practice if you are going to use the rolling certificate feature is to decouple the AudioVideoAuthentication certificate from the other certificate purposes.</span></span> <span data-ttu-id="8256e-121">Вы можете подготавливать сертификат по умолчанию и пополнить его, но только часть Аудиовидеоаусентикатион комбинированного сертификата будет полезна при выуровне.</span><span class="sxs-lookup"><span data-stu-id="8256e-121">You can provision and stage a certificate of the Default type, but only the AudioVideoAuthentication portion of the combined certificate will benefit from the staging.</span></span> <span data-ttu-id="8256e-122">Если при истечении срока действия сертификата пользователь приходил к разговору (например), вам потребуется выйти из системы и снова войти в систему, чтобы использовать новый сертификат, связанный с службой Edge Access.</span><span class="sxs-lookup"><span data-stu-id="8256e-122">A user involved in (for example) an instant messaging conversation when the certificate expires will need to log out and log back in to make use of the new certificate associated with the Access Edge service.</span></span> <span data-ttu-id="8256e-123">Аналогичное поведение может возникнуть для пользователя, участвующего в веб-конференции с помощью службы Edge для веб-конференций.</span><span class="sxs-lookup"><span data-stu-id="8256e-123">Similar behavior will occur for a user involved in a Web conference using the Web Conferencing Edge service.</span></span> <span data-ttu-id="8256e-124">Сертификат Оаустокениссуер — это конкретный тип, который является общим для всех серверов.</span><span class="sxs-lookup"><span data-stu-id="8256e-124">The OAuthTokenIssuer certificate is a specific type that is shared across all servers.</span></span> <span data-ttu-id="8256e-125">Вы создаете сертификат и управляете им в одном расположении, и сертификат хранится в хранилище Центрального управления для всех остальных серверов.</span><span class="sxs-lookup"><span data-stu-id="8256e-125">You create and manage the certificate in one place and the certificate is stored in the Central Management store for all other servers.</span></span>
  
<span data-ttu-id="8256e-126">Дополнительные сведения необходимы для полного понимания параметров и требований при использовании командлета Set-Ксцертификате и его использования для размещения сертификатов до истечения срока действия текущего сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-126">Additional detail is needed to fully understand your options and requirements when using the Set-CsCertificate cmdlet and using it to stage certificates prior to the current certificate expiring.</span></span> <span data-ttu-id="8256e-127">Параметр-рулон важен, но, по сути, единая цель.</span><span class="sxs-lookup"><span data-stu-id="8256e-127">The -Roll parameter is important, but essentially single purpose.</span></span> <span data-ttu-id="8256e-128">Если вы определите его как параметр, вы указываете Set-Ксцертификате, что вы будете предоставлять сведения о сертификате, который будет зависеть от типа (например, Аудиовидеоаусентикатион и Оаустокениссуер), когда сертификат станет эффективная работа, определенная функцией-Еффективедате.</span><span class="sxs-lookup"><span data-stu-id="8256e-128">If you define it as a parameter, you are telling Set-CsCertificate that you will be providing information about the certificate that will be affected defined by -Type (for example AudioVideoAuthentication and OAuthTokenIssuer), when the certificate will become effective defined by -EffectiveDate.</span></span>
  
 <span data-ttu-id="8256e-129">**-Рулон**: параметр-рулон является обязательным и имеет зависимости, которые должны быть предоставлены вместе с ним.</span><span class="sxs-lookup"><span data-stu-id="8256e-129">**-Roll**: The -Roll parameter is required and has dependencies that must be supplied along with it.</span></span> <span data-ttu-id="8256e-130">Обязательные параметры, позволяющие полностью определить, какие сертификаты будут затронуты и как они будут применены.</span><span class="sxs-lookup"><span data-stu-id="8256e-130">Required parameters to fully define which certificates will be affected and how they will be applied:</span></span>
  
 <span data-ttu-id="8256e-131">**-Еффективедате**: параметр-еффективедате определяет, когда новый сертификат будет работать совместно с текущим сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-131">**-EffectiveDate**: The parameter -EffectiveDate defines when the new certificate will become co-active with the current certificate.</span></span> <span data-ttu-id="8256e-132">Еффективедате может быть близким к сроку действия текущего сертификата или может быть более длительного периода времени.</span><span class="sxs-lookup"><span data-stu-id="8256e-132">The -EffectiveDate can be close to the expiry time of the current certificate, or it can be a longer period of time.</span></span> <span data-ttu-id="8256e-133">Рекомендуемый минимум для Еффективедате сертификата Аудиовидеоаусентикатион — это 8 часов, который является временем жизни токенов для маркеров обслуживания, выпущенных с использованием сертификата Аудиовидеоаусентикатион по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="8256e-133">A recommended minimum -EffectiveDate for the AudioVideoAuthentication certificate would be 8 hours, which is the default token lifetime for AV Edge service tokens issued using the AudioVideoAuthentication certificate.</span></span>
  
<span data-ttu-id="8256e-134">При использовании промежуточных сертификатов Оаустокениссуер для времени опережения могут быть разные требования, прежде чем сертификат станет эффективнее.</span><span class="sxs-lookup"><span data-stu-id="8256e-134">When staging OAuthTokenIssuer certificates, there are different requirements for the lead time before the certificate can become effective.</span></span> <span data-ttu-id="8256e-135">Минимальное время, в течение которого должен быть сертификат Оаустокениссуер для своего периода ожидания, составляет 24 часа до окончания срока действия текущего сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-135">The minimum time that the OAuthTokenIssuer certificate should have for its lead time is 24 hours before the expiration time of the current certificate.</span></span> <span data-ttu-id="8256e-136">Расширенное время упреждения для сосуществования связано с тем, что другие роли сервера, зависящие от сертификата Оаустокениссуер (например, Exchange Server), которые имеют более длительное время хранения для проверки подлинности сертификата и ключа шифрования. занимал.</span><span class="sxs-lookup"><span data-stu-id="8256e-136">The extended lead time for the coexistence is because of other server roles that are dependent on the OAuthTokenIssuer certificate (Exchange Server, for example) which has a longer retention time for certificate created authentication and encryption key materials.</span></span>
  
 <span data-ttu-id="8256e-137">**-** Отпечаток: отпечаток — это атрибут сертификата, уникальный для этого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-137">**-Thumbprint**: The thumbprint is an attribute on the certificate that is unique to that certificate.</span></span> <span data-ttu-id="8256e-138">Параметр-Thumbprint используется для идентификации сертификата, на который будут повлиять действия командлета Set-Ксцертификате.</span><span class="sxs-lookup"><span data-stu-id="8256e-138">The -Thumbprint parameter is used to identify the certificate that will be affected by the actions of the Set-CsCertificate cmdlet.</span></span>
  
 <span data-ttu-id="8256e-139">**-Type**: параметр-Type может иметь один тип использования сертификата или список типов использования сертификатов с разделителями-запятыми.</span><span class="sxs-lookup"><span data-stu-id="8256e-139">**-Type**: The -Type parameter can accept a single certificate usage type or a comma separated list of certificate usage types.</span></span> <span data-ttu-id="8256e-140">Типы сертификатов — это те, которые определяют для командлета и сервера назначение сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-140">The certificate types are those that identify to the cmdlet and to the server what the purpose of the certificate is.</span></span> <span data-ttu-id="8256e-141">Например, введите Аудиовидеоаусентикатион для использования службой Edge/V и службой проверки подлинности AV.</span><span class="sxs-lookup"><span data-stu-id="8256e-141">For example, type AudioVideoAuthentication is for use by the A/V Edge service and the AV Authentication service.</span></span> <span data-ttu-id="8256e-142">Если вы решите поэтапное резервное рабочее время и выложить сертификаты другого типа, вы должны оценить максимально необходимое минимальное количество времени упреждения для сертификатов.</span><span class="sxs-lookup"><span data-stu-id="8256e-142">If you decide to stage and provision certificates of a different type at the same time, you must consider the longest required minimum effective lead time for the certificates.</span></span> <span data-ttu-id="8256e-143">Например, необходимо выполнить поэтапную настройку сертификатов типа Аудиовидеоаусентикатион и Оаустокениссуер.</span><span class="sxs-lookup"><span data-stu-id="8256e-143">For example, you need to stage certificates of type AudioVideoAuthentication and OAuthTokenIssuer.</span></span> <span data-ttu-id="8256e-144">Ваш минимум Еффективедате должен быть большим из двух сертификатов, в этом случае Оаустокениссуер, в котором минимальное время упреждения — 24 часа.</span><span class="sxs-lookup"><span data-stu-id="8256e-144">Your minimum -EffectiveDate must be the greater of the two certificates, in this case the OAuthTokenIssuer, which has a minimum lead time of 24 hours.</span></span> <span data-ttu-id="8256e-145">Если вы не хотите пополнить сертификат Аудиовидеоаусентикатион с временем опережения в 24 часа, поэтапировать его отдельно с помощью Еффективедате, который больше ваших требований.</span><span class="sxs-lookup"><span data-stu-id="8256e-145">If you do not want to stage the AudioVideoAuthentication certificate with a lead time of 24 hours, stage it separately with an EffectiveDate that is more to your requirements.</span></span>
  
### <a name="to-update-or-renew-an-av-edge-service-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="8256e-146">Обновление и возобновление сертификата службы EDGE (A/V) с помощью параметров-рулонов и Еффективедате</span><span class="sxs-lookup"><span data-stu-id="8256e-146">To update or renew an A/V Edge service certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="8256e-147">Войдите на локальный компьютер как член группы "Администраторы".</span><span class="sxs-lookup"><span data-stu-id="8256e-147">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="8256e-148">Запрос возобновления или нового сертификата Аудиовидеоаусентикатион с экспортируемым закрытым ключом для существующего сертификата в службе EDGE (A/V).</span><span class="sxs-lookup"><span data-stu-id="8256e-148">Request a renewal or new AudioVideoAuthentication certificate with exportable private key for the existing certificate on the A/V Edge service.</span></span>
    
3. <span data-ttu-id="8256e-149">Импортируйте новый сертификат Аудиовидеоаусентикатион на пограничный сервер и весь другой пограничный сервер в пуле (если у вас есть пул).</span><span class="sxs-lookup"><span data-stu-id="8256e-149">Import the new AudioVideoAuthentication certificate to the Edge Server and all other Edge Server in your pool (if you have a pool deployed).</span></span>
    
4. <span data-ttu-id="8256e-150">Настройте импортированный сертификат с помощью командлета Set-Ксцертификате и используйте параметр-рулон с параметром-Еффективедате.</span><span class="sxs-lookup"><span data-stu-id="8256e-150">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="8256e-151">Дата вступления в силу должна быть задана в качестве срока действия текущего сертификата (14:00:00 или 2:00:00) минус время жизни токена (по умолчанию восемь часов).</span><span class="sxs-lookup"><span data-stu-id="8256e-151">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus token lifetime (by default eight hours).</span></span> <span data-ttu-id="8256e-152">Это дает нам время, в течение которого сертификат должен быть активным, а Еффективедате \<строка\>: "7/22/2015 6:00:00 AM".</span><span class="sxs-lookup"><span data-stu-id="8256e-152">This gives us a time that the certificate must be set to active, and is the -EffectiveDate \<string\>: "7/22/2015 6:00:00 AM".</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="8256e-153">Для пула пограничного сервера необходимо, чтобы все сертификаты Аудиовидеоаусентикатион были развернуты и настроены в соответствии с датой и временем, заданными параметром-Еффективедате первого сертификата, который был развернут для предотвращения возможных нарушений обмена данными, вызванных более старым срок действия сертификата истекает до того момента, когда все клиент и маркеры потребителей будут обновлены с использованием нового сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-153">For an Edge pool, you must have all AudioVideoAuthentication certificates deployed and provisioned by the date and time defined by the -EffectiveDate parameter of the first certificate deployed to avoid possible A/V communications disruption due to the older certificate expiring before all client and consumer tokens have been renewed using the new certificate.</span></span> 
  
    <span data-ttu-id="8256e-154">Команда Set-Ксцертификате с параметром-рулон и-Еффективетиме:</span><span class="sxs-lookup"><span data-stu-id="8256e-154">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          <thumb print of new certificate> -Roll -EffectiveDate <date and time
          for certificate to become active>
   ```

    <span data-ttu-id="8256e-155">Пример команды Set-Ксцертификате:</span><span class="sxs-lookup"><span data-stu-id="8256e-155">An example Set-CsCertificate command:</span></span>
    
   ```
   Set-CsCertificate -Type AudioVideoAuthentication -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/22/2015
          6:00:00 AM"
   ```

    > [!IMPORTANT]
    > <span data-ttu-id="8256e-156">Еффективедате должен быть отформатирован в соответствии с регионом сервера и языковыми параметрами.</span><span class="sxs-lookup"><span data-stu-id="8256e-156">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="8256e-157">В примере используются языковые параметры США и Language.</span><span class="sxs-lookup"><span data-stu-id="8256e-157">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="8256e-158">Более подробное описание процесса, который задается с помощью Set-Ксцертификате,-рулонов и-Еффективедате, используется для создания нового сертификата для выпуска новых маркеров Аудиовидеоаусентикатион, но по-прежнему используется существующий сертификат для проверки используемых Аудиовидеоаусентикатион. по потребителям визуальная временная шкала является эффективным средством понимания процесса.</span><span class="sxs-lookup"><span data-stu-id="8256e-158">To further understand the process that Set-CsCertificate, -Roll, and -EffectiveDate use to stage a new certificate for issuing new AudioVideoAuthentication tokens while still using an existing certificate to validate AudioVideoAuthentication that are in use by consumers, a visual timeline is an effective means of understanding the process.</span></span> <span data-ttu-id="8256e-159">В приведенном ниже примере администратор определяет, что срок действия сертификата службы EDGE (A/V) истек в 2:00:00 PM на 07/22/2015.</span><span class="sxs-lookup"><span data-stu-id="8256e-159">In the following example, the administrator determines that the A/V Edge service certificate is due to expire at 2:00:00 PM on 07/22/2015.</span></span> <span data-ttu-id="8256e-160">Он запрашивает и получает новый сертификат и импортирует его на каждый пограничный сервер в его пуле.</span><span class="sxs-lookup"><span data-stu-id="8256e-160">He requests and receives a new certificate and imports it to each Edge Server in his pool.</span></span> <span data-ttu-id="8256e-161">В 07/22/2015 начинается выполнение Get-Ксцертификате с параметром-Thumbprint, отпечаток, равным строке отпечатка нового сертификата, и-Еффективетиме, установленным на 07/22/2015 6:00:00 AM.</span><span class="sxs-lookup"><span data-stu-id="8256e-161">At 2 AM on 07/22/2015, he begins running Get-CsCertificate with -Roll, -Thumbprint equal to the thumbprint string of the new certificate, and -EffectiveTime set to 07/22/2015 6:00:00 AM.</span></span> <span data-ttu-id="8256e-162">Он запускает эту команду на каждом пограничном сервере.</span><span class="sxs-lookup"><span data-stu-id="8256e-162">He runs this command on each Edge Server.</span></span>
  
![Использование параметров Roll и EffectiveDate.](../../media/Ops_Certificate_Set_Roll_EffectiveTime_Timeline.jpg)
  
|<span data-ttu-id="8256e-164">**Выноска**</span><span class="sxs-lookup"><span data-stu-id="8256e-164">**Callout**</span></span>|<span data-ttu-id="8256e-165">**Стадии**</span><span class="sxs-lookup"><span data-stu-id="8256e-165">**Stage**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8256e-166">1</span><span class="sxs-lookup"><span data-stu-id="8256e-166">1</span></span>  <br/> |<span data-ttu-id="8256e-167">Начало: 7/22/2015 12:00:00 AM</span><span class="sxs-lookup"><span data-stu-id="8256e-167">Start: 7/22/2015 12:00:00 AM</span></span>  <br/> <span data-ttu-id="8256e-168">Срок действия текущего сертификата Аудиовидеоаусентикатион истекает в 2:00:00 на 7/22/2015.</span><span class="sxs-lookup"><span data-stu-id="8256e-168">The current AudioVideoAuthentication certificate is due to expire at 2:00:00 PM on 7/22/2015.</span></span> <span data-ttu-id="8256e-169">Это зависит от отметки времени, истекшей с момента истечения срока действия сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-169">This is determined by the expires time stamp on the certificate.</span></span> <span data-ttu-id="8256e-170">Запланируйте замену и смену сертификата для учетной записи в течение 8 часов (срок действия маркера по умолчанию) до того момента, когда существующий сертификат дойдет к концу.</span><span class="sxs-lookup"><span data-stu-id="8256e-170">Plan your certificate replacement and rollover to account for an 8 hour overlap (default token lifetime) before the existing certificate reaches the expire time.</span></span> <span data-ttu-id="8256e-171">В этом примере в 2:00:00 используется время упреждения, чтобы предоставить администратору достаточное время для размещения и подготовки новых сертификатов в течение 6:00:00 на момент вступления в силу.</span><span class="sxs-lookup"><span data-stu-id="8256e-171">The 2:00:00 AM lead time is used in this example to allow the administrator adequate time to place and provision the new certificates in advance of the 6:00:00 AM effective time.</span></span>  <br/> |
|<span data-ttu-id="8256e-172">2</span><span class="sxs-lookup"><span data-stu-id="8256e-172">2</span></span>  <br/> |<span data-ttu-id="8256e-173">7/22/2015 2:00:00 – 7/22/2015 5:59:59 AM</span><span class="sxs-lookup"><span data-stu-id="8256e-173">7/22/2015 2:00:00 AM - 7/22/2015 5:59:59 AM</span></span>  <br/> <span data-ttu-id="8256e-174">Настройка сертификатов на пограничных серверах с действительным временем в 6:00:00 AM (время упреждения в 4 часа — для этого примера, но может быть длиннее) с помощью \<функции Set-\> ксцертификате- \<Type Usage Certificate-\> отпечаток нового сертификата. Строка даты и \<времени еффективедате для нового сертификата (Дата вступления в силу)\></span><span class="sxs-lookup"><span data-stu-id="8256e-174">Set Certificates on Edge Servers with effective time of 6:00:00 AM (4 hour lead time is for this example, but can be longer) using Set-CsCertificate -Type \<certificate usage type\> -Thumbprint \<thumbprint of new certificate\> -Roll -EffectiveDate \<datetime string of the effective time for new certificate\></span></span>  <br/> |
|<span data-ttu-id="8256e-175">3</span><span class="sxs-lookup"><span data-stu-id="8256e-175">3</span></span>  <br/> |<span data-ttu-id="8256e-176">7/22/2015 6:00 – 7/22/2015 2:00 PM</span><span class="sxs-lookup"><span data-stu-id="8256e-176">7/22/2015 6:00 AM - 7/22/2015 2:00 PM</span></span>  <br/> <span data-ttu-id="8256e-177">Для проверки маркеров сначала выполняется попытка создать сертификат, а если новый сертификат не может проверить маркер, будет выполнена попытка использования старого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-177">To validate tokens, the new certificate is tried first, and if the new certificate fails to validate the token, the old certificate is tried.</span></span> <span data-ttu-id="8256e-178">Этот процесс используется для всех маркеров в течение 8 часов (срок жизни токена по умолчанию) перекрывает период.</span><span class="sxs-lookup"><span data-stu-id="8256e-178">This process is used for all tokens during the 8 hour (default token lifetime) overlap period.</span></span>  <br/> |
|<span data-ttu-id="8256e-179">4</span><span class="sxs-lookup"><span data-stu-id="8256e-179">4</span></span>  <br/> |<span data-ttu-id="8256e-180">Окончание: 7/22/2015 2:00:01 PM</span><span class="sxs-lookup"><span data-stu-id="8256e-180">End: 7/22/2015 2:00:01 PM</span></span>  <br/> <span data-ttu-id="8256e-181">Срок действия старого сертификата истек, и новый сертификат перейдет.</span><span class="sxs-lookup"><span data-stu-id="8256e-181">Old certificate has expired and the new certificate has taken over.</span></span> <span data-ttu-id="8256e-182">Старый сертификат можно безопасно удалить с помощью Remove-Ксцертификате- \<Type Usage\> Certificate (предыдущий).</span><span class="sxs-lookup"><span data-stu-id="8256e-182">Old certificate can be safely removed with Remove-CsCertificate -Type \<certificate usage type\> -Previous</span></span>  <br/> |
   
<span data-ttu-id="8256e-183">По истечении срока действия (7/22/2015 6:00:00 AM) все новые маркеры выдаются новым сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-183">When the effective time is reached (7/22/2015 6:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="8256e-184">При проверке маркеров сначала проверяются маркеры для нового сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-184">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="8256e-185">Если проверка завершится ошибкой, будет произведена попытка использования старого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-185">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="8256e-186">Процесс попытки нового и прекращения работы старого сертификата будет продолжаться до тех пор, пока не истечет срок действия старого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-186">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="8256e-187">После истечения срока действия старого сертификата (7/22/2015 2:00:00 PM) маркеры будут проверяться только новым сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-187">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="8256e-188">Старый сертификат можно безопасно удалить с помощью командлета Remove-Ксцертификате с параметром-Previous.</span><span class="sxs-lookup"><span data-stu-id="8256e-188">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>

```
Remove-CsCertificate -Type AudioVideoAuthentication -Previous
```

### <a name="to-update-or-renew-an-oauthtokenissuer-certificate-with-a--roll-and--effectivedate-parameters"></a><span data-ttu-id="8256e-189">Обновление и возобновление сертификата Оаустокениссуер с помощью параметров-рулонов и Еффективедате</span><span class="sxs-lookup"><span data-stu-id="8256e-189">To update or renew an OAuthTokenIssuer certificate with a -Roll and -EffectiveDate parameters</span></span>

1. <span data-ttu-id="8256e-190">Войдите на локальный компьютер как член группы "Администраторы".</span><span class="sxs-lookup"><span data-stu-id="8256e-190">Log on to the local computer as a member of the Administrators group.</span></span>
    
2. <span data-ttu-id="8256e-191">Запрос возобновления или нового сертификата Оаустокениссуер с экспортируемым закрытым ключом для существующего сертификата на сервере переднего плана.</span><span class="sxs-lookup"><span data-stu-id="8256e-191">Request a renewal or new OAuthTokenIssuer certificate with exportable private key for the existing certificate on the Front End Server.</span></span>
    
3. <span data-ttu-id="8256e-192">Импортируйте новый сертификат Оаустокениссуер на сервер переднего плана в пуле (если у вас развернут пул).</span><span class="sxs-lookup"><span data-stu-id="8256e-192">Import the new OAuthTokenIssuer certificate to a Front End Server in your pool (if you have a pool deployed).</span></span> <span data-ttu-id="8256e-193">Сертификат Оаустокениссуер реплицируется глобально и нуждается в обновлении и обновлении на любом сервере в развертывании.</span><span class="sxs-lookup"><span data-stu-id="8256e-193">The OAuthTokenIssuer certificate is replicated globally and only needs to be updated and renewed at any server in your deployment.</span></span> <span data-ttu-id="8256e-194">В качестве примера используется сервер переднего плана.</span><span class="sxs-lookup"><span data-stu-id="8256e-194">The Front End Server is used as an example.</span></span>
    
4. <span data-ttu-id="8256e-195">Настройте импортированный сертификат с помощью командлета Set-Ксцертификате и используйте параметр-рулон с параметром-Еффективедате.</span><span class="sxs-lookup"><span data-stu-id="8256e-195">Configure the imported certificate with the Set-CsCertificate cmdlet and use the -Roll parameter with the -EffectiveDate parameter.</span></span> <span data-ttu-id="8256e-196">Дата вступления в силу должна быть указана как срок действия текущего сертификата (14:00:00 или 2:00:00), но не менее 24 часов.</span><span class="sxs-lookup"><span data-stu-id="8256e-196">The effective date should be defined as the current certificate expire time (14:00:00, or 2:00:00 PM) minus a minimum of 24 hours.</span></span> 
    
    <span data-ttu-id="8256e-197">Команда Set-Ксцертификате с параметром-рулон и-Еффективетиме:</span><span class="sxs-lookup"><span data-stu-id="8256e-197">The Set-CsCertificate command with the -Roll and -EffectiveTime parameter:</span></span>
    
   ```
   Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint <thumb
          print of new certificate> -Roll -EffectiveDate <date and time for
          certificate to become active> -identity Global 
   ```

<span data-ttu-id="8256e-198">Пример команды Set-Ксцертификате:</span><span class="sxs-lookup"><span data-stu-id="8256e-198">An example Set-CsCertificate command:</span></span>
    
  ```
  Set-CsCertificate -Type OAuthTokenIssuer -Thumbprint
          "B142918E463981A76503828BB1278391B716280987B" -Roll -EffectiveDate "7/21/2015
          1:00:00 PM" 
  ```

> [!IMPORTANT]
> <span data-ttu-id="8256e-199">Еффективедате должен быть отформатирован в соответствии с регионом сервера и языковыми параметрами.</span><span class="sxs-lookup"><span data-stu-id="8256e-199">The EffectiveDate must be formatted to match your server's region and language settings.</span></span> <span data-ttu-id="8256e-200">В примере используются языковые параметры США и Language.</span><span class="sxs-lookup"><span data-stu-id="8256e-200">The example uses the US English Region and Language settings</span></span> 
  
<span data-ttu-id="8256e-201">По истечении срока действия (7/21/2015 1:00:00 AM) все новые маркеры выдаются новым сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-201">When the effective time is reached (7/21/2015 1:00:00 AM), all new tokens are issued by the new certificate.</span></span> <span data-ttu-id="8256e-202">При проверке маркеров сначала проверяются маркеры для нового сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-202">When validating tokens, tokens will first be validated against the new certificate.</span></span> <span data-ttu-id="8256e-203">Если проверка завершится ошибкой, будет произведена попытка использования старого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-203">If the validation fails, the old certificate is tried.</span></span> <span data-ttu-id="8256e-204">Процесс попытки нового и прекращения работы старого сертификата будет продолжаться до тех пор, пока не истечет срок действия старого сертификата.</span><span class="sxs-lookup"><span data-stu-id="8256e-204">The process of trying the new and falling back to the old certificate will continue until the expiry time of the old certificate.</span></span> <span data-ttu-id="8256e-205">После истечения срока действия старого сертификата (7/22/2015 2:00:00 PM) маркеры будут проверяться только новым сертификатом.</span><span class="sxs-lookup"><span data-stu-id="8256e-205">Once the old certificate has expired (7/22/2015 2:00:00 PM), tokens will only be validated by the new certificate.</span></span> <span data-ttu-id="8256e-206">Старый сертификат можно безопасно удалить с помощью командлета Remove-Ксцертификате с параметром-Previous.</span><span class="sxs-lookup"><span data-stu-id="8256e-206">The old certificate can be safely removed using the Remove-CsCertificate cmdlet with the -Previous parameter.</span></span>
```
Remove-CsCertificate -Type OAuthTokenIssuer -Previous 
```

## <a name="see-also"></a><span data-ttu-id="8256e-207">См. также</span><span class="sxs-lookup"><span data-stu-id="8256e-207">See also</span></span>

[<span data-ttu-id="8256e-208">Управление проверкой подлинности серверов (OAuth) и партнерских приложений в Skype для бизнеса Server</span><span class="sxs-lookup"><span data-stu-id="8256e-208">Manage server-to-server authentication (OAuth) and partner applications in Skype for Business Server</span></span>](server-to-server-and-partner-applications.md)

[<span data-ttu-id="8256e-209">Set-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="8256e-209">Set-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/set-cscertificate?view=skype-ps)
  
[<span data-ttu-id="8256e-210">Remove-CsCertificate</span><span class="sxs-lookup"><span data-stu-id="8256e-210">Remove-CsCertificate</span></span>](https://docs.microsoft.com/powershell/module/skype/remove-cscertificate?view=skype-ps)
