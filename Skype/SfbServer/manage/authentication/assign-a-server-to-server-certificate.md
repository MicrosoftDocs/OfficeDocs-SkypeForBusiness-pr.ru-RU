---
title: Назначение сертификата проверки подлинности от сервера к серверу для Skype для бизнеса Server
ms.reviewer: ''
ms.author: v-mahoffman
author: HowlinWolf-92
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
ms.assetid: c7413954-2504-47f4-a073-44548aff1c0c
description: Сводка. Назначить сертификат проверки подлинности от сервера к серверу для Skype для бизнеса Server.
ms.openlocfilehash: 30d62351d92a53c107e858ce1e0f88239f615208
ms.sourcegitcommit: 67324fe43f50c8414bb65c52f5b561ac30b52748
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/08/2021
ms.locfileid: "60839951"
---
# <a name="assign-a-server-to-server-authentication-certificate-to-skype-for-business-server"></a>Назначение сертификата проверки подлинности от сервера к серверу для Skype для бизнеса Server
**Сводка:** Назначение сертификата проверки подлинности от сервера к серверу для Skype для бизнеса Server.
  
Чтобы определить, назначен ли сертификат проверки подлинности от сервера к серверу для Skype для бизнеса Server, запустите следующую команду из Skype для бизнеса Server Management Shell:
  
```PowerShell
Get-CsCertificate -Type OAuthTokenIssuer
```

Если данные сертификата не возвращаются, необходимо назначить сертификат эмитента маркера, прежде чем использовать проверку подлинности от сервера к серверу. Как правило, любой сертификат Skype для бизнеса Server может использоваться в качестве сертификата OAuthTokenIssuer; например, сертификат Skype для бизнеса Server по умолчанию также может использоваться в качестве сертификата OAuthTokenIssuer. (Сертификат OAUthTokenIssuer также может быть любым сертификатом веб-сервера, который включает имя домена SIP в поле Subject.) Основные два требования к сертификату, используемому для проверки подлинности от сервера к серверу, таковы: 1)такой же сертификат должен быть настроен как сертификат OAuthTokenIssuer на всех серверах переднего входа; и 2) сертификат должен быть не менее 2048 битов.
  
Если у вас нет сертификата, который можно использовать для проверки подлинности от сервера к серверу, вы можете получить новый сертификат, импортировать новый сертификат, а затем использовать этот сертификат для проверки подлинности от сервера к серверу. После того, как вы запросили и получили новый сертификат, вы можете войти в любой из серверов переднего Windows PowerShell, аналогичную этой, для импорта и назначения этого сертификата:
  
```PowerShell
Import-CsCertificate -Identity global -Type OAuthTokenIssuer -Path C:\Certificates\ServerToServerAuth.pfx  -Password "P@ssw0rd"
```

В предыдущей команде параметр Path представляет полный путь к файлу сертификата, а параметр Password представляет пароль, который был назначен сертификату. Эта процедура должна выполняться только один раз: служба репликации Skype для бизнеса Server автоматически создает набор запланированных задач, которые расшифровывают и развертывают сертификат на всех серверах переднего входа.
  
Кроме того, можно использовать существующий сертификат в качестве сертификата проверки подлинности от сервера к серверу. (Как отмечено, сертификат по умолчанию может использоваться в качестве сертификата проверки подлинности от сервера к серверу.) Следующие пары команд Windows PowerShell извлекать значение свойства thumbprint сертификата по умолчанию, а затем использовать это значение, чтобы сделать сертификат по умолчанию сертификатом проверки подлинности от сервера к серверу:
  
```PowerShell
$x = (Get-CsCertificate -Type Default).Thumbprint
Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x
```

В предыдущей команде извлеченный сертификат настроен на функцию глобального сертификата проверки подлинности от сервера к серверу; это означает, что сертификат будет реплицироваться и использоваться всеми серверами переднего входа. Опять же, эта команда должна запускаться только один раз и только на одном из серверов переднего конца. Несмотря на то, что все серверы переднего конечного сервера должны использовать один и тот же сертификат, не следует настраивать сертификат OAuthTokenIssuer на каждом переднем сервере. Вместо этого настройте сертификат один раз, а затем Skype для бизнеса Server сервер репликации позаботится о копировании этого сертификата на каждый сервер.
  
Этот Set-CsCertificate принимает данный сертификат и сразу же настраивает этот сертификат в качестве текущего сертификата OAuthTokenIssuer. (Skype для бизнеса Server хранит две копии типа сертификата: текущий сертификат и предыдущий сертификат.) Если вам нужно, чтобы новый сертификат немедленно начал действовать в качестве сертификата OAuthTokenIssuer, необходимо использовать Set-CsCertificate.
  
Вы также можете использовать Set-CsCertificate, чтобы "свернуть" новый сертификат. "Перекатка" сертификата просто означает, что вы настроили новый сертификат, чтобы стать текущим сертификатом OAuthTokenIssuer в определенный момент времени. Например, эта команда извлекает сертификат по умолчанию, а затем настраивает этот сертификат для получения текущего сертификата OAuthTokenIssuer с 1 июля 2015 г.:
  
```PowerShell
$x = (Get-CsCertificate -Type Default).Thumbprint
Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x -EffectiveDate "7/1/2015" -Roll
```

С 1 июля 2015 года новый сертификат будет настроен как текущий сертификат OAuthTokenIssuer, а "старый" сертификат OAuthTokenIssuer будет настроен как предыдущий сертификат.
  
Если вы не хотите использовать Windows PowerShell вы также можете использовать консоль MMC Сертификаты для экспорта сертификата с одного переднего end Server, а затем импортировать этот же сертификат на всех остальных серверах переднего входа. При этом убедитесь, что вы экспортируете закрытый ключ вместе с самим сертификатом.
  
> [!CAUTION]
> В этом случае процедура должна выполняться на каждом переднем сервере. При экспорте и импорте сертификатов таким образом Skype для бизнеса Server не будет реплицировать этот сертификат на каждый сервер переднего конца. 
  
После импорта сертификата на все серверы переднего входа этот сертификат может быть назначен с помощью мастера развертывания Skype для бизнеса Server, а не Windows PowerShell. Чтобы назначить сертификат с помощью мастера развертывания, выполните следующие действия на компьютере, на котором установлен мастер развертывания:
  
1. Нажмите кнопку Начните, нажмите кнопку Все программы, **нажмите Skype для бизнеса Server,** а затем нажмите кнопку **Skype для бизнеса Server мастер развертывания**.
    
2. В мастере развертывания нажмите **кнопку Установить** или обновить Skype для бизнеса Server system .
    
3. На странице Skype для бизнеса Server нажмите кнопку **Выполнить** под заголовком Шаг **3: Запрос, Установка** или назначение сертификатов . (Примечание. Если вы уже установили сертификаты на этом компьютере, кнопка **Run** будет помечена **выполнить снова.)**
    
4. В мастере сертификатов выберите **сертификат OAuthTokenIssuer** и нажмите кнопку **Назначить**.
    
5. В мастере назначения сертификатов на странице **Назначение** сертификата нажмите **кнопку Далее**.
    
6. На странице **Хранилище сертификатов** выберите сертификат, который будет использоваться для проверки подлинности от сервера к серверу, а затем нажмите **кнопку Далее**.
    
7. На странице Сводка по назначениям сертификатов щелкните **Далее**.
    
8. На странице выполнения команд нажмите кнопку **Готово**.
    
9. Закрой мастер сертификатов и мастер развертывания.
    

