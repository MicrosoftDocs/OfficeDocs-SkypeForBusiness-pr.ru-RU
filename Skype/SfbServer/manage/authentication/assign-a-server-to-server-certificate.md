---
title: Назначение сертификата проверки подлинности "сервер-сервер" Skype для бизнеса Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: c7413954-2504-47f4-a073-44548aff1c0c
description: Сводка. Назначение сертификата проверки подлинности "сервер-сервер" для Skype для бизнеса Server.
ms.openlocfilehash: 122c2a1783fe4370027b4412ae5be8058e4914ce
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49828509"
---
# <a name="assign-a-server-to-server-authentication-certificate-to-skype-for-business-server"></a>Назначение сертификата проверки подлинности "сервер-сервер" Skype для бизнеса Server
**Сводка:** Назначьте сертификат проверки подлинности "сервер-сервер" для Skype для бизнеса Server.
  
Чтобы определить, назначен ли сертификат проверки подлинности "сервер-сервер" skype для бизнеса Server, в командной командной оболочке Skype для бизнеса Server запустите следующую команду:
  
```PowerShell
Get-CsCertificate -Type OAuthTokenIssuer
```

Если сведения о сертификате не возвращаются, необходимо назначить сертификат выдавливания маркеров, прежде чем можно будет использовать проверку подлинности "сервер-сервер". Как правило, любой сертификат Skype для бизнеса Server можно использовать в качестве сертификата OAuthTokenIssuer; Например, сертификат skype для бизнеса Server по умолчанию также можно использовать в качестве сертификата OAuthTokenIssuer. (Сертификат OAUthTokenIssuer также может быть любым сертификатом веб-сервера, который включает имя вашего домена SIP в поле "Тема".) К сертификату, используемому для проверки подлинности "сервер-сервер", предъявляются два основных требования: 1) один и тот же сертификат должен быть настроен как сертификат OAuthTokenIssuer на всех серверах переднего сервера; и 2) Сертификат должен быть не менее 2048 бит.
  
Если у вас нет сертификата, который можно использовать для проверки подлинности "сервер-сервер", можно получить новый сертификат, импортировать новый сертификат и затем использовать его для проверки подлинности "сервер-сервер". После запроса и запроса нового сертификата можно войти на любой из серверов переднего Windows PowerShell для импорта и назначения этого сертификата с помощью команды Windows PowerShell, аналогичной этой:
  
```PowerShell
Import-CsCertificate -Identity global -Type OAuthTokenIssuer -Path C:\Certificates\ServerToServerAuth.pfx  -Password "P@ssw0rd"
```

В предыдущей команде параметр Path представляет полный путь к файлу сертификата, а параметр Password — пароль, который был назначен сертификату. Эту процедуру следует выполнить только один раз: служба репликации Skype для бизнеса Server автоматически создаст набор запланированных задач, которые расшифровывают и развертывают сертификат на всех серверах переднего сервера.
  
Кроме того, можно использовать существующий сертификат в качестве сертификата проверки подлинности "сервер-сервер". (Как уже было отмечено, сертификат по умолчанию можно использовать в качестве сертификата проверки подлинности "сервер-сервер".) Следующая пара Windows PowerShell извлекает значение свойства Thumbprint сертификата по умолчанию, а затем использует это значение, чтобы сделать сертификат по умолчанию сертификатом проверки подлинности "сервер-сервер":
  
```PowerShell
$x = (Get-CsCertificate -Type Default).Thumbprint
Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x
```

В предыдущей команде полученный сертификат настраивается для работы в качестве глобального сертификата проверки подлинности "сервер-сервер"; это означает, что сертификат будет реплицирован и использован всеми серверами переднего сервера. Опять же, эту команду следует выполнить только один раз и только на одном из серверов переднего сервера. Хотя все серверы переднего сервера должны использовать один и тот же сертификат, не следует настраивать сертификат OAuthTokenIssuer на каждом сервере переднего сервера. Вместо этого настройте сертификат один раз, а затем позвольте серверу репликации Skype для бизнеса Server копировать этот сертификат на каждый сервер.
  
Этот Set-CsCertificate принимает сертификат и сразу настраивает его в качестве текущего сертификата OAuthTokenIssuer. (Skype для бизнеса Server сохраняет две копии типа сертификата: текущий и предыдущий.) Если требуется, чтобы новый сертификат сразу же начал действовать в качестве сертификата OAuthTokenIssuer, следует использовать Set-CsCertificate.
  
Вы также можете использовать Set-CsCertificate для "сверки" нового сертификата. "Развертывание" сертификата просто означает, что новый сертификат должен стать текущим сертификатом OAuthTokenIssuer в определенный момент времени. Например, эта команда извлекает сертификат по умолчанию, а затем настраивает его для получения в качестве текущего сертификата OAuthTokenIssuer с 1 июля 2015 г.:
  
```PowerShell
$x = (Get-CsCertificate -Type Default).Thumbprint
Set-CsCertificate -Identity global -Type OAuthTokenIssuer -Thumbprint $x -EffectiveDate "7/1/2015" -Roll
```

1 июля 2015 г. новый сертификат будет настроен как текущий сертификат OAuthTokenIssuer, а "старый" сертификат OAuthTokenIssuer — как предыдущий.
  
Если вы не хотите использовать Windows PowerShell вы также можете использовать консоль MMC "Сертификаты" для экспорта сертификата с одного сервера переднего сервера, а затем импортировать этот же сертификат на все остальные серверы переднего сервера. В этом случае необходимо экспортировать закрытый ключ вместе с самим сертификатом.
  
> [!CAUTION]
> В этом случае эту процедуру необходимо выполнить на каждом сервере переднего сервера. При экспорте и импорте сертификатов таким образом Skype для бизнеса Server не будет реплицировать этот сертификат на каждый сервер переднего сервера. 
  
После импорта сертификата на все серверы переднего Windows PowerShell. Чтобы назначить сертификат с помощью мастера развертывания, выполните следующие действия на компьютере, на котором установлен мастер развертывания:
  
1. Click Start, click All Programs, click **Skype for Business Server**, and then click Skype for Business Server Deployment **Wizard.**
    
2. В мастере развертывания щелкните "Установить или **обновить систему Skype для бизнеса Server".**
    
3. На странице Skype для бизнеса  Server нажмите кнопку "Выполнить" под заголовком **"Шаг 3. Запрос, установка или назначение сертификатов".** (Примечание. Если вы уже установили сертификаты  на этом компьютере, кнопка "Выполнить" будет помечена как "Запустить **снова".)**
    
4. В мастере сертификатов выберите сертификат **OAuthTokenIssuer** и нажмите кнопку **"Назначить".**
    
5. В мастере назначения сертификатов на странице **"Назначение сертификатов"** нажмите кнопку **"Далее".**
    
6. На странице **"Хранилище** сертификатов" выберите сертификат, используемый для проверки подлинности "сервер-сервер", и нажмите кнопку **"Далее".**
    
7. На странице Сводка по назначениям сертификатов щелкните **Далее**.
    
8. На странице выполнения команд нажмите кнопку **Готово**.
    
9. Закроем мастер сертификатов и мастер развертывания.
    

