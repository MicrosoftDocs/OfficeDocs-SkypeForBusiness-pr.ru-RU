---
title: Настройка и мониторинг службы резервного копирования
ms.reviewer: ''
author: cichur
ms.author: v-mahoffman
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
description: Для настройки и мониторинга службы резервного копирования можно использовать Skype для бизнеса Server команд командной оболочки управления.
ms.openlocfilehash: f50f8ab13c2013505beace71f7e35cbc7674777c
ms.sourcegitcommit: 65a10f80e5dfd67b2778e09f5f92c21ef09ce36a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2021
ms.locfileid: "60747047"
---
# <a name="configuring-and-monitoring-the-backup-service-in-skype-for-business-server"></a>Настройка и мониторинг службы резервного копирования в Skype для бизнеса Server

Для настройки и мониторинга службы резервного копирования можно использовать следующие Skype для бизнеса Server команд командной оболочки управления. Чтобы восстановить сведения о конференциях, хранимые в хранилище файлов пула переднего конца, см. в таблице Восстановление содержимого конференции с помощью службы резервного [копирования](#restore-conference-contents-using-the-backup-service)ниже.

> [!NOTE]  
> Группа RTCUniversalServerAdmins является единственной группой, у которой есть разрешения на запуск **Get-CsBackupServiceStatus** по умолчанию. Для использования этого командлета выполните вход в качестве члена этой группы. Либо можно предоставить доступ к этой команде другим группам (например, CSAdministrator) с помощью командлета **Set-CsBackupServiceConfiguration**.

## <a name="to-see-the-backup-service-configuration"></a>Просмотр конфигурации службы резервного копирования

Выполните следующий командлет:<br/><br/>Get-CsBackupServiceConfiguration

Значение SyncInterval по умолчанию равно двум минутам.

## <a name="to-set-the-backup-service-sync-interval"></a>Установка интервала синхронизации для службы резервного копирования

Выполните следующий командлет:<br/><br/>Set-CsBackupServiceConfiguration -SyncInterval

Например, следующая команда задает интервал в три минуты.<br/><br/>Set-CsBackupServiceConfiguration SyncInterval 00:03:00


> [!IMPORTANT]  
> Несмотря на то, что с помощью этого командлета можно изменить интервал синхронизации по умолчанию для службы резервного копирования, это следует делать только в случае крайней необходимости, поскольку интервал синхронизации оказывает огромное влияние на производительность работы службы резервного копирования и целевую точку восстановления (RPO).

## <a name="to-get-the-backup-service-status-for-a-particular-pool"></a>Получение состояния службы резервного копирования для конкретного пула

Выполните следующий командлет:<br/><br/>Get-CsBackupServiceStatus PoolFqdn \<pool-FQDN>

> [!NOTE]  
> Состояние синхронизации службы резервного копирования определяется в одном направлении — от пула P1 до его резервного пула P2. Состояние синхронизации от P1 до P2 может отличаться от состояния синхронизации от P2 до P1. Для направления от P1 до P2 служба резервного копирования находится в "готовом" состоянии, если все изменения, внесенные в P1, полностью реплицируются на P2 в течение интервала синхронизации. Она находится в "завершенном" состоянии, если изменений для синхронизации от P1 до P2 больше нет. Оба состояния указывают на мгновенный снимок службы резервного копирования в момент выполнения командлета. Возвращенное состояние не будет оставаться таким же и после. Например, "завершенное" состояние сохранится только до тех пор, пока на P1 не возникнет каких-либо изменений после выполнения командлета. Это же верно в случае аварийного переключения с P1 на P2 после перевода P1 режим только для чтения в рамках логики выполнения **Invoke-CsPoolfailover**.

## <a name="to-get-information-about-the-backup-relationship-for-a-particular-pool"></a>Получение сведений о резерве для конкретного пула

Выполните следующий командлет:<br/><br/>Get-CsPoolBackupRelationship PoolFQDN \<poolFQDN>

## <a name="to-force-a-backup-service-sync"></a>Принудительная синхронизация службы резервного копирования

Выполните следующий командлет:<br/><br/>Invoke-CsBackupServiceSync PoolFqdn \<poolFqdn> [-BackupModule {All| PresenceFocus| DataConf| CMSMaster}]

## <a name="restore-conference-contents-using-the-backup-service"></a>Восстановление содержимого конференции с помощью службы резервного копирования 

Если сведения о конференции, хранимые в хранилище файлов пула переднего конца, становятся недоступными, необходимо восстановить эти сведения, чтобы пользователи, которые были в пуле, сохраняли свои данные конференции. Если пул переднего конца, потеряв данные конференции, в паре с другим пулом переднего конца, для восстановления данных можно использовать службу резервного копирования.

Необходимо также выполнить эту задачу, если вследствие сбоя не работает весь пул и необходимо перенести его пользователей в резервный пул. При восстановлении пользователей в исходном пуле необходимо использовать эту процедуру для копирования контента конференций обратно в исходный пул.

Предположим, что пул1 объединен с пулом2, а данные конференций в пуле1 утрачены. Чтобы восстановить содержимое, можно использовать следующий комдлет для вызова службы резервного копирования.<br/><br/>Invoke-CsBackupServiceSync PoolFqdn \<Pool2 FQDN> -BackupModule ConfServices.DataConf

Восстановление содержимого конференций может занять некоторое время в зависимости от размера. Можно использовать приведенный ниже командлет для проверки состояния процесса:<br/><br/>Get-CsBackupServiceStatus PoolFqdn \<Pool2 FQDN> -BackupModule ConfServices.DataConf

Процесс завершается, когда этот командлет возвращает значение Steady State для данных в модуле конференций.
