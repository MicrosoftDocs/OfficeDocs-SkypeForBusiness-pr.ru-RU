---
title: Advanced Edge Server DNS planning for Skype for Business Server
ms.reviewer: ''
ms.author: v-cichur
author: cichur
audience: ITPro
manager: serdars
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Hybrid
ms.custom: ''
ms.assetid: f3a5895f-f64f-44eb-9a5e-8d606ac1fc38
description: Сводка. Обзор сценариев развертывания Skype для бизнеса Server. Этот раздел поможет вам использовать один сервер или пул серверов с DNS или HLB.
ms.openlocfilehash: 5a41baac30f3bf6a1e20ae34db009dae0cec40af
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49825329"
---
# <a name="advanced-edge-server-dns-planning-for-skype-for-business-server"></a><span data-ttu-id="a7e6e-104">Advanced Edge Server DNS planning for Skype for Business Server</span><span class="sxs-lookup"><span data-stu-id="a7e6e-104">Advanced Edge Server DNS planning for Skype for Business Server</span></span>
 
<span data-ttu-id="a7e6e-105">**Сводка:** Обзор сценариев развертывания Skype для бизнеса Server.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-105">**Summary:** Review scenarios for Skype for Business Server deployment options.</span></span> <span data-ttu-id="a7e6e-106">Этот раздел поможет вам использовать один сервер или пул серверов с DNS или HLB.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-106">Whether you want a single server or prefer a server pool with DNS or HLB, this topic should help.</span></span>
  
<span data-ttu-id="a7e6e-107">При планировании системы доменных имен (DNS) для Skype для бизнеса Server существует множество факторов, которые могут оказаться важными при принятии решения.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-107">When it comes to Domain Name System (DNS) planning for Skype for Business Server, there are a lot of factors that may play into your decision.</span></span> <span data-ttu-id="a7e6e-108">Если структура домена вашей организации уже есть, это может быть вопросом проверки того, как вы собираетесь продолжить.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-108">If your organization's domain structure's already in place, this may be a matter of reviewing how you're going to proceed.</span></span> <span data-ttu-id="a7e6e-109">Начнем с разделов, которые приведены ниже.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-109">We'll begin with the topics found below:</span></span>
  
- [<span data-ttu-id="a7e6e-110">Walkthrough of Skype for Business clients locating services</span><span class="sxs-lookup"><span data-stu-id="a7e6e-110">Walkthrough of Skype for Business clients locating services</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#WalkthroughOfSkype)
    
- [<span data-ttu-id="a7e6e-111">Разделенная DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-111">Split-brain DNS</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#SplitBrainDNS)
    
- [<span data-ttu-id="a7e6e-112">Автоматическая настройка без разделенной DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-112">Automatic configuration without split-brain DNS</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#NoSplitBrainDNS)
    
- [<span data-ttu-id="a7e6e-113">Аварийное восстановление DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-113">DNS disaster recovery</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#DNSDR)
    
- [<span data-ttu-id="a7e6e-114">Балансировка нагрузки на DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-114">DNS load balancing</span></span>](../../plan-your-deployment/edge-server-deployments/advanced-edge-server-dns.md#DNSLB)
    
## <a name="walkthrough-of-skype-for-business-clients-locating-services"></a><span data-ttu-id="a7e6e-115">Walkthrough of Skype for Business clients locating services</span><span class="sxs-lookup"><span data-stu-id="a7e6e-115">Walkthrough of Skype for Business clients locating services</span></span>
<span data-ttu-id="a7e6e-116"><a name="WalkthroughOfSkype"> </a></span><span class="sxs-lookup"><span data-stu-id="a7e6e-116"><a name="WalkthroughOfSkype"> </a></span></span>

<span data-ttu-id="a7e6e-117">Клиенты Skype для бизнеса похожи на предыдущие версии клиентов Lync в поиске служб в Skype для бизнеса Server и доступе к ним.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-117">Skype for Business clients are similar to previous versions of Lync clients in how they find and access services in Skype for Business Server.</span></span> <span data-ttu-id="a7e6e-118">В этом разделе подробно процесс определения местоположения сервера.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-118">This section details the server location process.</span></span>
  
1. <span data-ttu-id="a7e6e-119">lyncdiscoverinternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-119">lyncdiscoverinternal.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-120">*Это запись хоста A для службы автонаружия во внутренних веб-службах.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-120">*This is an A host record for the Autodiscover service on the internal web services.*</span></span> 
    
2. <span data-ttu-id="a7e6e-121">lyncdiscover.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-121">lyncdiscover.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-122">*Это запись хоста A для службы автонаружия во внешних веб-службах.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-122">*This is an A host record for the Autodiscover service on the external web services.*</span></span> 
    
3. <span data-ttu-id="a7e6e-123">_sipinternaltls._tcp.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-123">_sipinternaltls._tcp.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-124">*Это запись SRV для внутренних подключений TLS.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-124">*This is a SRV record for internal TLS connections.*</span></span> 
    
4. <span data-ttu-id="a7e6e-125">_sip._tls.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-125">_sip._tls.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-126">*Это запись SRV для внешних подключений TLS.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-126">*This is a SRV record for external TLS connections.*</span></span> 
    
5. <span data-ttu-id="a7e6e-127">sipinternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-127">sipinternal.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-128">*Это запись хоста A для пула переднего входа или директора, разрешаемая только во внутренней сети.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-128">*This is an A host record for the Front End pool or Director, resolvable only on the internal network.*</span></span> 
    
6. <span data-ttu-id="a7e6e-129">sip.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-129">sip.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-130">*Это запись хоста A для пула переднего входа или директора, разрешаемая только во внутренней сети.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-130">*This is an A host record for the Front End pool or Director, resolvable only on the internal network.*</span></span> 
    
7. <span data-ttu-id="a7e6e-131">sipexternal.\<domain\></span><span class="sxs-lookup"><span data-stu-id="a7e6e-131">sipexternal.\<domain\></span></span>
    
     <span data-ttu-id="a7e6e-132">*Это запись хоста A для службы доступа, когда клиент является внешним.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-132">*This is an A host record for the Access Edge service, when the client is external.*</span></span> 
    
<span data-ttu-id="a7e6e-133">Служба автоотнаружение всегда предпочтительнее, так как это предпочтительный метод для расположения службы, а остальные — это методы отката.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-133">The Autodiscover service is always favored as that's the preferred method for service location, and the others are fallback methods.</span></span>
  
> [!NOTE]
> <span data-ttu-id="a7e6e-134">При создании записей SRV важно помнить, что они должны указать на DNS-записи A (и AAAA, если вы используете IPv6-адреса) в том же домене, где создается запись SRV DNS.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-134">When you're creating SRV records, it's important to remember that they need to point to a DNS A (and AAAA if you're using IPv6 addressing) in the same domain in which the DNS SRV record's being created.</span></span> <span data-ttu-id="a7e6e-135">Например, если запись SRV в contoso.com, запись A (и AAAA), на которая она указывает, не может быть в fabrikam.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-135">For example, if they SRV record's in contoso.com, the A (and AAAA) record it points to can't be in fabrikam.com.</span></span> 
  
<span data-ttu-id="a7e6e-136">Если вы готовы сделать это, вы можете настроить мобильное устройство для обнаружения служб вручную.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-136">If you're inclined to do it, you can set your mobile device up for manual discovery of services.</span></span> <span data-ttu-id="a7e6e-137">Если это именно то, что вы хотите сделать, каждому пользователю необходимо настроить параметры мобильного устройства с полными внутренними и внешними URIS службы автооружия, включая протокол и путь, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-137">If that's what you're looking to do, each user needs to configure their mobile device settings with the full internal and external Autodiscover service URIs, including the protocol and path, as follows:</span></span>
  
- <span data-ttu-id="a7e6e-138">Для внешнего доступа: https:// \<ExtPoolFQDN\> /Autodiscover/autodiscoverservice.svc/Root</span><span class="sxs-lookup"><span data-stu-id="a7e6e-138">For external access: https://\<ExtPoolFQDN\>/Autodiscover/autodiscoverservice.svc/Root</span></span>
    
- <span data-ttu-id="a7e6e-139">Для внутреннего доступа: https:// \<IntPoolFQDN\> /AutoDiscover/AutoDiscover.svc/Root</span><span class="sxs-lookup"><span data-stu-id="a7e6e-139">For internal access: https://\<IntPoolFQDN\>/AutoDiscover/AutoDiscover.svc/Root</span></span>
    
<span data-ttu-id="a7e6e-140">Мы рекомендуем использовать автоматическое обнаружение, а не обнаружение вручную.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-140">We do recommend you use automatic discovery as opposed to manual discovery.</span></span> <span data-ttu-id="a7e6e-141">Но если вы устраняете неполадки или тестируете их, параметры вручную могут оказаться очень полезными.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-141">But if you're doing some troubleshooting or testing, manual settings can be very helpful.</span></span>
  
## <a name="split-brain-dns"></a><span data-ttu-id="a7e6e-142">Разделенная DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-142">Split-brain DNS</span></span>
<span data-ttu-id="a7e6e-143"><a name="SplitBrainDNS"> </a></span><span class="sxs-lookup"><span data-stu-id="a7e6e-143"><a name="SplitBrainDNS"> </a></span></span>

<span data-ttu-id="a7e6e-144">Это конфигурация DNS, в которой имеется две зоны DNS с одинаковым пространством имен.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-144">This is a DNS configuration where you have two DNS zones with the same namespace.</span></span> <span data-ttu-id="a7e6e-145">Первая зона DNS обрабатывает внутренние запросы, а вторая зона DNS обрабатывает внешние запросы.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-145">The first DNS zone handles internal requests, while the second DNS zone handles external requests.</span></span>
  
<span data-ttu-id="a7e6e-146">Зачем компании это делать?</span><span class="sxs-lookup"><span data-stu-id="a7e6e-146">Why would a company do this?</span></span> <span data-ttu-id="a7e6e-147">Для них может потребоваться использовать одно и то же пространство имен как внутри, так и извне, но, конечно, это приведет к уникальному использованию многих записей DNS SRV и A в той или иной зоне, а при дублировании IP-адреса, связанные с этими записями, будут уникальными.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-147">They may have a requirement to use the same namespace internally and externally, but of course this will lead to many DNS SRV and A records being unique to one zone or another, and where there is duplication, the IP addresses associated with these records would be unique.</span></span>
  
<span data-ttu-id="a7e6e-148">Это представляет некоторые проблемы.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-148">This presents some challenges.</span></span> <span data-ttu-id="a7e6e-149">Самое важное, что разделенная DNS не **поддерживается для** мобильной работы.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-149">The most important is that split-brain DNS is **not supported** for Mobility.</span></span> <span data-ttu-id="a7e6e-150">Это происходит из-за записей DNS LyncDiscover и LyncDiscoverInternal (LyncDiscover необходимо определить на внешнем DNS-сервере, а LyncDiscoverInternal — на внутреннем DNS-сервере).</span><span class="sxs-lookup"><span data-stu-id="a7e6e-150">This is because of the LyncDiscover and LyncDiscoverInternal DNS records (LyncDiscover has to be defined on you external DNS server, while LyncDiscoverInternal has to be defined on your internal DNS server).</span></span>
  
<span data-ttu-id="a7e6e-151">Здесь мы перечислим записи DNS для внутренней и внешней зон, но подробные примеры можно найти в разделе "Требования к среде edge Server".</span><span class="sxs-lookup"><span data-stu-id="a7e6e-151">We'll list the DNS records for the internal and external zones here, but you can find detailed examples on the Edge Server environmental requirements section.</span></span>
  
### <a name="internal-dns"></a><span data-ttu-id="a7e6e-152">Внутренняя DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-152">Internal DNS</span></span>

- <span data-ttu-id="a7e6e-153">Содержит зону DNS, называемую (например contoso.com), для которой она является достоверной.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-153">Contains a DNS zone called (for example) contoso.com, for which it's authoritative.</span></span>
    
- <span data-ttu-id="a7e6e-154">Этот внутренний contoso.com содержит:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-154">This internal contoso.com contains:</span></span>
    
  - <span data-ttu-id="a7e6e-155">Записи DNS A и AAAA (при использовании IPv6-адресов) для пула переднего сервера, пула директоров или имени пула директоров, а также всех внутренних серверов со Skype для бизнеса Server в сети организации.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-155">DNS A and AAAA (if you're using IPv6 addressing) records for your Front End pool, Director pool or Director pool name, and all internal servers running Skype for Business Server in your organization's network.</span></span>
    
  - <span data-ttu-id="a7e6e-156">Записи DNS A и AAAA (при использовании IPv6-адресов) для внутреннего интерфейса периметра для каждого сервера Skype для бизнеса Server в сети периметра.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-156">DNS A and AAAA (if you're using IPv6 addressing) records for your Edge internal interface for each Skype for Business Server Edge Server in your perimeter network.</span></span>
    
  - <span data-ttu-id="a7e6e-157">Записи DNS A и AAAA (при использовании IPv6-адресов) для внутреннего интерфейса каждого обратного прокси-сервера в сети периметра (это необязательно для управления обратным прокси-сервером). </span><span class="sxs-lookup"><span data-stu-id="a7e6e-157">DNS A and AAAA (if you're using IPv6 addressing) records for the internal interface of each reverse proxy server in your perimeter network (which is **optional** for management of a reverse proxy).</span></span>
    
  - <span data-ttu-id="a7e6e-158">DNS-записи A и AAAA (при использовании IPv6-адресов) и записи SRV для внутренней  автонастройки клиента Skype для бизнеса Server (необязательно).</span><span class="sxs-lookup"><span data-stu-id="a7e6e-158">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for internal Skype for Business Server client autoconfiguration (which is **optional** ).</span></span>
    
  - <span data-ttu-id="a7e6e-159">Записи DNS A и AAAA (при использовании IPv6-адресов) или ЗАПИСИ CNAME для автоматического  обнаружения веб-служб Skype для бизнеса Server (необязательно).</span><span class="sxs-lookup"><span data-stu-id="a7e6e-159">DNS A and AAAA (if you're using IPv6 addressing) or CNAME records for automatic discovery of Skype for Business Server Web Services (which is **optional** ).</span></span>
    
- <span data-ttu-id="a7e6e-160">Все внутренние интерфейсы Skype для бизнеса Server в сети периметра используют эту внутреннюю зону DNS для разрешения запросов contoso.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-160">All your Skype for Business Server internal Edge interfaces in your perimeter network use this internal DNS zone for resolving queries to contoso.com.</span></span>
    
- <span data-ttu-id="a7e6e-161">Все серверы, на которых работает Skype для бизнеса Server, и клиенты Skype для бизнеса Server в корпоративной сети, указывают на внутренние DNS-серверы для разрешения запросов в contoso.com или используют файл host на каждом сервере и перечисляют записи A и AAAA (при использовании IPv6-адресов) для сервера следующего прыжка (специально для VIP директора или пула директоров) , VIP-сервер пула переднего сервера или сервер Standard Edition).</span><span class="sxs-lookup"><span data-stu-id="a7e6e-161">All servers running Skype for Business Server, and clients running Skype for Business Server in the corporate network, point to internal DNS servers for resolving queries to contoso.com, or they use the Host file on each Edge Server and list A and AAAA (if you're using IPv6 addressing) records for the next hop server (specifically for the Director or Director pool VIP, Front End pool VIP, or Standard Edition server).</span></span>
    
### <a name="external-dns"></a><span data-ttu-id="a7e6e-162">Внешняя DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-162">External DNS</span></span>

- <span data-ttu-id="a7e6e-163">Содержит зону DNS, называемую (например contoso.com), для которой она является достоверной.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-163">Contains a DNS zone called (for example) contoso.com, for which it's authoritative.</span></span>
    
- <span data-ttu-id="a7e6e-164">Этот внешний contoso.com содержит:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-164">This external contoso.com contains:</span></span>
    
  - <span data-ttu-id="a7e6e-165">DNS-записи A и AAAA (при использовании IPv6-адресов) или записи CNAME для автоматического обнаружения веб-служб Skype для бизнеса Server.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-165">DNS A and AAAA (if you're using IPv6 addressing), or CNAME records, for automatic discovery of Skype for Business Server web services.</span></span> <span data-ttu-id="a7e6e-166">Это для использования с мобильностью.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-166">This is for use with mobility.</span></span>
    
  - <span data-ttu-id="a7e6e-167">DNS-записи A и AAAA (при использовании IPv6-адресов) и записи SRV для внешнего интерфейса каждого сервера Skype для бизнеса Server или IP-адреса аппаратной балансиры нагрузки (HLB) в сети периметра.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-167">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for the Edge external interface of each Skype for Business Server Edge Server or hardware load balanced (HLB) VIP in the perimeter network.</span></span>
    
  - <span data-ttu-id="a7e6e-168">DNS-записи A и AAAA (при использовании IPv6-адресов) и записи SRV для внешнего интерфейса обратного прокси-сервера или (VIP для пула обратных прокси-серверов) в сети периметра.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-168">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for the external interface of the Reverse proxy server or (VIP for a pool of Reverse proxy servers), in the perimeter network.</span></span>
    
  - <span data-ttu-id="a7e6e-169">DNS-записи A и AAAA (при использовании IPv6-адресов) и записи SRV для автоматической перенастройки клиента Skype для бизнеса Server **(необязательно).**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-169">DNS A and AAAA (if you're using IPv6 addressing) and SRV records for Skype for Business Server client autoconfiguration ( **optional** ).</span></span>
    
## <a name="automatic-configuration-without-split-brain-dns"></a><span data-ttu-id="a7e6e-170">Автоматическая настройка без разделенной DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-170">Automatic configuration without split-brain DNS</span></span>
<span data-ttu-id="a7e6e-171"><a name="NoSplitBrainDNS"> </a></span><span class="sxs-lookup"><span data-stu-id="a7e6e-171"><a name="NoSplitBrainDNS"> </a></span></span>

<span data-ttu-id="a7e6e-172">Если вы не используете разделенную DNS, внутренняя автоматическая настройка клиентов со Skype для бизнеса не будет работать, если вы не используете одно из обходных пути, которые у нас есть.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-172">If you don't use split-brain DNS, internal automatic configuration of clients running Skype for Business won't work unless you're using one of the workarounds we have here.</span></span> <span data-ttu-id="a7e6e-173">Почему нет?</span><span class="sxs-lookup"><span data-stu-id="a7e6e-173">Why not?</span></span> <span data-ttu-id="a7e6e-174">Поскольку Skype для бизнеса Server требует, чтобы SIP URI пользователя совпадал с доменом интерфейсного пула, предназначенным для автоматической настройки.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-174">Because Skype for Business Server requires the user's SIP URI to match the domain of the Front End pool designated for automatic configuration.</span></span> <span data-ttu-id="a7e6e-175">Это не изменилось по версии предыдущих версий Lync Server.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-175">This hasn't changed from earlier versions of Lync Server.</span></span>
  
<span data-ttu-id="a7e6e-176">Таким образом, если у вас есть два SIP-домена, вам потребуется использовать эти записи DNS SRV:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-176">So, if you have two SIP domains in use, you'd need these DNS SRV records:</span></span>
  
- <span data-ttu-id="a7e6e-177">_sipinternaltls._tcp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-177">_sipinternaltls._tcp.contoso.com.</span></span> <span data-ttu-id="a7e6e-178">86400 IN SRV 0 0 5061 pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-178">86400 IN SRV 0 0 5061 pool01.contoso.com</span></span>
    
     <span data-ttu-id="a7e6e-179">*Если пользователь в bob@contoso.com, эта запись будет работать для автоматической настройки, так как домен SIP пользователя совпадает с доменом интерфейсного пула (contoso.com).*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-179">*If a user signs in as bob@contoso.com, this record would work for automatic configuration, as the user's SIP domain matches the domain of the Front End pool (contoso.com).*</span></span> 
    
- <span data-ttu-id="a7e6e-180">_sipinternaltls._tcp.fabrikam.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-180">_sipinternaltls._tcp.fabrikam.com.</span></span> <span data-ttu-id="a7e6e-181">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-181">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span></span>
    
     <span data-ttu-id="a7e6e-182">*Если пользователь в alice@fabrikam.com, эта запись будет работать для автоматической настройки второго домена, так как домен SIP совпадает с интерфейсным пулом для этого домена.*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-182">*If a user signs in as alice@fabrikam.com, this record would work for automatic configuration of the second domain, again because the SIP domain matches the Front End pool for that domain.*</span></span> 
    
<span data-ttu-id="a7e6e-183">Если взять пример далее, это не сработает:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-183">To take the example further, this would not work:</span></span>
  
- <span data-ttu-id="a7e6e-184">_sipinternaltls._tcp.litwareinc.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-184">_sipinternaltls._tcp.litwareinc.com.</span></span> <span data-ttu-id="a7e6e-185">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-185">86400 IN SRV 0 0 5061 pool01.fabrikam.com</span></span>
    
     <span data-ttu-id="a7e6e-186">*Пользователь, который в tim@litwareinc.com не работает для автоматической настройки, так как его домен SIP (litwareinc.com) не совпадает с доменом в пуле (fabrikam.com).*</span><span class="sxs-lookup"><span data-stu-id="a7e6e-186">*A user signing in as tim@litwareinc.com won't work for automatic configuration, because his SIP domain (litwareinc.com) doesn't match the domain in the pool (fabrikam.com).*</span></span> 
    
<span data-ttu-id="a7e6e-187">Теперь, когда мы знаем все это, если вам требуется автоматическое требование для клиентов Skype для бизнеса без разделенной DNS, у вас есть указанные далее варианты.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-187">So now that we know all that, if you need automatic requirement for your Skype for Business clients without split-brain DNS, you have these options:</span></span>
  
- <span data-ttu-id="a7e6e-188">**Объекты групповой политики.**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-188">**Group Policy Objects**</span></span>
    
    <span data-ttu-id="a7e6e-189">Для заполнения правильных значений сервера можно использовать объекты групповой политики.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-189">You can use Group Policy Objects (GPOs) to populate the correct server values.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="a7e6e-190">Этот параметр не включает автоматическую настройку, но автоматизирует ручную настройку.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-190">This option doesn't enable automatic configuration, but it does automate manual configuration.</span></span> <span data-ttu-id="a7e6e-191">При таком подходе записи SRV, связанные с автоматической настройкой, не требуются.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-191">If this approach is used, the SRV records associated with automatic configuration aren't required.</span></span> 
  
- <span data-ttu-id="a7e6e-192">**Совпадающая внутренняя зона.**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-192">**Matching internal zone**</span></span>
    
    <span data-ttu-id="a7e6e-193">Вам потребуется создать зону во внутренней DNS, которая соответствует внешней зоне DNS (например, contoso.com), а затем создать записи DNS A (и AAAA, если вы используете IPv6-адреса), соответствующие пулу Skype для бизнеса Server, используемой для автоматической настройки.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-193">You'll need to create a zone in your internal DNS that matches your external DNS zone (for example, contoso.com), and then create DNS A (and AAAA if you're using IPv6 addressing) records that correspond to the Skype for Business Server pool used for automatic configuration.</span></span>
    
    <span data-ttu-id="a7e6e-194">Например, если у вас есть пользователь, который находится в pool01.contoso.net, но в Skype для бизнеса в качестве bob@contoso.com, создайте внутреннюю зону DNS с иконой contoso.com, а внутри нее необходимо создать запись DNS A (и AAAA, если используется IPv6-адрес) для pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-194">For example, if you have a user homed on pool01.contoso.net, but signs into Skype for Business as bob@contoso.com, create an internal DNS zone called contoso.com, and inside it you need to create a DNS A (and AAAA if IPv6 addressing's being used) record for pool01.contoso.com.</span></span>
    
- <span data-ttu-id="a7e6e-195">**Точное определение внутренней зоны.**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-195">**Pin-point internal zone**</span></span>
    
    <span data-ttu-id="a7e6e-196">Если создание всей зоны во внутренней DNS не является вариантом, вы можете создать зоны контактной точки (выделенные), соответствующие записям SRV, требуемой для автоматической настройки, и заполнить эти зоны с помощью dnscmd.exe.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-196">If creating an entire zone in your internal DNS isn't an option for you, you can create pin-point (dedicated) zones that correspond to the SRV records required for automatic configuration, and populate those zones using dnscmd.exe.</span></span> <span data-ttu-id="a7e6e-197">Dnscmd.exe требуется, так как пользовательский интерфейс DNS не поддерживает создание зон контактов.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-197">Dnscmd.exe is required because the DNS user interface won't support the creation of pin-point zones.</span></span>
    
    <span data-ttu-id="a7e6e-198">Например, если ваш домен SIP contoso.com, а у вас есть пул переднего сервера pool01, содержащий два сервера переднего сервера, во внутренней DNS вам потребуется следующая зона контактной точки и записи A:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-198">For example, if your SIP domain is contoso.com, and you have a Front End pool called pool01 that contains two Front End Servers, you'll need the following pin-point zones and A records in your internal DNS:</span></span>
    
  ```console
  dnscmd . /zoneadd _sipinternaltls._tcp.contoso.com. /dsprimary
  dnscmd . /recordadd _sipinternaltls._tcp.contoso.com. @ SRV 0 0 5061 pool01.contoso.com.
  dnscmd . /zoneadd pool01.contoso.com. /dsprimary
  dnscmd . /recordadd pool01.contoso.com. @ A 192.168.10.90
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  dnscmd . /recordadd pool01.contoso.com. @ A 192.168.10.91 
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  ```

    <span data-ttu-id="a7e6e-199">В вашей среде может быть второй домен SIP.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-199">You may have a second SIP domain in your environment.</span></span> <span data-ttu-id="a7e6e-200">В этом случае во внутренней DNS вам потребуется следующая зона контактных точек и записи A:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-200">In that case, you'll need the following pin-point zones and A records in your internal DNS:</span></span>
    
  ```console
  dnscmd . /zoneadd _sipinternaltls._tcp.fabrikam.com. /dsprimary
  dnscmd . /recordadd _sipinternaltls._tcp.fabrikam.com. @ SRV 0 0 5061 pool01.fabrikam.com.
  dnscmd . /zoneadd pool01.fabrikam.com. /dsprimary
  dnscmd . /recordadd pool01.fabrikam.com. @ A 192.168.10.90
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  dnscmd . /recordadd pool01.fabrikam.com. @ A 192.168.10.91
  dnscmd . /recordadd pool01.contoso.com. @ AAAA <IPv6 address>
  ```

> [!NOTE]
> <span data-ttu-id="a7e6e-201">You'll see the Front End pool FQDN appears twice, but with two different IP addresses.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-201">You'll see the Front End pool FQDN appears twice, but with two different IP addresses.</span></span> <span data-ttu-id="a7e6e-202">Это потому, что используется балансировка нагрузки на DNS.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-202">That's because DNS load balancing is used.</span></span> <span data-ttu-id="a7e6e-203">Если используется HLB, существует только одна запись пула переднего уровня.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-203">If HLB is used, there'd only be a single Front End pool entry.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a7e6e-204">Кроме того, значения FQDN пула переднего contoso.com и fabrikam.com, но IP-адреса остаются без изменений.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-204">Also, the Front End pool FQDN values change between the contoso.com and fabrikam.com examples, but the IP addresses remain the same.</span></span> <span data-ttu-id="a7e6e-205">Это потому, что пользователи, выполвшие вход из любого домена SIP, будут использовать один и тот же пул переднего уровня для автоматической настройки.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-205">That's because users who're signing in from either SIP domain will be using the same Front End pool for automatic configuration.</span></span> 
  
## <a name="dns-disaster-recovery"></a><span data-ttu-id="a7e6e-206">Аварийное восстановление DNS</span><span class="sxs-lookup"><span data-stu-id="a7e6e-206">DNS disaster recovery</span></span>
<span data-ttu-id="a7e6e-207"><a name="DNSDR"> </a></span><span class="sxs-lookup"><span data-stu-id="a7e6e-207"><a name="DNSDR"> </a></span></span>

<span data-ttu-id="a7e6e-208">Чтобы настроить DNS для перенаправления веб-трафика Skype для бизнеса Server на сайты аварийного восстановления и отработки сбойов, необходимо использовать поставщика DNS, который поддерживает GeoDNS.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-208">To configure DNS to redirect Skype for Business Server web traffic to your disaster recover (DR) and failover sites, you need to use a DNS provider that supports GeoDNS.</span></span> <span data-ttu-id="a7e6e-209">Вы можете настроить записи DNS для поддержки аварийного восстановления, чтобы функции, которые используют веб-службы, продолжались даже в случае свиса одного пула переднего входа.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-209">You can set up your DNS records to support disaster recover, so that features that use web services continue even if one entire Front End pool goes down.</span></span> <span data-ttu-id="a7e6e-210">Эта функция dr поддерживает простые URL-адреса автоdiscover, Meet и Dial-in.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-210">This DR feature supports the Autodiscover, Meet and Dial-in simple URLs.</span></span>
  
<span data-ttu-id="a7e6e-211">Вы определяете и настраивает дополнительные записи A (AAAA) для DNS-сайта (AAAA, если используется IPv6) для внутреннего и внешнего разрешения веб-служб у поставщика GeoDNS.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-211">You define and configure additional DNS host A (AAAA if using IPv6) records for internal and external resolution of web services at your GeoDNS provider.</span></span> <span data-ttu-id="a7e6e-212">В следующих сведениях предполагается, что сопряженные пулы географически распределены  и что geoDNS, поддерживаемый вашим поставщиком, либо имеет круговой перенастройки **DNS,** либо настроен для использования Pool1 в качестве основного и перенаправл на пул Pool2 в случае потери связи или сбоя питания.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-212">The following details assume paired pools, geographically dispersed, and that the GeoDNS supported by your provider **either** has round-robin DNS **or** is configured to use Pool1 as primary and fails over to Pool2 in the event of any communications loss or power failure.</span></span>
  
<span data-ttu-id="a7e6e-213">Все записи DNS в этой таблице являются примерами.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-213">All the DNS records in this table are examples.</span></span>
  
|<span data-ttu-id="a7e6e-214">**Запись GeoDNS**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-214">**GeoDNS record**</span></span>|<span data-ttu-id="a7e6e-215">**Записи пула**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-215">**Pool records**</span></span>|<span data-ttu-id="a7e6e-216">**Записи CNAME**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-216">**CNAME records**</span></span>|<span data-ttu-id="a7e6e-217">**Параметры DNS (выберите один вариант)**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-217">**DNS settings (select one option)**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="a7e6e-218">Meet-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-218">Meet-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-219">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-219">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-220">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-220">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-221">Псевдоним Meet.contoso.com для Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-221">Meet.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-222">Псевдоним Meet.contoso.com для Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-222">Meet.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-223">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-223">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-224">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-224">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-225">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-225">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-226">Meet-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-226">Meet-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-227">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-227">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-228">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-228">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-229">Псевдоним Meet.contoso.com для Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-229">Meet.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-230">Псевдоним Meet.contoso.com для Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-230">Meet.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-231">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-231">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-232">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-232">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-233">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-233">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-234">Dialin-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-234">Dialin-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-235">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-235">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-236">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-236">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-237">Псевдоним Dialin.contoso.com для Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-237">Dialin.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-238">Псевдоним Dialin.contoso.com для Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-238">Dialin.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-239">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-239">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-240">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-240">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-241">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-241">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-242">Dialin-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-242">Dialin-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-243">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-243">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-244">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-244">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-245">Псевдоним Dialin.contoso.com для Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-245">Dialin.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-246">Псевдоним Dialin.contoso.com для Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-246">Dialin.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-247">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-247">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-248">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-248">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-249">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-249">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-250">Lyncdiscoverint-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-250">Lyncdiscoverint-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-251">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-251">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-252">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-252">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-253">Псевдоним Lyncdiscoverinternal.contoso.com для Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-253">Lyncdiscoverinternal.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-254">Псевдоним Lyncdiscoverinternal.contoso.com для Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-254">Lyncdiscoverinternal.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-255">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-255">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-256">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-256">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-257">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-257">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-258">Lyncdiscover-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-258">Lyncdiscover-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-259">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-259">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-260">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-260">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-261">Псевдоним Lyncdiscover.contoso.com для Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-261">Lyncdiscover.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-262">Псевдоним Lyncdiscover.contoso.com для Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-262">Lyncdiscover.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-263">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-263">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-264">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-264">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-265">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-265">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-266">Scheduler-int.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-266">Scheduler-int.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-267">Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-267">Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-268">Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-268">Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-269">Псевдоним Scheduler.contoso.com для Pool1InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-269">Scheduler.contoso.com alias to Pool1InternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-270">Псевдоним Scheduler.contoso.com для Pool2InternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-270">Scheduler.contoso.com alias to Pool2InternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-271">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-271">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-272">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-272">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-273">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-273">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
|<span data-ttu-id="a7e6e-274">Scheduler-ext.geolb.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-274">Scheduler-ext.geolb.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-275">Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-275">Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-276">Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-276">Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-277">Псевдоним Scheduler.contoso.com для Pool1ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-277">Scheduler.contoso.com alias to Pool1ExternalWebFQDN.contoso.com</span></span>  <br/> <span data-ttu-id="a7e6e-278">Псевдоним Scheduler.contoso.com для Pool2ExternalWebFQDN.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-278">Scheduler.contoso.com alias to Pool2ExternalWebFQDN.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-279">Циклический перебор между пулами</span><span class="sxs-lookup"><span data-stu-id="a7e6e-279">Round Robin between pools</span></span>  <br/> <span data-ttu-id="a7e6e-280">**OR**</span><span class="sxs-lookup"><span data-stu-id="a7e6e-280">**OR**</span></span> <br/> <span data-ttu-id="a7e6e-281">Использование основного, подключение к дополнительному при сбое</span><span class="sxs-lookup"><span data-stu-id="a7e6e-281">Use primary, connect to secondary if there's a failure</span></span>  <br/> |
   
## <a name="dns-load-balancing"></a><span data-ttu-id="a7e6e-282">балансировка нагрузки DNS;</span><span class="sxs-lookup"><span data-stu-id="a7e6e-282">DNS load balancing</span></span>
<span data-ttu-id="a7e6e-283"><a name="DNSLB"> </a></span><span class="sxs-lookup"><span data-stu-id="a7e6e-283"><a name="DNSLB"> </a></span></span>

<span data-ttu-id="a7e6e-284">Балансировка нагрузки на DNS обычно реализуется на уровне приложения.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-284">DNS load balancing is usually implemented at the application level.</span></span> <span data-ttu-id="a7e6e-285">Приложение (например, клиент Skype для бизнеса) пытается подключиться к серверу в пуле, подключаясь к одному из IP-адресов, возвращенных запросом записи DNS A и AAAA (если используется IPv6-адрес) для FQDN пула.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-285">The application (for example, a client running Skype for Business), tries to connect to a server in a pool by connecting to one of the IP addresses returned from the DNS A and AAAA (if IPv6 addressing is used) record query for the pool FQDN.</span></span>
  
<span data-ttu-id="a7e6e-286">Например, если в пуле с именем pool01.contoso.com три сервера переднего pool01.contoso.com, произойдет следующее:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-286">For example, if there are three Front End Servers in a pool named pool01.contoso.com, the following would happen:</span></span>
  
- <span data-ttu-id="a7e6e-287">Клиенты, работающие под управлением Skype для бизнеса, запрашивают DNS для pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-287">Clients running Skype for Business query DNS for pool01.contoso.com.</span></span> <span data-ttu-id="a7e6e-288">Запрос возвращает три IP-адреса и кэширует их следующим образом (в определенном порядке):</span><span class="sxs-lookup"><span data-stu-id="a7e6e-288">The query returns three IP addresses and caches them as follows (in some order):</span></span>
    
   |||
   |:-----|:-----|
   |<span data-ttu-id="a7e6e-289">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-289">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-290">192.168.10.90</span><span class="sxs-lookup"><span data-stu-id="a7e6e-290">192.168.10.90</span></span>  <br/> |
   |<span data-ttu-id="a7e6e-291">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-291">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-292">192.168.10.91</span><span class="sxs-lookup"><span data-stu-id="a7e6e-292">192.168.10.91</span></span>  <br/> |
   |<span data-ttu-id="a7e6e-293">pool01.contoso.com</span><span class="sxs-lookup"><span data-stu-id="a7e6e-293">pool01.contoso.com</span></span>  <br/> |<span data-ttu-id="a7e6e-294">192.168.10.92</span><span class="sxs-lookup"><span data-stu-id="a7e6e-294">192.168.10.92</span></span>  <br/> |
   
- <span data-ttu-id="a7e6e-295">Клиент пытается установить подключение TCP к одному из IP-адресов.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-295">The client tries to establish a TCP connection to one of the IP addresses.</span></span> <span data-ttu-id="a7e6e-296">В случае сбойного решения он будет пытаться найти следующий IP-адрес, который кэшется из этого списка.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-296">If that fails, it'll try the next IP address it's cached from that list.</span></span>
    
- <span data-ttu-id="a7e6e-297">Если подключение TCP успешно установлено, клиент согласует TLS для подключения к основному регистратору на pool01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-297">If the TCP connection succeeds, the client negotiates TLS to connect to the primary registrar on pool01.contoso.com.</span></span>
    
- <span data-ttu-id="a7e6e-298">Если клиент пытается использовать все кэшные записи без успешного подключения, пользователь получает уведомление о том, что на данный момент серверы Skype для бизнеса Server недоступны.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-298">If the client tries all cached entries without a successful connection, the user receives a notification that no servers running Skype for Business Server are available at the moment.</span></span>
    
> [!NOTE]
> <span data-ttu-id="a7e6e-299">Балансировка нагрузки на основе DNS отличается от перезагрузки DNS (DNS RR), который обычно относится к балансировкой нагрузки, ссылаясь на DNS, чтобы указать другой порядок IP-адресов для серверов в пуле.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-299">DNS-based load balancing is different from DNS round robin (DNS RR), which typically refers to load balancing by relying on DNS to give a different order of IP addresses for the servers in your pool.</span></span> <span data-ttu-id="a7e6e-300">Как правило, DNS RR обеспечивает распределение нагрузки, но не позволяет включить отбой.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-300">Typically, DNS RR enables load distribution, but it won't allow you to enable failover.</span></span> <span data-ttu-id="a7e6e-301">Например, если подключение к одному IP-адресу, возвращенное запросом DNS A (или AAAA в сценарии IPv6), не будет, это подключение не будет работать.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-301">For example, if the connection to the one IP address returned by your DNS A (or AAAA in an IPv6 scenario) query fails, that connection will fail.</span></span> <span data-ttu-id="a7e6e-302">Это делает DNS-RR менее надежным, чем балансировка нагрузки на основе DNS.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-302">That makes DNS RR less reliable than DNS-based load balancing.</span></span> <span data-ttu-id="a7e6e-303">Вы по-прежнему можете использовать DNS RR в сочетании с балансировка нагрузки на основе DNS, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-303">You can still use DNS RR in conjunction with DNS-based load balancing if you need to do that.</span></span> 
  
<span data-ttu-id="a7e6e-304">Балансировка нагрузки на DNS используется для:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-304">You use DNS load balancing to:</span></span>
  
- <span data-ttu-id="a7e6e-305">Балансировать нагрузку SIP между серверами и на edge-серверы.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-305">Load balance server-to-server SIP to the Edge Servers.</span></span>
    
- <span data-ttu-id="a7e6e-306">Балансировать нагрузку приложений служб объединенных коммуникаций (UCAS), например службы автосекретарь, группы ответа и парковки вызовов.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-306">Load balance Unified Communication Application Services (UCAS) applications, such as Conferencing Auto Attendant, Response Group, and Call Park.</span></span>
    
- <span data-ttu-id="a7e6e-307">Предотвращение новых подключений к приложениям UCAS (также известной как "сток").</span><span class="sxs-lookup"><span data-stu-id="a7e6e-307">Prevent new connections to UCAS applications (also known as draining).</span></span>
    
- <span data-ttu-id="a7e6e-308">Балансировать нагрузку на весь трафик между клиентом и сервером между клиентами и серверами.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-308">Load balance all client-to-server traffic between clients and Edge Servers.</span></span>
    
<span data-ttu-id="a7e6e-309">Балансировку нагрузки на DNS нельзя использовать для:</span><span class="sxs-lookup"><span data-stu-id="a7e6e-309">You can't use DNS load balancing for:</span></span>
  
- <span data-ttu-id="a7e6e-310">Веб-трафик "клиент-сервер" на серверы переднего сервера или директора.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-310">Client-to-server web traffic to your Front End Servers or a Director.</span></span>
    
<span data-ttu-id="a7e6e-311">Чтобы более подробно и подробно узнать, как запись DNS SRV выбирается при возвращении записей DNS-мутипля, когда запрос возвращает записи DNS, по краям доступа всегда выбирается запись с наименьшим числом приоритета и, если требуется разбика на связь, самый высокий числовой вес.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-311">To go a little more in-depth on how a DNS SRV record's selected when mutiple DNS records are returned by a query, the Access Edge service always picks the record with the lowest numeric priority and, if a tie-breaker is needed, the highest numeric weight.</span></span> <span data-ttu-id="a7e6e-312">Это согласуется с [документацией по internet Engineering Task Force.](https://www.ietf.org/rfc/rfc2782.txt)</span><span class="sxs-lookup"><span data-stu-id="a7e6e-312">This is consistent with [Internet Engineering Task Force documentation](https://www.ietf.org/rfc/rfc2782.txt).</span></span>
  
<span data-ttu-id="a7e6e-313">Например, если первая запись DNS SRV имеет вес 20 и приоритет 40, а вторая DNS-запись SRV имеет вес 10 и приоритет 50, первая запись будет выбрана, так как она имеет более низкий приоритет 40.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-313">So, for example, if your first DNS SRV record has a weight of 20 and a priority of 40, and your second DNS SRV record has a weight of 10 and a priority of 50, the first record's going to be chosen because it has the lower priority of 40.</span></span> <span data-ttu-id="a7e6e-314">Приоритет всегда должен быть первым, и клиент будет в первую очередь нацелить его на этот хост.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-314">Priority always goes first, and that's the host that a client will target first.</span></span> <span data-ttu-id="a7e6e-315">Что делать, если существует два целевых объектов с одинаковым приоритетом?</span><span class="sxs-lookup"><span data-stu-id="a7e6e-315">What if there are two targets with the same priority?</span></span> 
  
<span data-ttu-id="a7e6e-316">В этом случае учитывается вес.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-316">In that case, weight comes into consideration.</span></span> <span data-ttu-id="a7e6e-317">При выборе более высоких весов следует иметь высокую вероятность выбора.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-317">Larger weights should be given a high probability, in this circumstance, of being selected.</span></span> <span data-ttu-id="a7e6e-318">Администраторам DNS следует использовать вес 0, если выбор сервера не существует.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-318">DNS administrators should use weight 0 when there isn't any server selection to do.</span></span> <span data-ttu-id="a7e6e-319">При наличии записей, содержащих вес больше 0, вероятность выбора записей с весом 0 очень мала.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-319">In the presence of records containing weights greater than 0, records with weight 0 have a very small chance of bring selected.</span></span>
  
<span data-ttu-id="a7e6e-320">Что произойдет, если возвращается несколько записей DNS SRV с одинаковым приоритетом и весом?</span><span class="sxs-lookup"><span data-stu-id="a7e6e-320">So, then, what happens if multiple DNS SRV records with equal priority and weight as returned?</span></span> <span data-ttu-id="a7e6e-321">В этой ситуации по краям доступа сначала выбирается запись SRV, которую она получила с DNS-сервера.</span><span class="sxs-lookup"><span data-stu-id="a7e6e-321">In this situation the Access Edge service will choose the SRV record that it got from the DNS server first.</span></span>
  

