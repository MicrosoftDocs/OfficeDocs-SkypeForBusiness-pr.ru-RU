---
title: Планирование выключения устаревших методов проверки подлинности для внутренней и внешней сети
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.custom: tracyp
ms.assetid: ''
description: В этой статье описываются командлеты, которые предоставляют администраторам больший контроль над методами проверки подлинности, которые используются внутри и снаружи предприятия. Администраторы могут включать и отключать методы проверки подлинности во внутренней или внешней сети.
ms.openlocfilehash: a3f26e0bb29a58b53547083a4410da849c054b03
ms.sourcegitcommit: 88a16c09dd91229e1a8c156445eb3c360c942978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2020
ms.locfileid: "42043721"
---
# <a name="planning-to-turn-off-legacy-authentication-methods-internally-and-externally-to-your-network"></a>Планирование отключения устаревших методов проверки подлинности от внутренней системы к сети.

> [!NOTE]
> Если вы собираетесь ознакомиться с этой статьей, вы уже знаете о поддерживаемых современных топологий проверки подлинности, ADAL и о современной проверке подлинности, но на тот случай, если у вас нет этих статей, вам нужно выполнить следующие действия: 
>  + [https://docs.microsoft.com/skypeforbusiness/plan-your-deployment/modern-authentication/topologies-supported](https://docs.microsoft.com/skypeforbusiness/plan-your-deployment/modern-authentication/topologies-supported)
>  + [https://docs.microsoft.com/skypeforbusiness/manage/authentication/use-adal](https://docs.microsoft.com/skypeforbusiness/manage/authentication/use-adal)
  
Современная проверка подлинности не только обеспечивает более безопасные методы проверки подлинности, например двухфакторную проверку подлинности или проверку подлинности на основе сертификатов, она может выполнять авторизацию пользователя, не требуя имени пользователя или пароля. Это очень удобно.

Эта статья поможет вам получить доступ к отверстиям, которые использовались для атак типа "отказ в обслуживании" (DOS) на серверах Skype для бизнеса, отключив более старые методы, используемые для проверки подлинности, во внутренней сети или в обоих случаях. Например, одним из хороших способов защиты от атак DOS является отключение встроенной проверки подлинности Windows (в том числе NTLM и Kerberos). Отключение проверки подлинности NTLM и полагаться на проверку подлинности на основе сертификатов помогает защитить пароли от уязвимости. Это вызвано тем, что NTLM использует учетные данные пароля для проверки подлинности пользователей, но проверка подлинности на основе сертификатов с помощью современной проверки подлинности не поддерживается. Это означает, что оптимальным вариантом снижения атак DOS является блокировка NTLM извне, а вместо этого используется только проверка подлинности на основе сертификатов.

Все правильно, давайте приступим.

## <a name="what-would-you-be-changing"></a>Что вы хотите изменить? 

Эти командлеты работают для точек доступа SIP и веб-служб. Несмотря на то, что эти два канала используют различные методы доступа, запуская цветовой охват из NTLM и Kerberos для анонимного доступа, учитываются все стандартные методы, используемые Skype для бизнеса.

## <a name="how-to-get-the-get--and-set-csauthconfig-cmdlets"></a>Получение командлетов Get и Set – Ксаусконфиг

Эти командлеты устанавливаются только после установки накопительного пакета обновления 2018 для Microsoft Skype для бизнеса Server 2015 (6.0.9319.534), а затем существует множество топологий, которые можно развернуть для Skype для бизнеса Server.

## <a name="topologies"></a>Топологии

Важно помнить, что это поддерживаемые топологии, используемые в этом сценарии! Если вам нужно перейти в службу поддержки для блокирования метода, например, вам потребуется настроить их среди перечисленных ниже типов. 

> [!IMPORTANT]
> В приведенной ниже таблице и описаниях *современная проверка подлинности* сокращена __, а__ *Встроенная проверка подлинности Windows* сокращена, как __Win__. Как напоминание, встроенная проверка подлинности Windows состоит из двух способов: NTLM и проверка подлинности Kerberos. Вам необходимо знать, как правильно прочитать таблицу!


|       |Извне  |Внутри  |Параметр  |
|---------|:---------|:---------|---------|
|__Тип 1__   |  MA + Win       | MA + Win         |  алловаллекстерналляндинтерналли       |
|__Тип 2__   |  ПОГЛОЩЕН       | MA + Win         | блокквиндовсаусекстерналли        |
|__Тип 3__   |  ПОГЛОЩЕН       | ПОГЛОЩЕН        | блокквиндовсаусекстерналляндинтерналли        |
|__Тип 4__   |  ПОГЛОЩЕН       | Победу        | блокквиндовсаусекстерналляндмодернаусинтерналли    |
|__Тип 5__   |  MA + Win       | Победу        | блоккмодернаусинтерналли         |

__Тип 1 Description:__ Этот сценарий используется по умолчанию при включении MA для __Skype для бизнеса__ Server. Другими словами, это *отправная точка* при настройке MA.

__Введите 2 Описание:__ Эта топология блокирует *ВНЕШНЮЮ*NTLM, но позволяет использовать NTLM или Kerberos (для клиентов, не поддерживающих ADAL) для *внутреннего*использования. Если ваши клиенты поддерживают ADAL, они будут использовать мА для внутреннего использования.

__Тип 3 Description:__ Для этой топологии требуется мА для всех пользователей. Все ваши клиенты с поддержкой ADAL будут работать в этой топологии, а пароли не будут использоваться, если, например, вы отключаете использование паролей с проверкой подлинности на основе сертификатов.

__Введите 4 Описание:__ Эта топология блокирует *внутреннюю и Ма* NTLM. Он позволяет *всем клиентам* использовать устаревшие методы проверки подлинности *внутренним образом* (даже для клиентов с поддержкой ADAL).

__Тип 5 Description:__ *Внешние*ваши современные клиенты ADAL будут использовать MA и все клиенты, не поддерживающие ADAL, будут использовать устаревшие методы проверки подлинности. Но ** *все клиенты* будут использовать устаревшую проверку подлинности (включая всех клиентов с поддержкой ADAL).

В доступных параметрах очень легко потерять возможность защиты паролей. Помните, что идеальная ситуация заключается в использовании MA извне (например, путем настройки проверки подлинности на основе сертификатов), чтобы избежать атак DOS. Если вы используете его для своих современных клиентов, вы также сможете проверить сеть на наличие атак Skype для бизнеса Server в будущем.

## <a name="why-to-use-set-csauthconfig-at-the-global-level"></a>Зачем использовать Set – Ксаусконфиг на глобальном уровне

Настройка `Set-CsAuthConfig` эффектов командлетов для ролей регистратора и веб-служб.

Этот командлет предназначен для запуска на глобальном уровне Skype для бизнеса Server. Его *можно* запустить на уровне пула, но это *не рекомендуется* , так как он повышает сложность установки. Выполнив эти команды на уровне пула, если в пуле нет всех включенных ролей (например, у него нет веб-служб), параметры будут установлены только для роли регистратора. В этом случае веб-службы будут переноситься с параметрами глобального уровня, что может привести к путанице (в частности, если это делается непреднамеренно).

Если клиент использует параметры регистратора из одного пула и параметры веб-служб из другого пула, а параметры проверки подлинности находятся в несогласованном состоянии, клиенты йоус не смогут войти в систему.

Кроме того, если для пула присутствует только одна роль: 
* Set — задает только те параметры, которые соответствуют существующей роли. Специальное предупреждение не будет задано, так как некоторые параметры *не* были заданы. 
* Get — возвращает параметр, соответствующий существующей роли, и глобальные параметры для несуществующей роли.
* Если для пула отсутствует ни одна роль, для Set-и Get-будет возвращено сообщение об ошибке.
* Если для пула имеются обе роли, но политики не определены на уровне пула, Get — возвращает сообщение об ошибке.

Это может быть рекомендуем для получения этих значений, а также для снимка экрана или записи начального состояния перед внесением изменений. Вы также можете сохранить журнал изменений в OneNote.

> [!NOTE]
> 
> Note: после настройки Ксаусконфиг необходимо запустить Enable – CsComputer на каждом компьютере, чтобы параметры вступили в силу.

> [!IMPORTANT]
> Если вы используете Lync Web Access (лва) и должны использовать доступ на основе форм (FBA) для внешнего доступа, перенастройте лва таким образом, чтобы клиенты могли получать к ней доступ анонимный доступ для поддержки этих сценариев. Аналогично, если вы используете ПИН-код для телефонного подключения, FBA будет заблокирован только для внешних пользователей. Если вам нужно изменить ПИН-код, им потребуется войти в свою организацию, чтобы сделать это, внутренне.

> [!NOTE]
> 
> Если вы используете параметр Блокквиндовсаусекстерналли для поблочного блокирования NTLM, обратите внимание на то, что он также блокирует внутреннюю NTLM для канала SIP. Тем не менее, пользователи Skype для бизнеса и Lync больше 2010 смогут выполнять вход, так как они будут использовать протокол NTLM через HTTP для входа, внутренне, а затем получать сертификат для входа по протоколу SIP. Тем не менее, в этом случае клиенты старше 2010 не смогут войти в систему, и вы можете обновить эти приложения, чтобы пользователи могли возобновить безопасные функции.


## <a name="links"></a>Ссылки 
- Дополнительные сведения о PowerShell:
    -  [Get — Ксаусконфиг](https://docs.microsoft.com/powershell/module/skype/get-csauthconfig?view=skype-ps)
    -  [Set — Ксаусконфиг](https://docs.microsoft.com/powershell/module/skype/set-csauthconfig?view=skype-ps)

- Дополнительные сведения о том, как использовать команды или CU, необходимые для их установки:
    - [Краткое описание командлетов](https://support.microsoft.com/help/4346673/new-cmdlets-to-manage-skype-for-business-server-2015-authentication)
    - [Обновления для Skype для бизнеса Server 2015](https://support.microsoft.com/help/3061064/updates-for-skype-for-business-server-2015) (Общие сведения)
    - [2018 на Skype для бизнеса Server 2015 за июль, основные компоненты Cu](https://support.microsoft.com/help/4340903/july-2018-cumulative-update-6-0-9319-534-for-skype-for-business-server) (6.0.9319.534)


 
