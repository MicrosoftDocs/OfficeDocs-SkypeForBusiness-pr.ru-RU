---
title: Высокая доступность и Управление пулом переднего плана
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: Сведения об управлении интерфейсным пулом в Skype для бизнеса Server, в том числе об управлении пулами, потере кворума и специальных действиях для пулов с двумя серверами переднего плана.
ms.openlocfilehash: 2982e2da0e7a103b5b598019baa7403a73da826d
ms.sourcegitcommit: 397c4840fb053238de24b8b24ae75588b33b693d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "45098437"
---
# <a name="front-end-pool-high-availability-and-management"></a>Высокая доступность и Управление пулом переднего плана
 
Сведения об управлении интерфейсным пулом в Skype для бизнеса Server, в том числе об управлении пулами, потере кворума и специальных действиях для пулов с двумя серверами переднего плана.
  
В Skype для бизнеса Server архитектура интерфейсных пулов использует модель распределенных систем, в которой данные каждого пользователя хранятся в виде трех серверов переднего плана в пуле. Для всех интерфейсных пулов Enterprise Edition рекомендуется включить по крайней мере три сервера переднего плана.

> [!NOTE]
> Skype для бизнеса Server 2019 не поддерживает пулы переднего плана Enterprise Edition с двумя серверами переднего плана и не разрешают публикацию топологии в этом сценарии.
  
## <a name="planning-for-the-management-of-front-end-pools"></a>Планирование управления интерфейсными пулами

 В Skype для бизнеса Server используется модель распределенных систем, основанная на Windows Fabric. В этой модели важные данные для каждого пользователя и конференции хранятся на трех серверах переднего плана в интерфейсном пуле. Эти три сервера сохраняют определенный набор данных калледрепликас.
  
При использовании распределенной модели для пулов переднего плана необходимо, чтобы пул работал с определенным количеством серверов пула. Существует два режима потерь для пула.
  
- Потеря кворума на уровне группы маршрутизации, вызванная недостаточной репликой серверов для определенной группы маршрутизации. Группа маршрутизации — это набор пользователей, размещенных в пуле. Каждая группа маршрутизации содержит три реплики в пуле: одну первичную реплику и две вторичные реплики.
    
- Потеря кворума на уровне пула, вызванная тем, что в пуле не работает достаточное количество серверов инициализации. 
    
### <a name="routing-group-level-quorum-loss"></a>Потеря кворума на уровне группы маршрутизации

При первом запуске нового пула переднего плана необходимо, чтобы 85% серверов были запущены и запущены, как показано в следующей таблице. Если запущено меньшее количество серверов, службы могут оставаться в состоянии запуска, а пул может не запуститься.
  
|Общее количество серверов в пуле  <br/> |Количество серверов, которые должны быть запущены в первый раз при первом запуске пула  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3   <br/> |3   <br/> |
|4   <br/> |3   <br/> |
|5   <br/> |4   <br/> |
|6   <br/> |5   <br/> |
|7   <br/> |5   <br/> |
|8   <br/> |6   <br/> |
|9   <br/> |7   <br/> |
|10   <br/> |8   <br/> |
|11   <br/> |9   <br/> |
|12   <br/> |10   <br/> |
|16 **для Skype для бизнеса Server 2019** <br/> |12   <br/> |


   
При каждом последующем запуске пула будет запущено 85% серверов (как показано в предыдущей таблице). Если это количество серверов не может быть запущено (но можно запустить достаточное количество серверов, чтобы их можно было получить из-за потери кворума на уровне пула), можно использовать `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` командлет, чтобы разрешить для пула восстановление после потери кворума на уровне группы маршрутизации и выполнения. Дополнительные сведения о том, как использовать этот командлет, можно найти в статье [Reset/кспулрегистрарстате](https://docs.microsoft.com/powershell/module/skype/reset-cspoolregistrarstate?view=skype-ps). 
  
> [!NOTE]
> В пулах с четным количеством серверов Skype для бизнеса Server использует основную базу данных SQL в качестве следящего сервера. В таком пуле, если вы выключите базу данных Primary и переключиться на зеркальную копию и выключите достаточный объем серверов переднего плана, чтобы они не выполнялись в соответствии с приведенной выше таблицей, весь пул перейдет. Дополнительные сведения можно найти в разделе [следящий сервер зеркального отображения баз данных](https://go.microsoft.com/fwlink/?LinkId=393672). 
  
#### <a name="pool-level-quorum-loss"></a>Потеря кворума на уровне пула

Для того, чтобы интерфейсный пул функционировал вообще, он не может находиться в потерях кворума на уровне пула. Если количество серверов, которые работают ниже режима работы, как показано в следующей таблице, оставшиеся серверы в пуле прекратят выполнение всех служб Skype для бизнеса Server. Обратите внимание, что в приведенных ниже таблицах предполагается, что серверы переднего планов в пуле работают.
  
|Общее число серверов переднего плана в пуле  <br/> |Число работающих серверов, требуемое для правильного функционирования пула  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3-4  <br/> |Любой 2  <br/> |
|5-6  <br/> |Любое 3  <br/> |
|7   <br/> |Любой 4  <br/> |
|8-9  <br/> |4 первых 7 серверов  <br/> |
|10-12  <br/> |5 первых девяти серверов  <br/> |
|12-16 **для Skype для бизнеса Server 2019**  <br/> |7 первых 12 серверов  <br/> |
   
В приведенной выше таблице первыми серверами являются серверы, которые были первыми, в хронологическом порядке, когда пул был запущен в первый раз. Для определения этих серверов можно использовать `Get-CsComputer` командлет с `-PoolFqdn` параметром. Этот командлет покажет серверы в том порядке, в котором они отображаются в топологии, а в верхней части списка находятся первые серверы.
  
> [!IMPORTANT]
> Максимальное число серверов переднего плана увеличено до 16 в [Skype для бизнеса Server 2019](https://docs.microsoft.com/skypeforbusiness/plan/user-model-2019)
> 
#### <a name="additional-steps-to-ensure-pools-are-functional"></a>Дополнительные действия для обеспечения работоспособности пулов

Необходимо проследить за несколько других факторов, чтобы обеспечить работоспособность пулов переднего плана.
  
- При первом перемещении пользователей в пул обязательно убедитесь, что запущено не менее трех серверов переднего плана.
    
- Если вы устанавливаете отношение связывания между этим пулом и другим пулом для целей аварийного восстановления, то после установки этого отношения необходимо убедиться, что этот пул одновременно использует три сервера переднего плана, выполняющие синхронизацию данных с резервным пулом. Дополнительные сведения о функциях связывания и аварийного восстановления пула приведены [в статье Планирование обеспечения высокой доступности и аварийного восстановления в Skype для бизнеса Server](high-availability-and-disaster-recovery.md). 
    
## <a name="front-end-pool-with-two-front-end-servers"></a>Интерфейсный пул с двумя серверами переднего плана

Мы не рекомендуем развертывать интерфейсный пул, содержащий всего два сервера переднего плана. Этот небольшой пул не обеспечит надежного решения высокого уровня доступности, такого как большой пул, и требует дополнительной осторожности в управлении. Кроме того, если внутренний сервер пула из двух серверов получится, весь сам пул, скорее всего, будет скоро перейдет. Если вы хотите развернуть один или два сервера, на которых работает Skype для бизнеса Server, рекомендуем развернуть их в качестве серверов Standard Edition.
  
Если вам когда-то потребуется развернуть пул с двумя серверами переднего плана, следуйте указанным ниже рекомендациям.
  
- В случае сбоя одного из двух этих серверов переднего плана вам следует как можно быстрее восстановить его работоспособность. Аналогичным образом, в случае обновления одного из двух серверов его также необходимо вернуть в рабочее состояние как можно быстрее.
    
- Если по какой-либо причине требуется отключить оба сервера одновременно, после окончания простоя пула выполните следующие действия:
    
  - Рекомендуется перезапустить оба сервера переднего плана одновременно. 
    
  - Если это невозможно, следует включать их в порядке, обратном порядку их отключения.
    
  - Если не удается выполнить резервное копирование в указанном порядке, используйте следующий командлет, прежде чем приступить к резервному копированию пула:`Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`
    
## <a name="front-end-pool-configuration-failures-and-changes"></a>Ошибки и изменения конфигурации пула переднего плана

В случае сбоя сервера переднего плана и маловероятного замены в течение нескольких дней, удалите сервер из топологии. Добавьте новый сервер переднего плана в топологию, когда он станет доступен.
  
При изменении конфигурации интерфейсного пула (например, при добавлении или удалении серверов) необходимо придерживаться следующих правил:
  
- После публикации новой топологии необходимо перезапустить все серверы переднего плана в пуле. Перезапускайте их по одному.
    
- Если во время изменения конфигурации был отключен весь пул, после публикации новой топологии запустите следующий командлет:`Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`
    

