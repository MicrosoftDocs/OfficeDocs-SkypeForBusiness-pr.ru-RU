---
title: Высокая доступность и управление пулом переднего уровня
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: Learn about Front End pool management in Skype for Business Server, including managing pools, quorum loss, and special steps for pools with only two Front End Servers.
ms.openlocfilehash: 3f1924b7a8ad26b880f8674ada4f0c99a1bc4596
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49802799"
---
# <a name="front-end-pool-high-availability-and-management"></a>Высокая доступность и управление пулом переднего уровня
 
Learn about Front End pool management in Skype for Business Server, including managing pools, quorum loss, and special steps for pools with only two Front End Servers.
  
В Skype для бизнеса Server архитектура интерфейсных пулов использует модель распределенных систем, при этом данные каждого пользователя хранятся на до трех серверах переднего интерфейса в пуле. Рекомендуется, чтобы все пулы переднего сервера Enterprise Edition включали по крайней мере три сервера переднего сервера.

> [!NOTE]
> Skype для бизнеса Server 2019 не поддерживает пулы переднего сервера Enterprise Edition с двумя серверами переднего сервера и не позволит публиковать топологию в этом сценарии.
  
## <a name="planning-for-the-management-of-front-end-pools"></a>Планирование управления пулами переднего плана

 Skype для бизнеса Server использует модель распределенных систем на основе Windows Fabric. В этой модели важные данные для каждого пользователя и конференции хранятся на трех серверах переднего интерфейса в интерфейсном пуле. Эти три сервера, на которые хранятся определенные данные, называютсяreplicas.
  
При распределенной модели для пулов переднего сервера для функционирования пула должно быть запущено определенное количество серверов пула. Существует два режима потерь для пула.
  
- Потеря кворума на уровне группы маршрутов, вызванная недостаточной репликой серверов для определенной группы маршрутов. Группа маршрутов — это набор пользователей, которые были в пуле. Каждая группа маршрутов имеет три реплики в пуле: одну первичную и две вторичные реплики.
    
- Потеря кворума на уровне пула, вызванная недостаточной количеством серверов для запуска в пуле. 
    
### <a name="routing-group-level-quorum-loss"></a>Потеря кворума на уровне группы маршрутов

При первом запуске нового пула переднего сервера важно, чтобы 85% серверов были запущены и запущены, как показано в следующей таблице. Если запущено меньше серверов, службы могут зависнуть в начальном состоянии, а пул может не запуститься.
  
|Общее количество серверов в пуле  <br/> |Количество серверов, которые должны быть запущены для первого запуска пула  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3   <br/> |3   <br/> |
|4   <br/> |3   <br/> |
|5   <br/> |4   <br/> |
|6   <br/> |5   <br/> |
|7   <br/> |5   <br/> |
|8   <br/> |6   <br/> |
|9   <br/> |7   <br/> |
|10   <br/> |8   <br/> |
|11   <br/> |9   <br/> |
|12   <br/> |10   <br/> |
|16 **Для Skype для бизнеса Server 2019** <br/> |12   <br/> |


   
При каждом последующем запущении пула должно быть запущено 85 % серверов (как показано в предыдущей таблице). Если это количество серверов не может быть запущено (но достаточно серверов может быть запущено таким образом, чтобы вы не утерили кворум на уровне пула), вы можете использовать этот cmdlet, чтобы позволить пулу восстановиться после потери кворума на уровне группы маршрутинга и добиться  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` прогресса. Дополнительные сведения об использовании этого cmdlet см. в [reset-CsPoolRegistrarState.](https://docs.microsoft.com/powershell/module/skype/reset-cspoolregistrarstate?view=skype-ps) 
  
> [!NOTE]
> В пулах с ряду серверов Skype для бизнеса Server использует основную SQL в качестве свидетеля. В подобном пуле при завершении работы основной базы данных и переключении на зеркальную копию и отключении достаточного количества серверов переднего сервера для работы в соответствии с предыдущей таблицей весь пул будет отключен. Дополнительные сведения см. в [свидетеле зеркального зеркального отражания базы данных.](https://go.microsoft.com/fwlink/?LinkId=393672) 
  
#### <a name="pool-level-quorum-loss"></a>Потеря кворума на уровне пула

Чтобы пул переднего уровня функционировал вообще, он не может быть в потере кворума на уровне пула. Если число работающих серверов меньше функционального уровня, как показано в следующей таблице, оставшиеся серверы в пуле остановят все службы Skype для бизнеса Server. Обратите внимание, что номера в следующей таблице предполагают, что серверы в пуле запущены.
  
|Общее число серверов переднего плана в пуле  <br/> |Число работающих серверов, требуемое для правильного функционирования пула  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3-4  <br/> |Любое 2  <br/> |
|5-6  <br/> |Любые 3  <br/> |
|7   <br/> |Любое 4  <br/> |
|8-9  <br/> |Все 4 из первых 7 серверов  <br/> |
|10-12  <br/> |Все 5 из первых 9 серверов  <br/> |
|12-16  **Для Skype для бизнеса Server 2019**  <br/> |Все 7 из первых 12 серверов  <br/> |
   
В предыдущей таблице "первые серверы" — это серверы, которые были первыми в хронологическом порядке, когда пул был запущен в первый раз. Чтобы определить эти серверы, можно использовать этот параметр с  `Get-CsComputer` помощью этого `-PoolFqdn` параметра. Этот cmdlet будет отображать серверы в том порядке, в который они отображаются в топологии, а серверы в верхней части списка являются первыми серверами.
  
> [!IMPORTANT]
> Максимальное число серверов переднего сервера в Skype для бизнеса [Server 2019](https://docs.microsoft.com/skypeforbusiness/plan/user-model-2019) увеличено до 16
> 
#### <a name="additional-steps-to-ensure-pools-are-functional"></a>Дополнительные действия для обеспечения функциональности пулов

Следует следить за несколькими другими факторами, чтобы убедиться, что пулы переднего ряда остаются функциональными.
  
- При первом перемещении пользователей в пул обязательно убедитесь, что запущено не менее трех серверов переднего плана.
    
- Если вы устанавливаете отношение сопряжения между этим пулом и другим пулом в целях аварийного восстановления, то после установления этой связи необходимо убедиться, что в этом пуле одновременно работают три сервера переднего сервера для правильной синхронизации данных с резервным пулом. Дополнительные сведения о сопряжении пулов и аварийном восстановлении см. в плане высокой доступности и аварийного [восстановления в Skype для бизнеса Server.](high-availability-and-disaster-recovery.md) 
    
## <a name="front-end-pool-with-two-front-end-servers"></a>Пул переднего сервера с двумя серверами переднего сервера

Мы не рекомендуем развертывать интерфейсный пул, содержащий всего два сервера переднего плана. Этот небольшой пул не будет предоставлять надежное решение с высоким уровнем доступности, как при большом пуле, и требует дополнительной помощи в управлении. Кроме того, если бы тыловой сервер пула из двух серверов был сбит, скорее всего, весь пул тоже скоро тоже по ухумел. Если вы хотите развернуть только один или два сервера со Skype для бизнеса Server, рекомендуется развернуть их как серверы Standard Edition.
  
Если вам когда-либо потребуется развернуть пул с двумя серверами переднего сервера, следуйте следующим рекомендациям:
  
- В случае сбоя одного из двух этих серверов переднего плана вам следует как можно быстрее восстановить его работоспособность. Аналогичным образом, в случае обновления одного из двух серверов его также необходимо вернуть в рабочее состояние как можно быстрее.
    
- Если по какой-либо причине требуется отключить оба сервера одновременно, после окончания простоя пула выполните следующие действия:
    
  - Лучше всего перезапустить оба сервера переднего сервера одновременно. 
    
  - Если это невозможно, следует включать их в порядке, обратном порядку их отключения.
    
  - Если вы не можете вернуть их в этом порядке, используйте следующий cmdlet перед тем, как сделать резервную порядок для пула:  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`
    
## <a name="front-end-pool-configuration-failures-and-changes"></a>Сбои и изменения конфигурации пула переднего конца

Если сервер переднего сервера не удается заменить в течение нескольких дней или более, удалите сервер из топологии. Добавьте новый сервер переднего сервера в топологию, когда он снова будет доступен.
  
При изменении конфигурации пула переднего сервера, например при добавлении или удалении серверов, необходимо следовать следующим рекомендациям:
  
- После публикации новой топологии необходимо перезапустить каждый сервер переднего сервера в пуле. Перезапускайте их по одному.
    
- Если во время изменения конфигурации не работает весь пул, после публикации новой топологии запустите следующий cmdlet:  `Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`
    

