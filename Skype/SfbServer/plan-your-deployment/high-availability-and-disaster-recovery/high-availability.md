---
title: Высокая доступность и управление пулом переднего плана
ms.reviewer: ''
ms.author: heidip
author: microsoftheidi
manager: serdars
ms.audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: Сведения об управлении пула переднего плана в Скайп для Business Server, включая управление пулов, потери кворума и специальные действия для пулов из только два сервера переднего плана.
ms.openlocfilehash: 43c8e3fffb010bf268f94970b5cca25ecee7cd58
ms.sourcegitcommit: da8c037bb30abf5d5cf3b60d4b71e3a10e553402
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2019
ms.locfileid: "30894197"
---
# <a name="front-end-pool-high-availability-and-management"></a><span data-ttu-id="ffa58-103">Высокая доступность и управление пулом переднего плана</span><span class="sxs-lookup"><span data-stu-id="ffa58-103">Front End Pool high availability and management</span></span>
 
<span data-ttu-id="ffa58-104">Сведения об управлении пула переднего плана в Скайп для Business Server, включая управление пулов, потери кворума и специальные действия для пулов из только два сервера переднего плана.</span><span class="sxs-lookup"><span data-stu-id="ffa58-104">Learn about Front End pool management in Skype for Business Server, including managing pools, quorum loss, and special steps for pools with only two Front End Servers.</span></span>
  
<span data-ttu-id="ffa58-105">В Скайп для Business Server архитектура пулов переднего плана используется модель распределенных систем с данными каждого пользователя, хранимых на до трех серверов переднего плана в пуле.</span><span class="sxs-lookup"><span data-stu-id="ffa58-105">In Skype for Business Server, the architecture of Front End pools uses a distributed systems model, with each user's data kept on as many as three Front End servers in the pool.</span></span> <span data-ttu-id="ffa58-106">Рекомендуется включить всех пулов переднего плана Enterprise Edition по крайней мере три сервера переднего плана.</span><span class="sxs-lookup"><span data-stu-id="ffa58-106">We recommend that all your Enterprise Edition Front End pools include at least three Front End Servers.</span></span> 
  
## <a name="planning-for-the-management-of-front-end-pools"></a><span data-ttu-id="ffa58-107">Планирование управления интерфейсными пулами</span><span class="sxs-lookup"><span data-stu-id="ffa58-107">Planning for the management of Front End pools</span></span>

 <span data-ttu-id="ffa58-108">Скайп для Business Server использует модель распределенных систем, основанная на Windows Fabric.</span><span class="sxs-lookup"><span data-stu-id="ffa58-108">Skype for Business Server uses a distributed systems model based on Windows Fabric.</span></span> <span data-ttu-id="ffa58-109">В этой модели важные данные для каждого пользователя и конференции хранятся на три сервера переднего плана в пуле переднего плана.</span><span class="sxs-lookup"><span data-stu-id="ffa58-109">In this model, important data for each user and conference is stored on three Front End Servers in a Front End pool.</span></span> <span data-ttu-id="ffa58-110">Эти три сервера хранения набора данных, calledreplicas.</span><span class="sxs-lookup"><span data-stu-id="ffa58-110">These three servers storing a certain set of data are calledreplicas.</span></span>
  
<span data-ttu-id="ffa58-111">С помощью распределенной модели для пулов переднего плана определенного количества серверов пула должен работать под управлением для пула для функции.</span><span class="sxs-lookup"><span data-stu-id="ffa58-111">With the distributed model for Front End pools, a certain numbers of a pool's servers must be running for the pool to function.</span></span> <span data-ttu-id="ffa58-112">Существует два режима потери для пула.</span><span class="sxs-lookup"><span data-stu-id="ffa58-112">There are two loss modes for a pool.</span></span>
  
- <span data-ttu-id="ffa58-113">Нехватка кворума на уровне группы маршрутизации, что вызвано недостаточным количеством серверов-реплик для определенной группы маршрутизации.</span><span class="sxs-lookup"><span data-stu-id="ffa58-113">Routing Group Level quorum loss, caused by not enough replica servers for a particular routing group.</span></span> <span data-ttu-id="ffa58-114">Группа маршрутизации — это группа пользователей, размещенных в пуле.</span><span class="sxs-lookup"><span data-stu-id="ffa58-114">A routing group is a set of users homed in the pool.</span></span> <span data-ttu-id="ffa58-115">Каждая группа маршрутизации имеет три реплики в пуле: одна главная и две дополнительные.</span><span class="sxs-lookup"><span data-stu-id="ffa58-115">Each routing group has three replicas in the pool: one primary replica and two secondary replicas.</span></span>
    
- <span data-ttu-id="ffa58-116">Нехватка кворума на уровне пула, что вызвано недостаточным количеством серверов инициализации в пуле.</span><span class="sxs-lookup"><span data-stu-id="ffa58-116">Pool Level quorum loss, caused when not enough seed servers are running in the pool.</span></span> 
    
### <a name="routing-group-level-quorum-loss"></a><span data-ttu-id="ffa58-117">Нехватка кворума на уровне группы маршрутизации</span><span class="sxs-lookup"><span data-stu-id="ffa58-117">Routing Group Level quorum loss</span></span>

<span data-ttu-id="ffa58-p105">При первом запуске нового интерфейсного пула необходимо, чтобы 85% серверов были установлены и запущены, как показано в следующей таблице. Если запущено меньшее количество серверов, службы могут зависнуть в состоянии запуска, а пул может вообще не запуститься.</span><span class="sxs-lookup"><span data-stu-id="ffa58-p105">The first time you start a new Front End pool, it is essential that 85% of the servers are up and running, as shown in the following table. If fewer servers are running, the services might be stuck in the starting state and the pool might not start.</span></span>
  
|<span data-ttu-id="ffa58-120">Общее количество серверов в пуле</span><span class="sxs-lookup"><span data-stu-id="ffa58-120">Total number of servers in the pool</span></span>  <br/> |<span data-ttu-id="ffa58-121">Количество запущенных серверов, которое требуется для первого запуска пула</span><span class="sxs-lookup"><span data-stu-id="ffa58-121">Number of servers that must be running for the pool to be started the first time</span></span>  <br/> |
|:-----|:-----|
|<span data-ttu-id="ffa58-122">2</span><span class="sxs-lookup"><span data-stu-id="ffa58-122">2</span></span>  <br/> |<span data-ttu-id="ffa58-123">1</span><span class="sxs-lookup"><span data-stu-id="ffa58-123">1</span></span>  <br/> |
|<span data-ttu-id="ffa58-124">3</span><span class="sxs-lookup"><span data-stu-id="ffa58-124">3</span></span>  <br/> |<span data-ttu-id="ffa58-125">3</span><span class="sxs-lookup"><span data-stu-id="ffa58-125">3</span></span>  <br/> |
|<span data-ttu-id="ffa58-126">4</span><span class="sxs-lookup"><span data-stu-id="ffa58-126">4</span></span>  <br/> |<span data-ttu-id="ffa58-127">3</span><span class="sxs-lookup"><span data-stu-id="ffa58-127">3</span></span>  <br/> |
|<span data-ttu-id="ffa58-128">5</span><span class="sxs-lookup"><span data-stu-id="ffa58-128">5</span></span>  <br/> |<span data-ttu-id="ffa58-129">4</span><span class="sxs-lookup"><span data-stu-id="ffa58-129">4</span></span>  <br/> |
|<span data-ttu-id="ffa58-130">6</span><span class="sxs-lookup"><span data-stu-id="ffa58-130">6</span></span>  <br/> |<span data-ttu-id="ffa58-131">5</span><span class="sxs-lookup"><span data-stu-id="ffa58-131">5</span></span>  <br/> |
|<span data-ttu-id="ffa58-132">7</span><span class="sxs-lookup"><span data-stu-id="ffa58-132">7</span></span>  <br/> |<span data-ttu-id="ffa58-133">5</span><span class="sxs-lookup"><span data-stu-id="ffa58-133">5</span></span>  <br/> |
|<span data-ttu-id="ffa58-134">8</span><span class="sxs-lookup"><span data-stu-id="ffa58-134">8</span></span>  <br/> |<span data-ttu-id="ffa58-135">6</span><span class="sxs-lookup"><span data-stu-id="ffa58-135">6</span></span>  <br/> |
|<span data-ttu-id="ffa58-136">9</span><span class="sxs-lookup"><span data-stu-id="ffa58-136">9</span></span>  <br/> |<span data-ttu-id="ffa58-137">7</span><span class="sxs-lookup"><span data-stu-id="ffa58-137">7</span></span>  <br/> |
|<span data-ttu-id="ffa58-138">10</span><span class="sxs-lookup"><span data-stu-id="ffa58-138">10</span></span>  <br/> |<span data-ttu-id="ffa58-139">8</span><span class="sxs-lookup"><span data-stu-id="ffa58-139">8</span></span>  <br/> |
|<span data-ttu-id="ffa58-140">11</span><span class="sxs-lookup"><span data-stu-id="ffa58-140">11</span></span>  <br/> |<span data-ttu-id="ffa58-141">9</span><span class="sxs-lookup"><span data-stu-id="ffa58-141">9</span></span>  <br/> |
|<span data-ttu-id="ffa58-142">12</span><span class="sxs-lookup"><span data-stu-id="ffa58-142">12</span></span>  <br/> |<span data-ttu-id="ffa58-143">10</span><span class="sxs-lookup"><span data-stu-id="ffa58-143">10</span></span>  <br/> |
   
<span data-ttu-id="ffa58-144">При каждом последующем запуске пула 85% серверов должны быть запущены (как показано на таблице выше).</span><span class="sxs-lookup"><span data-stu-id="ffa58-144">Every subsequent time the pool is started, 85% of the servers should be started (as shown in the preceding table).</span></span> <span data-ttu-id="ffa58-145">Если не удается запустить этот числа серверов (но недостаточно серверов можно запустить, чтобы не является потери кворума уровне пула), можно использовать `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` используется для включения в пул для восстановления из этой маршрутизации потери уровня кворума группы и хода выполнения.</span><span class="sxs-lookup"><span data-stu-id="ffa58-145">If this number of servers cannot be started (but enough servers can be started so that you are not at pool-level quorum loss), you can use the  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` cmdlet to enable the pool to recover from this routing group level quorum loss and make progress.</span></span> <span data-ttu-id="ffa58-146">Дополнительные сведения о том, как с помощью этого командлета можно <link Reset-CsPoolRegistrarState>.</span><span class="sxs-lookup"><span data-stu-id="ffa58-146">For more information about how to use this cmdlet, see <link Reset-CsPoolRegistrarState>.</span></span>
  
> [!NOTE]
> <span data-ttu-id="ffa58-147">В пулах с одинаковым количеством серверов Skype для бизнеса Server использует основную базу данных SQL в качестве следящего сервера.</span><span class="sxs-lookup"><span data-stu-id="ffa58-147">In pools with an even number of servers, Skype for Business Server uses the Primary SQL database as Witness.</span></span> <span data-ttu-id="ffa58-148">В таком пуле, если будет закрыта основная база данных, выполнено переключение на зеркальную копию и отключено достаточно серверов переднего плана, перечисленных в таблице выше, то весь пул будет остановлен.</span><span class="sxs-lookup"><span data-stu-id="ffa58-148">In a pool like this, if you shut down the primary database and switch to the Mirror copy, and shut down enough Front End servers so that not enough are running according to the preceding table, the entire pool will go down.</span></span> <span data-ttu-id="ffa58-149">Для получения дополнительных сведений см [Следящий сервер зеркального отображения базы данных](https://go.microsoft.com/fwlink/?LinkId=393672).</span><span class="sxs-lookup"><span data-stu-id="ffa58-149">For more information, see [Database Mirroring Witness](https://go.microsoft.com/fwlink/?LinkId=393672).</span></span> 
  
#### <a name="pool-level-quorum-loss"></a><span data-ttu-id="ffa58-150">Нехватка кворума на уровне пула</span><span class="sxs-lookup"><span data-stu-id="ffa58-150">Pool-level quorum loss</span></span>

<span data-ttu-id="ffa58-151">Для пула переднего плана функционировать оно не может быть потери кворума уровне пула.</span><span class="sxs-lookup"><span data-stu-id="ffa58-151">For a Front End pool to function at all, it cannot be in pool-level quorum loss.</span></span> <span data-ttu-id="ffa58-152">Если число работающих серверов становится ниже указанного в таблице функционального уровня, оставшиеся серверы в пуле остановят все службы Skype для бизнеса Server.</span><span class="sxs-lookup"><span data-stu-id="ffa58-152">If the number of servers running falls below the functional level as shown in the following table, the remaining servers in the pool will stop all Skype for Business Server services.</span></span> <span data-ttu-id="ffa58-153">Обратите внимание, что номера в следующей таблице предполагается, что выполняется внутренними серверами в пуле.</span><span class="sxs-lookup"><span data-stu-id="ffa58-153">Note that the numbers in the following table assume that the Back End Servers in the pool are running.</span></span>
  
|<span data-ttu-id="ffa58-154">Общее число серверов переднего плана в пуле</span><span class="sxs-lookup"><span data-stu-id="ffa58-154">Total number of Front End Servers in the pool</span></span>  <br/> |<span data-ttu-id="ffa58-155">Число работающих серверов, требуемое для правильного функционирования пула</span><span class="sxs-lookup"><span data-stu-id="ffa58-155">Number of servers that must be running for pool to be functional</span></span>  <br/> |
|:-----|:-----|
|<span data-ttu-id="ffa58-156">2</span><span class="sxs-lookup"><span data-stu-id="ffa58-156">2</span></span>  <br/> |<span data-ttu-id="ffa58-157">1</span><span class="sxs-lookup"><span data-stu-id="ffa58-157">1</span></span>  <br/> |
|<span data-ttu-id="ffa58-158">3-4</span><span class="sxs-lookup"><span data-stu-id="ffa58-158">3-4</span></span>  <br/> |<span data-ttu-id="ffa58-159">Любые 2</span><span class="sxs-lookup"><span data-stu-id="ffa58-159">Any 2</span></span>  <br/> |
|<span data-ttu-id="ffa58-160">5-6</span><span class="sxs-lookup"><span data-stu-id="ffa58-160">5-6</span></span>  <br/> |<span data-ttu-id="ffa58-161">Любые 3</span><span class="sxs-lookup"><span data-stu-id="ffa58-161">Any 3</span></span>  <br/> |
|<span data-ttu-id="ffa58-162">7</span><span class="sxs-lookup"><span data-stu-id="ffa58-162">7</span></span>  <br/> |<span data-ttu-id="ffa58-163">Любые 4</span><span class="sxs-lookup"><span data-stu-id="ffa58-163">Any 4</span></span>  <br/> |
|<span data-ttu-id="ffa58-164">8-9</span><span class="sxs-lookup"><span data-stu-id="ffa58-164">8-9</span></span>  <br/> |<span data-ttu-id="ffa58-165">Любые 4 из первых 7 серверов</span><span class="sxs-lookup"><span data-stu-id="ffa58-165">Any 4 of the first 7 servers</span></span>  <br/> |
|<span data-ttu-id="ffa58-166">10–12</span><span class="sxs-lookup"><span data-stu-id="ffa58-166">10-12</span></span>  <br/> |<span data-ttu-id="ffa58-167">Любые 5 из первых 9 серверов</span><span class="sxs-lookup"><span data-stu-id="ffa58-167">Any 5 of the first 9 servers</span></span>  <br/> |
   
<span data-ttu-id="ffa58-168">В приведенной выше таблице «первого серверы», серверы, которые были загружены копирование сначала, хронологически, при запуске пула в первый раз.</span><span class="sxs-lookup"><span data-stu-id="ffa58-168">In the preceding table, the "first servers" are the servers which were brought up first, chronologically, when the pool was started for the first time.</span></span> <span data-ttu-id="ffa58-169">Чтобы определить этих серверов, можно использовать `Get-CsComputer` командлет с ` -PoolFqdn` вариант.</span><span class="sxs-lookup"><span data-stu-id="ffa58-169">To determine these servers, you can use the  `Get-CsComputer` cmdlet with the ` -PoolFqdn` option.</span></span> <span data-ttu-id="ffa58-170">Этот командлет покажут серверов, в том порядке, в котором они отображаются в топологии, а из них в верхней части списка находятся на первом серверах.</span><span class="sxs-lookup"><span data-stu-id="ffa58-170">This cmdlet will show the servers in the order that they appear in the topology, and the ones at the top of the list are the first servers.</span></span>
  
#### <a name="additional-steps-to-ensure-pools-are-functional"></a><span data-ttu-id="ffa58-171">Дополнительные способы проверки работоспособности пулов</span><span class="sxs-lookup"><span data-stu-id="ffa58-171">Additional steps to ensure pools are functional</span></span>

<span data-ttu-id="ffa58-172">Для проверки функционирования пулов переднего плана требуется обратить внимание на еще несколько факторов.</span><span class="sxs-lookup"><span data-stu-id="ffa58-172">You should watch for a couple of other factors to ensure that your Front End pools remain functional.</span></span>
  
- <span data-ttu-id="ffa58-173">При перемещении пользователей в пул в первый раз убедитесь, по крайней мере три сервера переднего плана запущены.</span><span class="sxs-lookup"><span data-stu-id="ffa58-173">When you move users to the pool for the first time, be sure at least three of the Front End Servers are running.</span></span>
    
- <span data-ttu-id="ffa58-174">Если вы устанавливаете отношение связывания между данным пулом и другим пулом в целях обеспечения аварийного восстановления, то после этого вам следует убедиться, что данный пул имеет три одновременно работающих сервера переднего плана для правильной синхронизации данных с резервным пулом.</span><span class="sxs-lookup"><span data-stu-id="ffa58-174">If you establish a pairing relationship between this pool and another pool for disaster recovery purposes, then after establishing that relationship you must be sure this pool has three Front End servers running simultaneously at some time to properly synchronize data with the backup pool.</span></span> <span data-ttu-id="ffa58-175">Дополнительные сведения о функции пула связывания и аварийного восстановления в разделе [Планирование высокой доступности и аварийного восстановления в Скайп для Business Server](high-availability-and-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ffa58-175">For more information on pool pairing and disaster recovery features, see [Plan for high availability and disaster recovery in Skype for Business Server](high-availability-and-disaster-recovery.md).</span></span> 
    
## <a name="front-end-pool-with-two-front-end-servers"></a><span data-ttu-id="ffa58-176">Интерфейсный пул с двумя серверами переднего плана</span><span class="sxs-lookup"><span data-stu-id="ffa58-176">Front End pool with two Front End servers</span></span>

<span data-ttu-id="ffa58-177">Не рекомендуется развертывание интерфейсного пула, который содержит только два сервера переднего плана.</span><span class="sxs-lookup"><span data-stu-id="ffa58-177">We do not recommend deploying a Front End pool that contains only two Front End Servers.</span></span> <span data-ttu-id="ffa58-178">This small pool will not provide a robust high-availability solution like a larger pool would, and needs extra care in managing.</span><span class="sxs-lookup"><span data-stu-id="ffa58-178">This small pool will not provide a robust high-availability solution like a larger pool would, and needs extra care in managing.</span></span> <span data-ttu-id="ffa58-179">Кроме того Если отключения фоновый сервер из пула двумя серверами весь пул будет скорее всего вскоре перейти также.</span><span class="sxs-lookup"><span data-stu-id="ffa58-179">Additionally, if the Back End Server of a two-server pool went down, the whole pool itself would likely soon go down as well.</span></span> <span data-ttu-id="ffa58-180">Если вы хотите развернуть только одного или двух серверах с Скайп для сервера, мы рекомендуем развернуть их как серверы Standard Edition.</span><span class="sxs-lookup"><span data-stu-id="ffa58-180">If you want to deploy just one or two servers running Skype for Business Server, we recommend you deploy them as Standard Edition servers.</span></span>
  
<span data-ttu-id="ffa58-181">Если когда-либо необходимо развернуть в пул с двумя серверами переднего плана, придерживайтесь следующих рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="ffa58-181">If you do ever need to deploy a pool with two Front End Servers, follow these guidelines:</span></span>
  
- <span data-ttu-id="ffa58-182">Если один из двух серверов переднего плана отключается, попробуйте свести отказавший сервер резервного копирования, как только вы можете.</span><span class="sxs-lookup"><span data-stu-id="ffa58-182">If one of the two Front End Servers goes down, you should try to bring the failed server back up as soon as you can.</span></span> <span data-ttu-id="ffa58-183">Аналогичным образом, в случае обновления одного из двух серверов его также необходимо вернуть в рабочее состояние как можно быстрее.</span><span class="sxs-lookup"><span data-stu-id="ffa58-183">Similarly, if you need to upgrade one of the two servers, bring it back online as soon as the upgrade is finished.</span></span>
    
- <span data-ttu-id="ffa58-184">Если по какой-либо причине требуется отключить оба сервера одновременно, после окончания простоя пула выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="ffa58-184">If for some reason you need to bring both servers down at the same time, do the following when the downtime for the pool is finished:</span></span>
    
  - <span data-ttu-id="ffa58-185">Рекомендуется перезагрузить оба сервера переднего плана в то же время.</span><span class="sxs-lookup"><span data-stu-id="ffa58-185">The best practice is to restart both Front End Servers at the same time.</span></span> 
    
  - <span data-ttu-id="ffa58-186">Если это невозможно, следует включать их в порядке, обратном порядку их отключения.</span><span class="sxs-lookup"><span data-stu-id="ffa58-186">If the two servers cannot be restarted at the same time, you should bring them back up in the reverse order of the order they went down.</span></span>
    
  - <span data-ttu-id="ffa58-187">Если вы не может включать их в указанном порядке, затем используйте следующий командлет перед вызовом пула:`Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`</span><span class="sxs-lookup"><span data-stu-id="ffa58-187">If you cannot bring them back up in that order, then use the following cmdlet before bringing the pool back up:  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`</span></span>
    
## <a name="front-end-pool-configuration-failures-and-changes"></a><span data-ttu-id="ffa58-188">Сбои и изменения конфигурации пула переднего плана</span><span class="sxs-lookup"><span data-stu-id="ffa58-188">Front End pool configuration failures and changes</span></span>

<span data-ttu-id="ffa58-p113">Если сервер переднего плана ломается и будет заменен только через несколько дней или позднее, удалите этот сервер из топологии. Когда новый сервер переднего плана вновь станет доступен, добавьте его в топологию.</span><span class="sxs-lookup"><span data-stu-id="ffa58-p113">If a Front End server fails and is unlikely to be replaced for a few days or more, remove the server from the topology. Add the new Front End server to the topology when it is available again.</span></span>
  
<span data-ttu-id="ffa58-191">При внесении изменений в конфигурацию пула переднего плана, например при добавлении или удалении серверов, необходимо придерживаться следующих правил.</span><span class="sxs-lookup"><span data-stu-id="ffa58-191">Whenever you make a configuration change to a Front End pool, such as adding or removing servers, you must follow these guidelines:</span></span>
  
- <span data-ttu-id="ffa58-p114">После публикации новой топологии следует перезапустить каждый сервер переднего плана в пуле. Перезапускайте их по одному.</span><span class="sxs-lookup"><span data-stu-id="ffa58-p114">After the new topology has been published, you must restart each Front End server in the pool. Restart them one at a time.</span></span>
    
- <span data-ttu-id="ffa58-194">Если весь пул был отключен во время изменения конфигурации, выполните следующий командлет, после публикации новой топологии:`Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`</span><span class="sxs-lookup"><span data-stu-id="ffa58-194">If the entire pool has been down during the configuration change, then run the following cmdlet after the new topology is published:  `Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`</span></span>
    

