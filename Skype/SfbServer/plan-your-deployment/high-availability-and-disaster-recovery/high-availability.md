---
title: Высокая доступность и управление в пуле передней части
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: conceptual
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
ms.assetid: 965041b7-3136-49f2-89c1-8b30417cb8ea
description: Узнайте об управлении пулами в Skype для бизнеса Server, включая управление пулами, потерю кворума и специальные действия для пулов только с двумя серверами переднего конца.
ms.openlocfilehash: 2eabc5e32937b88de4a3c4bbd474e20e132c1984
ms.sourcegitcommit: 556fffc96729150efcc04cd5d6069c402012421e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "58585013"
---
# <a name="front-end-pool-high-availability-and-management"></a>Высокая доступность и управление в пуле передней части
 
Узнайте об управлении пулами в Skype для бизнеса Server, включая управление пулами, потерю кворума и специальные действия для пулов только с двумя серверами переднего конца.
  
В Skype для бизнеса Server архитектуре пулов переднего конечного интерфейса используется модель распределенных систем, при этом данные каждого пользователя хранятся в пуле до трех интерфейсных серверов. Мы рекомендуем, чтобы все выпуск Enterprise пулы переднего конца включали не менее трех серверов переднего конца.

> [!NOTE]
> Skype для бизнеса Server 2019 г. не поддерживает выпуск Enterprise с двумя передними конечными серверами и не позволит публиковать топологию в этом сценарии.
  
## <a name="planning-for-the-management-of-front-end-pools"></a>Планирование управления пулами переднего плана

 Skype для бизнеса Server использует модель распределенных систем на основе Windows Fabric. В этой модели важные данные для каждого пользователя и конференции хранятся на трех интерфейсных серверах в пуле переднего конца. Эти три сервера, хранимые определенный набор данных, называютсяreplicas.
  
С распределенной моделью для пулов переднего конца необходимо запускать определенное число серверов пула для функционирования пула. Для пула существует два режима потери.
  
- Потеря кворума группового уровня, вызванная недостаточной копией серверов для определенной группы маршрутов. Группа маршрутивок — это набор пользователей, обустроившись в пуле. Каждая группа маршрутов имеет три реплики в пуле: одна основная реплика и две вторичные реплики.
    
- Потеря кворума уровня пула, вызванная тем, что в пуле не хватает серверов семян. 
    
### <a name="routing-group-level-quorum-loss"></a>Потеря кворума группового уровня маршрутов

При первом запуске нового пула передней части необходимо, чтобы 85% серверов были запущены и запущены, как показано в следующей таблице. Если запущено меньше серверов, службы могут застрять в исходном состоянии, а пул может не запуститься.
  
|Общее число серверов в пуле  <br/> |Число серверов, которые должны запускаться для запуска пула с первого  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3   <br/> |3   <br/> |
|4   <br/> |3   <br/> |
|5   <br/> |4   <br/> |
|6   <br/> |5   <br/> |
|7   <br/> |5   <br/> |
|8   <br/> |6   <br/> |
|9   <br/> |7   <br/> |
|10   <br/> |8   <br/> |
|11   <br/> |9   <br/> |
|12   <br/> |10   <br/> |
|16 **For Skype для бизнеса Server 2019** <br/> |12   <br/> |


   
Каждый последующий период работы пула должен быть запущен 85% серверов (как показано в предыдущей таблице). Если это число серверов не может быть запущено (но достаточное количество серверов может быть запущено таким образом, чтобы вы не были в потере кворума уровня пула), вы можете использовать cmdlet, чтобы позволить пулу восстановиться после потери кворума группового уровня маршрутов и добиться  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery` прогресса. Дополнительные сведения об использовании этого cmdlet см. в [перезагружении-CsPoolRegistrarState.](/powershell/module/skype/reset-cspoolregistrarstate?view=skype-ps) 
  
> [!NOTE]
> В пулах с 0-м числом серверов Skype для бизнеса Server базы данных primary SQL в качестве свидетеля. В таком пуле при закрытии основной базы данных и переходе на зеркальную копию и закрытии достаточного количества серверов переднего конца, чтобы не было достаточного количества запущенных в соответствии с предыдущей таблицей, весь пул будет отключен. Дополнительные сведения см. в [статью Свидетель зеркального зеркального зеркала базы данных.](/sql/database-engine/database-mirroring/database-mirroring-witness) 
  
#### <a name="pool-level-quorum-loss"></a>Потеря кворума уровня пула

Чтобы пул переднего конца функционировал вообще, он не может быть в потере кворума уровня пула. Если количество запущенных серверов опускается ниже функционального уровня, как показано в следующей таблице, остальные серверы в пуле остановят все Skype для бизнеса Server службы. Обратите внимание, что номера в следующей таблице предполагают, что серверы back end в пуле запущены.
  
|Общее число серверов переднего плана в пуле  <br/> |Число работающих серверов, требуемое для правильного функционирования пула  <br/> |
|:-----|:-----|
|2   <br/> |1   <br/> |
|3-4  <br/> |Любые 2  <br/> |
|5-6  <br/> |Любые 3  <br/> |
|7   <br/> |Любые 4  <br/> |
|8-9  <br/> |Все 4 из первых 7 серверов  <br/> |
|10-12  <br/> |Все 5 из первых 9 серверов  <br/> |
|12-16 **For Skype для бизнеса Server 2019**  <br/> |Все 7 из первых 12 серверов  <br/> |
   
В предыдущей таблице "первые серверы" — это серверы, которые были впервые, в хронологическом порядке, когда пул был запущен впервые. Чтобы определить эти серверы, можно использовать  `Get-CsComputer` cmdlet с `-PoolFqdn` параметром. В этом комлете будут отображаться серверы в том порядке, в который они отображаются в топологии, а в верхней части списка находятся первые серверы.
  
> [!IMPORTANT]
> В [2019](../../../SfBServer2019/plan/user-model-2019.md) г. максимальное число серверов переднего Skype для бизнеса Server увеличено до 16.
> 
#### <a name="additional-steps-to-ensure-pools-are-functional"></a>Дополнительные действия для обеспечения функциональных пулов

Вы должны следить за несколькими другими факторами, чтобы гарантировать, что ваши пулы передней части остаются функциональными.
  
- При первом перемещении пользователей в пул обязательно убедитесь, что запущено не менее трех серверов переднего плана.
    
- Если вы устанавливаете связь между этим пулом и другим пулом для целей аварийного восстановления, то после установления этих отношений необходимо убедиться, что в этом пуле одновременно работают три сервера переднего конца, чтобы правильно синхронизировать данные с пулом резервного копирования. Дополнительные сведения о сопряжении пула и аварийном восстановлении см. в этой [Skype для бизнеса Server.](high-availability-and-disaster-recovery.md) 
    
## <a name="front-end-pool-with-two-front-end-servers"></a>Пул переднего конца с двумя серверами переднего конца

Мы не рекомендуем развертывать интерфейсный пул, содержащий всего два сервера переднего плана. Этот небольшой пул не будет предоставлять надежное решение с высокой доступностью, как более крупный пул, и требует дополнительного ухода в управлении. Кроме того, если сервер back end из двух серверов пула пошел вниз, весь пул, скорее всего, скоро также пойдут вниз. Если вы хотите развернуть только один или два Skype для бизнеса Server, мы рекомендуем развернуть их выпуск Standard серверов.
  
Если вам когда-либо потребуется развернуть пул с двумя серверами переднего конца, выполните следующие рекомендации:
  
- В случае сбоя одного из двух этих серверов переднего плана вам следует как можно быстрее восстановить его работоспособность. Аналогичным образом, в случае обновления одного из двух серверов его также необходимо вернуть в рабочее состояние как можно быстрее.
    
- Если по какой-либо причине требуется отключить оба сервера одновременно, после окончания простоя пула выполните следующие действия:
    
  - Передовой метод — одновременно перезапустить оба сервера переднего конца. 
    
  - Если это невозможно, следует включать их в порядке, обратном порядку их отключения.
    
  - Если вы не можете привести их обратно в этом порядке, используйте следующий cmdlet перед приведением пула обратно:  `Reset-CsPoolRegistrarState -ResetType QuorumLossRecovery -PoolFQDN <FQDN>`
    
## <a name="front-end-pool-configuration-failures-and-changes"></a>Сбои и изменения конфигурации пула переднего конца

Если сервер переднего конца сбой и вряд ли будет заменен в течение нескольких дней или более, удалите сервер из топологии. Добавьте новый сервер переднего конца в топологию, когда он снова будет доступен.
  
При изменении конфигурации в пуле переднего конца, например в добавлении или удалении серверов, необходимо следовать следующим рекомендациям:
  
- После публикации новой топологии необходимо перезапустить каждый сервер переднего конца в пуле. Перезапускайте их по одному.
    
- Если весь пул не работает во время изменения конфигурации, запустите следующий комдлет после публикации новой топологии:  `Reset-CsPoolRegistrarState -PoolFQDN <PoolFQDN> -ResetType ServiceReset`
