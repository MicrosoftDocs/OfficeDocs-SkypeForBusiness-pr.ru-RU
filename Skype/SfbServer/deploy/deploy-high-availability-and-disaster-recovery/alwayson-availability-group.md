---
title: Развертывание группы always on availability на сервере back end в Skype для бизнеса Server
ms.reviewer: ''
ms.author: serdars
author: SerdarSoysal
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
ms.localizationpriority: medium
ms.collection: IT_Skype16
ms.assetid: c93c01e6-626c-40ad-92dd-373b0fe9189f
description: Развертывание (установка) группы Always On Availability в Skype для бизнеса Server развертывании.
ms.openlocfilehash: c995c894df1d945522788b485f659a1c9b08b40e
ms.sourcegitcommit: 59d209ed669c13807e38196dd2a2c0a4127d3621
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2022
ms.locfileid: "62417232"
---
# <a name="deploy-an-always-on-availability-group-on-a-back-end-server-in-skype-for-business-server"></a>Развертывание группы always on availability на сервере back end в Skype для бизнеса Server
 
Развертывание (установка) группы всегда на доступности (AG) в Skype для бизнеса Server развертывании.
  
Развертывание AG зависит от того, развертывается ли он в новом пуле, существующем пуле, использующем зеркальное отражение, или существующем пуле, который в настоящее время не имеет высокой доступности для базы данных Back End.
  
> [!NOTE]
> Использование AG с ролью "Постоянный сервер чата" не поддерживается. 
  
- [Развертывание группы всегда на доступности в новом пуле передней части](alwayson-availability-group.md#BKMK_NewPool_CreateAlwaysOnGroup)
    
- [Развертывание группы всегда на доступности в существующем пуле с зеркальным отражением баз данных](alwayson-availability-group.md#BKMK_MirroredPool_CreateAlwaysOnGroup)
    
- [Развертывание группы Always On Availability в существующем пуле, который не использует зеркальное отражение баз данных](alwayson-availability-group.md#BKMK_NoHAPool_CreateAlwaysOnGroup)
    
## <a name="deploy-an-always-on-availability-group-on-a-new-front-end-pool"></a>Развертывание группы всегда на доступности в новом пуле передней части
<a name="BKMK_NewPool_CreateAlwaysOnGroup"> </a>

1. Включить функцию кластеризация failover на всех серверах баз данных, которые будут частью AG. На каждом сервере сделайте следующее
    
   - Откройте диспетчер сервера и нажмите **кнопку Добавить роли и функции**.
    
   - Нажмите **кнопку Далее** , пока не **достигнете окна Функции Выберите** . Здесь выберите поле кластеризация **failover** .
    
   - В поле **Добавить функции, необходимые для кластерного кластера failover?** нажмите **кнопку Добавить функции**.
    
   - Нажмите **Установить**.
    
2. Проверка конфигурации кластера.
    
   - В диспетчере серверов щелкните меню **Tools** и нажмите **кнопку Failover Cluster Manager**.
    
   - В **статье Действия** на правой стороне экрана нажмите кнопку **Проверка конфигурации**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления в кластер и нажмите кнопку **Выполнить все тесты**.
    
   - В поле **Сводка** проверьте все ошибки, которые сообщает мастер. Затем нажмите **кнопку Готово** , чтобы завершить проверку.
    
     Мастер, вероятно, сообщает несколько предупреждений, особенно если вы не используете общее хранилище. Использование общего хранилища не требуется. Однако, если вы видите сообщения **об ошибке** , перед продолжением необходимо устранить эти проблемы.
    
3. Создание кластера Windows сервера (WSFC).
    
   - В **мастере управления кластерами failover** щелкните правой кнопкой мыши управление кластером **failover**, а затем нажмите **кнопку Создать кластер**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Добавьте имя кластера и IP-адрес. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице Подтверждение нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
4. Рекомендуется настроить параметры кластерного кворума для использования свидетеля обмена файлами. Для этого используйте следующие действия:
    
   - Щелкните правой кнопкой мыши имя кластера, нажмите кнопку **Дополнительные действия** и нажмите **кнопку Настройка кластерного кворума Параметры**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выберите свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** нажмите **кнопку Настройка свидетеля обмена файлами**.
    
   - На странице **Configure File Share Witness** введите путь к нужному файлу, а затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
5. На каждом сервере кластера встроим функцию AG в диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигураций SQL Server. На дереве в левой части экрана нажмите кнопку **SQL Server Services**, а затем дважды щелкните SQL Server службу. 
    
   - В поле **Свойства** выберите вкладку **AlwaysOn с высокой доступностью** . Выберите поле **Включить группы доступности AlwaysOn** . Перезапустите службу SQL Server по запросу.
   
6. Используйте Topology Builder для создания пула переднего конца, как объясняется в [create and publish new topology in Skype для бизнеса Server](../../deploy/install/create-and-publish-new-topology.md). В этом случае укажите ag как SQL для пула.
    
7. Создание группы доступности.
    
   - Откройте SQL Server Management Studio и подключите к экземпляру SQL Server.
    
   - В Обозревателе объектов разложите **папку Always On High Availability** . Щелкните правой кнопкой мыши **папку Группы** доступности и нажмите **кнопку Мастер группы доступности**.
    
   - Если **появится страница Введение** , нажмите кнопку **Далее**.
    
   - На странице **Укажите имя группы** доступности введите имя группы доступности и нажмите **кнопку Далее**.
    
   - На странице Выбор баз данных выберите базы данных, которые необходимо включить в группу доступности AlwaysOn. Затем нажмите **Далее**.
    
     Не включайте базы данных **ReportServer**, **ReportServerTempDB** или Persistent Chat в группу доступности AlwaysOn, так как они не поддерживаются в этом сценарии. Вы можете включить все Skype для бизнеса Server базы данных в группу доступности AlwaysOn.
    
   - На странице **Укажите реплики**, щелкните **вкладку Реплики**. Затем нажмите **кнопку Добавить** реплики и подключите к другим экземплярам SQL, которые вы присоединились в качестве узлов кластера Windows серверов.
    
   - В каждом экземпляре выберите **параметры автоматической сбойной и** **синхронной фиксации** . Не выберите параметр **Readable Secondary** .
    
   - Щелкните **вкладку Конечные** точки и убедитесь, что **номер** порта установлен до 5022.
    
   - Щелкните **вкладку Listener** и выберите параметр **Create an availability group listener** . В этом параметре введите имя слушателя и установите порт 1433 (другие порты для этого параметра не поддерживаются).
    
   - Нажмите **кнопку Добавить**, а затем в **поле адрес IPv4** укайте предпочитаемый виртуальный IP-адрес, а затем нажмите **кнопку ОК**.
    
   - На странице **Выбор** начальной синхронизации данных выберите Полный и укажите папку, доступную репликам, и что учетная запись SQL Server, используемая обеими репликами, имеет разрешения на запись. Затем нажмите **Далее**.
    
     Эта доля файлов будет использоваться временно при инициализации баз данных. Если вы имеете дело с большими базами данных, рекомендуется вручную инициализировать их в том случае, если пропускная способность сети не может вместить размер резервных копий баз данных.
    
   - На странице Проверка убедитесь, что все проверки проверки успешны, нажмите кнопку **Далее**.
    
   - На странице **Сводка** проверьте все параметры и нажмите кнопку Готово.
      
8. После развертывания пула и ag выполните некоторые заключительные действия, чтобы убедиться, что SQL логины находятся на каждой из реплик в группе доступности AlwaysOn. 
    
   - Откройте топологию Builder, выберите **топологию загрузки из существующего развертывания** и нажмите **кнопку ОК**.
    
   - Расширяйте Skype для бизнеса Server, расширяйте топологию и **расширяйте SQL Server Магазины**. Щелкните правой кнопкой мыши SQL хранилище новой группы доступности AlwaysOn и нажмите **кнопку Изменить свойства**.
    
     - В нижней части страницы в поле **SQL Server FQDN** измените значение FQDN слушателя AG.
    
   - Опубликуйте топологию. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**. Затем подождите несколько минут, пока новая топология будет реплицироваться.
    
   - Откройте SQL Server Management Studio и перейдите в ag. Перенаправь его на вторичную реплику.
    
   - Откройте Skype для бизнеса Server управленческой оболочки и введите следующий cmdlet, чтобы создать SQL входа в эту реплику:
    
   ```powershell
   Install-CsDatabase -Update
   ```

   - Повторите два предыдущих шага (сбой над группой до вторичной реплики, а затем использовать  `Install-CsDatabase -Update`) для каждой реплики в группе.
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-uses-database-mirroring"></a>Развертывание группы всегда на доступности в существующем пуле с зеркальным отражением баз данных
<a name="BKMK_MirroredPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> Если в пуле, который вы обновляете до ag, находится центральный магазин управления для вашей организации, необходимо сначала переместить CMS в другой пул, прежде чем обновить этот пул. Используйте Move-CsManagementServer для перемещения пула. Если у вас нет другого пула в организации, вы можете временно развернуть сервер выпуск Standard и переместить CMS на этот сервер перед обновлением пула до AG. 
  
1. Переведите все данные из зеркала в основной узел, открыв Skype для бизнеса Server и введя следующий комдлет.
    
   ```powershell
   Invoke-CsDatabaseFailover -PoolFqdn <Pool FQDN> -DatabaseType <DatabaseType> -NewPrincipal "Primary"
   ```

    Повторите этот комлет для каждого типа базы данных в пуле. Вы можете использовать следующий cmdlet, чтобы найти все типы баз данных, хранимые в этом пуле.
     
   ```powershell
   Get-CsPool -Identity <Pool FQDN>
   ```

2. Используйте Topology Builder для удаления зеркального зеркала баз данных из пула.
    
   - Откройте построитель топологий. В топологии расширите **выпуск Enterprise** пулы, щелкните правой кнопкой мыши имя пула и нажмите **кнопку Изменить свойства**.
    
   - Для каждого типа SQL в пуле задайте контрольный ящик **Enable SQL Store Mirroring**.
    
3. Публикация измененной топологии. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**
    
4. Используйте SQL Server Management Studio, чтобы разбить зеркало.
    
   - Откройте SQL Server Management Studio, перейдите к базам данных, щелкните правой кнопкой мыши **Задачи** и щелкните **Зеркало**. Затем нажмите **кнопку Удалить зеркальное отражение** и нажмите **кнопку ОК**.
    
   - Повторите это для всех баз данных в пуле, который будет преобразован в AG.
    
5. Настройка функции кластеризация failover на всех серверах баз данных, которые будут частью AG. На каждом сервере сделайте следующее
    
   - Откройте диспетчер сервера и нажмите **кнопку Добавить роли и функции**.
    
   - Нажмите **кнопку Далее** , пока не **достигнете окна Функции Выберите** . Здесь выберите поле кластеризация **failover** .
    
   - В поле **Добавить функции, необходимые для кластерного кластера failover?** нажмите **кнопку Добавить функции**.
    
   - Нажмите **Установить**.
    
6. Проверка конфигурации кластера.
    
   - В диспетчере серверов щелкните меню **Tools** и нажмите **кнопку Failover Cluster Manager**.
    
   - В **статье Действия** на правой стороне экрана нажмите кнопку **Проверка конфигурации**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления в кластер и нажмите кнопку **Выполнить все тесты**.
    
   - В поле **Сводка** проверьте все ошибки, которые сообщает мастер. Затем нажмите **кнопку Готово** , чтобы завершить проверку.
    
     Мастер, вероятно, сообщает несколько предупреждений, особенно если вы не используете общее хранилище. Использование общего хранилища не требуется. Однако, если вы видите сообщения **об ошибке** , перед продолжением необходимо устранить эти проблемы.
    
7. Создание кластера Windows сервера.
    
   - В **мастере управления кластерами failover** щелкните правой кнопкой мыши управление кластером **failover**, а затем нажмите **кнопку Создать кластер**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Добавьте имя кластера и IP-адрес. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице Подтверждение нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
8. Рекомендуется настроить параметры кластерного кворума для использования свидетеля обмена файлами. Для этого используйте следующие действия:
    
   - Щелкните правой кнопкой мыши имя кластера, нажмите кнопку **Дополнительные действия** и нажмите **кнопку Настройка кластерного кворума Параметры**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выберите свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** нажмите **кнопку Настройка свидетеля обмена файлами**.
    
   - На странице **Configure File Share Witness** введите путь к нужному файлу, а затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
9. На каждом сервере кластера встроим функцию AG в диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигураций SQL Server. На дереве в левой части экрана нажмите кнопку **SQL Server Services**, а затем дважды щелкните SQL Server службу. 
    
   - В поле **Свойства** выберите вкладку **AlwaysOn с высокой доступностью** . Выберите поле **Включить группы доступности AlwaysOn** . Перезапустите службу SQL Server по запросу.
    
10. Создание группы доступности.
    
    - Откройте SQL Server Management Studio и подключите к экземпляру SQL Server.
    
    - В Обозревателе объектов разложите **папку Always On High Availability** . Щелкните правой кнопкой мыши **папку Группы** доступности и нажмите **кнопку Мастер группы доступности**.
    
    - Если **появится страница Введение** , нажмите кнопку **Далее**.
    
    - На странице **Укажите имя группы** доступности введите имя группы доступности и нажмите **кнопку Далее**.
    
    - На странице Выбор баз данных выберите базы данных, которые необходимо включить в группу доступности AlwaysOn. Затем нажмите **Далее**.
    
    Не включайте базы данных **ReportServer**, **ReportServerTempDB** или Persistent Chat в группу доступности AlwaysOn, так как они не поддерживаются в этом сценарии. Вы можете включить все Skype для бизнеса Server базы данных в группу доступности AlwaysOn.
    
    - На странице **Укажите реплики**, щелкните **вкладку Реплики**. Затем нажмите **кнопку Добавить** реплики и подключите к другим экземплярам SQL, которые вы присоединились в качестве узлов кластера Windows серверов.
    
    - В каждом экземпляре выберите **параметры автоматической сбойной и** **синхронной фиксации** . Не выберите параметр **Readable Secondary** .
    
    - Щелкните **вкладку Конечные** точки и убедитесь, что **номер** порта установлен до 5022.
    
      - Щелкните **вкладку Listener** и выберите параметр **Create an availability group listener** . В этом параметре введите имя слушателя и установите порт 1433 (другие порты для этого параметра не поддерживаются).
    
    - Нажмите **кнопку Добавить**, а затем в **поле адрес IPv4** укайте предпочитаемый виртуальный IP-адрес, а затем нажмите **кнопку ОК**.
    
    - На странице **Выбор** начальной синхронизации данных выберите Полный и укажите папку, доступную репликам, и что учетная запись SQL Server, используемая обеими репликами, имеет разрешения на запись. Затем нажмите **Далее**.
    
    Эта доля файлов будет использоваться временно при инициализации баз данных. Если вы имеете дело с большими базами данных, рекомендуется вручную инициализировать их в том случае, если пропускная способность сети не может вместить размер резервных копий баз данных.
    
    - На странице Проверка убедитесь, что все проверки проверки успешны, нажмите кнопку **Далее**.
    
    - На странице **Сводка** проверьте все параметры и нажмите кнопку Готово.
    
11. Создайте новый магазин с указанием прослушивателем AG и указанием основного старого зеркала в качестве основного узла AG.
    
    - Откройте построитель топологий. В топологии разойдите **общие** компоненты, щелкните правой кнопкой мыши **SQL Server магазинах** и нажмите **кнопку New SQL Server Store**.
    
    - На странице **Define New SQL Store** сначала выберите Параметры высокой доступности,  а затем убедитесь, что SQL Группы доступности AlwaysOn появляются в выпадаемом окне.
    
    - В поле **SQL Server FQDN** для прослушивания доступности введите FQDN слушателя, созданного при создания группы доступности.
    
    - В поле **SQL Server FQDN введите FQDN** основного узла AG и нажмите **кнопку ОК**. Это должно быть главным в старом зеркале для этого магазина.
    
12. Связывать новую AG с пулом переднего конца.
    
    - В Topology Builder щелкните правой кнопкой мыши пул, чтобы связаться с AG, и нажмите **кнопку Изменить свойства**.
    
    - В **поле Associations** в **SQL Server Store** выберите AG. Выберите ту же группу для любых других баз данных в пуле, которые необходимо переместить в AG.
    
    - Если вы уверены, что все необходимые базы данных настроены на ag, нажмите **кнопку ОК**.
    
13. Опубликуйте топологию. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**.
    
14. Выполните некоторые заключительные шаги, чтобы убедиться, что SQL логины находятся на каждой из реплик в группе доступности AlwaysOn.
    
    - Откройте топологию Builder, выберите **топологию загрузки из существующего развертывания** и нажмите **кнопку ОК**.
    
    - Расширяйте Skype для бизнеса Server, расширяйте топологию и **расширяйте SQL Server Магазины**. Щелкните правой кнопкой мыши SQL магазине новой AG и нажмите **кнопку Изменить свойства**.
    
    - В нижней части страницы в поле **SQL Server FQDN** измените значение FQDN слушателя AG.
    
    - Опубликуйте топологию. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**. Затем подождите несколько минут, пока новая топология будет реплицироваться.
    
    - Откройте SQL Server Management Studio и перейдите в ag. Перенаправь его на вторичную реплику.
    
    - Откройте Skype для бизнеса Server управленческой оболочки и введите следующий cmdlet, чтобы создать SQL входа в эту реплику:
    
    ```powershell
    Install-CsDatabase -Update
    ```

    - Повторите два предыдущих шага (сбой над группой до вторичной реплики, а затем использовать  `Install-CsDatabase -Update`) для каждой реплики в группе.
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-does-not-use-database-mirroring"></a>Развертывание группы Always On Availability в существующем пуле, который не использует зеркальное отражение баз данных
<a name="BKMK_NoHAPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> Если в пуле, который вы обновляете до ag, находится центральный магазин управления для вашей организации, необходимо сначала переместить CMS в другой пул, прежде чем обновить этот пул. Используйте Move-CsManagementServer для перемещения пула. Если у вас нет другого пула в организации, вы можете временно развернуть сервер выпуск Standard и переместить CMS на этот сервер перед обновлением пула до AG. 
  
1. Настройка функции кластеризация failover на всех серверах баз данных, которые будут частью AG. На каждом сервере сделайте следующее
    
   - Откройте диспетчер сервера и нажмите **кнопку Добавить роли и функции**.
    
   - Нажмите **кнопку Далее** , пока не **достигнете окна Функции Выберите** . Здесь выберите поле кластеризация **failover** .
    
   - В поле **Добавить функции, необходимые для кластерного кластера failover?** нажмите **кнопку Добавить функции**.
    
   - Нажмите **Установить**.
    
2. Проверка конфигурации кластера.
    
   - В диспетчере серверов щелкните меню **Tools** и нажмите **кнопку Failover Cluster Manager**.
    
   - В **статье Действия** на правой стороне экрана нажмите кнопку **Проверка конфигурации**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления в кластер и нажмите кнопку **Выполнить все тесты**.
    
   - В поле **Сводка** проверьте все ошибки, которые сообщает мастер. Затем нажмите **кнопку Готово** , чтобы завершить проверку.
    
     Мастер, вероятно, сообщает несколько предупреждений, особенно если вы не используете общее хранилище. Использование общего хранилища не требуется. Однако, если вы видите сообщения **об ошибке** , перед продолжением необходимо устранить эти проблемы.
    
3. Создание кластера Windows сервера (WSFC).
    
   - В **мастере управления кластерами failover** щелкните правой кнопкой мыши управление кластером **failover**, а затем нажмите **кнопку Создать кластер**.
    
   - На странице **Перед началом работы** нажмите кнопку **Далее**.
    
   - Добавьте имя кластера и IP-адрес. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице Подтверждение нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
4. Рекомендуется настроить параметры кластерного кворума для использования свидетеля обмена файлами. Для этого используйте следующие действия:
    
   - Щелкните правой кнопкой мыши имя кластера, нажмите кнопку **Дополнительные действия** и нажмите **кнопку Настройка кластерного кворума Параметры**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выберите свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** нажмите **кнопку Настройка свидетеля обмена файлами**.
    
   - На странице **Configure File Share Witness** введите путь к нужному файлу, а затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
5. На каждом сервере кластера встроим AG в диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигураций SQL Server. На дереве в левой части экрана нажмите кнопку **SQL Server Services**, а затем дважды щелкните SQL Server службу. 
    
   - В поле **Свойства** выберите вкладку **AlwaysOn с высокой доступностью** . Выберите поле **Включить группы доступности AlwaysOn** . Перезапустите службу SQL Server по запросу.
    
6. Создание группы доступности.
    
   - Откройте SQL Server Management Studio и подключите к экземпляру SQL Server.
    
   - В Обозревателе объектов разложите **папку Always On High Availability** . Щелкните правой кнопкой мыши **папку Группы** доступности и нажмите **кнопку Мастер группы доступности**.
    
   - Если **появится страница Введение** , нажмите кнопку **Далее**.
    
   - На странице **Укажите имя группы** доступности введите имя группы доступности и нажмите **кнопку Далее**.
    
   - На странице Выбор баз данных выберите базы данных, которые необходимо включить в ag. Затем нажмите **Далее**.
    
     Не включайте базы данных **ReportServer**, **ReportServerTempDB** или Persistent Chat в AG, так как они не поддерживаются в этом сценарии. Вы можете включить все Skype для бизнеса Server базы данных в AG.
    
   - На странице **Укажите реплики**, щелкните **вкладку Реплики**. Затем нажмите **кнопку Добавить** реплики и подключите к другим экземплярам SQL, которые вы присоединились в качестве узлов WSFC.
    
   - В каждом экземпляре выберите **параметры автоматической сбойной и** **синхронной фиксации** . Не выберите параметр **Readable Secondary** .
    
   - Щелкните **вкладку Конечные** точки и убедитесь, что **номер** порта установлен до 5022.
    
   - Щелкните **вкладку Listener** и выберите параметр **Create an availability group listener** . В этом параметре введите имя слушателя и установите порт 1433 (другие порты для этого параметра не поддерживаются).
    
   - Нажмите **кнопку Добавить**, а затем в **поле адрес IPv4** укайте предпочитаемый виртуальный IP-адрес, а затем нажмите **кнопку ОК**.
    
   - На странице **Выбор** начальной синхронизации данных выберите Полный и укажите папку, доступную репликам, и что учетная запись SQL Server, используемая обеими репликами, имеет разрешения на запись. Затем нажмите **Далее**.
    
     Эта доля файлов будет использоваться временно при инициализации баз данных. Если вы имеете дело с большими базами данных, рекомендуется вручную инициализировать их в том случае, если пропускная способность сети не может вместить размер резервных копий баз данных.
    
     - На странице Проверка убедитесь, что все проверки проверки успешны, нажмите кнопку **Далее**.
    
   - На странице **Сводка** проверьте все параметры и нажмите кнопку Готово.
    
7. Создайте новый магазин с указанием прослушиватель AG.
    
   - Откройте построитель топологий. В топологии разойдите **общие** компоненты, щелкните правой кнопкой мыши **SQL Server магазинах** и нажмите **кнопку New SQL Server Store**.
    
   - На странице **Define New SQL Store** сначала выберите Параметры высокой доступности,  а затем убедитесь, что SQL Группы доступности AlwaysOn появляются в выпадаемом окне.
    
   - В поле **SQL Server FQDN** для прослушивания доступности введите FQDN слушателя, созданного при создания группы доступности.
    
   - В поле **SQL Server FQDN введите FQDN** основного узла AG и нажмите **кнопку ОК**.
    
8. Связывать новую группу Всегда на доступности с пулом переднего конца.
    
   - В Topology Builder щелкните правой кнопкой мыши пул, чтобы связаться с AG, и нажмите **кнопку Изменить свойства**.
    
   - В **поле Associations** в **SQL Server Store** выберите AG. Выберите ту же группу для любых других баз данных в пуле, которые необходимо переместить в AG.
    
   - Если вы уверены, что все необходимые базы данных настроены на ag, нажмите **кнопку ОК**.
    
9. Опубликуйте топологию. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**.
    
10. Выполните некоторые заключительные шаги, чтобы убедиться, что SQL логины находятся на каждой из реплик в AG.
    
    - Откройте топологию Builder, выберите **топологию загрузки из существующего развертывания** и нажмите **кнопку ОК**.
    
    - Расширяйте Skype для бизнеса Server, расширяйте топологию и **расширяйте SQL Server Магазины**. Щелкните правой кнопкой мыши SQL магазине новой AG и нажмите **кнопку Изменить свойства**.
    
    - В нижней части страницы в поле **SQL Server FQDN** измените значение FQDN слушателя AG.
    
    - Опубликуйте топологию. Из меню **Действия** нажмите **топологию** и опубликуй. Затем на странице подтверждения нажмите **кнопку Далее**. Затем подождите несколько минут, пока новая топология будет реплицироваться.
    
    - Откройте SQL Server Management Studio и перейдите в ag. Перенаправь его на вторичную реплику.
    
    - Откройте Skype для бизнеса Server управленческой оболочки и введите следующий cmdlet, чтобы создать SQL входа в эту реплику:
    
      ```powershell
      Install-CsDatabase -Update
      ```

      - Повторите два предыдущих шага (сбой над группой до вторичной реплики, а затем использовать  `Install-CsDatabase -Update`) для каждой реплики в группе.
