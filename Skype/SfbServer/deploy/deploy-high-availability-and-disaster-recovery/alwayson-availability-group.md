---
title: Развертывание всегда на группы обеспечения доступности на сервере заднего плана в Скайп for Business Server 2015
ms.author: heidip
author: microsoftheidi
manager: serdars
ms.date: 2/14/2018
ms.audience: ITPro
ms.topic: get-started-article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: c93c01e6-626c-40ad-92dd-373b0fe9189f
description: Развертывание развертывания (установить) всегда на группы обеспечения доступности в вашей Скайп для Business Server.
ms.openlocfilehash: ed6155ca1d3c7b24450bd8ca5099c2f6fc75e8a4
ms.sourcegitcommit: 5a0b3fe49b64f08979c89443f66b15827034e755
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/17/2018
---
# <a name="deploy-an-always-on-availability-group-on-a-back-end-server-in-skype-for-business-server-2015"></a>Развертывание всегда на группы обеспечения доступности на сервере заднего плана в Скайп for Business Server 2015
 
Развертывание развертывания (установить) всегда на доступность группы (AG) в вашей Скайп для Business Server.
  
Развертыванием AG зависит от того, является ли вы развертываете его в новый пул, существующего пула, который использует зеркальное отображение или существующего пула, который в данный момент находится не высокой доступности для Тыловой базой данных.
  
> [!NOTE]
> Использование AG с ролью сервера сохраняемого чата не поддерживается. 
  
- [Развертывание всегда на группы обеспечения доступности на новый пул переднего плана](alwayson-availability-group.md#BKMK_NewPool_CreateAlwaysOnGroup)
    
- [Развертывание всегда на группы обеспечения доступности для существующего пула, который использует зеркальное отображение базы данных](alwayson-availability-group.md#BKMK_MirroredPool_CreateAlwaysOnGroup)
    
- [Развертывание всегда на группы обеспечения доступности для существующего пула, который не используется зеркальное отображение базы данных](alwayson-availability-group.md#BKMK_NoHAPool_CreateAlwaysOnGroup)
    
## <a name="deploy-an-always-on-availability-group-on-a-new-front-end-pool"></a>Развертывание всегда на группы обеспечения доступности на новый пул переднего плана
<a name="BKMK_NewPool_CreateAlwaysOnGroup"> </a>

1. Активация компонента отказоустойчивый кластер на все серверы базы данных, которые будут частью AG. На каждом сервере выполните указанные ниже
    
   - Откройте диспетчер серверов и щелкните **Добавить роли и компоненты**.
    
   - Нажимайте кнопку **Далее** до появления поля **Выбор компонентов**. В этом окне установите флажок **Отказоустойчивость кластеров**.
    
   - В поле **Добавить компоненты, необходимые для Отказоустойчивость кластеров?** щелкните **Добавить компоненты**.
    
   - Нажмите **Установить**.
    
2. Проверьте конфигурацию кластеров.
    
   - В диспетчере серверов щелкните меню **Сервис**, затем пункт **Диспетчер отказоустойчивости кластеров**.
    
   - В разделе **Действия** с правой стороны экрана щелкните **Проверить конфигурацию**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления к кластеру, затем щелкните **Выполнить все тесты**.
    
   - В окне "**Сводка** " Проверьте все ошибки, которые мастер отчетов. Затем нажмите кнопку **Готово** для завершения проверки.
    
    В этом поле мастера может отображаться несколько предупреждений, особенно в том случае, если не используется общее хранилище. Пользоваться общим хранилищем не обязательно. Однако при наличии сообщений с заголовком **Ошибка** перед продолжением необходимо устранить неполадки.
    
3. Создайте отказоустойчивый кластер Windows Server (WSFC).
    
   - В мастере **Средства управления отказоустойчивыми кластерами** щелкните **Средства управления отказоустойчивыми кластерами**, затем выберите **Создание кластера**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Добавьте имя и IP -адрес кластера. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице "Подтверждение" нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
4. Рекомендуется настроить параметры кворума кластера для работы с файловым ресурсом-свидетелем. Для этого выполните следующие действия.
    
   - Щелкните имя кластера правой кнопкой мыши и выберите **More Actions**, затем **Настройка параметров кворума кластера**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выбрать свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** щелкните **Настроить файловый ресурс-свидетель**.
    
   - На странице **Настройка файлового ресурса-свидетеля** введите путь к требуемому общему файловому ресурсу, затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
5. На каждом сервере в кластере включите функцию AG диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигурации SQL Server. В дереве с левой стороны экрана щелкните **Службы SQL Server**, затем дважды щелкните службу SQL Server.  
    
   - В окне **Свойства** перейдите на вкладку **Высокий уровень доступности AlwaysOn**. Установите флажок **Включить группы доступности AlwaysOn**. По запросу перезапустите службу SQL Server.
    
6. Создайте группу доступности.
    
   - Откройте Microsoft SQL Server Management Studio и установите соединение с экземпляром SQL Server.
    
   - В обозревателе объектов разверните папку **Всегда высокой доступности** . Щелкните папку **Группы доступности** правой кнопкой мыши и выберите **Мастер создания групп доступности**.
    
   - В случае появления страницы **Введение** нажмите кнопку **Далее**.
    
   - На странице **Указание имени группы доступности** введите имя группы доступности, затем нажмите кнопку **Далее**.
    
   - На странице Выбор базы данных выберите базы данных, которые необходимо включить в группу обеспечения доступности AlwaysOn. Then click **Next**.
    
    Не включайте **ReportServer**, **ReportServerTempDB**или Persistent Chat баз данных в группе обеспечения доступности AlwaysOn, как они не поддерживаются в этом сценарии. В группе обеспечения доступности AlwaysOn можно включить все Скайп для сервера баз данных.
    
   - На странице **Указание реплик** перейдите на вкладку **Реплики**. Затем нажмите кнопку **Добавить реплики** и установите соединение со всеми другими экземплярами SQL, присоединенными в качестве узлов отказоустойчивого кластера Windows Server.
    
   - Для каждого экземпляра выберите режимы **Автоматический переход на другой ресурс** и **Синхронная фиксация**. Не выбирайте режим **Вторичная реплика для чтения**.
    
   - Перейдите на вкладку **Конечные точки** и убедитесь в том, что для параметра **Номер порта** задано значение 5022.
    
   - Откройте вкладку **Прослушиватель** и выберите параметр **Создать прослушиватель группы доступности**. Введите имя прослушивателя и установите в поле **Порт** значение 1433 (этот параметр не поддерживает другие порты).
    
   - Нажмите кнопку **Добавить** и введите предпочтительный виртуальный IP‑адрес в поле **IPv4-адрес**, затем нажмите кнопку **ОК**.
    
   - На странице **Выбор начальной синхронизации данных** выберите "Полное" и укажите доступную для реплик папку, запись в которую разрешена учетной записи службы SQL, используемой обеими репликами. Затем нажмите кнопку **Далее**.
    
    Этот общий файловый ресурс будет временно использоваться при инициализации баз данных. При работе с большими базами данных рекомендуется инициализировать их вручную, если полосы пропускания сети недостаточно для передачи резервных копий баз данных.
    
   - На странице "Проверка" убедитесь в успешном выполнении всех операций проверки, затем нажмите кнопку **Далее**.
    
   - На странице "**Сводка** " Проверьте все параметры и нажмите кнопку Готово.
    
7. Используйте построитель топологий для создания пула переднего плана, как описано в статье [создания и публикации новой топологии в Скайп для Business Server 2015](../../deploy/install/create-and-publish-new-topology.md). В этом случае укажите AG хранилище SQL для пула.
    
8. После развертывания пула и AG, выполните некоторые завершающий этап убедитесь, что имена входа SQL на каждой реплики в группе обеспечения доступности AlwaysOn. 
    
   - Откройте построитель топологий, выберите **загрузить топологию из существующего развертывания**и нажмите **кнопку ОК**.
    
   - Разверните Скайп для сервера, топологии и **Хранилища SQL Server**. Щелкните правой кнопкой мыши хранилище SQL для создания группы обеспечения доступности AlwaysOn и нажмите кнопку ** Изменить свойства **.
    
    - В нижней части страницы в поле **Полное доменное имя SQL Server** измените значение на полное доменное имя прослушивателя AG.
    
   - Опубликуйте топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. Затем на странице подтверждения нажмите кнопку **Далее**. Репликация новой топологии занимает несколько минут.
    
   - Откройте SQL Server Management Studio и перейдите к AG. Сбое на вторичная реплика.
    
   - Откройте Скайп для Business Server Командная консоль и введите следующий командлет, чтобы создать входы SQL на этом реплики:
    
   ```
   Install-CsDatabase -Update
   ```

   - Повторите два предыдущих шага (переключаются в группе, чтобы вторичная реплика, а затем использовать `Install-CsDatabase -Update`) для каждой реплики в группе.
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-uses-database-mirroring"></a>Развертывание всегда на группы обеспечения доступности для существующего пула, который использует зеркальное отображение базы данных
<a name="BKMK_MirroredPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> Если пула, в котором обновлении AG размещается центральное хранилище управления для вашей организации, необходимо сначала переместить CMS в другой пул перед обновлением этого пула. Используйте командлет Move-CsManagementServer для перемещения в пул. Если у вас другой пул в вашей организации, можно временно развертывание сервера Standard Edition и переместить CMS на этом сервере перед обновлением до AG пуле. 
  
1. При сбое всех данных из зеркального отображения на узел участника, открыв Скайп для консоли Business Server и введя следующий командлет.
    
   ```
   Invoke-CsDatabaseFailover -PoolFqdn <Pool FQDN> -DatabaseType <DatabaseType> -NewPrincipal "Primary"
   ```

    Повторно выполните этот командлет для каждого типа баз данных в пуле. Для поиска всех типов баз данных, хранящихся в пуле, можно выполнить следующий командлет.
     
   ```
   Get-CsPool -Identity <Pool FQDN>
   ```

2. С помощью построителя топологий отключите зеркальное отображение баз данных из пула.
    
   - Откройте построитель топологий. В данной топологии разверните узел **Пулы переднего плана Enterprise Edition**, щелкните имя пула правой кнопкой мыши и выберите пункт **Изменить свойства**.
    
   - Для каждого типа хранилищ SQL в пуле снимите флажок, **разрешающий зеркальное отображение хранилищ SQL Store Mirroring**.
    
3. Опубликуйте измененную топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. После этого нажмите кнопку **Далее** на странице подтверждения.
    
4. С помощью Microsoft SQL Server Management Studio отключите зеркальное отображение.
    
   - Откройте SQL Server Management Studio, перейдите к базам данных, щелкните **Задачи** правой кнопкой мыши и выберите **Зеркало**. Затем щелкните **Отключить отображение** и нажмите кнопку **ОК**.
    
   - Повторите эти шаги для всех баз данных в пуле, который будет преобразован в AG.
    
5. Установите средство отказоустойчивости кластера на всех серверах базы данных, которые будут частью AG. На каждом сервере выполните указанные ниже
    
   - Откройте диспетчер серверов и щелкните **Добавить роли и компоненты**.
    
   - Нажимайте кнопку **Далее** до появления поля **Выбор компонентов**. В этом окне установите флажок **Отказоустойчивость кластеров**.
    
   - В поле **Добавить компоненты, необходимые для Отказоустойчивость кластеров?** щелкните **Добавить компоненты**.
    
   - Нажмите **Установить**.
    
6. Проверьте конфигурацию кластеров.
    
   - В диспетчере серверов щелкните меню **Сервис**, затем пункт **Диспетчер отказоустойчивости кластеров**.
    
   - В разделе **Действия** с правой стороны экрана щелкните **Проверить конфигурацию**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления к кластеру, затем щелкните **Выполнить все тесты**.
    
   - В окне "**Сводка** " Проверьте все ошибки, которые мастер отчетов. Затем нажмите кнопку **Готово** для завершения проверки.
    
    В этом поле мастера может отображаться несколько предупреждений, особенно в том случае, если не используется общее хранилище. Пользоваться общим хранилищем не обязательно. Однако при наличии сообщений с заголовком **Ошибка** перед продолжением необходимо устранить неполадки.
    
7. Создайте отказоустойчивый кластер Windows Server.
    
   - В мастере **Средства управления отказоустойчивыми кластерами** щелкните **Средства управления отказоустойчивыми кластерами**, затем выберите **Создание кластера**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Добавьте имя и IP -адрес кластера. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице "Подтверждение" нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
8. Рекомендуется настроить параметры кворума кластера для работы с файловым ресурсом-свидетелем. Для этого выполните следующие действия.
    
   - Щелкните имя кластера правой кнопкой мыши и выберите **More Actions**, затем **Настройка параметров кворума кластера**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выбрать свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** щелкните **Настроить файловый ресурс-свидетель**.
    
   - На странице **Настройка файлового ресурса-свидетеля** введите путь к требуемому общему файловому ресурсу, затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
9. На каждом сервере в кластере включите функцию AG диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигурации SQL Server. В дереве с левой стороны экрана щелкните **Службы SQL Server**, затем дважды щелкните службу SQL Server.  
    
   - В окне **Свойства** перейдите на вкладку **Высокий уровень доступности AlwaysOn**. Установите флажок **Включить группы доступности AlwaysOn**. По запросу перезапустите службу SQL Server.
    
10. Создайте группу доступности.
    
    - Откройте Microsoft SQL Server Management Studio и установите соединение с экземпляром SQL Server.
    
    - В обозревателе объектов разверните папку **Всегда высокой доступности** . Щелкните папку **Группы доступности** правой кнопкой мыши и выберите **Мастер создания групп доступности**.
    
    - В случае появления страницы **Введение** нажмите кнопку **Далее**.
    
    - На странице **Указание имени группы доступности** введите имя группы доступности, затем нажмите кнопку **Далее**.
    
    - На странице Выбор базы данных выберите базы данных, которые необходимо включить в группу обеспечения доступности AlwaysOn. Then click **Next**.
    
    Не включайте **ReportServer**, **ReportServerTempDB**или Persistent Chat баз данных в группе обеспечения доступности AlwaysOn, как они не поддерживаются в этом сценарии. В группе обеспечения доступности AlwaysOn можно включить все Скайп для сервера баз данных.
    
    - На странице **Указание реплик** перейдите на вкладку **Реплики**. Затем нажмите кнопку **Добавить реплики** и установите соединение со всеми другими экземплярами SQL, присоединенными в качестве узлов отказоустойчивого кластера Windows Server.
    
    - Для каждого экземпляра выберите режимы **Автоматический переход на другой ресурс** и **Синхронная фиксация**. Не выбирайте режим **Вторичная реплика для чтения**.
    
    - Перейдите на вкладку **Конечные точки** и убедитесь в том, что для параметра **Номер порта** задано значение 5022.
    
     - Откройте вкладку **Прослушиватель** и выберите параметр **Создать прослушиватель группы доступности**. Введите имя прослушивателя и установите в поле **Порт** значение 1433 (этот параметр не поддерживает другие порты).
    
    - Нажмите кнопку **Добавить** и введите предпочтительный виртуальный IP‑адрес в поле **IPv4-адрес**, затем нажмите кнопку **ОК**.
    
    - На странице **Выбор начальной синхронизации данных** выберите "Полное" и укажите доступную для реплик папку, запись в которую разрешена учетной записи службы SQL, используемой обеими репликами. Затем нажмите кнопку **Далее**.
    
    Этот общий файловый ресурс будет временно использоваться при инициализации баз данных. При работе с большими базами данных рекомендуется инициализировать их вручную, если полосы пропускания сети недостаточно для передачи резервных копий баз данных.
    
    - На странице "Проверка" убедитесь в успешном выполнении всех операций проверки, затем нажмите кнопку **Далее**.
    
    - На странице **Сводка** проверьте значения всех параметров и нажмите кнопку "Готово".
    
11. Создайте новое хранилище, указав прослушиватель AG, а субъекта старой зеркальной как основной узел AG.
    
    - Откройте построитель топологий. В данной топологии разверните узел **Общие компоненты**, щелкните **Хранилища SQL Server** правой кнопкой мыши и выберите **Создать хранилище SQL Server**.
    
    - На странице **Определение нового хранилища SQL Server** сначала установите флажок **Параметры высокого уровня доступности**, затем убедитесь в том, что в раскрывающемся списке отображаются группы доступности SQL AlwaysOn.
    
    - В поле **Полное доменное имя прослушивателя группы доступности SQL Server** введите полное доменное имя прослушивателя, созданного в процессе создания группы доступности.
    
    - В поле **Полное доменное имя SQL Server** введите полное доменное имя основного узла AG и нажмите кнопку **ОК**. Это должен быть субъекта старый зеркала для этого хранилища.
    
12. Сопоставьте новый AG с пулом переднего плана.
    
    - В построителе топологий щелкните правой кнопкой мыши пул для связи с AG и выберите команду **Изменить свойства**.
    
    - В разделе **связи**в поле **Хранилища SQL Server** выберите AG. Выберите ту же группу для других баз данных в пуле, который необходимо переместить в AG.
    
    - Если вы уверены, что все необходимые базы данных находятся в AG, нажмите **кнопку ОК**.
    
13. Опубликуйте топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. После этого нажмите кнопку **Далее** на странице подтверждения.
    
14. Выполните некоторые окончательный действия, чтобы убедиться, что имена входа SQL на каждой реплики в группе обеспечения доступности AlwaysOn.
    
    - Откройте построитель топологий, выберите **загрузить топологию из существующего развертывания**и нажмите **кнопку ОК**.
    
    - Разверните Скайп для сервера, топологии и **Хранилища SQL Server**. Щелкните правой кнопкой мыши хранилище SQL новые AG и выберите команду **Изменить свойства**.
    
    - В нижней части страницы в поле **Полное доменное имя SQL Server** измените значение на полное доменное имя прослушивателя AG.
    
    - Опубликуйте топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. Затем на странице подтверждения нажмите кнопку **Далее**. Репликация новой топологии занимает несколько минут.
    
    - Откройте SQL Server Management Studio и перейдите к AG. Сбое на вторичная реплика.
    
    - Откройте Скайп для Business Server Командная консоль и введите следующий командлет, чтобы создать входы SQL на этом реплики:
    
    ```
    Install-CsDatabase -Update
    ```

    - Повторите два предыдущих шага (переключаются в группе, чтобы вторичная реплика, а затем использовать `Install-CsDatabase -Update`) для каждой реплики в группе.
    
## <a name="deploy-an-always-on-availability-group-on-an-existing-pool-that-does-not-use-database-mirroring"></a>Развертывание всегда на группы обеспечения доступности для существующего пула, который не используется зеркальное отображение базы данных
<a name="BKMK_NoHAPool_CreateAlwaysOnGroup"> </a>

> [!NOTE]
> Если пула, в котором обновлении AG размещается центральное хранилище управления для вашей организации, необходимо сначала переместить CMS в другой пул перед обновлением этого пула. Используйте командлет Move-CsManagementServer для перемещения в пул. Если у вас другой пул в вашей организации, можно временно развертывание сервера Standard Edition и переместить CMS на этом сервере перед обновлением до AG пуле. 
  
1. Установите средство отказоустойчивости кластера на всех серверах базы данных, которые будут частью AG. На каждом сервере выполните указанные ниже
    
   - Откройте диспетчер серверов и щелкните **Добавить роли и компоненты**.
    
   - Нажимайте кнопку **Далее** до появления поля **Выбор компонентов**. В этом окне установите флажок **Отказоустойчивость кластеров**.
    
   - В поле **Добавить компоненты, необходимые для Отказоустойчивость кластеров?** щелкните **Добавить компоненты**.
    
   - Нажмите **Установить**.
    
2. Проверьте конфигурацию кластеров.
    
   - В диспетчере серверов щелкните меню **Сервис**, затем пункт **Диспетчер отказоустойчивости кластеров**.
    
   - В разделе **Действия** с правой стороны экрана щелкните **Проверить конфигурацию**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Выберите серверы для добавления к кластеру, затем щелкните **Выполнить все тесты**.
    
   - В окне "**Сводка** " Проверьте все ошибки, которые мастер отчетов. Затем нажмите кнопку **Готово** для завершения проверки.
    
    В этом поле мастера может отображаться несколько предупреждений, особенно в том случае, если не используется общее хранилище. Пользоваться общим хранилищем не обязательно. Однако при наличии сообщений с заголовком **Ошибка** перед продолжением необходимо устранить неполадки.
    
3. Создайте отказоустойчивый кластер Windows Server (WSFC).
    
   - В мастере **Средства управления отказоустойчивыми кластерами** щелкните **Средства управления отказоустойчивыми кластерами**, затем выберите **Создание кластера**.
    
   - На странице **Прежде чем приступить к работе** нажмите кнопку **Далее**.
    
   - Добавьте имя и IP -адрес кластера. После проверки параметров нажмите кнопку **Далее**.
    
   - На странице "Подтверждение" нажмите кнопку **Далее**.
    
   - После создания кластера нажмите кнопку **Готово**.
    
4. Рекомендуется настроить параметры кворума кластера для работы с файловым ресурсом-свидетелем. Для этого выполните следующие действия.
    
   - Щелкните имя кластера правой кнопкой мыши и выберите **More Actions**, затем **Настройка параметров кворума кластера**.
    
   - На странице **Выбор параметра конфигурации кворума** щелкните **Выбрать свидетель кворума**.
    
   - На странице **Выбор свидетеля кворума** щелкните **Настроить файловый ресурс-свидетель**.
    
   - На странице **Настройка файлового ресурса-свидетеля** введите путь к требуемому общему файловому ресурсу, затем нажмите кнопку **Далее**.
    
   - На странице **Подтверждение** нажмите кнопку **Далее**.
    
5. На каждом сервере в кластере включите AG диспетчер конфигурации SQL Server.
    
   - Откройте диспетчер конфигурации SQL Server. В дереве с левой стороны экрана щелкните **Службы SQL Server**, затем дважды щелкните службу SQL Server.  
    
   - В окне **Свойства** перейдите на вкладку **Высокий уровень доступности AlwaysOn**. Установите флажок **Включить группы доступности AlwaysOn**. По запросу перезапустите службу SQL Server.
    
6. Создайте группу доступности.
    
   - Откройте Microsoft SQL Server Management Studio и установите соединение с экземпляром SQL Server.
    
   - В обозревателе объектов разверните папку **Всегда высокой доступности** . Щелкните папку **Группы доступности** правой кнопкой мыши и выберите **Мастер создания групп доступности**.
    
   - В случае появления страницы **Введение** нажмите кнопку **Далее**.
    
   - На странице **Указание имени группы доступности** введите имя группы доступности, затем нажмите кнопку **Далее**.
    
   - На странице Выбор базы данных выберите базы данных, которые необходимо включить в AG. Then click **Next**.
    
    Не включайте **ReportServer**, **ReportServerTempDB**или Persistent Chat баз данных в AG, как они не поддерживаются в этом сценарии. Можно добавить другие Скайп для баз данных Business Server AG.
    
   - На странице **Определение реплик** перейдите на вкладку **реплики** . Затем нажмите кнопку **Добавить реплики** и подключитесь к других экземпляров SQL, состав как узлы WSFC.
    
   - Для каждого экземпляра выберите режимы **Автоматический переход на другой ресурс** и **Синхронная фиксация**. Не выбирайте режим **Вторичная реплика для чтения**.
    
   - Перейдите на вкладку **Конечные точки** и убедитесь в том, что для параметра **Номер порта** задано значение 5022.
    
   - Откройте вкладку **Прослушиватель** и выберите параметр **Создать прослушиватель группы доступности**. Введите имя прослушивателя и установите в поле **Порт** значение 1433 (этот параметр не поддерживает другие порты).
    
   - Нажмите кнопку **Добавить** и введите предпочтительный виртуальный IP‑адрес в поле **IPv4-адрес**, затем нажмите кнопку **ОК**.
    
   - На странице **Выбор начальной синхронизации данных** выберите "Полное" и укажите доступную для реплик папку, запись в которую разрешена учетной записи службы SQL, используемой обеими репликами. Затем нажмите кнопку **Далее**.
    
    Этот общий файловый ресурс будет временно использоваться при инициализации баз данных. При работе с большими базами данных рекомендуется инициализировать их вручную, если полосы пропускания сети недостаточно для передачи резервных копий баз данных.
    
    - На странице "Проверка" убедитесь в успешном выполнении всех операций проверки, затем нажмите кнопку **Далее**.
    
   - На странице **Сводка** проверьте значения всех параметров и нажмите кнопку "Готово".
    
7. Создайте новое хранилище, определяющее AG прослушивателя.
    
   - Откройте построитель топологий. В данной топологии разверните узел **Общие компоненты**, щелкните **Хранилища SQL Server** правой кнопкой мыши и выберите **Создать хранилище SQL Server**.
    
   - На странице **Определение нового хранилища SQL Server** сначала установите флажок **Параметры высокого уровня доступности**, затем убедитесь в том, что в раскрывающемся списке отображаются группы доступности SQL AlwaysOn.
    
   - В поле **Полное доменное имя прослушивателя группы доступности SQL Server** введите полное доменное имя прослушивателя, созданного в процессе создания группы доступности.
    
   - В поле **Полное доменное имя SQL Server** введите полное доменное имя основного узла AG и нажмите кнопку **ОК**.
    
8. Сопоставьте новый всегда на группы обеспечения доступности с пулом переднего плана.
    
   - В построителе топологий щелкните правой кнопкой мыши пул для связи с AG и выберите команду **Изменить свойства**.
    
   - В разделе **связи**в поле **Хранилища SQL Server** выберите AG. Выберите ту же группу для других баз данных в пуле, который необходимо переместить в AG.
    
   - Если вы уверены, что все необходимые базы данных находятся в AG, нажмите **кнопку ОК**.
    
9. Опубликуйте топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. После этого нажмите кнопку **Далее** на странице подтверждения.
    
10. Выполните некоторые окончательный действия, чтобы убедиться, что имена входа SQL на каждой реплики в AG.
    
    - Откройте построитель топологий, выберите **загрузить топологию из существующего развертывания**и нажмите **кнопку ОК**.
    
    - Разверните Скайп для сервера, топологии и **Хранилища SQL Server**. Щелкните правой кнопкой мыши хранилище SQL новые AG и нажмите кнопку ** Изменить свойства **.
    
    - В нижней части страницы в поле **Полное доменное имя SQL Server** измените значение на полное доменное имя прослушивателя AG.
    
    - Опубликуйте топологию. В меню **Действие** щелкните **Топология**, затем **Опубликовать**. Затем на странице подтверждения нажмите кнопку **Далее**. Репликация новой топологии занимает несколько минут.
    
    - Откройте SQL Server Management Studio и перейдите к AG. Сбое на вторичная реплика.
    
    - Откройте Скайп для Business Server Командная консоль и введите следующий командлет, чтобы создать входы SQL на этом реплики:
    
     ```
     Install-CsDatabase -Update
     ```

     - Повторите два предыдущих шага (переключаются в группе, чтобы вторичная реплика, а затем использовать `Install-CsDatabase -Update`) для каждой реплики в группе.
    

