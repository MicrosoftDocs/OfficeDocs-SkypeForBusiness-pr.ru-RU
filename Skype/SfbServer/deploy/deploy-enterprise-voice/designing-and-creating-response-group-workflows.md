---
title: Проектирование и создание рабочих процессов группы ответа в Skype для бизнеса
ms.reviewer: ''
ms.author: v-cichur
author: cichur
manager: serdars
audience: ITPro
ms.topic: quickstart
ms.prod: skype-for-business-itpro
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- IT_Skype16
- Strat_SB_Admin
ms.custom: ''
ms.assetid: dcb9effb-5d12-4dee-80fc-ab9654222d5a
description: Разработка и создание рабочих процессов группы ответа в Skype для бизнеса Server Корпоративная голосовая связь. Здесь освещаются как рабочий процесс сервисной группы, так и интерактивные процессы.
ms.openlocfilehash: 3ebd5f2705547aa96a9ebfcc6857781ef25854b5
ms.sourcegitcommit: c528fad9db719f3fa96dc3fa99332a349cd9d317
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "49831039"
---
# <a name="designing-and-creating-response-group-workflows-in-skype-for-business"></a>Проектирование и создание рабочих процессов группы ответа в Skype для бизнеса

Разработка и создание рабочих процессов группы ответа в Skype для бизнеса Server Корпоративная голосовая связь. Здесь освещаются как рабочий процесс сервисной группы, так и интерактивные процессы.

Рабочий процесс определяет порядок обработки вызова с момента телефонного звонка до момента ответа на вызов. Рабочий процесс указывает очередь, используемую для удержания вызова, и указывает метод маршрутинга, который будет применяться для процессов сервисной группы, а также вопросы и ответы, которые будут применяться для интерактивных процессов группы ответа.

Рабочий процесс также задает такие параметры, как приветственное сообщение, музыка при удержании, часы работы и выходные.

> [!NOTE]
> Вы должны создать группы агентов и очереди перед созданием рабочего процесса, в котором они используются.

## <a name="creating-or-modifying-a-hunt-group-workflow"></a>Создание или изменение рабочего процесса группы

### <a name="to-use-response-group-configuration-tool-to-create-or-modify-a-hunt-group-workflow"></a>Создание или изменение рабочего процесса группы ответа с помощью средства настройки группы ответа

1. Войдите как член группы RTCUniversalServerAdmins или как член одной из предопределеных административных ролей, которые поддерживают группу ответа.

2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления Skype для бизнеса Server.

3. В левой панели навигации щелкните **Response Groups** (Группы ответа), а затем **Workflow** (Рабочий процесс).

4. На странице **Workflow** (Рабочий процесс) щелкните **Create or edit a workflow** (Создание или изменение рабочего процесса).

5. В поле поиска **Выберите службу** введите имя службы **ApplicationServer** (полностью или частично), в которой размещается создаваемый или изменяемый рабочий процесс. В полученном списке служб щелкните нужную службу и нажмите кнопку **ОК**.

    > [!NOTE]
    > Откроется средство настройки группы ответа. Вы также можете открыть средство настройки группы ответа непосредственно в веб-браузере, введя следующий URL-адрес: https:// \<webPoolFqdn\> /RgsConfig.

6. Выполните одно из указанных ниже действий.

   - В **области "Создать новый рабочий процесс"** рядом с **"Hunt Group"**(Создать) нажмите кнопку **"Создать" (Создать).**

   - В области **Управление существующим рабочим процессом** найдите рабочий процесс, который нужно изменить, а затем в разделе **Действие** щелкните **Изменить**.

7. Если все готово к тому, чтобы разрешить пользователям использовать этот рабочий процесс, установите флажок **Activate the workflow** (Активировать рабочий процесс).

    > [!NOTE]
    >  При создании управляемого рабочего процесса необходимо выбрать **"Активировать рабочий процесс".** После сохранения активного, управляемого рабочего процесса его можно изменять и отключать.

8. Чтобы разрешить федеративным пользователям звонки группе, установите флажок **Enable for federation** (Включить федерацию). Кроме того, необходимо иметь политику внешнего доступа, которая применяется к приложению группы ответа, настроенной для федерации.

    > [!NOTE]
    > Глобальная политика внешнего доступа применяется к приложению группы ответа. Глобальную политику для федерации группы ответа можно настроить с помощью панели управления Skype для бизнеса Server или с помощью cmdlet **Set-CsExternalAccessPolicy,** чтобы установить для параметра EnableOutsideAccess значение True. Обратите внимание, что параметры глобальной политики применяются ко всем пользователям, если им не назначена политика на уровне сайта или пользователя. Поэтому перед изменением этого параметра для групп ответа убедитесь, что параметры федерации соответствуют требованиям организации. Дополнительные сведения о применении политик к пользователям см. в разделе [Manage External Access Policy for Your Organization](https://technet.microsoft.com/library/5571811e-34c8-443a-b94c-1ab5d4275581.aspx). Подробные сведения о параметре федерации см. в поле [Set-CsExternalAccessPolicy.](https://docs.microsoft.com/powershell/module/skype/set-csexternalaccesspolicy?view=skype-ps)

    > [!NOTE]
    > Пользователи, которые размещены в Skype для бизнеса Online, не могут звонить в группы ответа, которые размещены в локальном развертывании. Это справедливо как в гибридных развертываниях, так и в тех случаях, когда локальное развертывание совмещено с развертыванием Skype для бизнеса Online.

9. Чтобы скрывать удостоверения агентов в ходе звонка, установите флажок **Enable agent anonymity** (Включить анонимность агента).

    > [!NOTE]
    > Для выполнения анонимных звонков нельзя использовать мгновенные сообщения или видеоконференции, однако агент или звонящий может добавить функцию обмена мгновенными сообщениями и видео после установления звонка. Анонимный агент также может помещать звонки на удержание, переводить звонки (с консультацией и без нее), а также парковать и извлекать звонки. Анонимные звонки не поддерживают конференции, общий доступ к приложениям, совместный доступ к рабочему столу, передачу файлов, доступ к доске и совместную работу с данными, а также запись звонков. Агенты, использующие подключаемый модуль VDI Lync, могут принимать входящие вызовы анонимно, но не могут делать исходящую информацию анонимно.

10. В поле **Enter the address of the group that will receive the calls** (Введите адрес группы, которая будет получать вызовы) введите основной адрес универсального кода ресурса (URI) SIP группы, которая будет отвечать на вызовы рабочего процесса.

    > [!NOTE]
    > Основной URI рабочего процесса определяет порядок идентификации рабочего процесса и ссылки на него. В доменных службах Active Directory в качестве контактного объекта создается Введите URI SIP. Для создания URI объект должен быть уникальным в Active Directory.

11. В поле **Display name** (Отображаемое имя) введите отображаемое имя для рабочего процесса (например, группа ответа отдела продаж).

    > [!NOTE]
    > Не используйте в отображаемом имени символы «<» или «>». Не используйте следующие отображаемые имена, поскольку они зарезервированы: **RGS Presence Watcher** (Наблюдатель присутствия RGS) или **Announcement Service** (Служба оповещения).

12. В области **Номер телефона** введите URI линии для группы ответа (например, +14255550165).

13. В поле **Display number** (Отображаемый номер) введите отображаемый номер для группы ответа (например, +1 (425) 555-0165).

14. (Необязательно) In **Description,** type a description for the workflow as you want it to appear on the contact card in Skype for Business.

15. В поле **Workflow Type** (Тип рабочего процесса) выберите **Managed** (Управляемый), если этот рабочий процесс будет управляться менеджером группы ответа. Чтобы назначить диспетчеров группы ответа для рабочего процесса, выполните следующие действия:

    а. Введите URI SIP менеджера данного рабочего процесса и нажмите кнопку **Добавить**.

    б. Введите URI SIP дополнительных менеджеров, чтобы добавить их в рабочий процесс, и нажмите кнопку **Добавить**.

    > [!IMPORTANT]
    > Каждому пользователю, который назначен менеджером группы ответа, необходимо присвоить роль CsResponseGroupManager. Если пользователям не назначена эта роль, они не могут управлять группами ответа.

16. В области **Шаг 2 — выбор языка** щелкните язык, который необходимо использовать для распознавания речи и преобразования текста в речь.

17. Если требуется настроить приветственное сообщение, то в разделе **Step 3 Configure a Welcome Message** (Шаг  3. Настройка приветственного сообщения) установите флажок **Play a welcome message** (Воспроизводить приветственное сообщение) и затем выполните одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите флажок **Use text-to-speech** (Использовать преобразование текста в речь), а затем введите в поле текст приветственного сообщения.

    > [!NOTE]
    > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой WAV- или WMA-файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

    > [!NOTE]
    > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Сведения о поддерживаемых форматах файлов см. в разделе [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

18. В разделе **Step 4 Specify Your Business Hours** (Шаг 4. Указание режима работы) выберите часовой пояс в списке **Your time zone** (Часовой пояс).

    > [!NOTE]
    > С помощью этого параметра задается часовой пояс, в котором расположены звонящие и агенты рабочего процесса. Он используется для определения времени открытия и закрытия. Например, если рабочий процесс настроен для использования североамериканского восточного часового пояса и задано время открытия и закрытия 7:00 A.M. и 11:00 P.M. соответственно, то по восточноевропейскому времени временем открытия и закрытия будет 7:00 и 23:00 соответственно. (Для ввода времени необходимо использовать 24-часовой формат.)

19. Выберите тип расписания, выполнив одно из следующих действий:

    - Чтобы использовать предварительно заданное расписание, установите переключатель **Use a preset schedule** (Использовать предварительно заданное расписание) и затем выберите требуемое расписание в раскрывающемся списке.

      > [!NOTE]
      > Для выбора этого параметра необходимо создать как минимум одно предварительно заданное расписание. Для настройки предварительно заданных расписаний используется командлет **New-CSRgsHoursOfBusiness**. For details, see [(Optional) Define Response Group business hours in Skype for Business](optional-define-response-group-business-hours.md).

      > [!NOTE]
      > При выборе предварительно заданного расписания поля **Day** (День недели), **Open** (Время открытия) и **Close** (Время закрытия) будут заполнены автоматически.

    - Чтобы использовать настраиваемое расписание, которое применяется только к этому рабочему процессу, установите переключатель **Use a custom schedule** (Использовать настраиваемое расписание).

20. Если вы создаете настраиваемое расписание для этого рабочего процесса, установите флажки для дней недели, по которым группа ответа будет доступна.

21. При создании настраиваемого расписания  введите часы открытия и закрытия для каждого дня недели, когда группа ответа доступна. 

    > [!NOTE]
    > При вводе значений в поля **Open** (Время открытия) и **Close** (Время закрытия) используйте 24-часовой формат. Например, если организация работает с 09:00 до 17:00 с перерывом на обед, то в поле **Open** (Время открытия) укажите 09:00, в поле **Close** (Время закрытия) укажите 12:00, в поле **Open** (Время открытия) укажите 13:00 и в поле **Close** (Время закрытия) укажите 17:00.

22. Если требуется воспроизводить сообщение в нерабочие дни, установите флажок **Play a message when the response group is outside of business hours** (Воспроизводить сообщение, если группа ответа не работает в это время) и затем укажите сообщение, выполнив одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.

      > [!NOTE]
      > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

      > [!NOTE]
      > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах звуковых файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

23. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):

    - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).

    - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты *\<username\>* @ *\<domainName\>* ( например, bob@contoso.com).

    - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. Формат адреса пользователя: _\<username\>_ @ _\<domainName\>_ .

    - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона *\<number\>* @ *\<domainName\>* (например, +14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

24. В разделе **Step 5 Specify Your Holidays** (Шаг 5. Указание выходных дней) установите флажки для одного набора выходных дней или нескольких наборов.

    > [!NOTE]
    > Перед настройкой рабочего процесса необходимо задать выходные дни и наборы выходных дней. Чтобы задать выходные дни и наборы выходных дней, используйте командлеты **New-CsRgsHoliday** и **New-CsRgsHolidaySet**. For details, see [(Optional) Define Response Group holiday sets in Skype for Business](optional-define-response-group-holiday-sets.md).

25. Если требуется воспроизводить приветственное сообщение по выходным дням, установите флажок **Play a message during holidays** (Воспроизводить сообщение в выходные дни) и затем укажите сообщение, выполнив одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.

    > [!NOTE]
    > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

      > [!NOTE]
      > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах звуковых файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

26. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):

    - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).

    - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты *\<username\>* @ *\<domainName\>* ( например, bob@contoso.com).

    - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. Формат адреса пользователя: _\<username\>_ @ _\<domainName\>_ .

    - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона *\<number\>* @ *\<domainName\>* (например, +14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

27. В разделе **Step 6 Configure a Queue** (Шаг 6. Настройка очереди) выберите очередь, используемую для удержания вызывающих, которые ожидают агента в списке **Select the queue that will receive the calls** (Выбор очереди, используемой для приема звонков).

28. В разделе **Step 7 Configure Music on Hold** (Шаг 7. Настройка музыки при удержании звонка) выберите музыку, воспроизводимую для вызывающих при ожидании агента, выполнив одно из следующих действий:

    - Чтобы использовать музыку по умолчанию, установите переключатель **Use default** (Использовать по умолчанию).

    - Чтобы использовать звуковой файл, установите переключатель **Select a music file** (Выбор файла музыки). Чтобы загрузить новый звуковой файл, щелкните ссылку **a music file** (файл музыки). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

      > [!NOTE]
      > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах звуковых файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

29. Щелкните **Deploy** (Развернуть).

### <a name="to-use-skype-for-business-server-management-shell-to-create-or-modify-a-hunt-group-workflow"></a>Использование skype для бизнеса Server Management Shell для создания или изменения рабочего процесса сервисной группы

1. Войдите как член группы RTCUniversalServerAdmins или как член одной из предопределеных административных ролей, которые поддерживают группу ответа.

2. Запустите оболочку управления Skype для бизнеса Server: нажмите кнопку "Начните", выберите "Все программы", "Skype для бизнеса **2015",** а затем щелкните "Skype для бизнеса Server Management **Shell".**

3. Создайте подсказку для воспроизведения в качестве приветственного сообщения и сохраните ее в качестве переменной. В командной строке выполните команду:

   ```powershell
   $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "<text for TTS prompt>"
   ```

    Пример:

   ```powershell
   $promptWM = New-CsRgsPrompt -TextToSpeechPrompt "Welcome to Contoso. Please wait for an available agent."
   ```

     > [!NOTE]
     > Чтобы использовать для сообщения звуковой файл, воспользуйтесь командлетом **Import-CsRgsAudioFile**. Подробные сведения см. в [import-CsRgsAudioFile.](https://docs.microsoft.com/powershell/module/skype/import-csrgsaudiofile?view=skype-ps)

4. Получите идентификатор очереди или вопроса при перенаправлении вызовов. В командной строке выполните команду:

   ```powershell
   $qid = (Get-CsRgsQueue -Name "Help Desk").Identity
   ```

    Дополнительные сведения о создании очереди см. в подстроке [New-CsRgsQueue.](https://docs.microsoft.com/powershell/module/skype/new-csrgsqueue?view=skype-ps)

5. Определите действие по умолчанию, которое будет выполняться при открытии рабочего процесса в рабочие часы, и сохраните его в качестве переменной. В командной строке выполните команду:

   ```powershell
   $actionWM = New-CsRgsCallAction -Prompt <saved prompt from previous step> -Action <action to be taken> -QueueID $qid
   ```

    > [!NOTE]
    > Для рабочих процессов сервисной группы действие по умолчанию должно перенаправлять вызов в очередь. Этот параметр необходим для активных процессов. Для неактивных рабочих процессов этот параметр указывать не нужно.

    Пример:

   ```powershell
   $actionWM = New-CsRgsCallAction -Prompt $promptWM -Action TransferToQueue -QueueID $qid.Identity
   ```

6. Если требуется определить рабочие часы и праздники, их необходимо создать перед созданием или изменением рабочего процесса. For details, see [(Optional) Define Response Group business hours in Skype for Business](optional-define-response-group-business-hours.md) and [(Optional) Define Response Group holiday sets in Skype for Business](optional-define-response-group-holiday-sets.md).

7. Чтобы получить запросы на вызовы, которые принимаются не в неапикальные часы или в выходные дни, используйте для определения запроса с помощью cmdlet **New-CsRgsPrompt** и с помощью **new-CsRgsCallAction** определите действие, которое должно быть принято после запроса. Подробные сведения см. в новых [CsRgsPrompt](https://docs.microsoft.com/powershell/module/skype/new-csrgsprompt?view=skype-ps) и [New-CsRgsCallAction.](https://docs.microsoft.com/powershell/module/skype/new-csrgscallaction?view=skype-ps)

8. Извлеките имя службы для службы группы ответа Lync Server и назначьте его переменной. В командной строке выполните следующую команду:

   ```powershell
   $serviceId = "service:" + (Get-CsService | ?{$_.Applications -like "*RGS*"}).ServiceId;
   ```

9. Создайте или измените рабочий процесс. Чтобы создать рабочий процесс, используйте **New-CsRgsWorkflow**. Чтобы изменить рабочий процесс, используйте **Set-CsRgsWorkflow**. В командной строке введите следующую команду.

   ```powershell
   $workflowHG = New-CsRgsWorkflow -Parent <service ID for the Response Group service> -Name "<hunt group name>" [-Description "<hunt group description>"] -PrimaryUri "<SIP address for the workflow>" [-LineUri "<Phone number for the workflow>"] [-DisplayNumber "<Phone number displayed in Lync>"] [-Active <$true | $false>] [-Anonymous <$true | $false>] [-DefaultAction <variable from preceding step>] [-EnabledForFederation <$true | $false>] [-Managed <$true | $false>] [-ManagersByUri <SIP addresses for Response Group Managers who can manage the workflow>]
   ```

    Пример:

   ```powershell
   $workflowHG = New-CsRgsWorkflow -Parent $serviceID -Name "Human Resources" -Description "Human Resources workflow" -PrimaryUri "sip:humanresources@contoso.com" -LineUri "TEL:+14255551219" -DisplayNumber "555-1219" -Active $true -Anonymous $true -DefaultAction $actionWM -EnabledForFederation $false -Managed $true -ManagersByUri "sip:bob@contoso.com", "mindy@contoso.com"
   ```

     > [!IMPORTANT]
     > Всем пользователям, которые назначены менеджерами рабочих процессов, необходимо присвоить роль CsResponseGroupManager.

     > [!NOTE]
     > Дополнительные сведения о дополнительных необязательных параметрах см. в командной команде [New-CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/new-csrgsworkflow?view=skype-ps) или [Set-CsRgsWorkflow.](https://docs.microsoft.com/powershell/module/skype/set-csrgsworkflow?view=skype-ps)

## <a name="designing-an-interactive-workflow"></a>Разработка интерактивного рабочего процесса

Интерактивный голосовой ответ (IVR) можно использовать для получения информации от вызывающих и перенаправки звонка в соответствующую очередь. Пары вопросов и ответов определяют, какую очередь использовать. В зависимости от ответа вызываемого, вызываемая либо слышит последующий вопрос, либо перенанося в соответствующую очередь. Вопросы IVR и ответы вызываемой стороны предоставляются отвечая агенту, который принимает вызов, предоставляя агенту ценную информацию.

### <a name="overview-of-ivr-features"></a>Обзор возможностей интерактивного автоответчика

Приложение группы ответа предоставляет функции распознавания речи и текста в речь на 26 языках. Вы можете ввести вопросы IVR с помощью функции синтеза речи или WAV- или WMA-файла. Вызывающие абоненты могут ответить, используя голос или команды тонального набора (DTMF).

Интерактивные рабочие процессы поддерживают 2 уровня вопросов, каждый из которых имеет до 4 возможных ответов. IVR задает вопрос вызываемой стороны и в зависимости от ответа вызываемой стороны перенабрашивает вызываемую очередь или задает второй вопрос. Второй вопрос также может иметь четыре возможных ответа. Звонящий перенаправляется в соответствующую очередь в зависимости от ответа на вопрос второго уровня.

> [!NOTE]
> При разработке потоков звонков с помощью skype for Business Server Management Shell можно определить любое количество уровней вопросов IVR и любое количество ответов. Но для удобства мы не рекомендуем использовать более трех уровней вопросов не более чем с пятью ответами в каждом из них. Кроме того, если вы проектируете поток вызовов, который имеет более двух уровней вопросов с более чем четырьмя ответами на каждый из них, вы не сможете изменить поток вызовов с помощью панели управления Skype для бизнеса Server.

Вопросы IVR и ответы вызываемой стороны предоставляются отвечая агенту, который принимает вызов.

### <a name="working-with-speech-technologies"></a>Работа с речевыми технологиями

Речевые технологии, такие как распознавание и синтез речи, могут улучшить работу пользователей и позволить получать доступ к информации более естественно и эффективно. Но могут быть ситуации, когда заданный текст или голосовой ответ пользователя распознается неправильно речевой системой. Например, символ "#" интерпретируется модулем преобразования текста в речь как слово "номер". Эту проблему можно устранить следующим способом.

- Речевой модуль предоставляет звонящему пять попыток для ответа на вопрос. Если звонящий неправильно отвечает на вопрос (т. е. ответ не входит в число допустимых ответов) или не отвечает на вопрос, то ему или ей предоставляется еще одна попытка. Звонящему предоставляется 5 попыток, после чего звонок разъединяется. Вы можете настроить IVR для воспроизведения настраиваемого сообщения после каждой ошибки. Вопрос повторяется каждый раз.

- Чтобы минимизировать возможность интерпретации шума окружающей среды как ответа, используйте более длительные ответы. Например, в ответах должно быть более одного слога и они должны значительно отличаться друг от друга.

- Если ваши вопросы предполагают как речевые, так и тональные (DTMF) ответы, настройте речевые ответы со словами, представляющими концепцию, а не ответы DTMF. Например, вместо "Нажмите или скажите один" используйте "Нажмите 1 или скажите «счета»".

- После настройки IVR, позвоните но номеру, прослушайте голосовые подсказки, ответьте на каждую из них голосом и убедитесь, что IVR звучит и работает, как ожидается. Затем вы можете изменить IVR, чтобы определить проблемы с интерпретацией. Вспомним предыдущий пример — если требуется указать клавишу #, вы можете перезаписать подсказку IVR и использовать имя клавиши вместо символа. Пример: Для связи с сотрудником отдела продаж нажмите кнопку с решеткой.

### <a name="ivr-design-examples"></a>Примеры IVR

В следующих разделах представлены примеры различных сценариев IVR и пар вопросов и ответов.

#### <a name="ivr-with-one-level-of-questions"></a>IVR с одним уровнем вопросов

В следующем примере показан IVR, использующий один уровень вопросов. Он использует распознавание речи для обнаружения ответа вызываемой стороны.

 **Вопрос:** "Благодарим вас за звонок в отдел кадров. Если вы хотите обсудить зарплату, скажите «зарплата». В противном случае скажите «кадры»".

- **Выбран вариант 1:** звонящий перенаправляется в группу, отвечающую за зарплату.

- **Выбран вариант 2:** звонящий перенаправляется в группу отдела кадров.

На следующем рисунке показан поток вызовов.

 **Одноуровневый интерактивный поток вызовов**

![Разработка потоков вызовов с помощью интерактивного реплицы голосовой почты](../../media/Ops_OCS_RGS_IVRLevel1.jpg)

#### <a name="ivr-with-two-levels-of-questions"></a>IVR с двумя уровнями вопросов

В следующем примере показан IVR, использующий два уровня вопросов. Он позволяет звонящим отвечать с использованием речи или команд DTMF.

 **Вопрос:** "Благодарим вас за звонок в службу поддержки ИТ-отдела. Если у вас возникла проблема с доступом к сети, нажмите 1 или скажите «сеть». Если у вас возникла проблема с программным обеспечением, нажмите 2 или скажите «программное обеспечение». Если у вас возникла проблема с оборудованием, нажмите 3 или скажите «оборудование»".

- **Выбран вариант 1:** звонящий перенаправляется в группу поддержки сети.

- **Выбран вариант 2:** звонящему задается следующие вопрос.

    **Вопрос:** "Если это проблема с операционной системой, нажмите 1 или скажите «операционная система». Если это проблема с внутренним приложением, нажмите 2 или скажите «внутреннее приложение». В противном случае нажмите 3 или скажите «иное»".

  - **Выбран вариант 1:** звонящий перенаправляется в группу поддержки операционных систем.

  - **Выбран вариант 2:** звонящий перенаправляется в группу поддержки внутренних приложений.

  - **Выбран вариант 3:** звонящий перенаправляется в группу поддержки программного обеспечения.

- **Выбран вариант 3:** звонящему задается следующие вопрос.

    **Вопрос:** "Если это проблема с принтером, нажмите 1. В противном случае нажмите 2."

  - **Выбран вариант 1:** звонящий перенаправляется в группу поддержки принтеров.

  - **Выбран вариант 2:** звонящий перенаправляется в группу поддержки оборудования.

На следующем рисунке показан поток вызовов.

 **Двухуровневый интерактивный поток вызовов**

![Разработка потоков вызовов с помощью интерактивного реплицы голосовой почты](../../media/Ops_OCS_RGS_IVRLevel2.jpg)

### <a name="best-practices"></a>Рекомендации

В следующем списке описываются некоторые рекомендации по созданию IVR.

- Позвольте звонящему быстро перейти к нужной задаче. Избегайте слишком большого объема информации или длинных маркетинговых сообщений.

- Если вы хотите включить длинное сообщение, рассмотрите возможность добавления его к первому вопросу, а не к сообщению приветствия. Звонящие смогут пропустить сообщение, если оно входит в первый вопрос, ответив на него, но они не смогут пропустить приветствие.

- Говорить на языке вызываемого. Избегайте замещенного языка. Говорить естественно.

- Пишите эффективные подсказки. Удалите все ненужные варианты. Структурировать информацию так, чтобы ожидаемый ответ вызываемого вызываемого звонка был в конце предложения. Например, "Чтобы поговорить с отделом продаж, нажмите 1".

- Сделайте голосовые ответы понятными для пользователя. Например, если вы указываете и тональные, и голосовые ответы, используйте, например, следующую фразу: "Чтобы поговорить с группой продаж, нажмите 1 или скажите «продажи»".

- Проверьте IVR на группе пользователей перед развертыванием в организации.

## <a name="creating-or-modifying-an-interactive-workflow"></a>Создание или изменение интерактивного рабочего процесса

### <a name="to-use-response-group-configuration-tool-to-create-or-modify-an-interactive-workflow"></a>Использование средства настройки группы ответа для создания или изменения интерактивного рабочего процесса

1. Войдите как член группы RTCUniversalServerAdmins или как член одной из предопределеных административных ролей, которые поддерживают группу ответа.

2. Откройте окно браузера и введите URL-адрес администратора, чтобы открыть панель управления Skype для бизнеса Server.

3. В левой панели навигации щелкните **Response Groups** (Группы ответа), а затем **Workflow** (Рабочий процесс).

4. На странице **Workflow** (Рабочий процесс) щелкните **Create or edit a workflow** (Создание или изменение рабочего процесса).

5. В поле **выбора службы** введите полностью или частично имя службы **ApplicationServer**, размещающей рабочий процесс, который требуется создать или изменить. В полученном списке служб щелкните нужную службу и нажмите кнопку **ОК**.

    > [!NOTE]
    > Откроется средство настройки группы ответа. Вы также можете открыть средство настройки группы ответа непосредственно в веб-браузере, введя следующий URL-адрес: https:// \<webPoolFqdn\> /RgsConfig.

6. Выполните одно из следующих действий.

   - На странице **Create a New Workflow** (Создание нового рабочего процесса) напротив **Interactive** (Интерактивный) нажмите кнопку **Create** (Создать).

   - В разделе **Manage an Existing Workflow** (Управление существующим рабочим процессом) найдите рабочий процесс, который требуется изменить, а затем в меню **Action** (Действие) выберите команду **Edit** (Изменить).

7. Если вы не готовы обрабатывать пользовательские вызовы рабочего процесса, снимите флажок **Activate the workflow** (Активировать рабочий процесс).

    > [!NOTE]
    >  При создании управляемого рабочего процесса необходимо выбрать **"Активировать рабочий процесс".** После сохранения активного, управляемого рабочего процесса его можно изменять и отключать.

8. Чтобы разрешить федеративным пользователям звонки группе, установите флажок **Enable for federation** (Включить федерацию). Кроме того, необходимо иметь политику внешнего доступа, которая применяется к приложению группы ответа, настроенной для федерации.

    > [!NOTE]
    > Глобальная политика внешнего доступа применяется к приложению группы ответа. Глобальную политику для федерации группы ответа можно настроить с помощью панели управления Skype для бизнеса Server или с помощью cmdlet **Set-CsExternalAccessPolicy,** чтобы установить для параметра EnableOutsideAccess значение True. Обратите внимание, что параметры глобальной политики применяются ко всем пользователям, если им не назначена политика на уровне сайта или пользователя. Поэтому перед изменением этого параметра для групп ответа убедитесь, что параметры федерации соответствуют требованиям организации. Дополнительные сведения о применении политик к пользователям см. в разделе [Manage External Access Policy for Your Organization](https://technet.microsoft.com/library/5571811e-34c8-443a-b94c-1ab5d4275581.aspx). Подробные сведения о параметре федерации см. в документации **по set-CsExternalAccessPolicy.**

    > [!NOTE]
    > Пользователи, которые размещены в Skype для бизнеса Online, не могут звонить в группы ответа, которые размещены в локальном развертывании. Это справедливо как в гибридных развертываниях, так и в случаях, когда локальное развертывание является федератным с развертыванием Skype для бизнеса Online.

9. Чтобы скрывать удостоверения агентов в ходе звонка, установите флажок **Enable agent anonymity** (Включить анонимность агента).

    > [!NOTE]
    > Для выполнения анонимных звонков нельзя использовать мгновенные сообщения или видеоконференции, однако агент или звонящий может добавить функцию обмена мгновенными сообщениями и видео после установления звонка. Анонимный агент также может помещать звонки на удержание, переводить звонки (с консультацией и без нее), а также парковать и извлекать звонки. Анонимные звонки не поддерживают конференции, общий доступ к приложениям, совместный доступ к рабочему столу, передачу файлов, доступ к доске и совместную работу с данными, а также запись звонков. Агенты, использующие подключаемый модуль VDI Lync, могут принимать входящие вызовы анонимно, но не могут делать исходящую информацию анонимно.

10. В поле **Enter the address of the group that will receive the calls** (Введите адрес группы, которая будет принимать звонки) введите основной URI SIP группы, которая принимать звонки для рабочего процесса.

11. В поле **Display name** (Отображаемое имя) введите отображаемое имя для рабочего процесса (например, группа ответа интерактивного автоответчика отдела продаж).

    > [!NOTE]
    > Не включаем \<" or "\> символы "" в отображаемом имени. Не используйте следующие отображаемые имена, поскольку они зарезервированы: **RGS Presence Watcher** (Наблюдатель присутствия RGS) или **Announcement Service** (Служба оповещения).

12. В поле **Telephone number** (Номер телефона) введите URI для группы ответа (например, +14255550165).

13. В поле **Display number** (Отображаемый номер) введите отображаемый номер для группы ответа (например, +1 (425) 555-0165).

14. (Необязательно) In **Description**, type a description for the workflow that you want to appear on the contact card in Skype for Business.

15. В поле **Workflow Type** (Тип рабочего процесса) выберите **Managed** (Управляемый), если этот рабочий процесс будет управляться менеджером группы ответа. Чтобы назначить диспетчеров группы ответа для рабочего процесса, выполните следующие действия:

    а. Введите URI SIP менеджера данного рабочего процесса и нажмите кнопку **Добавить**.

    б. Введите URI SIP дополнительных менеджеров, чтобы добавить их в рабочий процесс, и нажмите кнопку **Добавить**.

    > [!IMPORTANT]
    > Каждому пользователю, назначенному менеджером группы ответа, должна быть назначена роль CsResponseGroupManager. Если пользователям не назначить эту роль, то они не смогут управлять группами ответа.

16. В разделе **Step 2 Select a Language** (Шаг 2. Выбор языка) выберите язык, используемый для распознавания речи и преобразования текста в речь.

17. Если требуется настроить приветственное сообщение, то в разделе **Step 3 Configure a Welcome Message** (Шаг  3. Настройка приветственного сообщения) установите флажок **Play a welcome message** (Воспроизводить приветственное сообщение) и затем выполните одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите флажок **Use text-to-speech** (Использовать преобразование текста в речь), а затем введите в поле текст приветственного сообщения.

    > [!NOTE]
    > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой WAV- или WMA-файл, установите флажок **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне браузера нажмите кнопку **Browse** (Обзор), выберите нужный звуковой файл и нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

    > [!NOTE]
    > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

18. В разделе **Step 4 Specify Your Business Hours** (Шаг 4. Указание режима работы) выберите часовой пояс в списке **Your time zone** (Часовой пояс).

    > [!NOTE]
    > С помощью этого параметра задается часовой пояс, в котором расположены звонящие и агенты рабочего процесса. Он используется для определения времени открытия и закрытия. Например, если рабочий процесс настроен для использования североамериканского восточного часового пояса и задано время открытия и закрытия 7:00 A.M. и 11:00 P.M. соответственно, то по восточноевропейскому времени временем открытия и закрытия будет 7:00 и 11:00:00 соответственно. (Для ввода времени необходимо использовать 24-часовой формат.)

19. Выберите тип расписания, выполнив одно из следующих действий:

    - Чтобы использовать предварительно заданное расписание, установите переключатель **Use a preset schedule** (Использовать предварительно заданное расписание) и затем выберите требуемое расписание в раскрывающемся списке.

      > [!NOTE]
      > Для выбора этого параметра необходимо создать как минимум одно предварительно заданное расписание. Предварительно задав расписания, можно использовать с помощью **cmdlet New-CsRgsHoursOfBusiness.** For details, see [(Optional) Define Response Group business hours in Skype for Business](optional-define-response-group-business-hours.md). При выборе предварительно заданного расписания поля **Day** (День недели), **Open** (Время открытия) и **Close** (Время закрытия) будут заполнены автоматически.

    - Чтобы использовать настраиваемое расписание, которое применяется только к этому рабочему процессу, установите переключатель **Use a custom schedule** (Использовать настраиваемое расписание).

20. Если вы создаете настраиваемое расписание для этого рабочего процесса, установите флажки для дней недели, по которым группа ответа будет доступна.

21. При создании настраиваемого расписания  введите часы открытия и закрытия, когда группа ответа будет доступна. 

     > [!NOTE]
     > При вводе значений в поля **Open** (Время открытия) и **Close** (Время закрытия) используйте 24-часовой формат. Например, если организация работает с 09:00 до 17:00 с перерывом на обед, то в поле **Open** (Время открытия) укажите 09:00, в поле **Close** (Время закрытия) укажите 12:00, в поле **Open** (Время открытия) укажите 13:00 и в поле **Close** (Время закрытия) укажите 17:00.

22. Если требуется воспроизводить сообщение в нерабочие дни, установите флажок **Play a message when the response group is outside of business hours** (Воспроизводить сообщение, если группа ответа не работает в это время) и затем укажите сообщение, выполнив одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.

      > [!NOTE]
      > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

    > [!NOTE]
    > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

23. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):

    - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).

    - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты *\<username\>* @ *\<domainname\>* ( например, bob@contoso.com).

    - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. Формат адреса пользователя: _\<username\>_ @ _\<domainname\>_ .

    - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона *\<number\>* @ *\<domainname\>* (например, +14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

24. В разделе **Step 5 Specify Your Holidays** (Шаг 5. Указание выходных дней) установите флажки для одного набора выходных дней или нескольких наборов.

    > [!NOTE]
    > Перед настройкой рабочего процесса необходимо задать выходные дни и наборы выходных дней. Чтобы задать выходные дни и наборы выходных дней, используйте командлеты **New-CsRgsHoliday** и **New-CsRgsHolidaySet**. For details, see [(Optional) Define Response Group holiday sets in Skype for Business](optional-define-response-group-holiday-sets.md).

25. Если требуется воспроизводить приветственное сообщение по выходным дням, установите флажок **Play a message during holidays** (Воспроизводить сообщение в выходные дни) и затем укажите сообщение, выполнив одно из следующих действий:

    - Чтобы ввести приветственное сообщение в виде текста, который будет преобразовываться для звонящих в речь, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите в поле текст приветственного сообщения.

      > [!NOTE]
      > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    - Чтобы использовать звуковой файл, установите переключатель **Select a recording** (Выбор записи). Чтобы загрузить новый звуковой файл, щелкните ссылку **a recording** (запись). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

      > [!NOTE]
      > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах звуковых файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

26. Укажите способ обработки звонков после воспроизведения приветственного сообщения (если оно задано):

    - Чтобы разъединять звонки, установите переключатель **Disconnect Call** (Разъединить звонок).

    - Чтобы переадресовывать звонки на голосовую почту, установите переключатель **Forward to voice mail** (Переадресация на голосовую почту) и затем введите адрес голосовой почты. Формат адреса голосовой почты *\<username\>* @ *\<domainname\>* ( например, bob@contoso.com).

    - Чтобы переадресовывать звонки другому пользователю, установите переключатель **Forward to SIP URI** (Переадресация на SIP URI) и затем введите адрес пользователя. Формат адреса пользователя: _\<username\>_ @ _\<domainname\>_ .

    - Чтобы переадресовывать звонки на другой номер телефона, установите переключатель **Forward to telephone number** (Переадресация на номер телефона) и затем введите номер телефона. Формат номера телефона *\<number\>* @ *\<domainname\>* (например, +14255550121@contoso.com). Имя домена используется для перенаправления вызывающего в правильное конечное расположение.

27. В разделе **Step 6 Configure Music on Hold** (Шаг 6. Настройка музыки при удержании звонка) выберите музыку, воспроизводимую для вызывающих при ожидании агента, выполнив одно из следующих действий:

    - Чтобы использовать музыку по умолчанию, установите переключатель **Use default** (Использовать по умолчанию).

    - Чтобы использовать звуковой файл, установите переключатель **Select a music file** (Выбор файла музыки). Чтобы загрузить новый звуковой файл, щелкните ссылку **a music file** (файл музыки). В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Чтобы загрузить звуковой файл, щелкните **Upload** (Загрузить).

    > [!NOTE]
    > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

28. В разделе **Step 7 Configure Interactive Voice Response** (Шаг 7. Настройка интерактивного автоответчика) под заголовком **The user will hear the following text or recorded message** (Пользователь услышит следующий текст или записанное сообщение) укажите вопрос, который будет задан звонящему:

    - Чтобы ввести вопрос в текстовом формате, установите переключатель **Use text-to-speech** (Использовать преобразование текста в речь) и затем введите вопрос в текстовом поле.

    > [!NOTE]
    > Вводимый текст не должен содержать HTML-теги. При добавлении HTML-тегов вы получите сообщение об ошибке.

    > [!NOTE]
    > Символ "#" интерпретируется модулем преобразования текста в речь как слово "номер". Если требуется указать клавишу #, то вместо символа используйте имя клавиши. Пример: Для связи с сотрудником отдела продаж нажмите кнопку с решеткой.

    - Чтобы использовать предварительно записанный звуковой файл, содержащий вопрос, щелкните **Select a recording** (Выбор записи) и затем щелкните ссылку **a recording** (запись), чтобы загрузить файл. В открывшемся окне нажмите кнопку **Browse** (Обзор), выберите требуемый звуковой файл и затем нажмите кнопку **Open** (Открыть). Нажмите **кнопку** "Отправить", чтобы загрузить файл, а затем при желании вы можете ввести вопрос в текстовом поле (это позволяет переадреировать вопрос и ответ вызывающего.

      > [!NOTE]
      > Все звуковые файлы, предоставляемые пользователями, должны удовлетворять определенным требованиям. Подробные сведения о поддерживаемых форматах файлов см. в статье [Technical Requirements for Response Groups](https://technet.microsoft.com/library/477488bd-124f-437b-9327-732a0d7271ca.aspx).

29. В разделе **Response 1** (1 ответ) укажите первый возможный ответ на вопрос, выполнив следующие действия:

    > [!IMPORTANT]
    > При указании голосовых ответов не используйте двойные кавычки ("). Это может привести к сбою интерактивного автоответчика.

    > [!NOTE]
    > Для ответа звонящий может использовать речь или буквенно-цифровые клавиши либо и то, и другое.

    - Чтобы выбрать речевой ответ, введите ответ в поле **Enter a voice response** (Введите голосовой ответ).

    - Чтобы выбрать ответ с помощью клавиш, введите требуемую цифру в поле **Digit** (Цифра).

30. Укажите, требуется ли перенаправлять звонящего в очередь или задать ему другой вопрос, выполнив следующие действия:

    - Чтобы перенаправить звонящего в очередь, щелкните **Send to a queue** (Отправить в очередь) и затем в списке **Select a queue** (Выбор очереди) выберите требуемую очередь.

    - Чтобы задать другой вопрос, щелкните **Ask another question** (Задать другой вопрос), затем щелкните **Use text-to-speech** (Использовать преобразование текста в речь) и введите вопрос либо щелкните **Select a recording** (Выбор записи). С помощью группировки ответов в этом разделе укажите до 4 возможных ответов на дополнительные вопросы и задайте очередность ответов. Чтобы указать 3 или 4 возможные ответы, установите флажки **Response 3** (3 ответ) или **Response 4** (4 ответ).

31. Укажите до трех других возможных ответов на исходный вопрос, повторив шаги 28 и 29, чтобы указать возможные ответы и действия, которые необходимо предпринять для каждого ответа. Чтобы указать 3 или 4 возможные ответы, установите флажки **Response 3** (3 ответ) или **Response 4** (4 ответ).

32. Щелкните **Deploy** (Развернуть).

### <a name="to-use-skype-for-business-server-management-shell-to-create-or-modify-an-interactive-workflow"></a>Создание или изменение интерактивного рабочего процесса с помощью skype для бизнеса Server Management Shell

1.  Войдите как член группы RTCUniversalServerAdmins или как член одной из предопределеных административных ролей, которые поддерживают группу ответа.

2. Запустите оболочку управления Skype для бизнеса Server: нажмите кнопку "Начните", выберите "Все программы", "Skype для бизнеса **2015",** а затем щелкните "Skype для бизнеса Server Management **Shell".**

3. Извлеките имя службы для службы группы ответа и назначьте его переменной. В командной строке введите следующую команду:

   ```powershell
   $serviceId = "service:" + (Get-CsService | ?{$_.Applications -like "*RGS*"}).ServiceId;
   ```

4. Интерактивному рабочему процессу требуется как минимум 2 очереди и как минимум 2 группы агентов. Сначала создайте группы агентов. Выполните следующую команду:

   ```powershell
   $AGSupport = New-CsRgsAgentGroup -Parent $serviceId -Name "Technical Support" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:agent1@contoso.com", "sip:agent2@contoso.com")]
   $AGSales = New-CsRgsAgentGroup -Parent $serviceId -Name "Sales Team" [-AgentAlertTime "20"] [-ParticipationPolicy "Informal"] [-RoutingMethod LongestIdle] [-AgentsByUri("sip:bob@contoso.com", "sip:alice@contoso.com")]
   ```

5. Создайте очереди. Выполните следующую команду:

   ```powershell
   $QSupport = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Support" -AgentGroupIDList($AG-Support.Identity)
   $QSales = New-CsRgsQueue -Parent $ServiceId -Name "Contoso Sales" -AgentGroupIDList($AG-Sales.Identity)
   ```

6. Создайте приглашение для первой группы ответа с помощью следующей команды:

   ```powershell
   $SupportPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please be patient while we connect you with Contoso Technical Support."
   ```

7. Теперь создайте действие, которое должно выполняться после приглашения, с помощью следующей команды:

   ```powershell
   $SupportAction = New-CsRgsCallAction -Prompt $SupportPrompt -Action TransferToQueue -QueueID $QSupport.Identity
   ```

8. Создайте ответ для первой группы ответа с помощью следующей команды:

   ```powershell
   $SupportAnswer = New-CsRgsAnswer -Action $SupportAction [-DtmfResponse 1]
   ```

9. Теперь создайте второе приглашение, действие вызова и ответ. Сначала создайте приглашение с помощью следующей команды:

   ```powershell
   $SalesPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Please hold while we connect you with Contoso Sales."
   ```

10. Создайте второе действие вызова с помощью следующей команды:

    ```powershell
    $SalesAction = New-CsRgsCallAction -Prompt $SalesPrompt -Action TransferToQueue -QueueID $QSales.Identity
    ```

11. Создайте ответ для второй группы ответа с помощью следующей команды:

    ```powershell
    $SalesAnswer = New-CsRgsAnswer -Action $SalesAction [-DtmfResponse 2]
    ```

12. Создайте приглашение верхнего уровня с помощью следующей команды:

    ```powershell
    $TopLevelPrompt = New-CsRgsPrompt -TextToSpeechPrompt "Thank you for calling Contoso. For Technical Support, press 1. For a Sales Representative, press 2."
    ```

13. Создайте вопрос верхнего уровня с помощью следующей команды:

    ```powershell
    $TopLevelQuestion = New-CsRgsQuestion -Prompt $TopLevelPrompt [-AnswerList ($SupportAnswer, $SalesAnswer)]
    ```

14. Теперь создайте рабочий процесс с помощью следующей команды:

    ```powershell
    $IVRAction = New-CsRgsCallAction -Action TransferToQuestion [-Question $Question]
    $IVRWorkflow = New-CsRgsWorkflow -Parent $ServiceId -Name "Contoso Helpdesk" [-Description "The Contoso Helpdesk line."] -PrimaryUri "sip:helpdesk@contoso.com" [-LineUri tel:+14255554321] [-DisplayNumber "+1 (425) 555-4321"] [-Active $true] [-Anonymous $true] [-DefaultAction $IVRAction] [-Managed $true] [-ManagersByURI ("sip:mindy@contoso.com", "sip:bob@contoso.com")]
    ```

     > [!NOTE]
     > Всем пользователям, назначенным менеджером группы ответа, должна быть назначена роль CsResponseGroupManager. Если пользователям не назначить эту роль, то они не смогут управлять группами ответа.

## <a name="see-also"></a>См. также

[(Необязательно) Определение наборов праздников группы ответа в Skype для бизнеса](optional-define-response-group-holiday-sets.md)

[(Необязательно) Определение часов работы группы ответа в Skype для бизнеса](optional-define-response-group-business-hours.md)

[New-CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/new-csrgsworkflow?view=skype-ps)

[Set-CsRgsWorkflow](https://docs.microsoft.com/powershell/module/skype/set-csrgsworkflow?view=skype-ps)

[New-CsRgsPrompt](https://docs.microsoft.com/powershell/module/skype/new-csrgsprompt?view=skype-ps)

[New-CsRgsCallAction](https://docs.microsoft.com/powershell/module/skype/new-csrgscallaction?view=skype-ps)

