---
title: Настройка поставщиков для централизованной службы ведения журналов в Skype для бизнеса Server 2015
ms.author: jambirk
author: jambirk
manager: serdars
ms.date: 2/1/2018
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: 6a197ecf-b56b-45e0-8e7c-f532ec5164ff
description: 'Сводка: Сведения о настройке поставщиков сценариев для централизованной службы ведения журналов в Скайп для Business Server 2015.'
ms.openlocfilehash: e67a1dee9227624ecc94c50437f60781435b2fe8
ms.sourcegitcommit: dd37c12a0312270955755ab2826adcfbae813790
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/04/2018
ms.locfileid: "25372494"
---
# <a name="configure-providers-for-centralized-logging-service-in-skype-for-business-server-2015"></a>Настройка поставщиков для централизованной службы ведения журналов в Skype для бизнеса Server 2015
 
**Сводка:** Сведения о настройке поставщиков сценариев для централизованной службы ведения журналов в Скайп для Business Server 2015.
  
Основные понятия и конфигурации поставщиков в централизованной службы ведения журналов является одним из наиболее важных для осознавать. Карта Theproviders непосредственно к Скайп Business Server компонентов роли сервера в Скайп для модели трассировки Business Server. Компоненты Скайп поставщиком для Business Server 2015, который будет отслеживаться тип сообщения (например, сообщения о неустранимых об ошибке или предупреждение) для сбора и флаги (например, TF_Connection или TF_Diag). Поставщики, выполняемых компоненты в каждом Скайп для роли сервера Business Server. С их помощью можно определить уровень и тип трассировки компонентов (например, S4, SIPStack, IM и Presence). Определенный поставщик используется в сценарии для группировки всех поставщиков в логическую коллекцию, описывающую состояние определенной проблемы.
  
Для запуска функции централизованной службы ведения журналов с помощью Скайп for Business Server Командная консоль, должна быть членом CsAdministrator или групп безопасности CsServerAdministrator доступом на основе ролей (RBAC) элемента управления или настраиваемые роли RBAC, содержит любой из этих двух групп. Чтобы получить список всех роли доступом на основе ролей (RBAC) элемента управления, которые этот командлет был назначен (включая любые пользовательские роли RBAC, созданные самостоятельно), выполните следующую команду из Скайп для консоли Business Server и Windows PowerShell в командной строке:
  
```
Get-CsAdminRole | Where-Object {$_.Cmdlets -match "Skype for Business Server 2015 cmdlet"}
```

Например:
  
```
Get-CsAdminRole | Where-Object {$_.Cmdlets -match "Set-CsClsConfiguration"}
```

Остальная часть данной темы посвящена определению поставщиков, изменению поставщика и компонентов поставщика, упрощающих поиск и устранение неисправностей. Существует два способа для выполнения команд, централизованной службы ведения журналов. Вы можете использовать файл CLSController.exe, который по умолчанию расположен в каталоге C:\Program Files\Common Files\Skype for Business Server 2015\CLSAgent. Или можно использовать Скайп для консоли Business Server на выполнение команд Windows PowerShell. С помощью Windows PowerShell, можно определить новые службы для использования в вашей сеансы ведения журналов и имеют полный контроль над их создания, что они сбор и на каком уровне их сбора данных.
  
> [!IMPORTANT]
> Как уже упоминалось, поставщики являются очень мощным средством. Однако сценарии имеют большее значение, так как объединяют в себе все данные, необходимые для определения и выполнения трассировок компонентов, представленных поставщиками. Сценарии, которые являются коллекциями поставщиков, можно сравнить с выполнением пакетного файла, содержащего сотни команд, для сбора большого объема данных, что отличается от выполнения сотен команд по одной в командной строке. 
  
Устраняет необходимость подробнее глубоко поставщиков, службы централизованного ведения журналов предоставляет ряд сценариев, которые уже определен. Предоставленные сценарии покрывают большое количество различных проблем и неполадок, которые могут возникнуть. В редких случаях может понадобиться создать и определить поставщиков и назначить их в сценарии. Настоятельно рекомендуется ознакомиться с каждым предоставленным сценарием, прежде чем создавать новых поставщиков и сценарии. Хотя здесь предоставляются сведения о создании поставщиков, чтобы вы могли ознакомиться с тем, как сценарии используют элементы поставщиков для сбора данных трассировок, сведения о самих поставщиках в настоящее время не предоставлены. 
  
Представлено в [Централизованной службы ведения журналов в Скайп для бизнеса 2015](centralized-logging-service.md), ключевые элементы определения поставщика для использования в сценарии являются:
  
- **Поставщики** Если вы знакомы с OCSLogger, поставщики — это компоненты, чтобы сообщить OCSLogger обработчик трассировки следует собирать данные для выбора. Поставщики — это те же компоненты, а во многих случаях их имя совпадает с компонентами в OCSLogger. Если вы не знакомы с OCSLogger, поставщики, роль сервера отдельные компоненты, которые можно собрать службы централизованного ведения журналов входит в систему. В случае Centralized Logging Service CLSAgent входит в архитектуре of the Centralized Logging Service, который делает трассировки компонентов, определенных в конфигурации поставщиков.
    
- **Уровни ведения журнала** OCSLogger обеспечивает возможность выбора нескольких уровнях детализации для данных, собранных. Эта функция является частью централизованной службы ведения журналов и сценарии и определяется с помощью параметра **типа Type** . Можно выбрать следующие значения:
    
  - **Все** Собирает трассировку сообщений неустранимые, ошибка, предупреждение, verbose и отладочной информации в журнал на определенном поставщике.
    
  - **Сообщения о неустранимых** Собирает только сообщения трассировки, определенные как «Неустранимая ошибка».
    
  - **Ошибка** Собирает только сообщения трассировки, определенные как «Ошибка» или «Ошибка».
    
  - **Предупреждение** Собирает только сообщения трассировки типа «Предупреждение», «Ошибка» и «Сообщения о неустранимых.»
    
  - **Сведения о** Собирает только сообщения трассировки, оповещающие об информационном сообщении на определенном поставщике, а также сообщения о неустранимых, ошибки и предупреждения.
    
  - **Verbose** Собирает сообщения трассировки всех типов критическая ошибка, ошибки, предупреждения и verbose на определенном поставщике.
    
  - **Отладка** это по сути эквивалент из «Все» — собирает трассировку типа Неустранимая ошибка, ошибка, предупреждение, информация, подробный и отладка на определенном поставщике.
    
- **Флаги** OCSLogger обеспечивает возможность выбора флаги для каждого поставщика, что определенный тип данных, можно извлечь из файлов трассировки. В зависимости от поставщика можно задать следующие флаги:
    
  - **TF_Connection** Содержит записи журнала, связанные с подключением. Эти журналы включают сведения о подключениях к определенному компоненту. Кроме того, может быть включен большой объем сведений сетевого уровня (то есть для компонентов без концепции подключения).
    
  - **TF_Security** Содержит все записи событий и журналов, связанных с безопасностью. Например, для SipStack, это события безопасности, такие как ошибки проверки домена и ошибки проверки подлинности и авторизации клиентов.
    
  - **TF_Diag** Предоставляет события диагностики, которые можно использовать для диагностики и устранения неполадок компонента. Например, для SipStack это ошибки сертификатов или ошибки/предупреждения, связанные с DNS.
    
  - **TF_Protocol** Предоставляет сообщения протокола, например сообщения SIP и в сочетании пакет кодек сообщества.
    
  - **TF_Component** Ведение журнала на компонентах, определенных как часть поставщиков.
    
  - **Все** Задает доступные флаги для поставщика.
    
### <a name="to-review-information-about-existing-centralized-logging-service-scenario-providers"></a>Чтобы просмотреть сведения о существующих поставщиков сценариев для централизованной службы ведения журналов

1. Запустите командную консоль Skype для бизнеса: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Skype для бизнеса 2015** и щелкните элемент **Командная консоль Skype для бизнеса**.
    
2. Чтобы просмотреть конфигурацию существующих поставщиков, введите следующую команду:
    
   ```
   Get-CsClsScenario -Identity <scope and scenario name>
   ```

    Например, чтобы просмотреть сведения о глобальном помощнике конференц-связи, введите следующее:
    
   ```
   Get-CsClsScenario -Identity "global/CAA"
   ```

    Команда отображает список поставщиков со связанными флагами, параметрами и компонентами. Если сведения, отображаемые недостаточно или списка слишком длинный формат списка по умолчанию Windows PowerShell, вы можете отобразить дополнительные сведения, определив другой метод. Для этого выполните следующую команду:
    
   ```
   Get-CsClsScenario -Identity "global/CAA" | Select-Object -ExpandProperty Provider
   ```

    В выходе этой команды отображается каждый поставщик. Каждая запись состоит из пяти строк: имя поставщика, тип ведения журнала, уровень ведения журнала, флаги, GUID и роль. 
    
### <a name="to-define-a-new-centralized-logging-service-scenario-provider"></a>Чтобы определить новый поставщик сценария централизованной службы ведения журналов

1. Запустите командную консоль Skype для бизнеса: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Skype для бизнеса 2015** и щелкните элемент **Командная консоль Skype для бизнеса**.
    
2. Поставщик сценария состоит из отслеживаемого компонента, используемых флагов и уровня детализации собираемых данных. Это определяется следующей командой:
    
   ```
   $<variableName> = New-CsClsProvider -Name <provider component> -Type <log type> -Level <log level detail type> -Flags <provider trace log flags>
   ```

    Например, определение поставщика трассировки, которое указывает, что нужно собирать с поставщика Lyss и при каком уровне детализации, выглядит следующим образом.
    
   ```
   $LyssProvider = New-CsClsProvider -Name "Lyss" -Type "WPP" -Level "Info" -Flags "All"
   ```

-Уровня собирает критическая ошибка, ошибки, предупреждения и сведения сообщений. Флаги, используемые все соединители, определенные для поставщика Lyss и включают в себя TF_Connection, TF_Diag и TF_Protocol.After, определенного переменной $LyssProvider, можно использовать его с помощью командлета **New-CsClsScenario** сбора трассировок с поставщика Lyss. Чтобы завершить создание и назначение поставщика новому сценарию, введите следующую команду:

```
New-CsClsScenario -Identity "site:Redmond/RedmondLyssInfo" -Provider $LyssProvider
```

Где $LyssProvider — это переменная, содержащая определенный сценарий, созданный с помощью **New-CsClsProvider**.
### <a name="to-change-an-existing-centralized-logging-service-scenario-provider"></a>Чтобы изменить существующего поставщика сценария централизованной службы ведения журналов

1. Запустите командную консоль Skype для бизнеса: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Skype для бизнеса 2015** и щелкните элемент **Командная консоль Skype для бизнеса**.
    
2. Чтобы обновить или изменить конфигурацию существующего поставщика, введите следующую команду:
    
   ```
   $LyssProvider = New-CsClsProvider -Name "Lyss" -Type "WPP" -Level "Debug" -Flags "TF_Connection, TF_Diag"
   ```

    Затем обновите сценарий, чтобы назначить поставщика. Введите следующее:
    
   ```
   Set-CsClsScenario -Identity "site:Redmond/RedmondLyssInfo" -Provider $LyssProvider
   ```

Конечный результат выполнения команды — обновление флагов и уровня поставщика назначенного для сайта сценария: Redmond/RedmondLyssInfo. Новый сценарий можно просмотреть с помощью командлета Get-CsClsScenario. Дополнительные сведения см [Get-CsClsScenario](https://docs.microsoft.com/powershell/module/skype/get-csclsscenario?view=skype-ps).
> [!CAUTION]
> **New-ClsCsProvider** не проверяет, чтобы определить допустимое флаги. Убедитесь, что названия флагов указаны верно (например, TF_DIAG или TF_CONNECTION). Если названия флагов указаны неверно, поставщик не вернет ожидаемые сведения журналов.
  
Если необходимо добавить в этот сценарий дополнительных поставщиков, введите следующую команду:

```
Set-CsClsScenario -Identity "site:Redmond/RedmondLyssInfo" -Provider @{Add=$ABSProvider, $CASProvider, S4Provider}
```

Где каждый поставщик, определенный с помощью директивы Add уже был определен с помощью процесса **New-CsClsProvider** .
### <a name="to-remove-a-scenario-provider"></a>Удаление поставщика сценария

1. Запустите командную консоль Skype для бизнеса: нажмите кнопку **Пуск**, последовательно выберите пункты **Все программы** и **Skype для бизнеса 2015** и щелкните элемент **Командная консоль Skype для бизнеса**.
    
2. Приведенные командлеты позволяют обновить существующих поставщиков и создать новых. Чтобы удалить поставщика, необходимо использовать директиву заменить для параметра поставщика для **Set-CsClsScenario**. Единственным способом полностью удалить поставщика является замена его на переопределенного поставщика того же типа с тем же именем, что выполняется с помощью директивы Update. Например, наш поставщик LyssProvider определен с типом журнала WPP, уровнем "Отладка" и флагами TF_CONNECTION и TF_DIAG. Чтобы сменить флаги для «Все». Чтобы изменить поставщика, выполните следующую команду:
    
   ```
   $LyssProvider = New-CsClsProvider -Name "Lyss" -Type "WPP" -Level "Debug" -Flags "All"
   ```

   ```
   Set-CsClsScenario -Identity "site:Redmond/RedmondLyssInfo" -Provider @{Replace=$LyssProvider}
   ```

3. Если необходимо полностью удалить сценарий и связанных с ним поставщиков, выполните следующую команду:
    
   ```
   Remove-CsClsScenario -Identity <scope and name of scenario>
   ```

    Например:
    
   ```
   Remove-CsClsScenario -Identity "site:Redmond/RedmondLyssInfo"
   ```

    > [!CAUTION]
    > Командлет **Remove-CsClsScenario** не запрашивать подтверждение. Сценарий удаляется вместе со всеми назначенными ему поставщиками. Можно повторно создать сценарий, повторно выполнив команды, которые использовались для его исходного создания. Процедуры восстановления удаленных сценариев или поставщиков не существует.
  
При удалении сценария с помощью командлета **Remove-CsClsScenario** , полностью удалить сценарий из области действия. Чтобы использовать созданные сценарии и поставщиков, которые являются частью сценария, необходимо создать новых поставщиков и назначить их новому сценарию.
## <a name="see-also"></a>См. также

[Get-CsClsScenario](https://docs.microsoft.com/powershell/module/skype/get-csclsscenario?view=skype-ps)
  
[New-CsClsScenario](https://docs.microsoft.com/powershell/module/skype/new-csclsscenario?view=skype-ps)
  
[Remove-CsClsScenario](https://docs.microsoft.com/powershell/module/skype/remove-csclsscenario?view=skype-ps)
  
[SET-CsClsScenario](https://docs.microsoft.com/powershell/module/skype/set-csclsscenario?view=skype-ps)
  
[New-CsClsProvider](https://docs.microsoft.com/powershell/module/skype/new-csclsprovider?view=skype-ps)