---
title: Настройка тестовых пользователей узла-наблюдателя и параметров
ms.reviewer: ''
ms.author: v-lanac
author: lanachin
manager: serdars
ms.date: 2/13/2018
ms.audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: IT_Skype16
ms.assetid: ab2e0d93-cf52-4a4e-b5a4-fd545df7a1a9
description: 'Сводка: Настройка тестовых учетных записей пользователей и параметры узла наблюдателя для Скайп для искусственных транзакций Business Server.'
ms.openlocfilehash: f1f80632c20212a1aa9a78bc272a8bc6340c9366
ms.sourcegitcommit: bb53f131fabb03a66f0d000f8ba668fbad190778
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "33904169"
---
# <a name="configure-watcher-node-test-users-and-settings"></a>Настройка тестовых пользователей узла-наблюдателя и параметров
 
**Сводка:** Настройка тестовых учетных записей пользователей и параметры узла наблюдателя для Скайп для искусственных транзакций Business Server.
  
Настроив компьютер, который будет выступать в качестве узла-наблюдателя, выполните следующие действия.
  
1. [Настройка тестовых учетных записей пользователей](test-users-and-settings.md#testuser) для использования этих узлах. Если вы используете проверку подлинности согласованием, вам также необходимо выполнить командлет **Set-CsTestUserCredential**, чтобы разрешить использование этих учетных записей узлом-наблюдателем.
    
2. Обновите параметры конфигурации узла-наблюдателя.
    
## <a name="configure-test-user-accounts"></a>Настройка тестовых учетных записей пользователей
<a name="testuser"> </a>

Тестовые учетные записи не требуется представляют фактические людей, но они должны иметь допустимые учетные записи Active Directory. Кроме того эти учетные записи должна быть включена поддержка Скайп для Business Server, они должны иметь допустимые адреса SIP и их необходимо включить для корпоративной голосовой связи (для использования искусственная транзакция Test-CsPstnPeerToPeerCall). 
  
If you are using the TrustedServer authentication method, all you need to do is to make sure that these accounts exist and configure them as noted. Вы должны назначить по крайней мере двух тестовых пользователей для каждого пула, который требуется проверить. При использовании метода проверки подлинности Negotiate, необходимо также использовать командлет Set-CsTestUserCredential и Скайп для Business Server командную консоль, чтобы включить их тестирование учетных записей для работы с искусственные транзакции. Это можно сделать с помощью команды, подобные приведенным ниже (эти команды предполагается, что были созданы две учетные записи пользователей Active Directory и включения этих учетных записей для Скайп для Business Server):
  
```
Set-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com" -UserName "litwareinc\watcher1" -Password "P@ssw0rd"
Set-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com" -UserName "litwareinc\watcher2" -Password "P@ssw0rd"
```

Помимо SIP-адреса вам нужно также указать имя пользователя и пароль. Если вы не укажете пароль, командлет Set-CsTestUserCredential выведет соответствующий запрос. Имя пользователя можно указывать в формате "имя_домена\имя_пользователя", как показано выше.
  
Чтобы убедиться в том, что были созданы учетных данных тестовых пользователей, выполните следующие команды Скайп для консоли Business Server:
  
```
Get-CsTestUserCredential -SipAddress "sip:watcher1@litwareinc.com"
Get-CsTestUserCredential -SipAddress "sip:watcher2@litwareinc.com"
```

Команды возвращают сведения о каждом пользователе, похожие на следующие.
  
|**Имя пользователя**|**Пароль**|
|:-----|:-----|
|Litwareinc\watcher1  <br/> |System.Security.SecureString  <br/> |
   
### <a name="configure-a-basic-watcher-node-with-the-default-synthetic-transactions"></a>Настройка базового узла-наблюдателя, использующего искусственные транзакции по умолчанию

Создав тестовых пользователей, вы можете создать узел-наблюдатель с помощью следующей команды.
  
```
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com"}
```

Эта команда создает узел-наблюдатель с параметрами по умолчанию, который выполняет набор искусственных транзакций по умолчанию. Новый компьютер узла-наблюдателя также использует тестовых пользователей watcher1@litwareinc.com и watcher2@litwareinc.com. Если компьютер узла-наблюдателя использует проверку подлинности TrustedServer, два тестовые учетные записи может быть любой допустимый учетных записей пользователей для Active Directory и Скайп для Business Server. Если узел-наблюдатель использует проверку подлинности согласованием, использование этих учетных записей пользователей также должно быть включено для узла-наблюдателя с помощью командлета Set-CsTestUserCredential.
  
Чтобы проверить правильность настройки автоматического обнаружения целевого пула для входа в систему вместо непосредственного определения пула, используйте следующие действия:
  
```
New-CsWatcherNodeConfiguration -UseAutoDiscovery $true -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com"}
```

### <a name="configuring-extended-tests"></a>Настройка расширенных тестов

Если вы хотите включить тест ТСОП, проверяющий подключение к телефонной сети общего пользования, вам потребуется произвести дополнительную настройку узла-наблюдателя. Во-первых, вам нужно связать тестовых пользователей с типом теста ТСОП, выполнив следующую команду командной консоли Skype для бизнеса Server.
  
```
$pstnTest = New-CsExtendedTest -TestUsers "sip:watcher1@litwareinc.com", "sip:watcher2@litwareinc.com" -Name "Contoso Provider Test" -TestType PSTN
```

> [!NOTE]
> Результаты выполнения этой команды необходимо сохранить в переменной. В этом примере используется переменная $pstnTest. 
  
Теперь можно использовать командлет **New-CsWatcherNodeConfiguration** связывание тип теста (и сохраненная в переменной $pstnTest) для Скайп для пула Business Server. Например следующая команда создает новый конфигурации узла-наблюдателя для пула atl-cs-001.litwareinc.com, добавление двух тестовых пользователей, созданную ранее, и добавление ТСОП проверки типа:
  
```
New-CsWatcherNodeConfiguration -TargetFqdn "atl-cs-001.litwareinc.com" -PortNumber 5061 -TestUsers @{Add= "sip:watcher1@litwareinc.com","sip:watcher2@litwareinc.com"} -ExtendedTests @{Add=$pstnTest}
```

Если вы не установили основные файлы Skype для бизнеса Server и базу данных RTCLocal на компьютере узла-наблюдателя, то предыдущая команда завершится с ошибкой. 
  
Чтобы протестировать несколько политик голосовой связи, вам нужно создать расширенный тест для каждой политики с помощью командлета **New-CsExtendedTest**. Для пользователей, назначенных этому тесту, следует настроить требуемые политики голосовой связи. После этого передайте расширенные тесты в командлет **New-CsWatcherNodeConfiguration** с помощью следующих команды с разделителями запятыми.
  
-ExtendedTests @{добавьте = $pstnTest1, $pstnTest2, $pstnTest3}
  
Так как командлет **New-CsWatcherNodeConfiguration** был вызван без параметра Tests, то для нового узла-наблюдателя будут включены только искусственные транзакции по умолчанию и указанные расширенные искусственные транзакции. Это означает, что узел-наблюдатель будет тестировать следующие компоненты:
  
- Registration
    
- IM
    
- GroupIM (групповые мгновенные сообщения)
    
- P2PAV (одноранговые аудио- и видеосеансы)
    
- AvConference (аудио- и видеоконференции)
    
- Presence
    
- ABS (служба адресной книги)
    
- ABWQ (веб-служба адресной книги)
    
Следующие компоненты не будут тестироваться по умолчанию:
  
- ASConference
    
- AVEdgeConnectivity
    
- DataConference
    
- DialinConferencing
    
- ExumConnectivity (единая система обмена сообщениями Exchange)
    
- JoinLauncher
    
- MCXP2PIM (мобильных устройств обмен мгновенными сообщениями)
    
- P2PVideoInteropServerSipTrunkAV
    
- PersistentChatMessage
    
- ТСОП (вызовы шлюза ТСОП, указанные как расширенный тест)
    
- UcwaConference
    
- UnifiedContactStore
    
- XmppIM
    
### <a name="adding-and-removing-synthetic-transactions"></a>Добавление и удаление искусственных транзакций

После настройки узла-наблюдателя вы можете добавлять искусственные транзакции на узел-наблюдатель или удалять их с узла-наблюдателя с помощью командлета Set-CsWatcherNodeConfiguration. Например, чтобы добавить тест PersistentChatMessage на узел-наблюдатель, используйте следующую команду с методом Add.
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage"}
```

При указании нескольких тестов используйте запятые. Пример:
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Add="PersistentChatMessage","DataConference","UnifiedContactStore"}
```

Если один или несколько этих тестов (например, DataConference) уже были включены на узле-наблюдателе, произойдет ошибка. В этом случае вы получите следующее сообщение.
  
Set-CsWatcherNodeConfiguration : Существует повторяющаяся последовательность ключей 'DataConference' для ключа 'urn:schema:Microsoft.Rtc.Management.Settings.WatcherNode.2010:TestName' или ограничение по уникальному идентификатору.
  
Если произошла эта ошибка, изменения не применяются. Команду следует выполнить повторно, удалив повторяющийся тест.
  
Чтобы удалить искусственную транзакцию с узла-наблюдателя, используйте метод Remove. Например, следующая команда удаляет тест ABWQ с узла-наблюдателя.
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Remove="ABWQ"}
```

С помощью метода Replace вы можете заменить все тесты, включенные в настоящий момент, на один или несколько новых тестов. Например, если вы хотите, чтобы узел-наблюдатель только выполнял тест IM, вы можете использовать следующую команду.
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" -Tests @{Replace="IM"}
```

При выполнении этой команды на указанном узле-наблюдателе отключаются все искусственные транзакции, кроме IM.
  
### <a name="viewing-and-testing-the-watcher-node-configuration"></a>Просмотр и тестирование конфигурации узла-наблюдателя

Чтобы просмотреть тесты, назначенные узлу-наблюдателю, используйте следующую команду.
  
```
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests
```

Данная команда возвращает сведения, схожие со следующими (с учетом искусственных транзакций, назначенных узлу).
  
Регистрация обмена мгновенными Сообщениями GroupIM P2PAV AvConference сведения о присутствии PersistentChatMessage DataConference
> [!TIP]
> Чтобы просмотреть искусственные транзакции в алфавитном порядке, используйте следующую команду. 
  
```
Get-CsWatcherNodeConfiguration -Identity "atl-cs-001.litwareinc.com" | Select-Object -ExpandProperty Tests | Sort-Object
```

Чтобы проверить, был ли создан узел-наблюдатель, введите в командную консоль Skype для бизнеса Server следующую команду.
  
```
Get-CsWatcherNodeConfiguration
```

Команда возвращает сведения, похожие на следующие.
  
Удостоверение: atl-cs-001.litwareinc.com <br/>
TestUsers: {sip:watcher1@litwareinc.com, sip:watcher2@litwareinc.com...}<br/>
ExtendedTests : {TestUsers=IList<System.String>;Name=PSTN Test; Te...}<br/>
TargetFqdn: atl-cs-001.litwareinc.com<br/>
PortNumber: 5061<br/>

Чтобы проверить конфигурацию узла-наблюдателя, введите следующую команду в командную консоль Skype для бизнеса Server.
  
```
Test-CsWatcherNodeConfiguration
```

Данная команда проверяет каждый узел-наблюдатель в развертывании и подтверждает выполнение следующих действий:
  
- Установленные роли регистратора.
    
- Созданы требуемые разделы реестра (завершено при выполнении командлета Set-CsWatcherNodeConfiguration).
    
- Запущена ли на серверах требуемая версия Скайп для Business Server.
    
- Порты настроены правильно.
    
- Наличие у назначенных тестовых пользователей требуемых учетных данных.
    
## <a name="managing-watcher-nodes"></a>Управление узлами-наблюдателями
<a name="testuser"> </a>

В дополнение к изменению искусственных транзакций, выполняемых на узле-наблюдателе, вы можете также использовать командлет **Set-CsWatcherNodeConfiguration** для выполнения двух других важных задач: включение/отключение узла-наблюдателя и настройка узла-наблюдателя для использования внутренних URL-адресов или внешних URL-адресов при проведении тестирования.
  
По умолчанию узлы-наблюдатели периодически запускают все включенные искусственные транзакции. Однако иногда может потребоваться приостановка выполнения транзакций. Например, если узел-наблюдатель временно отключился от сети, у него больше нет причин запускать искусственные транзакции. Без сетевого подключения эти транзакции завершатся со сбоем. Для временного отключения узла-наблюдателя выполните команду, идентичную команде из командной консоли Skype для бизнеса Server:
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $False
```

Эта команда приведет к отключению выполнения искусственных транзакций на узле-наблюдателе atl watcher 001.litwareinc.com. Чтобы возобновить выполнение искусственных транзакций, снова задайте для свойства Enabled значение True ($True):
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -Enabled $True
```

> [!NOTE]
> Свойство Enabled может использоваться для включения или отключения узлов-наблюдателей. Если нет необходимости временно удалять узел-наблюдатель, используйте командлет **Remove-CsWatcherNodeConfiguration**:
  
```
Remove-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com"
```

Эта команда удаляет с указанного компьютера все параметры конфигурации узла-наблюдателя, что препятствует автоматическому запуску на этом компьютере искусственных транзакций. Тем не менее, команда не приводит к удалению Скайп для Business Server системные файлы или файлы агента System Center.
  
По умолчанию узлы-наблюдатели используют при проведении тестов внешние URL-адреса. Однако узлы-наблюдатели можно настроить для использования внутренних URL-адресов организации. Это позволит администраторам проверить доступ к URL-адресам тех пользователей, которые находятся внутри сети периметра. Чтобы настроить узел-наблюдатель для использования внутренних URL-адресов вместо внешних URL-адресов, задайте для свойства UseInternalWebURls значение True ($True):
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $True
```

Сброс этого свойства до значения по умолчанию False ($False) приведет к повторному использованию наблюдателем внешних URL-адресов:
  
```
Set-CsWatcherNodeConfiguration -Identity "atl-watcher-001.litwareinc.com" -UseInternalWebUrls $False
```

## <a name="special-setup-instructions-for-synthetic-transactions"></a>Специальные инструкции по установке для искусственных транзакций
<a name="special_synthetictrans"> </a>

Большинство искусственных транзакций может работать на узле-наблюдателе без изменений. То есть, как только искусственная транзакция добавляется в параметры конфигурации узла-наблюдателя, узел-наблюдатель может начать использовать эту искусственную транзакцию во время тестовых проходов. Однако существуют некоторые искусственные транзакции, которые нуждаются в специальных инструкциях. Такие транзакции обсуждаются в следующих разделах.
  
### <a name="data-conferencing-synthetic-transaction"></a>Искусственная транзакция в конференц-связи с передачей данных

Если компьютер узла-наблюдателя расположен за пределами сетевого периметра, скорее всего, невозможно будет запускать искусственные транзакции конференц-связи с передачей данных, если только не отключить сначала параметры прокси-сервера в интернет-браузере Windows Internet Explorer® для учетной записи сетевой службы, выполнив следующие действия.
  
1. На компьютере узла-наблюдателя щелкните кнопку **Пуск**, последовательно щелкните пункты **Все программы**, **Стандартные**, щелкните правой кнопкой мыши значок **Командная строка** и в контекстном меню выберите пункт **Запуск от имени администратора**.
    
2. В окне консоли введите следующую команду и нажмите клавишу ВВОД: 
    
```
bitsadmin /util /SetIEProxy NetworkService NO_PROXY
```

В окне командной строки отобразится следующее сообщение:
  
BITSAdmin является устаревшей, доступность для использования в следующих версиях Windows не гарантируется. Средства администрирования для службы BITS теперь предоставляются командлетами BITS PowerShell.
  
Для параметров прокси-сервера интернет-службы учетной записи NetworkService установлено значение NO_PROXY. 
  
(подключение = по умолчанию)
  
Это сообщение означает, что вы отключили параметры прокси-сервера браузера Internet Explorer для учетной записи сетевой службы.
  
### <a name="exchange-unified-messaging-synthetic-transaction"></a>Искусственная транзакция единой системы обмена сообщениями Exchange

Искусственная транзакция обмена сообщениями Exchange (UM) проверяет, что тестовые пользователи могут подключаться к учетным записям голосовой почты, которые размещаются в Exchange.
  
Для этих тестовых пользователей должны быть предварительно настроены учетные записи голосовой почты. 
  
### <a name="persistent-chat-synthetic-transaction"></a>Искусственная транзакция сохраняемого чата

Чтобы воспользоваться искусственной транзакцией сохраняемого чата, необходимо сначала создать канал и предоставить тестовым пользователям разрешения для использования.
  
Искусственную транзакцию сохраняемого чата можно использовать для настройки следующего канала: 
  
```
$cred1 = Get-Credential "contoso\testUser1"
$cred2 = Get-Credential "contoso\testUser2"

Test-CsPersistentChatMessage -TargetFqdn pool0.contoso.com -SenderSipAddress sip:testUser1@contoso.com -SenderCredential $cred1 -ReceiverSipAddress sip:testUser2@contoso.com -ReceiverCredential $cred2 -TestUser1SipAddress sip:testUser1@contoso.com -TestUser2SipAddress sip:testUser2@contoso.com -Setup $true
```

Эта задача настройки должна быть запущена изнутри предприятия:
  
- Если запустить ее с компьютера, не являющегося сервером, пользователь, запустивший командлет должен являться членом роли CsPersistentChatAdministrators в соответствии с управлением доступом на основе ролей.
    
- Если выполнить непосредственно с самого сервера, пользователь, запустивший командлет, должен являться членом группы RTCUniversalServerAdmins.
    
### <a name="pstn-peer-to-peer-call-synthetic-transaction"></a>Искусственная транзакция однорангового вызова ТСОП

Искусственная транзакция Test-CsPstnPeerToPeerCall проверяет возможность выполнять и принимать вызовы через телефонную сеть общего доступа (ТСОП).
  
Чтобы запустить искусственную транзакцию, вы должны настроить следующие элементы:
  
- Два тестовых пользователя с поддержкой UC (вызывающий и вызываемый абонент).
    
- Прямые входные номера для каждой учетной записи пользователя.
    
- Маршруты политики VoIP и голосовой связи, которые позволяют звонков на номер получателя для связи с шлюзом ТСОП.
    
- Шлюз ТСОП, который принимает звонок и мультимедиа, который будет маршрутизации вызовов в домашний пул получателя в, зависит от числа набираемым.
    
### <a name="unified-contact-store-synthetic-transaction"></a>Искусственная транзакция единой системы хранилища контактов

Искусственная транзакция единого хранилища контактов проверяет возможность Скайп Business Server для получения контактов от имени пользователя из Exchange.
  
Чтобы использовать эту искусственную транзакцию, следует выполнить следующие условия:
  
- необходимо настроить проверку подлинности сервер-сервер Lyss-Exchange;
    
- тестовые пользователи должны иметь допустимые почтовые ящики Exchange.
    
После этих условий, можно запустить следующий командлет Windows PowerShell, чтобы переносить списки контактов тестовых пользователей в Exchange:
  
```
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer -Setup
```

Перенос списков контактов тестового пользователя в Exchange может занять некоторое время. Для проверки хода выполнения миграции, то же самое командной строки можно запустить без флага - программы установки:
  
```
Test-CsUnifiedContactStore -TargetFqdn pool0.contoso.com -UserSipAddress sip:testUser1@contoso.com -RegistrarPort 5061 -Authentication TrustedServer
```

Данная команда будет выполнена по завершении процесса миграции.
  
### <a name="xmpp-synthetic-transaction"></a>Искусственная транзакция XMPP

Искусственная транзакция мгновенных сообщений XMPP нуждается в настройке компонента XMPP с указанием одного или нескольких федеративных доменов.
  
Чтобы включить искусственную транзакцию XMPP, необходимо предоставить параметр XmppTestReceiverMailAddress, используя учетную запись пользователя в домене XMPP с поддержкой маршрутизации. Пример:
  
```
Set-CsWatcherNodeConfiguration -Identity pool0.contoso.com -Tests @{Add="XmppIM"} -XmppTestReceiverMailAddress user1@litwareinc.com
```

В этом примере Скайп для правила Business Server потребуется существует для маршрутизации сообщений для домена litwareinc.com на шлюз XMPP.

> [!NOTE]
> XMPP шлюзов и прокси-серверы, доступные в Скайп для Business Server 2015, но больше не поддерживается в Скайп для Business Server 2019. Для получения дополнительных сведений в разделе [федерации XMPP миграции](../../../SfBServer2019/migration/migrating-xmpp-federation.md) . 
  
### <a name="video-interop-server-vis-synthetic-transaction"></a>Искусственная транзакция сервера видеовзаимодействия

Искусственная транзакция видео взаимодействия сервера по ДИАГОНАЛИ необходимо загрузить и установить файлы поддержки искусственная транзакция ([VISSTSupportPackage.msi](https://www.microsoft.com/en-us/download/details.aspx?id=46921)). 
  
Чтобы установить VISSTSupportPackage.msi убедитесь, что зависимости для msi уже установлены (вкладка системных требований). Запустите VISSTSupportPackage.msi для выполнения простой установки. MSI-файла устанавливает все файлы по следующему пути: «%ProgramFiles%\VIS искусственная транзакция пакет поддержки».
  
Для получения дополнительных сведений о запуске искусственных транзакций VIS обратитесь к документации для командлета [Test-CsP2PVideoInteropServerSipTrunkAV](https://technet.microsoft.com/en-us/library/dn985894.aspx) .
  
## <a name="changing-the-run-frequency-for-synthetic-transactions"></a>Изменение частоты запуска искусственных транзакций
<a name="special_synthetictrans"> </a>

По умолчанию искусственные транзакции будут выполнятся для настроенных пользователей каждые 15 минут. Искусственные транзакции выполняются последователь в пределах набора пользователей с целью предотвращения конфликтов между двумя искусственными транзакциями. Для выполнения всех искусственных транзакций необходимо указать более длительный интервал времени.
  
Если искусственные транзакции необходимо выполнять чаще, количество этих выполняемых для указанного набора пользователей транзакций необходимо уменьшить, чтобы тесты могли быть завершены в рамках требуемого периода времени с наличием небольшого запаса для случайных задержек в работе сети. При необходимости выполнения большего количества искусственных транзакций создайте больше наборов пользователей для выполнения дополнительных искусственных транзакций.
  
Чтобы изменить частоту выполнения искусственных транзакций, выполните следующие действия:
  
1. Открыть System Center Operations Manager. Нажмите раздел "Создание". Выберите раздел правила (в разделе Разработка).
    
2. В разделе правила найти правило с именем «Main искусственных транзакций средства выполнения производительности коллекции правил».
    
3. Правила, щелкните правой кнопкой мыши и выберите переопределений, установите переключатель в положение правило и выберите «для всех объектов класса: наблюдатель пула».
    
4. В окне Свойства переопределить выберите имя параметра «Частота» и установите значение переопределить нужную папку.
    
5. В том же окне выберите пакет управления, к которому необходимо применить это переопределение.
    
## <a name="using-rich-logging-for-synthetic-transactions"></a>Использование подробного журнала для искусственных транзакций
<a name="special_synthetictrans"> </a>

Искусственные транзакции доказали свою огромную пользу в рамках помощи по определению неполадок в системе. Например, командлет Test-CsRegistration может оповестить администраторов о наличии затруднений у пользователей во время регистрации в Skype для бизнеса Server. Однако для определения фактической причины неполадки могут потребоваться дополнительные сведения.
  
По этой причине искусственные транзакции предоставляют широкий набор возможностей ведения журнала. Благодаря этим возможностям для каждого активного действия искусственной транзакции записывается следующая информация:
  
- Время начала операции
    
- Время завершения операции
    
- Действие, которое было выполнено (например, создание конференции, присоединение к ней или выход, вход в Skype для бизнеса Server; отправка мгновенного сообщения)
    
- Информационные, подробные сообщения, предупреждения или сообщения об ошибках, созданные при выполнении операции.
    
- Сообщения о регистрации SIP
    
- Записи об исключениях или диагностические коды, созданные при выполнении операции
    
- Итоговый результат выполнения операции
    
Эта информация создается автоматически при каждом запуске искусственной транзакции, но автоматическое отображение или сохранение сведений в файл журнала не выполняется. Если вы запустили искусственную транзакцию вручную, можно использовать параметр OutLoggerVariable для указания переменной Windows PowerShell, в которой будет сохраняться информация. Затем у вас есть возможность использования одного из двух методов, позволяющих сохранять и/или просматривать полный журнал сообщений об ошибках в формате XML или HTML. 
  
Чтобы извлечь информацию об устранении неполадки, укажите параметр OutLoggerVariable с последующим именем переменной по своему выбору:
  
```
Test-CsRegistration -TargetFqdn atl-cs-001.litwareinc.com -OutLoggerVariable RegistrationTest
```

> [!NOTE]
> Не вводите перед имени переменной символ $. Например, используйте имя переменной RegistrationTest, а не $RegistrationTest. 
  
При выполнении данной команды будут отображены следующие выходные данные:
  
Полное доменное имя целевого: atl-cs-001.litwareinc.com результатов: сбой задержка: 00:00:00 сообщение об ошибке: этот компьютер не имеет назначенного сертификаты. Диагностика: можно получить доступ к намного более подробные сведения для Эта ошибка только сообщение об ошибке, показано ниже.

Для получения доступа к этой информации в формате HTML используйте команду, аналогичную этой, чтобы сохранить данные, хранящиеся в переменной RegistrationTest, в файл HTML:
  
```
$RegistrationTest.ToHTML() | Out-File C:\Logs\Registration.html
```

Можно также использовать метод ToXML() для сохранения данных в файл XML:
  
```
$RegistrationTest.ToXML() | Out-File C:\Logs\Registration.xml
```

Эти файлы затем можно просматривать с помощью Windows Internet Explorer, Microsoft Visual Studio или любого другого приложения, поддерживающего открытие файлов HTML/XML.
  
Искусственные транзакции, выполните в System Center Operations Manager автоматически создаются файлы журнала для сбоев. Эти журналы не будут созданы, если сбой выполнения произойдет до того, как PowerShell Skype для бизнеса Server загрузит и запустит искусственную транзакцию. 
  
> [!IMPORTANT]
> По умолчанию Скайп для Business Server сохраняет файлы журналов в папку, которая не является общей. Чтобы сделать эти журналы доступны, должны совместно использовать эту папку. Например: \\atl-watcher-001.litwareinc.com\WatcherNode. 
