---
title: Руководство по безопасности для Skype для бизнеса Online
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.reviewer: ''
ms.date: 01/22/2018
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
ms.collection: Adm_Skype4B_Online
ms.audience: Admin
appliesto:
- Skype for Business
- Skype for Business Online
- Microsoft Teams
localization_priority: Normal
f1keywords: None
ms.custom:
- Security
description: Руководство по безопасности для Skype для бизнеса Online <add description>
ms.openlocfilehash: b3ba4368cd68239ad612e5c4dfd059a100173b30
ms.sourcegitcommit: 0fa147c33b1d7b5790af8d93339700ab62939430
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2018
ms.locfileid: "19744324"
---
#  <a name="security-and-skype-for-business-online"></a>Безопасность в Skype для бизнеса Online

Skype для бизнеса Online (SfBO), входящий в состав службы Office 365, следует всем передовым методам и процедурам безопасности, таким как безопасность на уровне обслуживания, посредством глубокой защиты, контроля клиентов в рамках службы, повышения безопасности и лучшей практики работы.  Подробную информацию см. в [Центре управления безопасностью Office 365](https://products.office.com/en-us/business/office-365-trust-center-security).

## <a name="trustworthy-by-design"></a>Надежность, заложенная Конструктором
Skype для бизнеса Online разработан и разработан в соответствии с жизненным циклом разработки надежной вычислительной безопасности Microsoft (SDL), который описан в https://www.microsoft.com/en-us/sdl/default.aspx. Первым этапом создания более безопасной системы объединенных коммуникаций была разработка моделей угроз и тестирование каждого компонента по мере проектирования. В процесс и практику программирования был внесен ряд усовершенствований, связанных с безопасностью. Переполнения буфера и другие угрозы безопасности обнаруживаются средствами разработки на этапе сборки, прежде чем код будет внесен в окончательную версию продукта. Разумеется, невозможно на стадии проектирования предотвратить все неизвестные угрозы безопасности. Никакая система не может гарантировать полной безопасности. Однако, поскольку разработка продукта с самого начала основывалась на безопасных принципах разработки, Skype для бизнеса Online включает в себя стандартные технологии безопасности в качестве фундаментальной части своей архитектуры. 

## <a name="trustworthy-by-default"></a>Надежность по умолчанию
Сетевая связь в Skype для бизнеса Online зашифровывается по умолчанию. Требуя, чтобы все серверы использовали сертификаты и используя OAUTH, TLS, защищенный протокол реального времени (SRTP) и другие стандартные технологии шифрования, включая 256-битное шифрование Advanced Encryption Standard (AES), все данные для Skype для бизнеса Online защищены в сети.

## <a name="how-sfbo-handles-common-security-threats"></a>Как SfBO обрабатывает общие угрозы безопасности
В этом разделе описываются более распространенные угрозы безопасности службы SFBO и как Microsoft уменьшает риски каждой угрозы.

### <a name="compromised-key-attack"></a>Атака с использованием скомпрометированного ключа
Ключ — это секретный код или число, используемые для шифрования, расшифровки или проверки секретных сведений. В инфраструктуре открытого ключа (PKI) есть два чувствительных ключа: закрытый ключ, который имеет каждый владелец сертификата, и ключ сеанса, который используется после успешного обмена идентификационными данными и сеансом партнерами обмена.  Атака с использованием скомпрометированного ключа происходит, когда злоумышленнику удается получить закрытый ключ или ключ сеанса. После этого он может использовать полученный ключ для расшифровки зашифрованных данных без ведома отправителя.

Skype для бизнеса Online использует функции инфраструктуры открытых ключей операционной системы Windows Server для защиты данных ключей, которые применяются при шифровании данных, передаваемых по подключениям протокола Transport Layer Security (TLS). Ключи, используемые для шифрования мультимедиа, передаются по подключениям протокола TLS. 

### <a name="network-denial-of-service-attack"></a>Атака отказа в обслуживании сети
Атака типа "отказ в обслуживании" происходит, когда злоумышленнику удается нарушить нормальную работу сети и возможность ее штатного использования. С помощью атаки типа "отказ в обслуживании" злоумышленник может выполнить следующие действия:
- Отправить недействительные данные приложениям и службам, работающим в атакуемой сети, для нарушения их нормальной работы.
- Отправка больших объемов трафика, перегружающего систему, пока она не прекратит реагировать на нормальные запросы либо время реакции не замедлится.
- Сокрытие следов атаки.
- Запретить доступ пользователей к ресурсам сети.

SFBO уменьшает риски этих атак, запуская защиту сети Azure DDOS и регулируя запросы клиентов с одних и тех же конечных точек, подсетей и федеративных объектов.

### <a name="eavesdropping"></a>Прослушивание
Прослушивание осуществляется, когда злоумышленнику удается получить доступ к каналам передачи данных в сети с возможностью контролировать и просматривать трафик. Такой тип атаки также называется сканированием или слежением. Если трафик передается в виде обычного текста, злоумышленник может прочитать его, получив доступ к пути сохранения данных. Примером такой атаки является контроль маршрутизатора в составе такого пути  сохранения данных. 

SfBO использует взаимные TLS (MTLS) для серверной связи в пределах O365 и TLS от клиентов к сервису, что делает эту атаку очень трудно-почти невозможной достичь в течение периода времени, в течение которого данный разговор может быть атакован. При работе по протоколу TLS производится проверка подлинности всех участников и шифруется весь трафик. Это не защищает от прослушивания, однако злоумышленнику не удастся прочитать передаваемые данные, если только он не взломает систему шифрования.

Протокол TURN используется для целей мультимедиа в реальном времени.  Протокол TURN не требует шифрования трафика, и отправляемая с его использованием информация защищается посредством контроля целостности сообщений. Хотя этот протокол открыт для прослушивания, передаваемые по нему данные (такие как, IP-адреса и порт) можно получить непосредственно путем простого анализа исходного и конечного адресов пакета. Служба SfBO проверяет действительность информации посредством контроля целостности сообщений с помощью ключа, основанного на нескольких элементах, включая пароль TURN, который никогда не передается в виде простого текста. SRTP используется для медиа-трафика и также зашифрован.

### <a name="identity-spoofing-ip-address-spoofing"></a>Спуфинг удостоверений (спуфинг IP-адреса)
Спуфинг происходит, когда злоумышленнику удается несанкционированно определить IP-адрес сети, компьютера или элемента сети. Успешная атака позволяет злоумышленнику действовать под видом субъекта, обладающего допустимым IP-адресом. В контексте Microsoft Lync Server 2010 такая ситуация возникает только в том случае, если администратор выполнил оба из указанных ниже действий:
- Настроил подключения, поддерживающие только протокол TCP (делать этого не рекомендуется, так как данные, передаваемые по протоколу TCP, не шифруются).
- Отметил IP-адреса участников таких подключений как надежные узлы. 

Эта проблема менее актуальна для подключений по протоколу TLS, так как при обмене данными по этому протоколу производится проверка подлинности всех участников и шифрование всей информации. Использование TLS не позволяет злоумышленнику выполнить IP-спуфинг для определенного подключения (например, для взаимных соединений). При этом злоумышленник все же может подделать адрес DNS-сервера, используемого SfBO. Однако, поскольку проверка подлинности в SfBO выполняется с сертификатами, у злоумышленника не будет действительного сертификата, необходимого для спуфинга одного из участников общения.

### <a name="man-in-the-middle-attack"></a>Атака "злоумышленник в середине"
Атака типа "злоумышленник в середине" происходит, когда злоумышленнику удается перенаправить данные, которыми обмениваются два пользователя, через свой компьютер без ведома этих пользователей. В результате злоумышленник получает возможность контролировать и просматривать трафик перед его отправкой предполагаемому получателю. Каждый из участников обмена данными на самом деле обменивается трафиком со злоумышленником, думая при этом, что информация передается второму пользователю. Такая ситуация может возникнуть, если злоумышленнику удается внести изменения в доменные службы Active Directory и добавить свой сервер в качестве доверенного либо изменить систему доменных имен (DNS) таким образом, чтобы клиенты подключались к серверу через компьютер злоумышленника. 

Атака "злоумышленник в середине" также может возникать при использовании медиа-трафика между двумя клиентами, за исключением того, что в потоках аудио, видео и приложений совместного доступа SfBO шифруются с помощью SRTP, используя криптографические ключи, которые согласовываются между одноранговыми участниками используя протокол инициирования сеанса (SIP) через TLS. 

### <a name="rtp-replay-attack"></a>Атака с повторением пакетов RTP
Атака с повторением пакетов происходит при перехвате допустимых мультимедиа, которыми обмениваются две стороны, и их повторной пересылке в злонамеренных целях. SfBO использует SRTP в сочетании с протоколом безопасной сигнализации, который защищает передачи от атак с повторением пакетов, позволяя получателю поддерживать индекс уже полученных пакетов RTP и сравнивать каждый новый пакет с теми, которые уже указаны в индексе.

### <a name="spim"></a>Нежелательные мгновенные сообщения
Нежелательные мгновенные сообщения — это намеренно непредусмотренные сообщения коммерческого характера либо запросы подписки на сведения о присутствии. Хотя такие сообщения сами по себе не нарушают безопасность сети, они как минимум раздражают пользователей, ухудшают их доступность и производительность и в перспективе могут привести к нарушению сетевой безопасности. Примером является отправка пользователями нежелательных запросов друг другу. Чтобы избавиться от таких запросов, пользователи могут блокировать друг друга, однако защититься от скоординированной атаки нежелательными мгновенными сообщениями в федеративной среде сложно без отключения федерации партнера.

### <a name="viruses-and-worms"></a>Вирусы и вирусы-черви
Вирус — это единица кода, задача которого — воспроизводство идентичных единиц. Для работы вирусу нужен носитель, например файл, сообщение электронной почты или программа. Подобно вирусу, вирус-червь представляет собой единицу кода, которая кодируется для воспроизведения дополнительных похожих единиц кода, но в отличие от вируса не требуется основного приложения. Вирусы и вирусы-черви в основном появляются при обмене файлами между клиентами, а также при получении URL-адресов от других пользователей. Если вирус находится на компьютере, он может, например, использовать идентификационные данные хозяина для отправки мгновенных сообщений от его имени.  Стандартные рекомендации по безопасности клиентов, такие как периодическое сканирование вирусов, могут уменьшить эту проблему.  

## <a name="personally-identifiable-information"></a>Идентифицирующие персональные данные
SfBO потенциально может раскрывать информацию в общедоступной сети, которая может быть связана с отдельным лицом. Сведения можно отнести к двум категориям:
- **Расширенные данные о присутствии**&nbsp;&nbsp;&nbsp;Расширенные данные о присутствии - это информация, которой пользователь может по желанию делить или не делиться по ссылке со своим федеративным партнером или с контактами в организации. Эти данные не передаются пользователям в общедоступной сети обмена мгновенными сообщениями. Администратор может в определенной мере контролировать доступ к такой информации с помощью политик и других настроек клиентов. В службе SfBO расширенный режим конфиденциальности присутствия может быть настроен для отдельного пользователя, чтобы запретить пользователям SfBO, которые не находятся в списке контактов пользователя, просматривать информацию о присутствии пользователя. 
- **Mandatory data**&nbsp;&nbsp;&nbsp;Обязательные данные - это данные, необходимые для правильной работы сервера или клиента. Это сведения, которые необходимы на уровне сервера или сети для осуществления маршрутизации, поддержки состояния и передачи сигналов.
В следующих таблицах перечислены данные, необходимые для работы SfBO.

***Таблица 1 - Расширенные данные присутствия***

<!--start table here -->

||||
|:-----|:-----|:-----|
|**Данные**|**Возможные** **настройки**|
|Личные данные |Имя, Должность, Организация, Адрес электронной почты, Часовой пояс|
|Номера телефонов|Рабочий, мобильный, домашний|
|Данные календаря|Доступен/занят, уведомление об отсутствии в городе, сведения о собрании (для пользователей, имеющих доступ к Календарю)| 
|Состояние присутствия|Отсутствует, Доступен, Занят, Не беспокоить, Не в сети|
|||||

<!-- end of table -->

***Таблица 2 - Обязательные данные***

<!--start table here -->

||||
|:-----|:-----|:-----|
|**Категория** |**Возможные настройки** |
|IP-адрес|Фактический адрес компьютера или адрес NAT|
|Универсальный код ресурса (URI) SIP|<u>david.campbell@contoso.com</u>|
|Имя|Дэвид Кэмпбелл (как определено в доменных службах Active Directory)|
|||||

<!-- end of table -->

## <a name="security-framework-for-sfbo"></a>Рамки безопасности для SfBO
В этом разделе представлен обзор основных элементов, формирующих платформу безопасности для Microsoft SfBO. Ниже представлены эти элементы:
- Azure Active Directory (AAD) предоставляет единый надежный репозиторий для пользовательских учетных записей. 
- Инфраструктура открытых ключей (PKI) использует сертификаты, выданные доверенными центрами сертификации (ЦС) с целью проверки подлинности серверов и обеспечения целостности данных.
- Безопасность на транспортном уровне (TLS), передача HTTPS по SSL (HTTPS) и взаимные подключения по протоколу TLS (MTLS) позволяют выполнять проверку подлинности конечной точки и шифровать обмен мгновенными сообщениями. Потоки обмена аудио, видео и приложений "точка-точка" шифруются и проверяются на целостность с использованием протокола безопасной транспортировки в режиме реального времени (SRTP).
- Протоколы отраслевых стандартов для проверки подлинности пользователя, по мере возможности.

В темах этого раздела описан способ работы каждого основного элемента для повышения уровня безопасности инфраструктуры SfBO.

### <a name="azure-active-directory"></a>Azure Active Directory
Azure Active Directory функционирует как служба каталогов для O365. В нем хранятся все данные справочника пользователя и назначения политик. 

### <a name="public-key-infrastructure-for-sfbo"></a>Инфраструктура открытого ключа для SfBO
Служба SfBO полагается на сертификаты для проверки подлинности сервера и устанавливает цепочку доверия между клиентами и серверами и между различными ролями сервера. Инфраструктура открытого ключа Windows Server (PKI) предоставляет инфраструктуру для установления и проверки этой цепи доверия.
Сертификаты представляют собой цифровые удостоверения. Они определяют сервер по имени и указывают его свойства. Чтобы убедиться, что информация о сертификате действительна, сертификат должен быть выдан центром сертификации (ЦС), которому доверяют клиенты или другие серверы, подключающиеся к серверу. Если сервер подключается только к другим клиентам и серверам в частной сети, ЦС может являться корпоративным ЦС. Если сервер взаимодействует с объектами за пределами частной сети, может потребоваться общедоступный ЦС.

Даже при условии действительности сведений сертификата необходим способ проверки того, что представляющий сертификат сервер фактически является тем, который представлен сертификатом. Именно в этом случае используется Windows PKI.
Каждый сертификат связан с открытым ключом. Сервер, который указан в сертификате, содержит соответствующий известный только ему закрытый ключ. Подключаемый клиент или сервер использует открытый ключ для шифрования произвольной части сведений и отправляет его на сервер. Если сервер расшифровывает эти сведения и возвращает их в виде обычного текста, подключаемый объект может быть уверен в том, что сервер содержит закрытый ключ для сертификата и, следовательно, является указанным в сертификате сервером.

#### <a name="crl-distribution-points"></a>Точки распространения списка отзыва сертификатов (CRL)
SfBO требует, чтобы все сертификаты сервера содержали одну или несколько точек распространения списка отзыва сертификатов (CRL). Точки распространения списка отзыва сертификатов (CDP) представляют собой местоположения, из которых можно загрузить CRL для проверки того, что сертификат не был отозван с момента выдачи и его срок действия не истек. Точка распространения CRL отмечена в свойствах сертификата как URL-адрес и является защищенным HTTP.  Служба SfBO проверяет CRL с каждой  проверкой подлинности сервера сертификата.

#### <a name="enhanced-key-usage"></a>Расширенное использование ключа
Все компоненты службы SfBO требуют, чтобы все сертификаты сервера поддерживали расширенное использование ключа (EKU) для  проверки подлинности сервера. Настройка поля EKU для проверки подлинности сервера означает, что сертификат действителен для проверки подлинности сервера. Использование EKU важно для MTLS. 

### <a name="tls-and-mtls-for-sfbo"></a>TLS и MTLS для SfBO
Протоколы TLS и MTLS обеспечивают шифрование и аутентификацию конечных точек в Интернете. SfBO использует эти два протокола для создания сети доверенных серверов и обеспечения шифрования всех коммуникаций в этой сети. Весь обмен данными по протоколу SIP между серверами происходит по протоколу MTLS. Обмен данными по протоколу SIP от клиента к серверу выполняется по протоколу TLS.

Протокол TLS позволяет пользователям посредством их клиентского программного обеспечения выполнять проверку подлинности серверов SfBO, к которым они подключаются. При подключении по протоколу TLS клиент запрашивает от сервера действительный сертификат. Чтобы сертификат был действительным, он должен быть выдан ЦС, который также является доверенным объектом клиента, а имя DNS должно соответствовать имени сертификата. Если сертификат действительный, клиент использует открытый ключ в сертификате для шифрования симметричных ключей шифрования, которые будут использоваться для обмена данными, поэтому только исходный владелец сертификата может использовать закрытый ключ для шифрования содержимого сеанса обмена данными. Результатом является доверенное подключение, которое после этого уже не проверяется другими доверенными серверами или клиентами. В рамках этого контекста протокол SSL, используемый веб-службами, может быть связан как протокол на базе TLS.

Соединения между серверами основаны на взаимном TLS (MTLS) для взаимной проверки подлинности. В подключениях по протоколу MTLS создавший сообщение сервер и сервер, который получает его, обмениваются сертификатами из ЦС со взаимным доверием. Сертификаты подтверждают удостоверение каждого из серверов по отношению друг к другу. В службе SfBO, выполняется следующая процедура.

TLS и MTLS помогают предотвратить как перехватывание, так и атаки "злоумышленник в середине". В атаке "злоумышленник в середине" злоумышленник перенаправляет связь между двумя сетевыми объектами через компьютер злоумышленника без ведома любой из сторон. Спецификация TLS и SfBO доверенных серверов снижает риск атаки "злоумышленник в середине" частично на уровне приложения, используя сквозное шифрование, скоординированное с использованием криптографии с открытым ключом между двумя конечными точками, и злоумышленник должен будет иметь действительный и доверенный сертификат с соответствующим закрытым ключом и выданный от имени службы, которой клиент сообщает о дешифровании сообщения. 

### <a name="encryption-for-sfbo"></a>Шифрование для SfBO
SfBO использует TLS и MTLS для шифрования мгновенных сообщений. Для трафика от сервера к серверу требуется MTLS, независимо от того, ограничивается ли трафик внутренней сетью или пересекает внутренний периметр сети.

В следующей таблице представлен протокол, используемый SfBO.

***Таблица 3 - Защита трафика***

<!--start table here with header -->


|||
|:-----|:-----|
|**Тип трафика**|**Защита**|
|Сервер-сервер|Протокол MTLS|
|Клиент-сервер|Протокол TLS|
|Мгновенные сообщения и присутствие|TLS (если настроено для TLS)|
|Аудио/видео и рабочий стол для общего доступа к мультимедиа|SRTP|
|Общий доступ к рабочему столу (передача сигналов)|Протокол TLS|
|веб-конференции|Протокол TLS|
|Загрузка содержимого собрания, загрузка адресной книги, расширение группы рассылки|HTTPS|
|||

<!-- end of table -->

#### <a name="media-encryption"></a>Шифрование мультимедиа
Трафик мультимедиа шифруется по протоколу SRTP, профилю протокола RTP, который обеспечивает конфиденциальность, проверку подлинности и защиту от атак с повторением пакетов для трафика RTP. SRTP использует ключ сеанса, сгенерированный с использованием защищенного генератора случайных чисел и обмениваемый с использованием канала TLS сигнализации. Кроме того, потоки мультимедиа в обоих направлениях между сервером-посредником и его внутренним узлом следующего прыжка также шифруются с помощью SRTP. 

SfBO генерирует имя пользователя/пароли для безопасного доступа к мультимедийным реле через TURN. Мультимедийное реле обмениваются именем пользователя/паролем через SIP-канал с поддержкой TLS.

#### <a name="fips"></a>FIPS
SfBO использует алгоритмы FIPS (Federal Information Processing Standard) для обмена ключами шифрования. 

### <a name="user-and-client-authentication"></a>Проверка подлинности пользователей и клиентов 
Доверенным пользователем является тот, чьи учетные данные были аутентифицированы AAD в O365. 

Проверка подлинности представляет собой предоставление учетных данных пользователя доверенному серверу или службе. SfBO использует следующие протоколы проверки подлинности, в зависимости от состояния и местоположения пользователя.
- **Современная проверка подлинности** является реализацией Microsoft OAUTH 2.0 для взаимодействия клиента с сервером. Она включает функции безопасности, такие как проверка подлинности на основе сертификатов O365, многофакторная проверка подлинности O365 и условный доступ O365.  Чтобы использовать MA, для онлайн-арендатора и клиентов необходимо включить MA.  У арендаторов SfBO, созданных после мая 2017 года, MA включен по умолчанию.  Для арендаторов, созданных до этого времени, следуйте инструкциям здесь, чтобы включить его.  Следующие клиенты поддерживают MA: Skype для бизнеса  2015 или 2016, Skype для бизнеса  on Mac, Lync 2013 client, IP-телефоны 3PIP, iOS и Android. 
- **Org ID** используется, когда современная проверка подлинности Modern Authentication не включена (или недоступна)
- **Дайджест-проверка** для так называемых анонимных пользователей. Анонимные пользователи — это внешние пользователи, которые не имеют распознанных учетных данных Active Directory, но были приглашены в локальную конференцию и обладают действительным ключом конференции. Дайджест-проверка подлинности не используется для других клиентских взаимодействий.

Проверка подлинности SfBO состоит из двух этапов:
1. Между клиентом и сервером устанавливается сопоставление безопасности.
2. Клиент и сервер используют существующее сопоставление безопасности для подписи сообщений, которые они отправляют, и для проверки получения сообщений. Не прошедшие проверку подлинности сообщения от клиента не принимаются при включенной на сервере проверке подлинности.

Доверие пользователя прикрепляется к каждому сообщению, которое исходит от пользователя, но не к удостоверению пользователя. Сервер проверяет каждое сообщение на наличие действительных учетных данных пользователя. Если учетные данные пользователя допустимы, сообщение принимается не только первым получившим его сервером, но и всеми другими серверами в SfBO.

Пользователи с действительными выданными федеративным партнером учетными данными являются доверенными, но к ним могут применяться другие ограничения привилегий, которые полностью доступны внутренним пользователям.

Для проверки подлинности мультимедиа протоколы ICE и TURN также используют запрос защиты хэш-тега, как описано в IETF TURN RFC. Подробнее см. [обход мультимедиа](#external-user-av-traffic-traversal).

Сертификаты клиента позволяют выполнять проверку подлинности пользователей с помощью SFBO. Вместо предоставления имени пользователя и пароля пользователи имеют сертификат и закрытый ключ, соответствующий необходимому для решения криптографической задачи сертификату. 

### <a name="windows-powershell-and-sfbo-management-tools"></a>Средства управления Windows PowerShell и SfBO
В SfBO ИТ-администраторы могут управлять своим сервисом через портал администратора O365 или с помощью Tenant Remote PowerShell (TRPS).  Администраторы-арендаторы используют современную проверку подлинности для аутентификации в TRPS.

### <a name="configuring-access-to-sfbo-at-your-internet-boundary"></a>Настройка доступа к SfBO на границе вашего интернета
Настраивая доступ к SfBO в вашей интернет-границе для правильной работы SfBO (пользователи могут присоединиться к собраниям и т. д.), клиентам необходимо настроить свой интернет-доступ, чтобы разрешался исходящий UDP и TCP-трафик на службы в облаке SfBO.  Для более подробной информации смотрите здесь: https://support.office.com/en-us/article/Office-365-URLs-and-IP-address-ranges-8548a211-3fe7-47cb-abb1-355ea5aa88a2#bkmk_lyo 

### <a name="udp-3478-3481-and-tcp-443"></a>UDP 3478-3481 и TCP 443

Порты UDP 3478-3481 и TCP 443 используются клиентами для запроса службы из службы A/V Edge. Клиент использует эти два порта для распределения портов UDP и TCP соответственно для удаленной стороны для подключения. Чтобы получить доступ к службе A/V Edge, клиент должен сначала установить аутентифицированный сеанс сигнализации SIP с регистратором SFBO для получения прошедших проверку подлинности учетных данных A/V Edge. Эти значения отправляются по сигнальному каналу, защищенному TLS, и генерируются компьютером для уменьшения рисков атак перебором по словарю. Затем клиенты могут использовать эти учетные данные для аутентификации дайджеста с помощью службы A/V Edge для распределения портов для использования в сеансе мультимедиа. Первоначальный запрос на распределение отправляется от клиента и отвечает сообщением 401 nonce/challenge от службы A/V Edge. Клиент отправляет второй запрос на распределение, содержащий имя пользователя, и хэш сообщение кода проверки подлинности (HMAC) хэш-имени пользователя и nonce. 

Для предотвращения повторных атак используется механизм последовательности номеров. Сервер вычисляет ожидаемый HMAC на основе собственных знаний о имени пользователя и пароле, и если значения HMAC совпадают, выполняется процедура распределения. В противном случае пакет будет удален. Этот же механизм HMAC также применяется к последующим сообщениям в рамках этого сеанса вызова. Срок действия этого имени пользователя/пароля составляет не более восьми часов, после чего клиент повторно запрашивает новое имя пользователя/пароль для последующих вызовов.

### <a name="udptcp-50000-59999"></a>UDP/TCP 50 000– 59 999
Исходный протокол TCP 50 000 используется для SfBO, в том числе для совместного использования приложений и компьютеров, передачи файлов. Диапазоны портов UDP/TCP 50 000-59 999 используются для сеансов мультимедиа с партнерами Microsoft Office Communications Server 2007, которым требуется служба обхода NAT/брандмауэра из службы A/V Edge. Поскольку служба A/V Edge является единственным процессом, использующим эти порты, размер диапазона портов не указывает на потенциальную поверхность атаки. Хорошая практика безопасности заключается в том, чтобы всегда минимизировать общее количество прослушивающих портов, не запуская ненужных сетевых сервисов. Если сетевая услуга не запущена, она не может быть использована удаленным злоумышленником, а поверхность атаки главного компьютера будет уменьшена. Однако, в рамках единой службы, сокращение количества портов не дает такой же выгоды. Программное обеспечение сервисного обслуживания A/V Edge больше не подвергается атаке, при этом 10 000 портов открыты, как и в случае с 10. Выделение портов в этом диапазоне выполняется произвольно, а порты, которые в настоящее время не выделены, не прослушивают пакеты.
 
### <a name="external-user-av-traffic-traversal"></a>Обход A/V трафика по внешнему пользователю
Для включения внешних пользователей и внутренних пользователей для обмена носителями требуется служба Access Edge для обработки сигнализации SIP, необходимой для настройки и срыва сеанса. Он также требует, чтобы служба A/V Edge выступала в качестве реле для передачи мультимедиа. Последовательность вызовов показана на следующем рисунке.


![Последовательность вызовов в Meeting Join](media/sfbo-call-sequence-security.png) 

1. Пользователь получает электронное письмо с приглашением присоединиться к собранию SfBO. В электронном письме содержится ключ конференции и URL-адрес, основанный на HTTP и ссылaющийся на конференцию. И ключ, и URL-адрес уникальны для конкретного собрания.<p>Пользователь инициирует процедуру соединения, щелкнув URL-адрес собрания в письме, которое инициирует процесс обнаружения клиента на машине пользователя.  Если клиент обнаружен, этот клиент запускается.  Если он не обнаружен, пользователь перенаправляется на веб-клиент.<p/>
2. Клиент SfBO отправляет SIP INVITE, содержащий учетные данные пользователя. Объединенный или удаленный пользователь присоединяется к конференции, используя свои учетные данные предприятия. Для федеративного пользователя SIP INVITE сначала отправляется на его или ее домашний сервер, который проверяет подлинность пользователя и перенаправляет INVITE на SfBO. Анонимный пользователь должен пройти проверку подлинности дайджеста.<p>SfBO проверяет подлинность удаленного или анонимного пользователя и уведомляет клиента. Как упомянуто в шаге 2, федеративные пользователи, присоединяющиеся к конференции, аутентифицируются своим предприятием.<p/>

3. Клиент отправляет запрос INFO для добавления пользователя на конференцию A/V.

    A/V-конференции отправляют ответ «Добавить пользователя», содержащий маркер, который должен присутствовать в службе AV Conferencing Edge, среди другой информации.

    [Примечание] Весь предыдущий SIP-трафик протекал через службу Access Edge.

    Клиент подключается к серверу конференций A/V, который проверяет маркер и проксирует запрос, который содержит другой маркер авторизации, на внутренний сервер конференций A/V Сервер конференций A/V Conferencing Server проверяет маркер авторизации, который он изначально выдал по каналу SIP, чтобы гарантировать, что действительный пользователь присоединится к конференции.
    
4. Между клиентом и сервером конференций AV, мультимедийное соединение согласовывается и настраивается по SRTP.
5. Пользователь получает электронное письмо с приглашением присоединиться к собранию SfBO. В электронном письме содержится ключ конференции и URL-адрес, основанный на HTTP и ссылaющийся на конференцию. И ключ, и URL-адрес уникальны для конкретного собрания.

### <a name="federation-safeguards-for-sfbo"></a>Защита Федерации для SfBO
Федерация предоставляет вашей организации возможность общаться с другими организациями для обмена мгновенными сообщениями и присутствием. В SfBO федерация включена по умолчанию.  Тем не менее, администраторы-арендаторы имеют возможность контролировать это через портал администратора O365.  См. больше.

## <a name="addressing-threats-to-sfbo-conferences"></a>Устранение угроз в конференциях SfBO

SfBO предоставляет возможность корпоративным пользователям создавать и присоединяться к веб-конференциям в режиме реального времени. Пользователи предприятия могут также приглашать внешних пользователей, у которых нет учетной записи AAD/O365, для участия в этих собраниях. Пользователи, нанятые федеративными партнерами с надежной и аутентифицированной личностью, также могут участвовать в собраниях и, если они будут повышены уровнем, могут выступать в качестве докладчиков. Анонимные пользователи не могут создавать или присоединяться к собранию в качестве докладчика, но после того, как они присоединяются, они могут быть повышены уровнем в качестве докладчиков.

Включение внешних пользователей для участия в собраниях SfBO значительно увеличивает ценность этой функции, но также влечет за собой некоторые риски для безопасности. Чтобы устранить эти риски, SfBO предоставляет следующие дополнительные гарантии:
- Роли участников определяют права на управление конференцией.
- Типы участников позволяют ограничить доступ к определенным собраниям.
- Определенные типы собраний определяют, какие типы участников могут принимать участие.
- Планирование конференции ограничено пользователями, имеющими учетную запись AAD и лицензию SfBO.
- Анонимные пользователи, желающие присоединиться к конференции с телефонным подключением, набирают один из номеров доступа к конференции, а затем у них запрашивается удостоверение конференции. Не прошедшим проверку подлинности анонимным пользователям также предлагается записать свое имя. Записанные имена идентифицируют неавторизованных пользователей в конференции. Анонимные пользователи не допускаются в конференцию, пока к ней не присоединится хотя бы один авторизованный пользователь или ведущий, и анонимным пользователям нельзя назначать предопределенную роль.

### <a name="participant-roles"></a>Роли участников
Участники собрания делятся на три группы, каждая из которых имеет свои привилегии и ограничения:
- **Организатор**&nbsp;&nbsp; Пользователь, который создает собрание — импровизированное или запланированное. Организатор должен быть прошедшим проверку подлинности пользователем предприятия и иметь контроль над всеми аспектами конечного пользователя собрания.
- **Докладчик**&nbsp;&nbsp;Пользователь, авторизованный представлять информацию на совещании, используя любое мультимедиа. Организатор собрания по определению также является докладчиком и определяет, кто еще может быть докладчиком. Организатор может принять это решение, когда собрание запланировано или во время проведения собрания.
- **Участник**&nbsp;&nbsp;Пользователь, приглашенный для участия в собрании, но не уполномоченный выступать в качестве докладчика.

Докладчик может также способствовать повышению уровня участника в роли докладчика во время собрания.

### <a name="participant-types"></a>Типы участников

Участники собрания также классифицируются по местоположению и учетным данным. Вы можете использовать обе эти характеристики, чтобы указать, какие пользователи могут иметь доступ к конкретным собраниям. Пользователи могут быть разделены на несколько категорий:
1.  **Пользователи, принадлежащие арендатору**&nbsp;&nbsp; Эти пользователи имеют учетные данные в Azure Active Directory для арендатора.<br/>
    а. *Внутренняя корпоративная сеть* – эти пользователи присоединяются изнутри корпоративной сети.<br/>б. *Удаленные пользователи* - эти пользователи подключаются за пределами корпоративной сети. К ним относятся сотрудники, которые работают дома или в дороге, и другие, например, сотрудники доверенных поставщиков, которым были предоставлены полномочия предприятия на их условиях обслуживания. Удаленные пользователи могут создавать и присоединяться к конференциям и выступать в качестве докладчиков.
2.  **Пользователи, принадлежащие арендатору**&nbsp;&nbsp;Эти пользователи имеют учетные данные в Azure Active Directory для арендатора.<br/>а. *Федеративные пользователи* - Федеративные пользователи имеют допустимые учетные данные с федеративными партнерами и поэтому рассматриваются как прошедшие проверку подлинности у SFBO. Федеративные пользователи могут участвовать в конференциях и быть повышены уровнем в качестве докладчиков после того, как они присоединились к совещанию, но они не могут создавать конференции на предприятиях, с которыми они объединены.<br/>б. *Анонимные пользователи* - Анонимные пользователи не имеют удостоверения Active Directory и не объединены с арендатором. 

Данные клиентов показывают, что во многих конференциях участвуют внешние пользователи. Те же клиенты также хотят получить подтверждение об удостоверении внешних пользователей, прежде чем позволить этим пользователям присоединиться к конференции. Как описано в следующем разделе, SfBO ограничивает доступ тем пользовательским типам, которые были явно разрешены, и требует, чтобы все типы пользователей представляли соответствующие учетные данные при входе в совещание.

### <a name="participant-admittance"></a>Прием участника
В SfBO анонимные пользователи переносятся в зону ожидания, называемую "зал ожидания". Затем участники могут либо допустить этих пользователей на совещание, либо отклонить их. Эти пользователи переносятся в "зал ожидания", лидер уведомляется, и затем пользователи ждут, пока лидер либо примет, либо отклонит их, либо их время соединения истечёт. Тем временем в"зале ожидания" пользователи слышат музыку. 

По умолчанию участники, набирающие номер из PSTN, отправляются непосредственно на совещание, но этот параметр можно изменить, чтобы заставить участников набора номера перейти в "зал ожидания".  
Организаторы совещания контролируют, могут ли участники присоединиться к совещанию, не ожидая в "зале ожидания". Каждое совещание может быть настроено для обеспечения доступа с использованием любого из следующих способов:
- **Только я, организатор совещания**&nbsp;&nbsp;Все, кроме организатора, должны ожидать в "зале ожидания" до тех пор, пока не будут допущены.
- **Людей, которых я приглашаю из своей компании**&nbsp;&nbsp;Любой человек из вашей компании может напрямую попасть на совещание, даже если его не пригласят.
- **Любой из моей организации**&nbsp;&nbsp;Все пользователи SfBO в арендаторе O365 могут присоединиться к совещанию, не ожидая в "зале ожидания", даже те, кто не входит в список рассылки. Все остальные, включая всех внешних и анонимных пользователей, должны ожидать в "зале ожидания" до тех пор, пока не будут допущены.
- **Кто угодно**&nbsp;&nbsp;Любой (без ограничений), у кого есть доступ к ссылке совещания, попадает непосредственно на совещание.
Если указан какой-либо метод, кроме Организатора (заблокирован), организатор совещания также может указать, что люди набирают номер по телефону в обход "зала ожидания". 

### <a name="presenter-capabilities"></a>Возможности докладчика
Организаторы совещаний контролируют, могут ли участники присутствовать во время совещания. Каждое совещание может быть настроено таким образом, чтобы лимитировать докладчиков одним из следующих:
- **Только организатор**&nbsp;&nbsp; Может присутствовать только организатор совещания.
- **Люди из моей компании**&nbsp;&nbsp; Все внутренние пользователи могут представлять доклад.
- **Все, включая людей вне моей компании**&nbsp;&nbsp; Все (нет ограничений), которые могут присоединиться к совещанию.
- **Люди, которых я выбираю**&nbsp;&nbsp;Организатор совещания определяет, какие пользователи могут присутствовать, добавив их в список докладчиков.

## <a name="learn-more"></a>Дополнительные сведения
[Центр управления безопасностью Office 365](https://products.office.com/en-us/business/office-365-trust-center-security)