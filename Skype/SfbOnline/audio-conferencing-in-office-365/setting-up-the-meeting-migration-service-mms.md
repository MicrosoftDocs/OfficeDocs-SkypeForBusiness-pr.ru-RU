---
title: Использование службы переноса собраний (MMS)
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.reviewer: oscarr
ms.topic: article
ms.assetid: 031f09c0-9d2a-487a-b6db-b5d4bed6d16a
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection:
- Adm_Skype4B_Online
- Strat_SB_PSTN
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
ms.localizationpriority: medium
f1.keywords:
- NOCSH
ms.custom:
- Audio Conferencing
description: Служба переноса собраний (MMS) — это служба, которая работает в фоновом режиме и автоматически обновляет Skype для бизнеса и Microsoft Teams собрания для пользователей. Эта служба позволяет пользователям не запускать средство переноса собраний для обновления собраний Skype для бизнеса и Microsoft Teams.
ms.openlocfilehash: 008974d71d92667da96316aafa7b8c4adf478026
ms.sourcegitcommit: 15e90083c47eb5bcb03ca80c2e83feffe67646f2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2021
ms.locfileid: "58726698"
---
# <a name="using-the-meeting-migration-service-mms"></a>Использование службы переноса собраний (MMS)

Служба переноса собраний (MMS) обновляет существующие собрания пользователя в следующих сценариях:

- При миграции пользователя из локальной сети в облако (как в Skype для бизнеса Online, так и в TeamsOnly).
- Изменение параметров аудиоконференции для пользователя 
- Когда пользователь в сети обновляется только Teams или когда для его режима в TeamsUpgradePolicy задается SfBwithTeamsCollabAndMeetings
- При использовании PowerShell 


По умолчанию MMS автоматически активируется в каждом из этих случаев, хотя администраторы могут отключить ее на уровне клиента. Кроме того, администраторы могут запускать перенос собраний вручную с помощью powerShell для определенного пользователя.


**Ограничения. Службу** переноса собраний нельзя использовать, если применяются следующие правила:

- Почтовый ящик пользователя находится в Exchange локально.
- Пользователь будет перенесен из облака в Skype для бизнеса Server локальной сети.


## <a name="how-mms-works"></a>Как работает MMS

При запуске MMS для данного пользователя запрос на миграцию помещается в очередь. Чтобы избежать каких-либо условий в очереди, запрос в очереди обрабатывается преднамеренно до тех пор, пока не продлятся по крайней мере 90 минут. После обработки запроса MMS выполняет следующие задачи:

1. Оно выполняет поиск всех собраний, организованных этим пользователем и запланированных в будущем, в почтовом ящике этого пользователя.
2. На основе сведений, найденных в почтовом ящике пользователя, оно обновляет или планировать новые собрания в Teams или Skype для бизнеса Online для этого пользователя в зависимости от конкретного сценария.
3. В сообщении электронной почты он заменяет блок собрания по сети в сведениях о собрании.
4. Обновленная версия собрания отправляется всем получателям собрания от имени организатора собрания. Приглашенные на собрание получат обновление с обновленными координатами собрания в своих сообщениях электронной почты. 

    ![Блок собраний, обновляемый MMS.](../images/210a03ee-30c1-46f3-808f-4c2ebdaa3ea1.png)

С момента запуска MMS обычно занимает около 2 часов до переноса собраний пользователя. Однако если у пользователя много собраний, это может занять больше времени. Если MMS столкнулась с ошибкой при переносе одного или нескольких собраний для пользователя, она будет периодически повторить попытку до 9 раз в течение 24 часов.

**Примечания:**

- При переносе собрания MMS заменяет все сведения в блоке информации о собрании по сети. Если же пользователь изменил этот блок, внесенные им изменения будут перезаписаны. Все остальные данные в сведениях о собрании, за исключением этого блока, останутся нетронутыми. Это означает, что все файлы, вложенные в приглашение на собрание, будут по-прежнему включены. 
- Переносятся только те собрания Skype для бизнеса или Microsoft Teams, которые были запланированы с помощью кнопки **Добавить собрание Skype** в Outlook в Интернете или с помощью надстройки "Собрание Skype" для Outlook. Если пользователь копирует и Skype сведения о собрании по сети из одного собрания в новое, это новое собрание не будет обновлено, так как в исходной службе нет собрания.
- Содержимое собрания, созданное или присоединенное к собранию (доски, опросы и т. д.), не будет храниться после того, как MMS начнется. Если организаторы собрания заранее прикрепили содержимое к собраниям, после того как MMS начнет работать, его потребуется воссоздать.
- Ссылки на общие заметки собрания в элементе календаря и в собрании Skype также будут перезаписаны. Обратите внимание, что фактические заметки к собранию, хранимые в OneNote, по-прежнему будут там; перезаписывается только ссылка на общие заметки.
- Собрания с числом участников больше 250 (включая организатора) не будут перенесены.
- Некоторые символы ЮНИКОДа в теле приглашения могут быть неправильно обновлены до одного из следующих специальных символов: и, знаки ,,, 1/2, .

## <a name="triggering-mms-for-a-user"></a>Запуск MMS для пользователя

В этом разделе описано, что происходит при запуске MMS в каждом из следующих случаев:

- При миграции пользователя из локальной сети в облако
- Изменение параметров аудиоконференции для пользователя 
- Когда в режиме пользователя в TeamsUpgradePolicy установлено имя TeamsOnly или SfBWithTeamsCollabAndMeetings (с помощью Powershell или портала администрирования Teams)
- При использовании powerShell используйте Start-CsExMeetingMigration

### <a name="updating-meetings-when-you-move-an-on-premises-user-to-the-cloud"></a>Обновление собраний при помещении локального пользователя в облако

Это самый распространенный сценарий, в котором MMS помогает создать более плавный переход для пользователей. Без переноса собраний существующие собрания, организованные пользователем Skype для бизнеса Server локальной сети, перестанут работать после его переноса в интернет-службу. Поэтому при использовании средств локального администрирования (или панели управления администратором) для перемещения пользователя в облако существующие собрания автоматически перемещаются в облако следующим `Move-CsUser` образом:

- Если задан переключатель, собрания переносятся непосредственно в Teams и пользователь будет работать `MoveToTeams` `Move-CsUser` в режиме TeamsOnly. Для использования этого переключателя требуется Skype для бизнеса Server 2015 с cu8 или более поздней. Эти пользователи по-прежнему могут присоединиться к Skype для бизнеса собраниям, на которые они могут быть приглашены, используя клиент Skype для бизнеса или приложение Skype для собраний.
- В противном случае собрания переносются в Skype для бизнеса Online.

В любом случае, если пользователю была назначена лицензия на аудиоконференцию перед его перемещением в облако, собрания будут создаваться с координатами телефонного связи. Если вы переместите пользователя из локальной службы в облако и предполагаете, что он будет использовать аудиоконференции, рекомендуем сначала назначить аудиоконференции перед перемещением пользователя, чтобы запускалась только одна миграция собрания.


### <a name="updating-meetings-when-a-users-audio-conferencing-settings-change"></a>Обновление собраний при изменении параметров аудиоконференции для пользователя

В следующих случаях MMS обновляет существующие Skype для бизнеса и Microsoft Teams собрания, чтобы добавлять, удалять и изменять координаты телефонного дозвона:

- Если вы назначаете или удаляете лицензию на службу аудиоконференций Майкрософт для пользователя, но он не может быть включен сторонним поставщиком аудиоконференций.
- При смене поставщика аудиоконференций пользователя с любого другого поставщика на Майкрософт при условии, что пользователю назначена лицензия на аудиоконференцию Майкрософт. Дополнительные сведения см. в том, как назначить Майкрософт поставщиком услуг [аудиоконференций.](./assign-microsoft-as-the-audio-conferencing-provider.md) Обратите внимание также, что срок поддержки сторонних поставщиков аудиоконференций [ACP] планируется на 1 апреля 2019 г., как было объявлено [ранее.](../legal-and-regulatory/end-of-integration-with-3rd-party-providers.md)
- Если включить или отключить аудиоконференцию для пользователя.
- При изменении или сбросе ИД конференции для пользователя, настроенного для использования общедоступных собраний.
- При переключении пользователя на новый мост аудиоконференции.
- Если номер телефона для моста аудиоконференции не назначен. Это сложный сценарий, который требует дополнительных действий. Дополнительные сведения см. в сведениях Об изменении [номеров телефонов](/MicrosoftTeams/change-the-phone-numbers-on-your-audio-conferencing-bridge)на мосте аудиоконференции.

Не все изменения в параметрах аудиоконференции для пользователя приводят к запуску MMS. В частности, MMS не будет обновлять собрания в двух следующих случаях:

- При изменении SIP-адреса организатора собрания (его имени пользователя SIP или домена SIP)
- При изменении URL-адреса собрания организации с помощью `Update-CsTenantMeetingUrl` команды.


### <a name="updating-meetings-when-assigning-teamsupgradepolicy"></a>Обновление собраний при назначении TeamsUpgradePolicy

По умолчанию перенос собраний запускается автоматически, когда пользователю предоставлен экземпляр `TeamsUpgradePolicy` с или `mode=TeamsOnly` `mode= SfBWithTeamsCollabAndMeetings` . Если вы не хотите переносить собрания при предоставлении любого из этих режимов, укажите (при использовании PowerShell) или сделайте это при настройке режима совместной работы пользователя (при использовании `MigrateMeetingsToTeams $false` `Grant-CsTeamsUpgradePolicy` портала администрирования Teams).

Кроме того, обратите внимание на следующее:

- Перенос собраний вызывается только в том случае, если вы `TeamsUpgradePolicy` предоставили разрешение конкретному пользователю. При предоставлении или на уровне клиента перенос собраний не `TeamsUpgradePolicy` `mode=TeamsOnly` `mode=SfBWithTeamsCollabAndMeetings` вызывается. 
- Пользователю можно предоставить режим TeamsOnly только в том случае, если он находится в Интернете. Пользователи, которые находятся на локальной основе, должны быть перемещены, `Move-CsUser` как описано выше.
- Предоставление режима, кроме TeamsOnly или SfBWithTeamsCollabAndMeetings, не преобразует существующие Teams собрания в Skype для бизнеса собрания.

### <a name="trigger-meeting-migration-manually-via-powershell-cmdlet"></a>Запуск переноса собраний вручную с помощью cmdlet PowerShell

В дополнение к автоматическому переносу собраний администраторы могут запускать перенос собраний вручную, запуская его с помощью этого `Start-CsExMeetingMigration` cmdlet. Этот cmdlet очереди запроса на миграцию для указанного пользователя.  Помимо обязательного параметра требуется два необязательных параметра и , которые позволяют указать, как `Identity` `SourceMeetingType` перенести `TargetMeetingType` собрания:

**TargetMeetingType:**

- Использование указывает, Skype для бизнеса собрания остаются Skype для бизнеса, а Teams собрания остаются Teams `TargetMeetingType Current` собраниях. Однако координаты аудиоконференции могут быть изменены, а все Skype для бизнеса собрания будут перенесены в Skype для бизнеса Online. Это значение по умолчанию для TargetMeetingType.
- Использование указывает на то, что любое существующее собрание необходимо перенести в Teams, независимо от того, где оно находится : в Skype для бизнеса online или локально, независимо от того, требуется ли для аудиоконференции `TargetMeetingType Teams` обновление. 

**SourceMeetingType:**
- Использование означает, что Skype для бизнеса собрания (как локальное, так и `SourceMeetingType SfB` сетевое).
- Использование `SourceMeetingType Teams` означает, что Teams только собрания должны обновляться.
- Использование означает, что Skype для бизнеса и Teams должны `SourceMeetingType All` быть обновлены. Это значение по умолчанию для SourceMeetingType.
    

В примере ниже показано, как инициировать перенос собраний для пользователей ashaw@contoso.com таким образом, чтобы все собрания переносились в Teams:

```PowerShell
Start-CsExMeetingMigration -Identity ashaw@contoso.com -TargetMeetingType Teams
```



## <a name="managing-mms"></a>Управление MMS

С Windows PowerShell вы можете проверить состояние текущей миграции, вручную активировать перенос собраний и полностью отключить ее. 

### <a name="check-the-status-of-meeting-migrations"></a>Проверка состояния переноса собраний

Используйте его для проверки состояния `Get-CsMeetingMigrationStatus` переноса собраний. Ниже приведено несколько примеров.

- Чтобы получить сводное состояние для всех миграций MMS, запустите следующую команду, которая предоставляет таблионное представление всех штатов миграции:

    ```PowerShell
    Get-CsMeetingMigrationStatus -SummaryOnly

    State      UserCount
    ------     ---------
    Pending      21
    InProgress    6
    Failed            2 
    Succeeded   131
    ```
- Чтобы получить полные сведения о всех миграциях за определенный период времени, используйте `StartTime` параметры `EndTime` и параметры. Например, следующая команда возвращает полные сведения о всех миграциях, которые были совершены с 1 по 8 октября 2018 г.

    ```PowerShell
    Get-CsMeetingMigrationStatus -StartTime "10/1/2018" -EndTime "10/8/2018"
    ```
- Чтобы проверить состояние миграции для определенного пользователя, используйте `Identity` параметр. Например, следующая команда получит состояние переноса для пользователя ashaw@contoso.com:

    ```PowerShell
    Get-CsMeetingMigrationStatus -Identity ashaw@contoso.com
    ```
Если вы видите, что миграция завершилась сбойом, как можно скорее примите меры для устранения этих проблем, так как пользователи не смогут принимать участие в собраниях, организованных этими пользователями, пока вы не уберите их. Если `Get-CsMeetingMigrationStatus` показана любая миграция в состоянии сбойного выполнения, выполните следующие действия:
 
1. Определите пользователей, которых затронул сбой. Для получения списка пользователей, которых затронул сбой, и возникших ошибок выполните следующую команду:

    ```PowerShell
    Get-CsMeetingMigrationStatus| Where {$_.State -eq "Failed"}| Format-Table UserPrincipalName, LastMessage
    ```
2. Для каждого затронутого пользователя запустите средство переноса собраний, чтобы вручную перенести свои собрания.

3. Если с помощью средства переноса собраний перенос выполнить все равно не удается, есть два варианта действий.

    - Попросить пользователей создать собрания Skype заново.
    - [Связаться со службой поддержки](/microsoft-365/Admin/contact-support-for-business-products).

Его можно использовать для получения состояния миграции, которая была активна в течение `Get-CsMeetingMigrationStatus` последних 150 дней. Записи о миграции старше 150 дней будут стерто из системы.

### <a name="enabling-and-disabling-mms"></a>Включение и отключение MMS

MMS включена по умолчанию для всех организаций, но ее можно отключить следующим образом:

- Отключить полностью для клиента. 
- Отключить только для изменений, связанных с аудиоконференцией. В этом случае MMS будет по-прежнему работать при переносе пользователя из локальной сети в облако или при предоставлении режима TeamsOnly или SfBWithTeamsCollabAndMeetings в `TeamsUpgradePolicy` режиме .

Например, может потребоваться вручную перенести все собрания или временно отключить MMS, внося существенные изменения в параметры аудиоконференции для организации.

Чтобы узнать, включена ли MMS для вашей организации, запустите следующую команду: MMS включена, если `MeetingMigrationEnabled` параметр имеет параметр `$true` .
```PowerShell
Get-CsTenantMigrationConfiguration
```
Чтобы полностью включить или отключить MMS, используйте `Set-CsTenantMigrationConfiguration` эту команду. Например, чтобы отключить MMS, запустите следующую команду:

```PowerShell
Set-CsTenantMigrationConfiguration -MeetingMigrationEnabled $false
```
Если MMS включена в организации и вы хотите проверить, включена ли она для обновлений аудиоконференции, проверьте значение параметра в выходных `AutomaticallyMigrateUserMeetings` данных из `Get-CsOnlineDialInConferencingTenantSettings` . Чтобы включить или отключить MMS для аудиоконференций, используйте `Set-CsOnlineDialInConferencingTenantSettings` . Например, чтобы отключить MMS для аудиоконференции, запустите следующую команду:

```PowerShell
Set-CsOnlineDialInConferencingTenantSettings  -AutomaticallyMigrateUserMeetings $false
```

## <a name="related-topics"></a>Статьи по теме

[Попробуйте или приобретйте аудиоконференцию в Microsoft 365 или Office 365](../audio-conferencing-in-office-365/try-or-purchase-audio-conferencing-in-office-365.md)

[Перемещение пользователей между локальной средой и облаком](../../SfbHybrid/hybrid/move-users-between-on-premises-and-cloud.md)
