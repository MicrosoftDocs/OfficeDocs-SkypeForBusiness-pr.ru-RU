---
title: Использование службы миграции собраний (MMS)
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.reviewer: oscarr
ms.topic: article
ms.assetid: 031f09c0-9d2a-487a-b6db-b5d4bed6d16a
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection:
- Adm_Skype4B_Online
- Strat_SB_PSTN
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
ms.localizationpriority: medium
f1.keywords:
- NOCSH
ms.custom:
- Audio Conferencing
description: Служба миграции собраний (MMS) — это служба, которая работает в фоновом режиме и автоматически обновляет Skype для бизнеса и Microsoft Teams собрания для пользователей.
ms.openlocfilehash: a7e917a5b579c60ff84c3e1a5e6468a28f75faff
ms.sourcegitcommit: c53c22069b1babce7a2364de631057ff501ca1c0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2022
ms.locfileid: "65671645"
---
# <a name="using-the-meeting-migration-service-mms"></a>Использование службы миграции собраний (MMS)

Служба миграции собраний (MMS) — это служба, которая обновляет существующие собрания пользователя в следующих сценариях:

- При миграции пользователя из локальной среды в облако.
- Когда администратор вносит изменения в параметры аудиоконференций пользователя
- Когда пользователь в сети обновляется только Teams или если для режима пользователя в TeamsUpgradePolicy задано значение SfBwithTeamsCollabAndMeetings
- При использовании PowerShell

По умолчанию MMS автоматически активируется в каждом из этих случаев. Кроме того, администраторы могут использовать командлет PowerShell, чтобы вручную активировать перенос собраний для заданного пользователя.

**Ограничения:** службу переноса собраний нельзя использовать, если применяется любое из следующих действий:

- Почтовый ящик пользователя размещается в Exchange локальной среде.
- Пользователь переносится из облака в Skype для бизнеса Server локальной среде.

## <a name="how-mms-works"></a>Принцип работы MMS

При активации MMS для данного пользователя запрос на миграцию для этого пользователя помещается в очередь. Чтобы избежать каких-либо состояний гонки, запрос в очереди намеренно не обрабатывается, пока не пройдется по крайней мере 90 минут. После обработки запроса MMS выполняет следующие задачи:

1. Он ищет в почтовом ящике этого пользователя все существующие собрания, организованные этим пользователем и запланированные в будущем.
2. На основе сведений, найденных в почтовом ящике пользователя, он обновляет или планирует новые собрания в Teams для этого пользователя в зависимости от конкретного сценария.
3. В сообщении электронной почты он заменяет блок собрания по сети в сведениях о собрании.
4. Он отправляет обновленную версию этого собрания всем получателям собрания от имени организатора собрания. Приглашенные участники собрания получат обновление собрания с обновленными координатами собраний в их электронной почте.

    ![Блок собрания, который обновляется MMS.](../images/210a03ee-30c1-46f3-808f-4c2ebdaa3ea1.png)

С момента активации MMS обычно требуется около 2 часов до переноса собраний пользователя. Однако если у пользователя много собраний, это может занять больше времени. Если MMS обнаруживает ошибку при переносе одного или нескольких собраний для пользователя, она будет периодически повторять попытку до 9 раз в течение 24 часов.

**Примечания**:

- При переносе собрания MMS заменяет все сведения в блоке информации о собрании по сети. Если же пользователь изменил этот блок, внесенные им изменения будут перезаписаны. Все остальные данные в сведениях о собрании, за исключением этого блока, останутся нетронутыми. Это означает, что все файлы, вложенные в приглашение на собрание, по-прежнему будут включены.
- Переносятся только те собрания Skype для бизнеса или Microsoft Teams, которые были запланированы с помощью кнопки **Добавить собрание Skype** в Outlook в Интернете или с помощью надстройки "Собрание Skype" для Outlook. Если пользователь копирует и вставляет Skype из одного собрания в новое собрание, это новое собрание не будет обновлено, так как в исходной службе нет собрания.
- Содержимое собрания, созданное или присоединенное к собранию (доски, опросы и т. д.), не сохраняется после запуска MMS. Если организаторы собраний заранее присоединили содержимое к собраниям, его необходимо будет повторно создать после запуска MMS.
- Ссылки на общие заметки собрания в элементе календаря и в собрании Skype также будут перезаписаны. Обратите внимание, что фактические заметки о собрании, хранящиеся в OneNote, по-прежнему будут там; перезаписывается только ссылка на общие заметки.
- Собрания с числом участников больше 250 (включая организатора) не будут перенесены.
- Некоторые символы ЮНИКОДА в тексте приглашения могут быть неправильно обновлены до одного из следующих специальных символов: ы, }, 1/2, .

## <a name="triggering-mms-for-a-user"></a>Активация MMS для пользователя

В этом разделе описывается, что происходит при активации MMS в каждом из следующих случаев:

- При миграции пользователя из локальной среды в облако
- Когда администратор вносит изменения в параметры аудиоконференций пользователя
- Если для режима пользователя в TeamsUpgradePolicy задано значение TeamsOnly или SfBWithTeamsCollabAndMeetings (с помощью PowerShell или портала Teams Администратор)
- При использовании командлета PowerShell Start-CsExMeetingMigration

### <a name="updating-meetings-when-you-move-an-on-premises-user-to-the-cloud"></a>Обновление собраний при перемещении локального пользователя в облако

Это наиболее распространенный сценарий, в котором MMS помогает обеспечить более плавный переход для пользователей. Без переноса собраний существующие собрания, упорядоченные пользователем Skype для бизнеса Server локальной среде, больше не будут работать после перемещения пользователя в сеть. Таким образом, при использовании локальных средств администрирования (`Move-CsUser`либо Администратор панель управления) для перемещения пользователя в облако существующие собрания автоматически перемещаются в облако и преобразуются в TeamsOnly.

Если пользователю была назначена лицензия Аудиоконференции перед перемещением в облако, собрания будут создаваться с координатами телефонного подключения. Если вы перемещали пользователя из локальной среды в облако и планируете использовать Аудиоконференции, рекомендуется сначала назначить аудиоконференции перед перемещением пользователя, чтобы активировать миграцию только на 1 собрание.

### <a name="updating-meetings-when-a-users-audio-conferencing-settings-change"></a>Обновление собраний при изменении параметров аудиоконференции для пользователя

В следующих случаях MMS обновляет существующие Skype для бизнеса и Microsoft Teams собрания, чтобы добавлять, удалять или изменять координаты телефонного подключения:

- При назначении или удалении лицензии службы Microsoft Аудиоконференции пользователю, и этот пользователь не включен для стороннего поставщика аудиоконференций.
- При изменении поставщика аудиоконференций пользователя с любого другого поставщика на Корпорацию Майкрософт при условии, что пользователю назначена лицензия microsoft Аудиоконференции. Дополнительные сведения см. [в статье "Назначение Майкрософт в качестве поставщика аудиоконференций"](./assign-microsoft-as-the-audio-conferencing-provider.md). Также обратите внимание, что поддержка сторонних поставщиков аудиоконференций [ACP] запланирована на 1 апреля 2019 г., как было объявлено [ранее](../legal-and-regulatory/end-of-integration-with-3rd-party-providers.md).
- Когда вы включаете или отключаете аудиоконференции для пользователя.
- При изменении или сбросе идентификатора конференции для пользователя, настроенного для использования общедоступных собраний.
- При переключении пользователя на новый мост аудиоконференции.
- Если номер телефона из моста аудиоконференций не назначен. Это сложный сценарий, который требует дополнительных действий. Дополнительные сведения см [. в статье "Изменение номеров телефонов в мосте аудиоконференций"](/MicrosoftTeams/change-the-phone-numbers-on-your-audio-conferencing-bridge).

Не все изменения в параметрах аудиоконференции для пользователя приводят к запуску MMS. В частности, MMS не будет обновлять собрания в двух следующих случаях:

- При изменении SIP-адреса организатора собрания (его имени пользователя SIP или домена SIP)
- При изменении URL-адреса собрания организации с помощью команды `Update-CsTenantMeetingUrl` .

### <a name="updating-meetings-when-assigning-teamsupgradepolicy"></a>Обновление собраний при назначении TeamsUpgradePolicy

По умолчанию миграция собрания автоматически `TeamsUpgradePolicy` активируется, когда пользователю предоставляется экземпляр с или `mode=TeamsOnly` `mode= SfBWithTeamsCollabAndMeetings`. Если вы не хотите переносить собрания при предоставлении любого из этих режимов, `MigrateMeetingsToTeams $false` `Grant-CsTeamsUpgradePolicy` укажите (при использовании PowerShell) или снимите флажок для переноса собраний при настройке режима сосуществования пользователя (при использовании портала администрирования Teams).

Также обратите внимание на следующее:

- Перенос собраний вызывается только при предоставлении разрешения `TeamsUpgradePolicy` конкретному пользователю. Если вы предоставляете `TeamsUpgradePolicy` или `mode=SfBWithTeamsCollabAndMeetings` `mode=TeamsOnly` *выполняете* миграцию на уровне клиента, перенос собраний не вызывается.
- Пользователю может быть предоставлен режим TeamsOnly только в том случае, если он размещен в Сети. Пользователи, которые размещены в локальной среде, должны быть перемещены, как `Move-CsUser` описано выше.
- Предоставление режима, отличного от TeamsOnly или SfBWithTeamsCollabAndMeetings, не преобразует существующие Teams собрания в Skype для бизнеса собрания.

### <a name="trigger-meeting-migration-manually-via-powershell-cmdlet"></a>Активация переноса собраний вручную с помощью командлета PowerShell

Помимо автоматической миграции собраний, администраторы могут вручную активировать перенос собраний для пользователя, запустив командлет `Start-CsExMeetingMigration`. Этот командлет ставит в очередь запрос на миграцию для указанного пользователя.  Помимо обязательного параметра`Identity`, он принимает два необязательных параметра и `TargetMeetingType``SourceMeetingType` позволяет указать способ переноса собраний:

**TargetMeetingType:**

- Использование `TargetMeetingType Current` указывает, Skype для бизнеса собрания остаются Skype для бизнеса, а Teams — Teams собраний. Однако координаты аудиоконференций могут быть изменены, и все локальные собрания Skype для бизнеса будут перенесены в Skype для бизнеса Online. Это значение по умолчанию для TargetMeetingType.
- Использование `TargetMeetingType Teams` указывает, что любое существующее собрание должно быть перенесено в Teams независимо от того, размещено ли собрание в Skype для бизнеса online или локально, и независимо от того, требуются ли обновления аудиоконференций.

**SourceMeetingType:**

- Использование `SourceMeetingType SfB` означает, что Skype для бизнеса собрания (локальные или сетевые) должны быть обновлены.
- Использование `SourceMeetingType Teams` означает, что Teams должны быть обновлены только собрания.
- Использование `SourceMeetingType All` означает, что Skype для бизнеса и Teams должны быть обновлены. Это значение по умолчанию для SourceMeetingType.

В приведенном ниже примере показано, как инициировать миграцию собраний для пользователей ashaw@contoso.com, чтобы все собрания переносимы в Teams:

```PowerShell
Start-CsExMeetingMigration -Identity ashaw@contoso.com -TargetMeetingType Teams
```

## <a name="managing-mms"></a>Управление MMS

С Windows PowerShell вы можете проверить состояние текущих миграций, вручную активировать перенос собраний и полностью отключить миграцию.

### <a name="check-the-status-of-meeting-migrations"></a>Проверка состояния переноса собраний

Этот командлет `Get-CsMeetingMigrationStatus` используется для проверки состояния переноса собраний. Ниже приведено несколько примеров.

- Чтобы получить сводное состояние всех миграций MMS, выполните следующую команду, которая предоставляет табличное представление всех состояний миграции:

    ```PowerShell
    Get-CsMeetingMigrationStatus -SummaryOnly

    State      UserCount
    ------     ---------
    Pending      21
    InProgress    6
    Failed        2
    Succeeded   131
    ```

- Чтобы получить полные сведения о всех миграциях в течение определенного периода времени, используйте параметры `StartTime` и параметры `EndTime` . Например, приведенная ниже команда вернет полные сведения о всех миграциях, выполненных с 1 октября 2018 г. по 8 октября 2018 г.

    ```PowerShell
    Get-CsMeetingMigrationStatus -StartTime "10/1/2018" -EndTime "10/8/2018"
    ```

- Чтобы проверить состояние миграции для конкретного пользователя, используйте параметр `Identity` . Например, следующая команда получит состояние переноса для пользователя ashaw@contoso.com:

    ```PowerShell
    Get-CsMeetingMigrationStatus -Identity ashaw@contoso.com
    ```

Если вы видите какие-либо миграции, которые не удалось выполнить, примите меры для устранения этих проблем как можно скорее, так как пользователи не смогут подключаться к собраниям, организованным этими пользователями, пока вы их не устраните. Если `Get-CsMeetingMigrationStatus` отображаются какие-либо миграции в состоянии сбоя, выполните следующие действия:

1. Определите пользователей, которых затронул сбой. Для получения списка пользователей, которых затронул сбой, и возникших ошибок выполните следующую команду:

    ```PowerShell
    Get-CsMeetingMigrationStatus| Where {$_.State -eq "Failed"}| Format-Table UserPrincipalName, LastMessage
    ```

2. Для каждого затронутого пользователя проверьте значение свойства LastMessage, чтобы определить причину сбоя миграции собрания и действия по исправлению. После присоединения к исправлению повторно запустите миграцию собраний для затронутых пользователей с `Start-CsExMeetingMigration` помощью командлета PowerShell, как описано выше.

3. Если миграция по-прежнему не работает, у вас есть два варианта:

    - Попросить пользователей создать собрания Skype заново.
    - [Связаться со службой поддержки](/microsoft-365/Admin/contact-support-for-business-products).

Командлет `Get-CsMeetingMigrationStatus` можно использовать для получения состояния миграций, которые были запущены в течение последних 150 дней. Записи для миграций старше 150 дней удаляются из системы.

### <a name="enabling-and-disabling-mms"></a>Включение и отключение MMS

MMS включен по умолчанию для всех организаций, но его можно отключить следующим образом:

- Полностью отключить для клиента.
- Отключите только изменения, связанные с аудиоконференций. В этом случае MMS по-прежнему будет выполняться при переносе пользователя из локальной среды в облако или при предоставлении режима TeamsOnly или режима SfBWithTeamsCollabAndMeetings `TeamsUpgradePolicy`в .

Например, может потребоваться вручную перенести все собрания или временно отключить MMS, внося значительные изменения в параметры аудиоконференций для вашей организации.

Чтобы узнать, включен ли MMS для вашей организации, выполните следующую команду. MMS включен, если параметр `MeetingMigrationEnabled` имеет значение `$true`.

```PowerShell
Get-CsTenantMigrationConfiguration
```

Если MMS включен в организации и вы хотите проверить, включено ли обновление аудиоконференций, `AutomaticallyMigrateUserMeetings` проверьте значение параметра в выходных данных `Get-CsOnlineDialInConferencingTenantSettings`. Чтобы включить или отключить MMS для аудиоконференций, используйте `Set-CsOnlineDialInConferencingTenantSettings`. Например, чтобы отключить MMS для аудиоконференций, выполните следующую команду:

```PowerShell
Set-CsOnlineDialInConferencingTenantSettings  -AutomaticallyMigrateUserMeetings $false
```

## <a name="related-topics"></a>Статьи по теме

[Попробуйте или Аудиоконференции в Microsoft 365 или Office 365](../audio-conferencing-in-office-365/try-or-purchase-audio-conferencing-in-office-365.md)

[Перемещение пользователей между локальной средой и облаком](../../SfbHybrid/hybrid/move-users-between-on-premises-and-cloud.md)
