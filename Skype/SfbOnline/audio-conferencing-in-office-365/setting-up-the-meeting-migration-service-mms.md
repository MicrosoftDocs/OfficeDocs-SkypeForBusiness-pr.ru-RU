---
title: Использование службы миграции собраний (MMS)
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.reviewer: oscarr
ms.topic: article
ms.assetid: 031f09c0-9d2a-487a-b6db-b5d4bed6d16a
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection:
- Adm_Skype4B_Online
- Strat_SB_PSTN
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
localization_priority: Normal
f1keywords: None
ms.custom:
- Audio Conferencing
description: Служба миграции собраний (MMS) — это служба, которая запускается в фоновом режиме и автоматически обновляет собрания Skype для бизнеса и Microsoft Teams для пользователей. MMS предназначен для предотвращения необходимости запуска средства миграции собраний для обновления собраний Skype для бизнеса и Microsoft Teams.
ms.openlocfilehash: 3f643f20937fd13b0d9576640487da30f17dd7bf
ms.sourcegitcommit: 8db50c46992dccf54c1d4be58d8a0d21ec64ddd0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "37772283"
---
# <a name="using-the-meeting-migration-service-mms"></a>Использование службы миграции собраний (MMS)

Служба миграции собраний (MMS) — это служба, которая обновляет существующие собрания пользователя в следующих сценариях:

- Если пользователь переносится из локальной сети в облако (Skype для бизнеса Online или Теамсонли).
- Когда администратор вносит изменения в настройки голосовой конференции пользователя, 
- Если пользователь в сети обновляется только для Teams или режим пользователя в Теамсупградеполици имеет значение Сфбвистеамсколлабандмитингс
- При использовании PowerShell 


По умолчанию MMS автоматически запускается в каждом из этих случаев, хотя администраторы могут отключить ее на уровне клиента. Кроме того, администраторы могут использовать командлет PowerShell, чтобы вручную инициировать миграцию собраний для определенного пользователя.


**Ограничения**: служба миграции собраний не может использоваться, если применимо одно из следующих действий:

- Почтовый ящик пользователя размещен в локальной среде Exchange.
- Пользователь переносится из облака в локальную версию Skype для бизнеса Server.

В этих случаях конечные пользователи могут использовать [средство миграции собраний](https://www.microsoft.com/en-us/download/details.aspx?id=51659) для миграции собственных собраний.

## <a name="how-mms-works"></a>Как работает MMS

Если для определенного пользователя запущен протокол MMS, в очередь помещается запрос на перенос для этого пользователя. Чтобы избежать каких – либо условий состязания, запрос в очереди не обрабатывается до тех пор, пока не пройдет хотя бы 90 минут. После того как MMS обрабатывает запрос, он выполняет следующие задачи:

1. Он выполняет поиск в почтовом ящике этого пользователя для всех собраний, организованных этим пользователем и запланированных в будущем.
2. На основе данных, находящихся в почтовом ящике пользователя, он либо обновляет, либо планирует новые собрания в Teams или Skype для бизнеса Online для этого пользователя в зависимости от истинной ситуации.
3. В сообщении электронной почты он заменяет блок собрания по сети в сведениях о собрании.
4. Она отправляет обновленную версию собрания всем получателям собрания от имени организатора собрания. Приглашенные на собрание будут получать обновленные координаты собраний по электронной почте. 

    ![Блокировка собрания, обновляемого MMS](../images/210a03ee-30c1-46f3-808f-4c2ebdaa3ea1.png)

При срабатывании часового пояса обычно занимает 2 часа, пока собрания пользователя не будут перенесены. Тем не менее, если у пользователя большое количество собраний, может потребоваться больше времени. Если MMS обнаруживает ошибку, которая переносит одно или несколько собраний для пользователя, она периодически повторяется до 9 раз в течение интервала в 24 часа.

**Заметки**:

- При переносе собрания MMS заменяет все сведения в блоке информации о собрании по сети. Если же пользователь изменил этот блок, внесенные им изменения будут перезаписаны. Все остальные данные в сведениях о собрании, за исключением этого блока, останутся нетронутыми.
- Переносятся только те собрания Skype для бизнеса или Microsoft Teams, которые были запланированы с помощью кнопки **Добавить собрание Skype** в Outlook в Интернете или с помощью надстройки "Собрание Skype" для Outlook. Если пользователь копирует и вставляет сведения о собрании Skype Online из собрания на новое собрание, новое собрание не будет обновляться, так как в исходной службе нет собрания.
- Содержимое собрания, которое было создано или присоединено к собранию (доски, опросы и т. д.), не будет сохранено после выполнения MMS. Если ваше собрание организаторов прикрепить содержимое к собраниям, его необходимо будет заново создать после выполнения MMS.
- Ссылки на общие заметки собрания в элементе календаря и в собрании Skype также будут перезаписаны. Обратите внимание, что фактические заметки к собранию, хранящиеся в OneNote, будут по-прежнему там. Это ссылка только на общие заметки, которые перезаписываются.
- Собрания с числом участников больше 250 (включая организатора) не будут перенесены.
- Некоторые символы Юникода в тексте приглашения может быть неправильно обновлены на один из следующих специальных символов: ï, ¿, 1/2,.

## <a name="triggering-mms-for-a-user"></a>Активация MMS для пользователя

В этом разделе объясняется, что происходит при запуске MMS в каждом из указанных ниже случаев.

- Миграция пользователя из локальной сети в облако
- Когда администратор вносит изменения в настройки голосовой конференции пользователя, 
- Если пользовательским режимом в Теамсупградеполици задано значение Теамсонли или Сфбвистеамсколлабандмитингс (с помощью PowerShell или портала администрирования Teams)
- При использовании командлета PowerShell Start-Ксексмитингмигратион

### <a name="updating-meetings-when-you-move-an-on-premises-user-to-the-cloud"></a>Обновление собраний при перемещении локального пользователя в облако

Это наиболее распространенный сценарий, в котором MMS помогает создавать более плавные переходы для пользователей. Без миграции собраний собрания, упорядоченные по сети в Skype для бизнеса Server, не будут работать после перемещения пользователя в Интернете. Таким образом, при использовании локальных средств администрирования ( `Move-CsUser` или панели управления "Администрирование") для перемещения пользователя в облако существующие собрания автоматически переносятся в облако следующим образом:

- `MoveToTeams` Если указан параметр in `Move-CsUser` in, собрания переносятся непосредственно в Teams, и пользователь переходит в режим теамсонли. Для использования этого переключателя требуется Skype для бизнеса Server 2015 с обновления HF1 или более поздней версии. Эти пользователи по-прежнему могут присоединиться к собранию Skype для бизнеса, на которое они могут быть приглашены, с помощью клиента Skype для бизнеса или из приложения "собрания Skype".
- В противном случае собрания переносятся в Skype для бизнеса Online.

В любом случае, если пользователю назначена лицензия на голосовую конференцию, прежде чем она будет перенесена в облако, собрания будут создаваться с помощью координат подключения. Если вы перемещаете пользователя из локальной сети в облако и хотите, чтобы он использовал голосовую конференцию, мы рекомендуем сначала назначить звуковую конференцию перед перемещением пользователя, чтобы активировать только 1 миграцию собраний.


### <a name="updating-meetings-when-a-users-audio-conferencing-settings-change"></a>Обновление собраний при изменении параметров аудиоконференции для пользователя

В следующих случаях MMS обновит существующие собрания Skype для бизнеса и Microsoft Teams, чтобы добавить, удалить или изменить координаты телефонного подключения.

- Если вы назначаете или удаляете лицензию на службу Microsoft Audio Конференц-связь с пользователем, и этот пользователь не включен для стороннего поставщика голосовой связи.
- При смене поставщика видеоконференций у другого поставщика в Microsoft при условии, что ему назначена лицензия Microsoft Audio для Конференции. Дополнительные сведения можно найти [в разделе Назначение Microsoft поставщиком звуковых конференций](https://docs.microsoft.com/skypeforbusiness/audio-conferencing-in-office-365/assign-microsoft-as-the-audio-conferencing-provider). Также обратите внимание на то, что поддержка сторонних поставщиков видеоконференций [ACP] запланирована на окончание срока действия 1 апреля 2019, как [было объявлено ранее](https://docs.microsoft.com/skypeforbusiness/legal-and-regulatory/end-of-integration-with-3rd-party-providers).
- При включении или отключении голосовой конференции для пользователя.
- При изменении или сбросе идентификатора конференции для пользователя, настроенного на использование общедоступных собраний.
- При переключении пользователя на новый мост аудиоконференции.
- Когда номер телефона из моста голосовой конференции не назначен. Это сложный сценарий, в котором требуется выполнить дополнительные действия. Дополнительные сведения можно найти [в разделе изменение номеров телефонов для вашего моста звуковых конференций](https://docs.microsoft.com/MicrosoftTeams/change-the-phone-numbers-on-your-audio-conferencing-bridge).

Не все изменения в параметрах аудиоконференции для пользователя приводят к запуску MMS. В частности, MMS не будет обновлять собрания в двух следующих случаях:

- При изменении SIP-адреса организатора собрания (его имени пользователя SIP или домена SIP)
- Когда вы измените URL-адрес собрания Организации с помощью `Update-CsTenantMeetingUrl` команды.


### <a name="updating-meetings-when-assigning-teamsupgradepolicy"></a>Обновление собраний при назначении Теамсупградеполици

По умолчанию миграция собрания запускается автоматически, когда пользователю предоставляется экземпляр `TeamsUpgradePolicy` с помощью `mode=TeamsOnly` или. `mode= SfBWithTeamsCollabAndMeetings` Если вы не хотите переносить собрания при предоставлении одного из этих режимов, укажите `MigrateMeetingsToTeams $false` в `Grant-CsTeamsUpgradePolicy` (если используется PowerShell) или снимите флажок для миграции собраний при настройке режима сосуществования пользователя (если используется портал администрирования Teams).

Также обратите внимание на следующее:

- Миграция собрания вызывается только при предоставлении `TeamsUpgradePolicy` определенного пользователя. `TeamsUpgradePolicy` Если вы предоставляете `mode=TeamsOnly` или `mode=SfBWithTeamsCollabAndMeetings` на *уровне клиента* , то миграция собрания не вызывается.
- Пользователь может предоставить режим Теамсонли только в том случае, если пользователь подключен к сети. Локальные пользователи должны перемещаться с помощью `Move-CsUser` описанных выше функций.
- Предоставление режима, отличного от Теамсонли или Сфбвистеамсколлабандмитингс, не приводит к преобразованию существующих собраний Teams в собрания Skype для бизнеса.

### <a name="trigger-meeting-migration-manually-via-powershell-cmdlet"></a>Запуск миграции собраний вручную с помощью командлета PowerShell

Помимо автоматических миграций собраний, администраторы могут вручную инициировать миграцию собраний для пользователя, запустив командлет `Start-CsExMeetingMigration`. Этот командлет помещает в очередь запрос на перенос для указанного пользователя.  В дополнение к обязательному `Identity` параметру принимаются два необязательных `SourceMeetingType` `TargetMeetingType`параметра, которые позволяют задать способ миграции собраний.

**Таржетмитингтипе:**

- Если `TargetMeetingType Current` вы указываете, что собрания Skype для бизнеса останутся на собраниях Skype для бизнеса, а собрания Teams остались на собраниях Teams. Однако возможно изменение координат голосовой конференции и перенос локальных собраний Skype для бизнеса в Skype для бизнеса Online. Это значение по умолчанию для Таржетмитингтипе.
- Использование `TargetMeetingType Teams` указывает на то, что существующее собрание должно быть перенесено в Teams, независимо от того, размещается ли собрание в Skype для бизнеса Online или локально и вне зависимости от того, требуются ли какие-либо обновления голосовой конференции. 

**Саурцемитингтипе:**
- Использование `SourceMeetingType SfB` показывает, что нужно обновить только собрания Skype для бизнеса (локально или в сети).
- Использование `SourceMeetingType Teams` указывает на то, что только собрания Teams будут обновляться.
- Использование `SourceMeetingType All` указывает на то, что оба Skype для собраний и собраний Teams должны быть обновлены. Это значение по умолчанию для Саурцемитингтипе.
    

В приведенном ниже примере показано, как инициировать миграцию ashaw@contoso.com для пользователя, чтобы все собрания были перенесены в teams:

```
Start-CsExMeetingMigration -Identity ashaw@contoso.com -TargetMeetingType Teams
```



## <a name="managing-mms"></a>Управление MMS

С помощью Windows PowerShell можно проверять состояние текущих миграций, запускать миграцию собраний вручную и полностью отключать миграцию. 

### <a name="check-the-status-of-meeting-migrations"></a>Проверка состояния миграции собраний

Вы можете проверить `Get-CsMeetingMigrationStatus` состояние миграции собраний с помощью командлета. Ниже приведено несколько примеров.

- Чтобы получить сводное состояние всех миграций MMS, выполните следующую команду, которая обеспечивает представление всех состояний миграции в виде таблицы.

    ```
    Get-CsMeetingMigrationStatus -SummaryOnly

    State      UserCount
    ------     ---------
    Pending      21
    InProgress    6
    Failed            2 
    Succeeded   131
    ```
- Чтобы получить полные сведения обо всех миграции за определенный период времени, используйте параметры `StartTime` и. `EndTime` Например, следующая команда возвращает полные сведения обо всех миграции, произошедших с 1 октября 2018 г. на 8 октября 2018 г.

    ```
    Get-CsMeetingMigrationStatus -StartTime "10/1/2018" -EndTime "10/8/2018"
    ```
- Чтобы проверить состояние миграции для определенного пользователя, используйте `Identity` параметр. Например, следующая команда получит состояние переноса для пользователя ashaw@contoso.com:

    ```
    Get-CsMeetingMigrationStatus -Identity ashaw@contoso.com
    ```
Если вы видите сбой миграции, выполните действия по устранению этих проблем, так как это возможно, так как пользователи не смогут звонить на собрания, упорядоченные по этим пользователям, пока они не будут устранены. Если `Get-CsMeetingMigrationStatus` в состоянии сбоя отображаются все миграции, выполните указанные ниже действия.
 
1. Определите пользователей, которых затронул сбой. Для получения списка пользователей, которых затронул сбой, и возникших ошибок выполните следующую команду:

    ```
    Get-CsMeetingMigrationStatus| Where {$_.State -eq "Failed"}| Format-Table UserPrincipalName, LastMessage
    ```
2. Для каждого затронутого пользователя запустите средство миграции собраний, чтобы вручную переносить их собрания.

3. Если с помощью средства переноса собраний перенос выполнить все равно не удается, есть два варианта действий.

    - Попросить пользователей создать собрания Skype заново.
    - [Связаться со службой поддержки](https://go.microsoft.com/fwlink/p/?LinkID=518322).


### <a name="enabling-and-disabling-mms"></a>Включение и отключение MMS

MMS включается по умолчанию для всех организаций, но его можно отключить, выполнив указанные ниже действия.

- Отключение для клиента целиком. 
- Отключить только для тех изменений, которые относятся к голосовой конференции. В этом случае MMS будет выполняться, когда пользователь переносится из локальной сети в облако или когда вы предоставляете режим Теамсонли или Сфбвистеамсколлабандмитингс `TeamsUpgradePolicy`.

Например, вы можете вручную перенести все собрания или временно отключить MMS, внося существенные изменения в параметры голосовой конференции для вашей организации.

Чтобы проверить, включена ли поддержка MMS для вашей организации, выполните следующую команду: MMS включен, если `MeetingMigrationEnabled` параметр имеет `$true`значение.
```
Get-CsTenantMigrationConfiguration
```
Чтобы включить или отключить MMS целиком, используйте `Set-CsTenantMigrationConfiguration` команду. Например, чтобы отключить MMS, выполните следующую команду:

```
Set-CsTenantMigrationConfiguration -MeetingMigrationEnabled $false
```
Если в организации включена поддержка MMS и вы хотите проверить, разрешено ли для них обновление для голосовой конференции, проверьте значение `AutomaticallyMigrateUserMeetings` параметра в выходных данных. `Get-CsOnlineDialInConferencingTenantSettings` Чтобы включить или отключить MMS для голосовой конференции, используйте `Set-CsOnlineDialInConferencingTenantSettings`. Например, чтобы отключить MMS для голосовой конференции, выполните следующую команду:

```
Set-CsOnlineDialInConferencingTenantSettings  -AutomaticallyMigrateUserMeetings $false
```

## <a name="related-topics"></a>Статьи по теме

[Платная или пробная версия аудиоконференций в Office 365](../audio-conferencing-in-office-365/try-or-purchase-audio-conferencing-in-office-365.md)

[Перемещение пользователей между локальной средой и облаком](https://docs.microsoft.com/SkypeForBusiness/hybrid/move-users-between-on-premises-and-cloud)
