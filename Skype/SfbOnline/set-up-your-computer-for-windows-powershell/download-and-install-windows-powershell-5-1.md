---
title: Загрузка и установка Windows PowerShell 5.1
ms.reviewer: ''
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.topic: article
ms.assetid: d739cd71-3c18-42ea-879f-b408bf53b1f4
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection: Adm_Skype4B_Online
ms.audience: Admin
appliesto:
- Skype for Business
localization_priority: Normal
f1keywords: None
ms.custom:
- PowerShell
- LIL_Placement
description: Загрузки, установки и затем использовать Windows PowerShell 5.1 для создания удаленного сеанса PowerShell, который подключается к Скайп для бизнеса в Интернет.
ms.openlocfilehash: 63f4924a30bfc910679f23a617cc5252ecc5b6aa
ms.sourcegitcommit: 111bf6255fa877b3fce70fa8166e8ec5a6643434
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "32198071"
---
# <a name="download-and-install-windows-powershell-51"></a>Загрузка и установка Windows PowerShell 5.1

Если вы используете Windows Update Годовщина 10 или Windows Server 2016, необходимо иметь Windows PowerShell 5.1. Вот так, как это приложение предварительно с этими операционными системами.
  
Чтобы определить, какая версия Microsoft PowerShelll использовании, выполните следующие действия в Windows 7 или Windows Server 2008 R2 или Windows Server 2012 компьютера:
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные**, **Windows PowerShell** и затем щелкните **Windows PowerShell**.
    
2. В консоли PowerShell введите следующую команду и нажмите клавишу ВВОД:
    
   ```
   Get-Host | Select-Object Version
   ```

3. В окне консоли должна появиться информация примерно следующего вида:
    
    <pre>
    Version <BR>
    ------- <BR>
    4.0
    </pre>

    Если возвращенный номер версии — 5.1, вы выполняете Windows PowerShell 5.1. Если возвращенный номер версии не 5.1, то необходимо для установки Windows PowerShell 5.1. Windows Management Framework 5.1, включая Windows PowerShell 5.1, можно загрузить из [Центра загрузки Майкрософт](https://www.microsoft.com/en-us/download/details.aspx?id=54616).
  
После проверки, что установлено Windows PowerShell 5.1, необходимо убедиться, PowerShell настроен для запуска удаленного сценариев. Для этого запустите приложение PowerShell от имени администратора. В ОС Windows 7, Windows Server 2008 R2, Windows Server 2012 или Windows Server 2012 R2 выполните следующие действия:
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные** и **Windows PowerShell**. Затем щелкните элемент **Windows PowerShell** правой кнопкой мыши и выберите **Запуск от имени администратора**.
    
2. Если появится диалоговое окно **Контроль учетных записей**, нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
В ОС Windows 8 выполните следующие действия:
  
1. Откройте панель чудо-кнопок и выберите **Поиск**, после чего щелкните правой кнопкой мыши элемент **Windows PowerShell**. Для быстрого доступа к панели чудо-кнопок на любом компьютере под управлением ОС Windows 8 (независимо от наличия сенсорного экрана) нажмите клавишу Windows и, не отпуская ее, клавишу C.
    
2. В панели инструментов внизу экрана выберите пункт **Запуск от имени администратора**.
    
3. Если появится диалоговое окно **Контроль учетных записей**, нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
После запуска PowerShell необходимо разрешить работу с удаленными сценариями в политике выполнения. Для этого в консоли PowerShell введите следующую команду и нажмите клавишу ВВОД:
```
Set-ExecutionPolicy RemoteSigned -Force
```
   
 
> [!NOTE]
> При выполнении предыдущей команды, вы можете получить следующие ошибки сообщения: > *Set-ExecutionPolicy: доступ к разделу реестра "HKEY_LOCAL_MACHINE\\программного обеспечения\\Microsoft\\PowerShell\\1\\ShellIds\\Micrsoft.PowerShell "отказано.* Это сообщение об ошибке, как правило, возникает, если не выполняется PowerShell с использованием учетных данных администратора. Чтобы исправить эту ошибку, закройте сеанс PowerShell и запустите новый сеанс от имени администратора.
 
Чтобы проверить правильность настройки политики выполнения, в командной строке PowerShell введите следующую команду и нажмите клавишу ВВОД:
  
```
Get-ExecutionPolicy
```

Если настройка выполнена правильно, будет возвращено следующее значение:
  
`RemoteSigned`

Если вы не используется в настоящее время Windows PowerShell 5.1, также необходимо загрузить и установить Windows Management Framework 5.1 из центра загрузки Майкрософт. Это установочного пакета, содержащего Windows PowerShell 5.1 и удаленное управление Windows (WinRM) 3.0. Этот пакет установки может потребоваться, если, например, выполняется Windows 7 с пакетом обновления 1 и еще не обновлена до версии 5.1 Windows PowerShell. Если выполняется 2016 сервера Windows или Windows Update Годовщина 10, должен быть не требуется устанавливать Windows PowerShell 5.1. Windows PowerShell 5.1 предварительно в этих операционных системах.
  
Перед установкой Windows Management Framework 5.1:
  
- Убедитесь, что вы скачали правильную версию пакета установки. Если выполняется 64-разрядная версия Windows 7 с пакетом обновления 1, загрузите файл Win7AndW2K8R2 KB3191566 x64.ZIP. Если выполняется 32-разрядная версия Windows 7 Загрузите файл Win7 KB3191566 x86.ZIP.
    
- Если на вашем компьютере установлена ОС Windows 7, проверьте наличие пакета обновления 1 для этой операционной системы.

Если вы не знаете свою версию Windows или не уверены, установлен ли у вас пакет обновления 1 для Windows 7, откройте меню **Пуск**, щелкните правой кнопкой мыши пункт **Компьютер** и выберите пункт **Свойства**. Нужная информация будет представлена в диалоговом окне "Система".
  
Чтобы установить Windows Management Framework 5.1, выполните процедуру в разделе [Установка и настройка WMF 5.1](https://docs.microsoft.com/en-us/powershell/wmf/5.1/install-configure)
  
После перезагрузки проверьте работоспособность Windows PowerShell и возможность запуска этого приложения от имени администратора. Для этого выполните следующие действия:
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные** и **Windows PowerShell**. Затем щелкните элемент **Windows PowerShell** правой кнопкой мыши и выберите **Запуск от имени администратора**.
    
2. Если появится диалоговое окно "Контроль учетных записей", нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
В появившейся консоли PowerShell необходимо убедиться, что служба WinRM запущена и правильно настроена. Для этого в командной строке PowerShell введите следующую команду и нажмите клавишу ВВОД:
  
```
Get-Service winrm
```

На экран будут выведены сведения о службе WinRM:
  
<pre>
Status   Name               DisplayName
------   ----               -----------
Running  winrm              Windows Remote Management (WS-Manag...
</pre>

Если в столбце состояния не указано, что служба WinRM запущена, запустите ее. Для этого введите следующую команду и нажмите клавишу ВВОД:
  
```
Start-Service winrm
```

После запуска службы WinRM выполните следующую команду, чтобы проверить, что в ней используется обычная проверка подлинности:
  
```
winrm set winrm/config/client/auth '@{Basic="True"}'
```

На экране должна появиться информация примерно следующего вида:
  
<pre>
Auth
    Basic = true
    Digest = true
    Kerberos = true
    Negotiate = true
    Certificate = true
    CredSSP = false
</pre>

Если обычная проверка подлинности имеет значение true, а затем вы готовы к использование PowerShell для подключения к Скайп для бизнеса в Интернет.
  
[!INCLUDE [LinkedIn Learning Info](../../common/office/linkedin-learning-info.md)]
   
## <a name="related-topics"></a>Статьи по теме
[Настройка компьютера для Windows PowerShell](set-up-your-computer-for-windows-powershell.md) 

  
 
