---
title: Скачивание и установка Windows PowerShell 5,1
ms.reviewer: ''
ms.author: tonysmit
author: tonysmit
manager: serdars
ms.topic: article
ms.assetid: d739cd71-3c18-42ea-879f-b408bf53b1f4
ms.tgt.pltfrm: cloud
ms.service: skype-for-business-online
search.appverid: MET150
ms.collection: Adm_Skype4B_Online
audience: Admin
appliesto:
- Skype for Business
localization_priority: Normal
f1keywords: None
ms.custom:
- PowerShell
- LIL_Placement
description: Скачивание, установка и использование Windows PowerShell 5,1 для создания удаленного сеанса PowerShell, который подключается к Skype для бизнеса Online.
ms.openlocfilehash: 5afca0ef1fd5d7437c3974de1424a664c99ab1a1
ms.sourcegitcommit: 9c54fd0a51ece8624155dc543d5df922834aa51e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2019
ms.locfileid: "35701559"
---
# <a name="download-and-install-windows-powershell-51"></a>Скачивание и установка Windows PowerShell 5,1

Если вы используете Windows 10 с обновлением годовщины или Windows Server 2016, у вас уже должно быть Windows PowerShell 5,1. Это связано с тем, что это приложение предустановлено для этих операционных систем.
  
Чтобы узнать, какая у вас версия Microsoft PowerShell, выполните указанные ниже действия на компьютере с операционной системой Windows 7 или Windows Server 2008 R2 или Windows Server 2012.
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные**, **Windows PowerShell** и затем щелкните **Windows PowerShell**.
    
2. В консоли PowerShell введите следующую команду и нажмите клавишу ВВОД:
    
   ```
   Get-Host | Select-Object Version
   ```

3. В окне консоли должна появиться информация примерно следующего вида:
    
    <pre>
    Version <BR>
    ------- <BR>
    4.0
    </pre>

    Если возвращенный номер версии — 5,1, значит вы используете Windows PowerShell 5,1. Если возвращенный номер версии не является 5,1, вам потребуется установить Windows PowerShell 5,1. Вы можете скачать среду Windows Management Framework 5,1, которая содержит Windows PowerShell 5,1, в [центре загрузки Майкрософт](https://www.microsoft.com/en-us/download/details.aspx?id=54616).
  
После того как вы проверили установку Windows PowerShell 5,1, необходимо убедиться, что в PowerShell настроено выполнение удаленных сценариев. Для этого запустите приложение PowerShell от имени администратора. В ОС Windows 7, Windows Server 2008 R2, Windows Server 2012 или Windows Server 2012 R2 выполните следующие действия:
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные** и **Windows PowerShell**. Затем щелкните элемент **Windows PowerShell** правой кнопкой мыши и выберите **Запуск от имени администратора**.
    
2. Если появится диалоговое окно **Контроль учетных записей**, нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
В ОС Windows 8 выполните следующие действия:
  
1. Откройте панель чудо-кнопок и выберите **Поиск**, после чего щелкните правой кнопкой мыши элемент **Windows PowerShell**. Для быстрого доступа к панели чудо-кнопок на любом компьютере под управлением ОС Windows 8 (независимо от наличия сенсорного экрана) нажмите клавишу Windows и, не отпуская ее, клавишу C.
    
2. В панели инструментов внизу экрана выберите пункт **Запуск от имени администратора**.
    
3. Если появится диалоговое окно **Контроль учетных записей**, нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
После запуска PowerShell необходимо разрешить работу с удаленными сценариями в политике выполнения. Для этого в консоли PowerShell введите следующую команду и нажмите клавишу ВВОД:
```
Set-ExecutionPolicy RemoteSigned -Force
```
   
 
> [!NOTE]
> При выполнении предыдущей команды может появиться следующее сообщение об ошибке: > *Set-ExecutionPolicy: доступ к\\реестру кэй'хкэй_локал_мачине программного обеспечения\\Microsoft\\PowerShell\\1 шеллидс\\\\Микрсофт. PowerShell запрещен.* Это сообщение об ошибке обычно появляется, если вы не используете PowerShell с учетными данными администратора. Чтобы исправить эту ошибку, закройте сеанс PowerShell и запустите новый сеанс от имени администратора.
 
Чтобы проверить правильность настройки политики выполнения, в командной строке PowerShell введите следующую команду и нажмите клавишу ВВОД:
  
```
Get-ExecutionPolicy
```

Если настройка выполнена правильно, будет возвращено следующее значение:
  
`RemoteSigned`

Если вы не используете Windows PowerShell 5,1, вам также потребуется скачать и установить платформу Windows Management Framework 5,1 из центра загрузки Майкрософт. Это установочный пакет, включающий Windows PowerShell 5,1 и службу удаленного управления Windows (WinRM) 3,0. Этот пакет установки может потребоваться, если, например, используется Windows 7 с пакетом обновления 1 (SP1), но еще не обновил Windows PowerShell 5,1. Если вы используете Windows Server 2016 или обновление годовщины Windows 10, вам не нужно устанавливать Windows PowerShell 5,1. Windows PowerShell 5,1 предустановлена в этих операционных системах.
  
Перед установкой Windows Management Framework 5,1 выполните указанные ниже действия.
  
- Убедитесь, что вы скачали правильную версию пакета установки. Если вы используете 64-разрядную версию Windows 7 с пакетом обновления 1 (SP1), скачайте файл Win7AndW2K8R2-KB3191566-x64. ZIP. Если вы используете 32-разрядную версию Windows 7, скачайте файл Win7-KB3191566-x86. ZIP.
    
- Если на вашем компьютере установлена ОС Windows 7, проверьте наличие пакета обновления 1 для этой операционной системы.

Если вы не знаете свою версию Windows или не уверены, установлен ли у вас пакет обновления 1 для Windows 7, откройте меню **Пуск**, щелкните правой кнопкой мыши пункт **Компьютер** и выберите пункт **Свойства**. Нужная информация будет представлена в диалоговом окне "Система".
  
Чтобы установить среду Windows Management Framework 5,1, выполните действия, описанные в разделе [Установка и настройка WMF 5,1](https://docs.microsoft.com/powershell/wmf/setup/install-configure).
  
После перезагрузки проверьте работоспособность Windows PowerShell и возможность запуска этого приложения от имени администратора. Для этого выполните следующие действия:
  
1. В меню **Пуск** последовательно выберите пункты **Все программы**, **Стандартные** и **Windows PowerShell**. Затем щелкните элемент **Windows PowerShell** правой кнопкой мыши и выберите **Запуск от имени администратора**.
    
2. Если появится диалоговое окно "Контроль учетных записей", нажмите кнопку **Да**, чтобы разрешить запуск PowerShell с правами администратора.
    
В появившейся консоли PowerShell необходимо убедиться, что служба WinRM запущена и правильно настроена. Для этого в командной строке PowerShell введите следующую команду и нажмите клавишу ВВОД:
  
```
Get-Service winrm
```

На экран будут выведены сведения о службе WinRM:
  
<pre>
Status   Name               DisplayName
------   ----               -----------
Running  winrm              Windows Remote Management (WS-Manag...
</pre>

Если в столбце состояния не указано, что служба WinRM запущена, запустите ее. Для этого введите следующую команду и нажмите клавишу ВВОД:
  
```
Start-Service winrm
```

После запуска службы WinRM выполните следующую команду, чтобы проверить, что в ней используется обычная проверка подлинности:
  
```
winrm set winrm/config/client/auth '@{Basic="True"}'
```

На экране должна появиться информация примерно следующего вида:
  
<pre>
Auth
    Basic = true
    Digest = true
    Kerberos = true
    Negotiate = true
    Certificate = true
    CredSSP = false
</pre>

Если для обычной проверки подлинности установлено значение true, вы можете использовать PowerShell для подключения к Skype для бизнеса Online.
  
[!INCLUDE [LinkedIn Learning Info](../../common/office/linkedin-learning-info.md)]
   
## <a name="related-topics"></a>Статьи по теме
[Настройка компьютера для Windows PowerShell](set-up-your-computer-for-windows-powershell.md) 

  
 
