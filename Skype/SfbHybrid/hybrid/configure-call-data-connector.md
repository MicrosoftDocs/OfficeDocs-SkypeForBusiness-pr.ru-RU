---
title: Настройка соединителя данных вызовов
ms.reviewer: ''
ms.author: crowe
author: CarolynRowe
manager: serdars
audience: ITPro
ms.topic: article
ms.prod: skype-for-business-itpro
localization_priority: Normal
ms.collection: ''
description: Инструкции по настройке соединителя данных вызовов, которые позволяют просматривать телеметрию из локальной сети Skype для бизнеса с помощью средств Skype для бизнеса Online.
ms.openlocfilehash: 1851e1e0c430107a27d706f7bc16ad974c5abaed
ms.sourcegitcommit: a78fee3cad5b58bf41dd014a79f4316cf310c8d1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2019
ms.locfileid: "36160735"
---
# <a name="configure-call-data-connector"></a>Настройка соединителя данных вызовов

В этой статье описывается настройка соединителя данных вызовов (один набор инструментов), позволяющий просматривать данные качества звонков Skype для бизнеса Server с помощью панели мониторинга качества звонков в Skype для бизнеса Online (CQD) и средства анализа вызовов (CA). 

> [!NOTE]
> В общедоступной версии предварительной версии доступна только панель мониторинга службы анализа вызовов.

Дополнительные сведения о преимуществах и преимуществах соединителей данных вызовов, таких как требования к роли и настройка гибридного подключения, приведены в статье [Plan Call Data Connector](plan-call-data-connector.md).

## <a name="enable-monitoring"></a>Включение мониторинга
 
Необходимо настроить сбор данных о вызовах (CDR) и качества взаимодействия (QoE) в мониторинге пула переднего плана с локальными базами данных LCSCdr и QoEMetrics; в противном случае информационные панели анализа вызовов и качества звонков не будут работать с данными. Перед настройкой соединителя данных вызовов выполните действия, описанные в разделе [deploy Monitoring in Skype для бизнеса Server](../../SfbServer/deploy/deploy-monitoring/deploy-monitoring.md) , чтобы настроить как CDR, так и QoE, а также базовый мониторинг.

> [!IMPORTANT]
> Соединитель данных вызовов не будет работать, если мониторинг не включен в интерфейсном пуле.

## <a name="enable-call-data-connector"></a>Включить соединитель данных вызовов

Чтобы настроить и включить соединитель данных вызовов, необходимо использовать следующие командлеты:

| Командлет| Описание|
| :-----------------|---------------:|
| New — Ксклаудкаллдатаконнектион | Сетевой командлет, который устанавливает сборщик данных в сети.|
| Get — Ксклаудкаллдатаконнектион | Оперативный командлет, который получает существующий веб-сборщик данных.|  
| Get — Ксклаудкаллдатаконнектор | Локальный Командлет, который получает сведения о подключении, созданные командлетом New – Ксклаудкаллдатаконнектион. |
| Set — Ксклаудкаллдатаконнектор | Локальный Командлет, сохраняющий локальную копию сведений о подключении, созданную командлетом New – Ксклаудкаллдатаконнектион. |  
| Set — Ксклаудкаллдатаконнекторконфигуратион | Локальный Командлет, который позволяет включать или отключать соединитель и настраивать уровень области.|

> [!NOTE]
> Чтобы стереть конфигурацию и начать заново, используйте командлет Remove – ксклауддатконнекторконфигуратион.

### <a name="configure-your-environment"></a>Настройка среды 

Чтобы настроить среду для включения сборщика данных в Интернете, сначала необходимо войти в Skype для бизнеса Online PowerShell от имени администратора. Дополнительные сведения можно найти [в статье Управление Skype для бизнеса Online с помощью Office 365 PowerShell](https://docs.microsoft.com/office365/enterprise/powershell/manage-skype-for-business-online-with-office-365-powershell).

Существует два способа входа в Skype для бизнеса Online PowerShell:

- В командной консоли Skype для бизнеса Server 2019 (рекомендуемый способ)
- Из другого сеанса PowerShell

#### <a name="log-in-to-skype-for-business-online-powershell-from-the-skype-for-business-server-management-shell-recommended-method"></a>Вход в Skype для бизнеса Online PowerShell из командной консоли Skype для бизнеса Server (рекомендуемый способ)

1. При первом запуске соединителя выполните следующую команду:

   ```
   New-CsCloudCallDataConnection | Set-CsCloudCallDataConnector -TenantId <tenant_id>
   ```

2. Если возникнет сообщение об ошибке, что подключение уже существует, это означает, что подключение к данным вызова уже существует для вашего клиента. В этом случае выполните следующую команду: 

   ```
   Get-CsCloudCallDataConnection | Set-CsCloudCallDataConnector -TenantId <tenant_id>
   ```


#### <a name="log-in-to-skype-for-business-online-powershell-from-another-powershell-session-optional-method"></a>Вход в Skype для бизнеса Online PowerShell из другого сеанса PowerShell (необязательный метод)

1.  При первом запуске соединителя выполните следующую команду: 

    ``` 
    New-CsCloudCallDataConnection 
    ```

2.  Если возникнет сообщение об ошибке, что подключение уже существует, это означает, что подключение к данным вызова уже существует для вашего клиента. В этом случае выполните следующую команду: 

    ```
    Get-CsCloudCallDataConnection  
    ```

Выходные данные вышеуказанных команд содержат значение маркера, которое потребуется при настройке локальной среды следующим образом:

В командной консоли Skype для бизнеса Server укажите следующую команду:

```
Set-CsCloudCallDataConnector -Identity Global -TenantId <tenant_id> -Token <token-copied-from-online>
```

### <a name="configure-the-scope"></a>Настройка области

Вы можете включить соединитель данных вызовов для определенного сайта или для всего развертывания Skype для бизнеса Server с помощью командлета Set-Ксклаудкаллдатаконнекторконфигуратион в командной консоли Skype для бизнеса Server. Например, следующая команда включает соединитель данных вызова в глобальной области:

```
Set-CsCloudCallDataConnectorConfiguration -Identity "global" -EnableCallDataConnector $True
```

В дополнение к глобальным параметрам параметры конфигурации соединителя данных могут быть назначены для области сайта. Это обеспечивает дополнительную гибкость управления, когда дело доходит до мониторинга. Например, администратор может включить переадресацию соединителя данных вызовов для сайта Redmond, но отключить переадресацию соединителя данных вызовов для сайта Dublin, как показано в следующем примере:

```
Set-CsCloudCallDataConnectorConfiguration -Identity "site:Redmond" -EnableCallDataConnector $True
```

```
Set-CsCloudCallDataConnectorConfiguration -Identity "site:Dublin" -EnableCallDataConnector $False
```

Параметры, настроенные в области сайта, имеют приоритет над параметрами, настроенными в глобальной области. Например, предположим, что переадресация соединителя данных вызовов включена в глобальной области, но отключена на уровне сайта (для сайта Redmond). Это означает, что сведения о регистрации вызовов и QoE не будут пересылаться для пользователей на сайте Redmond. Тем не менее, для пользователей на других сайтах (то есть для пользователей, управляемых глобальными параметрами, а не с параметрами сайта Redmond), записываются сведения о вызовах и пересылаются сведения о QoE.

Значения наиболее часто используемых параметров соединителя данных вызовов показаны в следующей таблице.  

|Свойство|Описание|Значение по умолчанию|
|:-----|:-----|:-----|
|Енаблекаллдатаконнектор  <br/> |Указывает, включен ли соединитель данных вызовов. Если задано значение true, записи мониторинга будут пересылаться в оперативный мониторинг.  <br/> |$False  <br/> |
| Удостоверение | Определяет уровень области для команды: глобальная или site.   | глобального  |

## <a name="disable-call-data-connector"></a>Отключить соединитель данных вызовов

Отключение соединителя данных вызовов не приводит к удалению хранилища мониторинга из пула переднего плана, а также удалению или невозможности влияния на внутреннюю базу данных мониторинга. Когда вы отключаете соединитель данных вызовов, вы останавливаете Skype для бизнеса Server на отправку данных о вызовах в облако. 

Вы отключаете соединитель данных вызовов с помощью командлета Set-Ксклаудкаллдатаконнекторконфигуратион в командной консоли Skype для бизнеса Server. Например, следующая команда отключает соединитель данных вызова в глобальной области, присвоив свойству Енаблекаллдатаконнектор значение $False:

```
Set-CsCloudCallDataConnectorConfiguration -Identity "global" -EnableCallDataConnector $False
```

Если вы хотите возобновить передачу данных вызовов в облако, присвойте свойству Енаблекаллдатаконнектор значение $True, как показано в следующем примере:

```
Set-CsCloudCallDataConnectorConfiguration -Identity "global" -EnableCallDataConnector $True
```

## <a name="view-on-premises-data-through-the-online-dashboard"></a>Просмотр локальных данных через веб-панель мониторинга

 После включения соединителя данных вызовов вы можете просматривать данные локального вызова на панели мониторинга анализа вызовов, как описано в статье [использование аналитики вызовов для устранения неполадок низкого качества](https://docs.microsoft.com/skypeforbusiness/using-call-quality-in-your-organization/use-call-analytics-to-troubleshoot-poor-call-quality).


## <a name="for-more-information"></a>Дополнительные сведения

Для получения дополнительных сведений о командлетах можно использовать команду Get-Help в командной консоли Skype для бизнеса Server. Пример:

Get – Help Get – Ксклаудкаллдатаконнектор | превышает

Get – Help Set — Ксклаудкаллдатаконнектор | превышает

Get – Help Set — Ксклаудкаллдатаконнекторконфигуратион | превышает
