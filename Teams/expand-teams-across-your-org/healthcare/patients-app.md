---
title: Обзор приложения "Пациенты"
author: dstrome
ms.author: dstrome
manager: serdars
audience: ITPro
ms.topic: article
ms.service: msteams
search.appverid: MET150
f1.keywords:
- NOCSH
localization_priority: Normal
ms.collection:
- M365-collaboration
- Teams_ITAdmin_Healthcare
appliesto:
- Microsoft Teams
ms.reviewer: anach
description: Узнайте, как интегрировать электронные медицинские записи в приложение "Пациенты" Microsoft Teams с помощью API FHIR.
ms.custom: seo-marvel-apr2020
ROBOTS: NOINDEX, NOFOLLOW
ms.openlocfilehash: 2b4878f67b7738a13e3c1385ee0713d6e3e3d481
ms.sourcegitcommit: 01087be29daa3abce7d3b03a55ba5ef8db4ca161
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2021
ms.locfileid: "51096213"
---
# <a name="integrating-electronic-healthcare-records-into-microsoft-teams"></a>Интеграция электронных историй болезни в Microsoft Teams

> [!NOTE]
> С 30 октября 2020 г. приложение "Пациенты" устарело и заменено приложением [Lists](https://support.microsoft.com/office/get-started-with-lists-in-teams-c971e46b-b36c-491b-9c35-efeddd0297db) в Teams. Данные приложения "Пациенты" хранятся в почтовом ящике группы Office 365, на которой основана команда. Все данные, связанные с приложением "Пациенты", сохраняются в этой группе, но больше недоступны в пользовательском интерфейсе. Пользователи могут повторно создать свои списки с помощью приложения [Lists](https://support.microsoft.com/office/get-started-with-lists-in-teams-c971e46b-b36c-491b-9c35-efeddd0297db).
>
>С помощью приложения Lists медицинские бригады вашей организации здравоохранения могут создавать списки пациентов для различных сценариев: от обходов и собраний междисциплинарных команд до общего наблюдения за пациентами. Ознакомьтесь с шаблоном "Пациенты" в приложении Lists, чтобы начать работу. Дополнительные сведения об управлении приложением Lists в организации см. в статье [Управление приложением Lists](../../manage-lists-app.md).

Эта статья предназначена для ИТ-разработчиков в области здравоохранения, заинтересованных в использовании API FHIR для подключения к Microsoft Teams в медицинской информационной системе. Это позволит обеспечить координацию работы по сфере здравоохранения, которые соответствуют потребностям организации здравоохранения.

В следующих статьях данная статья содержит спецификации интерфейса FHIR для приложения "Пациенты" Microsoft Teams, а также в следующих разделах объясняется, что необходимо для настройки сервера FHIR и подключения к приложению "Пациенты" в среде разработки или клиенте. Кроме того, вам потребуется ознакомиться с документацией выбранного сервера FHIR, который должен быть одним из поддерживаемых вариантов:

- Datica (в рамках [предложения CMI)](https://datica.com/compliant-managed-integration/)
- Infor Cloverleaf (через мост [Infor FHIR)](https://pages.infor.com/hcl-infor-fhir-bridge-brochure.html)
- Redox (через [сервер R^FHIR)](https://www.redoxengine.com/fhir/)
- Dapasoft (через [Corolar on FHIR)](https://www.dapasoft.com/corolar-fhir-server-for-microsoft-teams/)

> [!NOTE]
> Этот процесс не включает шаги, которые включают в себя центр администрирования Microsoft Teams или командлеты PowerShell. Настройка полностью происходит на стороне сервера или службы FHIR, а также в клиенте приложения "Пациенты".

Ниже приведена архитектура приложения "Пациенты":

![Схема архитектуры приложения "Пациенты"](../../media/patients-app-architecture.png)

В следующих разделах объясняется, что для интеграции с приложением "Пациенты" должен соответствовать уровень доступа только для данных FHIR для приложения "Пациенты", который должен выполняться для интеграции с приложением "Пациенты" сервером FHIR (или API С ПОДДЕРЖКОЙ FHIR):

- Ожидания проверки подлинности пользователей
- Функциональные и технические требования интерфейса интеграции
- Ожидания производительности и надежности
- Ожидания по ресурсам, которые будут поддерживаться с помощью FHIR для приложения "Пациенты"
- Процесс интеграции и ожидаемая модель взаимодействия
- Начало работы с FHIR и некоторые распространенные проблемы, с которыми сталкиваются приложения "Пациенты"
- Будущие требования для следующей итерации приложения "Пациенты"

> [!NOTE]
> В следующих разделах слово "партнер" или "партнер interop" используется для ссылки на сторонние организации, которые обеспечивают интеграцию с системами EHR для приложения "Пациенты" с помощью FHIR и внедряют сервер FHIR в соответствии со спецификациями, указанными в списке.

## <a name="functional-and-technical-requirements"></a>Функциональные и технические требования  

### <a name="authentication"></a>Проверка подлинности  

Авторизация на  уровне приложения без поддержки авторизации на уровне пользователя — это наиболее распространенный способ выполнения преобразований данных и передачи подключений к данным EHR с помощью FHIR, несмотря на то что система EHR может реализовать авторизацию на уровне пользователя. Службе Interop Service (partner) предоставляется повышенный доступ к данным EHR, и когда они выставляют те же данные, что и соответствующие ресурсы FHIR, контекст авторизации не передается interop Service Consumer (приложение Patients), интегрированному со службой Interop Service или Платформой. Приложение "Пациенты" не сможет принудительно выполнять авторизацию на уровне пользователя, но поддерживает приложение для проверки подлинности приложений между приложением "Пациенты" и службой партнера Interop.

Модель проверки подлинности "Приложения к приложению" описана ниже.

Проверка подлинности службы должна проходить через поток [](https://www.oauth.com/oauth2-servers/access-tokens/client-credentials/)учетных данных клиента OAuth 2.0. Служба партнера должна предоставлять следующие услуги:

1. Служба партнеров позволяет приложению "Пациенты" создать учетную запись партнера, которая позволяет приложению "Пациенты" создавать и создавать собственные учетные записи client_id и client_secret, управлять которыми можно с помощью портала проверки подлинности на сервере проверки подлинности партнера.

2. Партнерская служба владеет системой проверки подлинности и авторизации, которая проверяет предоставленные учетные данные клиента и возвращает маркер доступа с подсказкой клиента (как описано ниже).

3. В целях безопасности или в случае секретного нарушения приложение "Пациенты" может повторно создать секрет, сделать ее недействительной или удалить старую секретную (ее пример также можно найти на портале Azure — регистрация приложений AAD).

4. Конечная точка метаданных с заявлением о соответствии должна быть неконтентирована, она должна быть доступна без маркера проверки подлинности.

5. Служба партнеров предоставляет конечную точку маркера для приложения "Пациенты" для запроса маркера доступа с использованием потока учетных данных клиента. URL-адрес маркера для каждого сервера авторизации должен быть частью заявления о соответствии (возможности) FHIR, извлекаемого из метаданных на сервере FHIR, как в этом примере:

    ```
    {
        "resourceType": "CapabilityStatement",
        .
        .
        .
        "rest": [
            {
                "mode": "server",
                "security": {
                    "extension": [
                        {
                            "extension": [
                                {
                                    "url": "token",
                                    "valueUri": "https://login.contoso.com/145f4184-1b0b-41c7-ba24-b3c1291bfda1/oauth2/token"
                                },
                                {
                                    "url": "authorize",
                                    "valueUri": "https://login.contoso.com/145f4184-1b0b-41c7-ba24-b3c1291bfda1/oauth2/authorize"
                                }
                            ],
                            "url": "http://fhir-registry.smarthealthit.org/StructureDefinition/oauth-uris"
                        }
                    ],
                    "service": [
                        {
                            "coding": [
                                {
                                    "system": "https://hl7.org/fhir/ValueSet/restful-security-service",
                                    "code": "OAuth"
                                }
                            ]
                        }
                    ]
                },
                .
                .
                .
            }
        ]
    }
    ```

Запрос маркера доступа состоит из следующих параметров:

```http
POST /token HTTP/1.1
Host: authorization-server.com

grant-type=client_credentials
&client_id=xxxxxxxxxx
&client_secret=xxxxxxxxxx
```

Партнерская служба предоставляет приложение client_id и client_secret для пациентов, управляемое через портал регистрации через веб-сайт со стороны партнера. Служба партнеров предоставляет конечную точку для запроса маркера доступа с помощью потока учетных данных клиента. Для успешного отклика необходимо включить token_type, access_token и expires_in параметры.

### <a name="routing-mapping-aad-tenant-to-the-provider-endpoint"></a>Маршрутирование: сопоставление клиента AAD с конечной точкой поставщика

Приложение "Пациенты" подключается к партнерской службе через одну конечную точку. Партнерская служба владеет и ведет механизм для связи каждого клиента Майкрософт (AAD-ИД клиента) с соответствующим поставщиком услуг здравоохранения (FHIR-сервером), с помощью которых работает партнерская служба.

Сопоставление клиента AAD с конечной точкой поставщика использует его ИД (GUID). Приложение "Пациенты" передает ИД клиента в области действия, запрашивая маркер доступа для каждого запроса. Служба партнеров сохраняет сопоставление ИД клиента с конечной точкой поставщика и перенаправляет запросы в конечную точку поставщика на основе его ИД клиента. Для этого партнеры по-своему поддерживают конфигурацию (вручную или через портал в рамках передачи организаций-поставщиков на свою платформу Interop).

Ниже показан рабочий процесс проверки подлинности и маршрутизации.

![Схема рабочего процесса проверки подлинности и маршрутизации](../../media/Patient-app-6.png)

1. Запрос маркера доступа приложения с помощью отправки:
 
    ```
    {   grant_type: client_credentials,
        client_id: xxxxxx, 
        client_secret: xxxxxx,
        scope: {Provider Identifier, Ex: tenant ID}
    }
    ```

2. Ответ с помощью маркера приложения:

    ```
    {  access_token: {JWT, with scope: tenant ID},
       expires_in: 156678,
       token_type: "Bearer",
    }
    ```

3. Запрос защищенных данных с помощью маркера Access.

4. Сообщение о авторизации: выберите нужный сервер FHIR для маршрутизации из ИД клиента в области.

5. Отправляет защищенные приложение данные с авторизованнго сервера FHIR после проверки подлинности с помощью маркера приложения.

## <a name="interfaces"></a>Интерфейсы

Конкретные вызовы и поля, используемые приложением "Пациенты", описаны в следующих статьях. Выберите интерфейс, соответствующий API сервера FHIR или FHIR.

- [Характеристики интерфейса DSTU2](dstu2-interface.md)
- [Характеристики интерфейса STU3](stu3-interface.md)

## <a name="performance-and-reliability"></a>Производительность и надежность

Пока приложение "Пациенты" находится в режиме личной предварительной версии, нет никаких гарантий производительности. К факторам, влияющим на производительность, относятся относительные задержки всех переходов рабочего процесса, начиная от EHR в среде системы здравоохранения до партнера по работе с interop, включая сервер FHIR и приложение "Пациенты" в Office 365.

![Изображение производительности партнеров Interop](../../media/FHIR.png)

## <a name="get-started-with-fhir"></a>Начало работы с FHIR  

Если вы впервые используете службу FHIR и вам нужен простой доступ к FHIR-серверу, который можно открыть в интерфейсе интеграции с EHR Microsoft Teams, все разработчики могут использовать сервер FHIR с открытым кодом. Дополнительные данные о сервере FHIR Server с открытым кодом, который доступен корпорации Майкрософт, и его развертывании для организаций, см. в статье "Что такое [FHIR Server](/azure/healthcare-apis/overview-open-source-server) для Azure".

Вы также можете использовать среду EHR Open HSPC для создания EHR, который также поддерживает открытый сервер FHIR, и использовать его для управления приложением "Пациенты". Рекомендуем ознакомиться с документацией по песочнице [HSPC.](https://healthservices.atlassian.net/wiki/spaces/HSPC/pages/64585866/HSPC+Sandbox) Песочница не только обеспечивает простой, ориентированный на пользовательский интерфейс и удобное для пользователя способом создания, добавления и редактирования пациентов, но и предоставляет несколько примеров для начала работы.