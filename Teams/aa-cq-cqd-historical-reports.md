---
title: Auto Attendant & Call Queue Historical Report
ms.author: mikeplum
author: MikePlumleyMSFT
manager: serdars
ms.reviewer: colongma
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
ms.collection:
- M365-voice
search.appverid: MET150
audience: Admin
appliesto:
- Skype for Business
- Microsoft Teams
localization_priority: Normal
f1.keywords:
- CSH
ms.custom:
- Reporting
- ms.teamsadmincenter.directrouting.cqd
- ms.lync.lac.ToolsCallQualityDashboard
description: Узнайте, как использовать отчет Power BI панели мониторинга качества звонка для просмотра исторических данных автосекатора и очереди вызовов.
ms.openlocfilehash: 77b74eb48a16992f7f601bd6cccf3c61b421fc30
ms.sourcegitcommit: 24ae0c223e9d915c505146d422ad049c88a4ed51
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "53023250"
---
# <a name="auto-attendant--call-queue-historical-report"></a>Auto Attendant & Call Queue Historical Report

В шаблоне Power BI для автосектаря CQD Teams & истории очереди вызовов есть три отчета:

- Автоответ: отображение аналитики для звонков, которые будут приходить в автоответы.
- Очередь звонков— отображение аналитики для звонков, которые будут приходить в очереди звонков.
- Временная шкала агента— отображение временной шкалы, в которой агенты активны при звонках в очереди звонков.

В этих отчетах используются данные из магазина [данных панели мониторинга](CQD-Power-BI-query-templates.md) качества звонка. Они позволяют организациям сообщать о количестве звонков, обрабатываемых автоответами и очередями звонков.  Они также дают представление о производительности агента в очередях вызовов.

## <a name="what-are-the-requirements"></a>Каковы требования? 

Необходимо установить Power BI Desktop. Вы можете установить его из [Магазина Microsoft Windows](https://aka.ms/pbidesktopstore).

Вы можете использовать бесплатную версию Power BI Desktop. Минимальная совместимая версия: 2.85.681.0 (сентябрь 2020 г.).

## <a name="permissions-to-access-the-cqd-pipeline"></a>Разрешения на доступ к каналу CQD

Учетная запись, используемая для просмотра отчета AA & CQ Analytics, должна иметь разрешения на доступ к каналу данных CQD. Дополнительные сведения см. в [роли доступа к CQD.](./turning-on-and-using-call-quality-dashboard.md#assign-admin-roles-for-access-to-cqd)

## <a name="installation"></a>Установка 

В следующих действиях предполагается, что на компьютере уже установлено приложение Power BI Desktop и что у вашей учетной записи есть необходимые разрешения на доступ к каналу данных CQD.

Выполните следующие действия:

- Скачайте [шаблоны запросов Power BI CQD](https://www.microsoft.com/download/details.aspx?id=102291) и сохраните ZIP-файл в каталоге на компьютере.

- Дважды щелкните ZIP-файл, чтобы открыть его.

- Дважды щелкните файл шаблона "CQ и AA combined Analytics 20201105.pbit" и запустится Power BI Desktop.

- Вам будет предложено выбрать область CQD-канал данных. Выберите регион, в котором находится ваш клиент.

  :::image type="content" source="media/cqd-teams-aa-cq-historical-report-01.png" alt-text="Снимок экрана: выбор области CQD-каналов данных":::

- Регион, в котором находится ваш клиент, можно получить с помощью [cmdlet Get-CsTenant.](/powershell/module/skype/get-cstenant)

    ```PowerShell
    (Get-CsTenant).ServiceInstance


    microsoftcommunicationsonline/noam-4a-s7
    ```

    - Регион будет отображаться после того, как в примере выше, где **/** есть регион: noam

 - Отчет будет запущен с образцом данных.
 
 - Чтобы увидеть собственные данные, выберите Обновить на вкладке Главная в области Запросы в Power BI Desktop. 

   :::image type="content" source="media/cqd-teams-aa-cq-historical-report-02.png" alt-text="Снимок экрана: выбор параметра обновления":::

- После этого вам будет предложено войти в нее. Выберите **Учетная запись организации,** а затем выберите **Войти**.

  :::image type="content" source="media/cqd-teams-aa-cq-historical-report-03.png" alt-text="Снимок экрана: вход":::

- Выберите **Подключить и** посмотрите обновление данных.

## <a name="data-latency-and-aa--cq-analytics"></a>Задержка данных и аналитика CQ & AA

Данные будут доступны в канале данных CQD в течение 30 минут.

Чтобы увидеть новые аналитические данные, необходимо обновить данные. 

## <a name="customization"></a>Настройки 

Вы можете настроить определенные аспекты визуализации отчетов, например добавить или удалить поля, которые будут показаны в различных визуализациях, изменить тип диаграммы и так далее.

Добавить дополнительные поля данных в отчет невозможно.

### <a name="change-color-schema"></a>Изменение цветовой схемы 

Ниже предполагается, что вы уже выполнили действия по установке.

Выполните следующие действия:
- На **ленте выберите вкладку** Вид.

  :::image type="content" source="media/cqd-teams-aa-cq-historical-report-04.png" alt-text="Снимок экрана: выбор вкладки "Вид" для изменения цветовой схемы":::

- Выберите цветовую схему в списке.

  :::image type="content" source="media/cqd-teams-aa-cq-historical-report-05.png" alt-text="Снимок экрана: различные цветовые схемы":::
  
## <a name="auto-attendant-and-call-queue-historical-reports-definitions"></a>Auto Attendant and Call Queue Historical Reports Definitions

### <a name="cloud-auto-attendant-analytics"></a>Аналитика автоотвода в облаке

#### <a name="report-description"></a>Описание отчета

|Раздел отчета                          |Описание                                                       |
|:---------------------------------------|:-----------------------------------------------------------------|
|Источник входящих<sup>вызовов 1</sup>        |Распространение звонков по внутреннему или внешнему источнику звонков             |
|Итоги метода поиска по каталогу          |Распределение звонков по типу поиска                               |
|Действие вызываемой вызовы                           |Распространение звонков по приемнику звонков                             |
|Результат вызова                             |Распространение звонков по состояниям конечного звонка                          |
|Количество действий вызываемой вызовы                     |Распределение звонков по числовому действию, используемом во время звонка        |


#### <a name="report-to-cqd-table-and-field-mapping"></a>Сопоставление таблиц и полей отчета с CQD

|Вкладка "Отчет"            |Имя таблицы отчета     |Глобальный фильтр                          |
|:---------------------|:---------------------|:--------------------------------------|
|Автосекретаря        |fAutoAttendant        |AAStartTime находится в течение последних 28 дней |


|Имя таблицы отчета            |Имя таблицы-источника            |Обработки       |
|:----------------------------|:----------------------------|:----------------|
|fAutoAttendant               |AutoAttendant                |Source = AutoAttendant, <br>#"Отфильтрованные строки" = Table.SelectRows(Source, each true), <br>#"Auto Attendant" = Table.AddColumn(#"Filtered Rows", "AA Name", each List.First(Text.Split([AAIdentity], "@")) <br>#"Changed Type" = Table.TransformColumnTypes(#"Auto Attendant",{{"AAStartTime", type datetime}}), <br>#"Удалены столбцы" = Table.RemoveColumns(#"Changed Type",{"AAIdentity"}) |


|Раздел отчета                                  |Использовано полей                              |Примененные фильтры     |
|:-----------------------------------------------|:------------------------------------------|:-------------------|
|Выбор даты                                   |AAStartTime                                |Нет                |
|Автосекретаря                                  |Имя АА                                    |Нет                |
|Источник входящих<sup>вызовов 1</sup>                |Тип вызова<br>TotalCallCount                |Внешние звонки: внешний тип звонка<br>Внутренние звонки: тип звонка внутренний |
|Итоги метода поиска по каталогу                  |AADirectorySearchMethod<br>TotalCallCount  |AADirectorySearchMethod abs_search_dtmf или abs_search_name    |
|Действия вызываемой стороны                                  |AATransferAction<br>TotalCallCount         |Нет                                                             |
|Среднее количество секунд в АА<br>Среднее число действий вызываемой стороны |AAChainDuration<br>AACallerActionCount     |Нет                                                             |
|Результаты зовов                                    |AACallResult<br>TotalCallCount             |Нет                                                             |
|Количество действий вызываемой стороны                            |AACallerActionCount<br>TotalCallCount      |Нет                                                             |
|Нижняя часть отчета                         |Имя АА<br>AACallFlow<br>AACallResult<br>AAChainDuration<br>Тип вызова<br>TotalCallCount |Нет                |

#### <a name="fautoattendant-cqd-fields-description"></a>Описание полей CQD fAutoAttendant

|Имя                                    |Тип данных                |Описание                            |
|:---------------------------------------|:------------------------|:--------------------------------------|
|Имя АА                                 |Текст                     |Имя учетной записи ресурса, вложенной в автоотчет<br><br>Если полное имя учетной записи **ресурса aa_test@microsoft.com** это значение будет: **aa_test** |
|AACallerActionCount                     |целое число             |Суммировать: Сумма<br>Количество действий, выбранных звонив в автоотзывщике во время звонка  |
|AACallFlow                              |Текст                     |Инкапсулирует различные состояния вызова автоответа — возможные значения:<br><br>§ abs_search<br>Объявление §<br>§ automatic_menu<br>§ call_termination<br>§ call_transfer<br>§ first_level_menu<br>§ main_menu<br>§ speech_input_confirmation<br>§ user_selection |
|AACallResult                            |Текст                     |Результат последнего звонка : возможные значения:<br><br>§ failed_to_establish_media<br>§ failover_to_operator<br>§ oaa_chain_too_long<br>§ oaa_session_too_long<br>§ service_declined<br>§ service_terminated<br>§ terminated_automatic_selection<br>§ terminated_no_operator<br>§ terminated_transfer_failed<br>***§ transferred_to_operator***<br>§ transferred_to_receptionist<br>§ transferred_to_self<br>§ transferred_to_shared_voicemail<br>§ transferred_to_user<br>§ неизвестно<br>§ user_terminated |
|AAChainDuration                         |десятичной число           |Суммировать: Сумма<br>Длительность вызова в автозаводе                     |
|AAChainIndex                            |Текст                     |                                                                         |
|AAConnectivityType                      |Текст                     |Тип звонка — возможные значения:<br><br>§ ExternalCall<br>§ InternalCall |
|AACount                                 |Текст                     |Количество автозаводников, участвующих в звонке                               |
|AADirectorySearchMethod                 |Текст                     |Метод поиска в последней адресной книге: возможные значения:<br><br>§ abs_search_dtmf<br>§ abs_search_extension_x<br>§ abs_search_name |
|AAStartTime                             |дата и время                |Время начала вызова автозавода                                           |
|AATransferAction                        |Текст                     |Целевой тип пере звонока: возможные значения:<br><br>***§ приложение — сущность приложения голосового** приложения _<br> § external_pstn <br>_§ hunt_group - Организация очереди *_вызовов_* _<br>_ * _§ orgaa — сущность автоотправления организации_**<br>§ shared_voicemail<br>§ неизвестно<br>§ пользователь |
|Тип<sup>звонка 1</sup>                   |Текст                     |Тип звонка — возможные значения:<br><br>§ Внешний<br>§ Внутренние         |
|IsAAInvolved                            |Текст                     |Всегда 1                                                                 |
|PSTNMinutes                             |целое число             |Суммировать: Сумма<br>Общее использование минут                                     |
|TotalCallCount                          |целое число             |Суммировать: Сумма<br>Всегда 1 — используется для предоставления суммы всех звонков            |


### <a name="cloud-call-queue-analytics"></a>Аналитика очереди облачных вызовов

#### <a name="report-description"></a>Описание отчета

|Раздел отчета                          |Описание                                                        |
|:---------------------------------------|:------------------------------------------------------------------|
|Источник входящих<sup>вызовов 1</sup>        |Распространение звонка по внутреннему или внешнему источнику вызовов              |
|Громкость вызова                             |Распределение вызовов по очередям вызовов                                |
|Результат для вызываемой связи                           |Распространение звонка по результатам звонка                                |
|Общее действие по вызову в timeout/Overflow      |Распределение звонка NOT forwarded(abandoned) по результатам звонка       |
|Итоги для целевой передачи и переадвартовки          |Распространение звонка, переадвароваемого по результату звонка                      |
|Отношение отказа от звонков                   |Отношение успешного количества вызовов к отмененным                        |
|Средняя продолжительность сеанса (в секундах)        |Продолжительность звонка в секундах с группировкой по отмененным и успешным звонкам       |

#### <a name="report-to-cqd-table-and-field-mapping"></a>Сопоставление таблиц и полей отчета с CQD

|Вкладка "Отчет"         |Имена таблиц отчетов                                                          |Глобальный фильтр |
|:------------------|:---------------------------------------------------------------------------|:-------------|
|Очередь вызовов         |Даты<br>dCQ-CQIdenity<br>fCallQueueAnalytics<br>fCallQueueFinalStateAction |Нет          |
 
|Имя таблицы отчета            |Имя таблицы-источника            |Обработки       |
|:----------------------------|:----------------------------|:----------------|
|Даты                        |Даты                        |Нет             |
|dCQ-CQIdentity               |CallQueueAnalytics           |Source = CallQueueAnalytics, <br>#"Removed Columns" = Table.RemoveColumns(Source,{"Call Count", "Call Queue Call Result", "Date", "PSTN Connectivity Type", "Call Queue Target Type", "PSTN Total Minutes"}),<br>Distinct = Table.Distinct(#"Removed Columns") |
|fCallQueueAnalytics          |CallQueueAnalytics           |Нет             |
|fCallQueueFinalStateAction   |CallQueueFinalStateAction    |Нет             |

|Раздел отчета                      |Таблица > полей                |Примененные фильтры       |
|:-----------------------------------|:-------------------------------------|:---------------------|
|Выбор даты                       |Даты и > даты и времени                     |Нет                  |
|Удостоверение очереди вызовов                 |dCQ-CQIdentity -> очереди вызовов |Нет                  |
|Источник входящих<sup>вызовов 1</sup>    |fCallQueueAnalytics -> количество вызовов<br>fCallQueueAnalytics -> Тип звонка    |Внешние звонки: внешний тип звонка<br>Внутренние звонки: тип звонка — внутренний |
|Avg Waiting Time                    |fCallQueueFinalStateAction -> Средняя длительность звонка (в секундах) |Перед передачей: результат звонка в очереди звонка agent_joined_conference или transferred_to_agent<br>Перед повесить трубку: результат звонка в очереди звонка не agent_joined_conference или transferred_to_agent |
|Результат вызова                         |fCallQueueAnalytics -> количество вызовов<br>fCallQueueAnalytics -> call Queue Call Result | Нет |
|Timeout/Overflow calls total action |fCallQueueFinalStateAction -> Call Count<br>fCallQueueFinalStateAction -> Call Queue Final State Action |Действие "Конечное состояние очереди вызовов" не переадпоряется |
|Итоги по целевому объекту transfer/Forard       |fCallQueueAnalytics -> количество вызовов<br>fCallQueueAnalytics -> тип очереди вызовов |Нет |
|Громкость вызовов                        |fCallQueueAnalytics -> количество вызовов<br>fCallQueueAnalytics -> определение очереди вызовов<br>fCallQueueAnalytics -> date |Нет |
|Отмененные звонки                     |fCallQueueAnalytics -> %Abandoned Calls<br>fCallQueueAnalytics -> количество вызовов<br>fCallQueueAnalytics -> date<br>fCallQueueAnalytics -> IsAbandoned |IsAbandoned is True |
|Средняя продолжительность сеанса (в секундах)    |fCallQueueFinalStateAction -> Средняя длительность звонка<br>fCallQueueFinalStateAction -> Date<br>fCallQueueFinalStateAction -> IsAbandoned |Нет |

#### <a name="dcq-cqidenity-cqd-fields-description"></a>Описание полей DCQ-CQIdenity CQD

|Имя                                    |Тип данных                |Описание                            |
|:---------------------------------------|:------------------------|:--------------------------------------|
|Удостоверение очереди вызовов                     |Текст                     |Имя учетной записи ресурса, подключенной к очереди вызовов<br><br>Если полное имя учетной записи **ресурса cq_test@microsoft.com** это значение будет: **cq_test** |

#### <a name="fcallqueueanalytics-cqd-fields-description"></a>Описание полей CQD для fCallQueueAnalytics

|Имя                                    |Тип данных                |Описание                                                                |
|:---------------------------------------|:------------------------|:--------------------------------------------------------------------------|
|Количество вызовов                              |целое число             |Суммировать: Сумма<br>Число звонков                                          |
|Результат вызова в очереди вызовов                  |Текст                     |Конечное состояние очереди вызовов : возможные значения:<br><br>§ agent_joined_conference<br>§ отклонено<br>§ отключена<br>§ ошибка<br>§ не удалось<br>§ недопустимый<br>§ переполнение<br>§ timed_out<br>§ transferred_to_agent |
|Удостоверение очереди вызовов                     |Текст                     |Имя учетной записи ресурса, подключенной к очереди вызовов<br><br>Если полное имя учетной записи **ресурса cq_test@microsoft.com** это значение будет: **cq_test** |
|Тип целевого типа очереди вызовов                  |Текст                     |***Целевой тип перенаправления вызовов: возможные значения:***<br><br>§ ApplicationEndpoint<br>§ Почтовый ящик<br>§ Other<br>§ Пользователь |
|Тип<sup>звонка 1</sup>                   |Текст                     |Тип звонка — возможные значения:<br><br>§ Внешний<br>§ Внутренние           |
|Дата                                    |дата и время                |Дата начала и время начала и времени (в часах) очереди вызовов (UTC)                           | 
|IsAbandoned                             |true/false               |True, если агент не отвечает на звонок                                   |
|Тип подключения через ПС                  |Текст                     |Тип звонка — возможные значения:<br><br>§ ExternalCall<br>§ InternalCall   |
|Общая сумма минут по ПСПС                      |целое число             |Суммировать: Сумма<br>Общее использование минут для звонков по ОКП                       |

#### <a name="fcallqueueanalytics-measures-description"></a>описание мер fCallQueueAnalytics

|Имя                                    |Тип данных                |Описание                              |
|:---------------------------------------|:------------------------|:----------------------------------------|
|***% отмененных звонков***                 |Процент               |Мера: TotalCallCount / Total Calls<br>Отношение успешного количества вызовов к отмененным    |
|Всего звонков                             |целое число             |Мера: агент суммы ответил на звонки        |
|TotalCallCount                          |целое число             |Мера: Sum(Количество зовов)                 |

#### <a name="fcallqueuefinalstateaction--cqd-fields-description"></a>fCallQueueFinalStateAction CQD fields description

|Имя                                    |Тип данных                |Описание                                        |
|:---------------------------------------|:------------------------|:--------------------------------------------------|
|Средняя длительность звонка (в секундах)         |десятичной число           |Суммировать: Сумма<br>Средняя длительность звонка в секундах |
|Количество вызовов                              |целое число             |Суммировать: Сумма<br>Число звонков                  |
|Результат вызова в очереди вызовов                  |Текст                     |Конечное состояние очереди вызовов : возможные значения:<br><br>§ agent_joined_conference<br>§ отклонено<br>§ отключена<br>§ ошибка<br>§ не удалось<br>§ недопустимый<br>§ переполнение<br>§ timed_out<br>§ transferred_to_agent |
|Действие "Конечное состояние очереди вызовов"           |Текст                     |Конечное действие очереди вызовов — возможные значения:<br><br>§ отключить<br>§ disconnect_with_busy<br>§ failed_to_accept_call<br>§ вперед<br>§ shared_voicemail<br>§ другое<br>§ голосовая почта |
|Удостоверение очереди вызовов                     |Текст                     |Имя учетной записи ресурса, подключенной к очереди вызовов<br><br>Если полное имя учетной записи **ресурса cq_test@microsoft.com** это значение будет: **cq_test** |
|Дата                                    |дата и время                |Дата начала и время начала и времени (в часах) очереди вызовов (UTC)   |
|IsAbandoned                             |true/false               |True, если агент не отвечает на звонок           |


### <a name="cloud-call-queue-agent-timeline"></a>Временная шкала агента очереди облачных вызовов

#### <a name="report-description"></a>Описание отчета

|Раздел отчета                                          |Описание                                                  |
|:-------------------------------------------------------|:------------------------------------------------------------|
|# звонки от агента                                        |Распространение звонка по очереди вызовов и агенту                 |
|Общая длительность звонка (в секундах) по агенту и очереди вызовов   |Общая длительность (в секундах) звонка от агента и очереди вызовов     |
|Средняя длительность звонка (в секундах) по имени агента           |Средняя длительность (в секундах) звонка агентом                  |

#### <a name="report-to-cqd-table-and-field-mapping"></a>Сопоставление таблиц и полей отчета с CQD

|Вкладка "Отчет"         |Имена таблиц отчетов        |Глобальный фильтр |
|:------------------|:-------------------------|:-------------|
|Временная шкала агента     |fAgentTimelineAnalytics   |Нет          |
 
|Имя таблицы отчета            |Имя таблицы-источника            |Обработки       |
|:----------------------------|:----------------------------|:----------------|
|fAgentTimelineAnalytics      |AgentTimelineAnalytics       |Source = AgentTimelineAnalytics, <br>#"Changed Type" = Table.TransformColumnTypes(Source,{{"Call Count", Int64.Type}, {"Call Duration (Minute)", Int64.Type}, {"Average Call Duration (Second)", type number}, {"Date", type date}})|

|Раздел отчета                                |Использовано полей                         |Примененные фильтры       |
|:---------------------------------------------|:-------------------------------------|:---------------------|
|Имя агента                                    |Имя агента                            |Нет                  |
|Имя очереди вызовов                               |Имя очереди вызовов                       |Нет                  |
|#Calls по агенту                               |Имя агента<br>Количество вызовов<br>Дата      |Нет                  |
|Распределение по агенту и очереди вызовов          |Имя агента<br>Количество вызовов<br>Длительность вызова (в минутах)<br>Имя очереди вызовов |Нет                      |
|Слева внизу                                   |Имя агента<br>Средняя длительность звонка (секунды)<br>Количество вызовов<br>Длительность вызова (минута)<br>Имя очереди вызовов | Нет |
|Средняя длительность звонка (в секундах) по имени агента |Имя агента<br>Средняя длительность звонка (секунды)<br>Количество вызовов<br>Длительность вызова (минута)<br>Имя очереди вызовов | Нет |

#### <a name="fagenttimelineanalytics-cqd-fields-description"></a>Описание полей CQD для fAgentTimelineAnalytics

|Имя                                    |Тип данных                |Описание                                         |
|:---------------------------------------|:------------------------|:---------------------------------------------------|
|Имя агента                              |Текст                     |Имя пользователя (UPN)<br>Если полное имя пользователя **user@microsoft.com** это значение будет: **пользователь** |
|Средняя длительность звонка (секунды)          |десятичной число           |Суммировать: Сумма<br>Средняя длительность звонков в очереди звонков в секундах |
|Количество вызовов                              |целое число             |Суммировать: Сумма<br>Количество звонков, обрабатываемого агентом                    |
|Длительность вызова (минута)                  |целое число             |Суммировать: Сумма<br>Общая длительность звонков в очереди звонков в минутах  |
|Имя очереди вызовов                         |Текст                     |Имя учетной записи ресурса, подключенной к очереди вызовов<br><br>Если полное имя учетной записи **ресурса cq_test@microsoft.com** это значение будет: **cq_test** |
|Дата                                    |Дата                     |                                                    |


## <a name="known-issues"></a>Известные проблемы

- В очереди вызовов и автоотехниках вместо имен очереди зовов и автоотехников отображается ИД учетной записи ресурса.  Чтобы отобрать весь трафик для автозавода или очереди вызовов, необходимо выбрать все учетные записи ресурсов, которые назначены автозаводщику или очереди вызовов.

- На панели мониторинга доступен только 28-й день истории, так как данные очереди вызовов и автоотетаря считаются личными данными и подотгодиняются политикам хранения данных.

- <sup>1</sup> **Источник входящих** вызовов в графиках автозавода и очереди зовов показывает конечный источник, а не исходный источник зова. Например, если автозаводщик получает внешний звонок и переносит звонок другому  автозаводу или очереди зовов, источник входящих зовов будет называться Внутренний.
