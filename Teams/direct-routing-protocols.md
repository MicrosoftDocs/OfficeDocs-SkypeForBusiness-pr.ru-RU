---
title: 'Прямая маршрутизация телефонной системы Teams: определения и стандарты RFC'
author: CarolynRowe
ms.author: crowe
manager: serdars
ms.date: 12/16/2019
ms.topic: article
ms.service: msteams
audience: admin
ms.collection:
- M365-voice
ms.reviewer: nmurav
search.appverid: MET150
f1.keywords:
- NOCSH
description: Как прямая маршрутизация телефонной системы Майкрософт реализует стандартные протоколы RFC.
appliesto:
- Microsoft Teams
ms.openlocfilehash: 01dbd61748d14ef21a600b2e4f44a306517e46d9
ms.sourcegitcommit: 173bdbaea41893d39a951d79d050526b897044d5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2022
ms.locfileid: "67271244"
---
# <a name="direct-routing---definitions-and-rfc-standards"></a>Прямая маршрутизация — определения и стандарты RFC

В этой статье описывается, как прямая маршрутизация телефонной системы Майкрософт реализует стандартные протоколы RFC. Эта статья предназначена для голосовых администраторов, которые отвечают за настройку подключения между локальным пограничным контроллером сеансов (SBC) и прокси-службой протокола Инициации сеансов (SIP).

Клиентский интерфейс SBC со следующими компонентами в серверной части Microsoft Teams: 

- **Прокси-сервер SIP** для сигнализации. Это компонент прямой маршрутизации с выходом в Интернет, который обрабатывает подключения SIP (TLS) между контроллерами SBC и прямой маршрутизатора.

- **Обработчики мультимедиа** для мультимедиа. Это компонент прямой маршрутизации с выходом в Интернет, который обрабатывает трафик мультимедиа. Этот компонент использует протоколы SRTP и SRTCP.


Дополнительные сведения о прямой маршрутизации см. в разделе ["Прямая маршрутизация телефонной системы"](direct-routing-landing-page.md).

Дополнительные сведения о том, как прямая маршрутизация реализует протокол SIP, см. в разделе ["Прямая маршрутизация — протокол SIP"](direct-routing-protocols-sip.md).

## <a name="rfc-standards"></a>Стандарты RFC

Прямая маршрутизация соответствует стандартам RFC.  SBC, подключенный к прямой маршрутизации, также должен соответствовать следующим RFC (или их последователям). 

### <a name="standards-applicable-to-devices-that-support-non-media-bypass-mode"></a>Стандарты, применимые к устройствам, поддерживающих режим обхода без носителя 

Следующие стандарты применимы к устройствам, поддерживающих только режим обхода без носителя:

- [RFC 3261 SIP](https://tools.ietf.org/html/rfc3261): протокол инициации сеанса
- [RFC 3325](https://www.ietf.org/rfc/rfc3325). Частное расширение протокола инициации сеанса для утверждения удостоверения в доверенных сетях — разделы об обработке заголовка P-Asserted-Identity. Прямая маршрутизация отправляет P-Asserted-Identity с заголовками идентификатора конфиденциальности. 
- [RFC 4244](https://www.ietf.org/rfc/rfc4244.txt) Расширение протокола Инициации сеанса (SIP) для необходимых сведений журнала. Дополнительные сведения см. в описании протокола SIP маршрутизации.
- [RFC 3892](https://www.ietf.org/rfc/rfc3892.txt) Механизм Referred-By Referred-By сеанса
- [RFC 3891](https://www.ietf.org/rfc/rfc3891.txt) Заголовок "Replaces" протокола Инициации сеанса (SIP) 
- [RFC 6337](https://tools.ietf.org/html/rfc6337) Использование протокола SIP модели предложений и ответов.
  См. раздел "Отклонения от RFC".
- [RFC 3711](https://tools.ietf.org/html/rfc3711) и [RFC 4771](https://tools.ietf.org/html/rfc4771). Защита трафика RTP с помощью SRTP. SBC должен иметь возможность устанавливать ключи с помощью SDES. 
- [RFC 8035](https://www.ietf.org/rfc/rfc8035.txt) Уточнения предложений и ответов по протоколу SDP для RTP/RTCP-множественных запросов

### <a name="standards-applicable-to-devices-that-support-media-bypass-mode"></a>Стандарты, применимые к устройствам, поддерживающих режим обхода сервера-посредника

В дополнение к стандартам, указанным в качестве применимых к режиму без обхода, для режима обхода носителя используются следующие стандарты:

- [Установка интерактивного подключения RFC 5245 (ICE) для обхода сервера-посредника](https://tools.ietf.org/html/rfc5245).  SBC должен поддерживать следующее:
  - ICE Lite — клиенты Teams являются полными клиентами ICE
  - [Перезапуск ice](https://tools.ietf.org/html/rfc5245#section-9.1.1.1). Дополнительные сведения о варианте использования перезапуска ICE и примеры в ice Restart: Вызов обхода сервера-посредника, переданный в конечную точку, которая не поддерживает обход сервера-посредника   
- [RFC RFC 5589 Session Initiation Protocol (SIP) Call Control — Transfer](https://tools.ietf.org/html/rfc5589). 
- [RFC 3960 Early Media and Ringing Tone Generation in the Session Initiation Protocol (SIP)](https://tools.ietf.org/html/rfc3960), see sections 3.1, Forking, and 3.2, Ringing Tone Generation 
- [Служебные программы обхода сеансов RFC 5389 для NAT (STUN)](https://tools.ietf.org/html/rfc5389)
- [RFC 5766 Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)](https://tools.ietf.org/html/rfc5766)

### <a name="standards-applicable-to-support-conveying-location-information-to-e911-providers"></a>Стандарты, применимые для поддержки передачи сведений о расположении поставщикам E911

- [RFC 6442, конвейер расположения для протокола инициации сеанса](https://tools.ietf.org/html/rfc6442)

### <a name="deviations-from-the-rfcs"></a>Отклонения от RFC

В следующей таблице перечислены разделы RFC, в которых реализация SIP или стека мультимедиа корпорацией Майкрософт отклонит от стандарта:

| RFC и разделы | Описание | Отклонение |
| :---------------------  |:---------------------- |:-----------------------|
| [RFC 6337, раздел 5.3" "Удержание и возобновление мультимедиа"](https://tools.ietf.org/html/rfc6337#section-5.3) | RFC позволяет использовать "a=inactive", "a=sendonly", a=rec демили" для размещения вызова на удержание. |Прокси-сервер SIP поддерживает только "a=inactive" и не понимает, отправляет ли SBC "a=sendonly" или "a=rec кодly".
| [RFC 6337, раздел 5.4 "Поведение при получении SDP с c=0.0.0.0](https://tools.ietf.org/html/rfc6337#section-5.4) | [RFC3264](https://tools.ietf.org/html/rfc3264) требует, чтобы агент способен получать SDP с адресом подключения 0.0.0.0. В этом случае это означает, что ни RTP, ни RTCP не должны отправляться одноранговую точку. | Прокси-сервер SIP не поддерживает этот параметр. |

## <a name="operational-modes"></a>Рабочие режимы

Существует два режима работы для прямой маршрутизации:

- **Без обхода сервера-посредника** , при котором весь трафик RTP проходит между клиентом Teams, обработчиками мультимедиа и SBC.  

- **При обходе сервера-посредника** все носители RTP передаются между конечными точками Teams и SBC. 

Обратите внимание, что трафик SIP всегда проходит через прокси-сервер SIP. 

## <a name="dtmf"></a>DTMF
DTMF в диапазоне не поддерживается стеком носителей.
