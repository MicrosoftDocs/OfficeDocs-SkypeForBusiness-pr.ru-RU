---
title: Прямая маршрутизация телефонной системы
author: CarolynRowe
ms.author: crowe
manager: serdars
ms.date: 12/16/2019
ms.topic: article
ms.service: msteams
audience: admin
ms.collection:
- Teams_ITAdmin_Help
- M365-voice
ms.reviewer: nmurav
search.appverid: MET150
f1.keywords:
- NOCSH
description: Протоколы прямой маршрутизации
appliesto:
- Microsoft Teams
ms.openlocfilehash: 88fb4459192ad9ff5af8702878d1cbf6a59d8e9d
ms.sourcegitcommit: 6227667c9941cc3289029099b7b6781581f16ea7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2021
ms.locfileid: "52569207"
---
# <a name="direct-routing---definitions-and-rfc-standards"></a>Прямая маршрутизация - Определения и стандарты RFC

В этой статье описывается, Телефон (Майкрософт) система Direct Routing реализует стандартные протоколы RFC. Эта статья предназначена для голосовых администраторов, которые отвечают за настройку связи между на-предупосылок сессии пограничного контроллера (SBC) и протокол сессии (SIP) прокси-сервис.

Клиент SBC взаимодействует со следующими компонентами в Microsoft Teams бэкэнда: 

- **Прокси SIP для** сигнализации. Это компонент прямой маршрутизации, который обрабатывает соединения SIP (TLS) между SBCs и Direct Routing.

- **Медиа-процессоры для** мультимедиа. Это интернет-компонент Direct Routing, который обрабатывает медиа-трафик. Этот компонент использует протоколы SRTP и SRTCP.


Для получения дополнительной информации о прямой маршрутизации, [телефонная система Прямая маршрутизация](direct-routing-landing-page.md).

Для получения дополнительной информации о том, как Direct Routing реализует протокол SIP, [см.](direct-routing-protocols-sip.md)

## <a name="rfc-standards"></a>Стандарты RFC

Прямая маршрутизация соответствует стандартам RFC.  SBC, подключенный к Direct Routing, должен также соответствовать следующим RFCs (или их преемникам). 

### <a name="standards-applicable-to-devices-that-support-non-media-bypass-mode"></a>Стандарты, применимые к устройствам, ехавя на устройства, такие как несохуденяемый режим обхода 

Следующие стандарты применимы к устройствам, которые поддерживают только не мультимедиа режим обхода:

- [RFC 3261 SIP](https://tools.ietf.org/html/rfc3261): Протокол инициирования сессии
- [RFC 3325](https://www.ietf.org/rfc/rfc3325). Частное расширение протокола инициирования сессии для утверждений идентификации в доверенных сетях --Разделы об обработке заголовка P-Asserted-Identity. Прямая маршрутизация отправляет P-Asserted-Identity с головами Privacy ID. 
- [RFC 4244](https://www.ietf.org/rfc/rfc4244.txt) Расширение Протокола инициации сессии (SIP) для получения необходимой информации по истории. Смотрите также: Описание протокола маршрутизации SIP для получения дополнительной информации.
- [RFC 3892](https://www.ietf.org/rfc/rfc3892.txt) Механизм протокола инициации Referred-By сессии
- [RFC 3891](https://www.ietf.org/rfc/rfc3891.txt) Протокол посвящения сессии (SIP) "Заменяет" заголовок 
- [RFC 6337](https://tools.ietf.org/html/rfc6337) Протокол инициации сеанса (SIP) Использование модели предложения/ответа.
  Смотрите раздел "Отклонения от RFC".
- [RFC 3711](https://tools.ietf.org/html/rfc3711) и [RFC 4771](https://tools.ietf.org/html/rfc4771). Защитите трафик RTP с помощью SRTP. SBC должен быть в состоянии установить ключи с помощью SDES. 
- [RFC 8035](https://www.ietf.org/rfc/rfc8035.txt) Протокол описания сессии (SDP) Предложение/Ответ Разъяснения для МУЛЬТИП/RTCP Multiplexing

### <a name="standards-applicable-to-devices-that-support-media-bypass-mode"></a>Стандарты, применимые к устройствам, ехавам в режиме обхода мультимедиа

В дополнение к стандартам, перечисленным в режиме необвода, для режима обхода мультимедиа используются следующие стандарты:

- [RFC 5245 Интерактивная связь создание (ICE) для средств массовой информации обойти](https://tools.ietf.org/html/rfc5245).  SBC должен поддерживать следующее:
  - ICE Lite - Teams клиенты являются полноправными клиентами ICE
  - [ICE перезапускает](https://tools.ietf.org/html/rfc5245#section-9.1.1.1). Подробнее о перезапуске ICE случая использования и примеров в ICE Restart: Медиа-обход вызова перенесен в конечную точку, которая не поддерживает обход мультимедиа   
- [RFC RFC 5589 Протокол инициирования сессии (SIP) Управление вызовом - Передача](https://tools.ietf.org/html/rfc5589). 
- [RFC 3960 Ранние средства массовой информации и звон тон поколения в протоколе инициации сессии (SIP)](https://tools.ietf.org/html/rfc3960), см. разделы 3.1, Forking, и 3.2, Звенящий тон поколения 
- [RFC 5389 Сессия Обход Утилиты для NAT (STUN)](https://tools.ietf.org/html/rfc5389)
- [RFC 5766 Обход с использованием ретрансляторов вокруг NAT (TURN): Реле Расширения сессии Обход Утилиты для NAT (STUN)](https://tools.ietf.org/html/rfc5766)

### <a name="standards-applicable-to-support-conveying-location-information-to-e911-providers"></a>Стандарты, применимые к поддержке передачи информации о местоположении поставщикам E911

- [RFC 6442, Транспортировка местонахождения для Протокола инициации сессии](https://tools.ietf.org/html/rfc6442)

### <a name="deviations-from-the-rfcs"></a>Отклонения от RFC

В следующей таблице перечислены разделы RFC (ы), в которых реализация Microsoft SIP или медиа-стека отклоняется от стандарта:

| RFC и разделы | Описание | отклонение |
| :---------------------  |:---------------------- |:-----------------------|
| [RFC 6337, раздел 5.3 Удержание и возобновление СМИ](https://tools.ietf.org/html/rfc6337#section-5.3) | RFC позволяет использовать "a'inactive", "a'sendonly", a'recvonly", чтобы позвонить на удержание. |Прокси-сервер SIP поддерживает только "a'inactive" и не понимает, отправляет ли SBC "a'sendonly" или "a'recvonly".
| [RFC 6337, раздел 5.4 "Поведение при приеме СДП с c'0.0.0.0](https://tools.ietf.org/html/rfc6337#section-5.4) | [RFC3264](https://tools.ietf.org/html/rfc3264) требует, чтобы агент был способен получать SDP с адресом соединения 0.0.0.0, и это означает, что ни RTP, ни RTCP не должны быть отправлены сверстнику. | Прокси SIP не поддерживает эту опцию. |

## <a name="operational-modes"></a>Режимы работы

Существует два режима работы для прямой маршрутизации:

- **Без средств массовой** информации обойти, в котором все потоки трафика RTP Teams клиентом, медиа-процессоров и SBC.  

- **С обходом средств** массовой информации, в котором все средства массовой информации TEAMS конечных точек и SBC. 

Обратите внимание, что sip трафик всегда течет через прокси SIP. 

## <a name="dtmf"></a>DTMF
In-диапазон DTMF не поддерживается медиа стеком.
