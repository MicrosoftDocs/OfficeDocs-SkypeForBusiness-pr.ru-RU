---
title: Отработка отказа канала связи при исходящих звонках
ms.author: crowe
author: CarolynRowe
manager: serdars
audience: ITPro
ms.reviewer: NMuravlyannikov
ms.topic: article
ms.service: msteams
localization_priority: Normal
search.appverid: MET150
ms.collection:
- M365-voice
appliesto:
- Microsoft Teams
f1.keywords:
- NOCSH
description: В этой статье рассказывается о том, как обрабатывать переходные запросы на магистральные линии по исходящим звонкам из Teams на контроллер границ сеансов (SBC).
ms.openlocfilehash: c88394cba0a98316ac272901a6ab2972e9eaf3c8
ms.sourcegitcommit: ed3d7ebb193229cab9e0e5be3dc1c28c3f622c1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2020
ms.locfileid: "41836181"
---
# <a name="trunk-failover-on-outbound-calls"></a>Отработка отказа канала связи при исходящих звонках

В этой статье описано, как избежать переходных на магистральные перемещения по исходящим вызовам — от Teams до контроллера границ сеансов (SBC).

## <a name="failover-on-network-errors"></a>Отработка отказа при ошибках сети

Если магистраль не может быть подключено по какой-либо причине, подключение к одной и той же магистрали будет выполняться из другого центра обработки данных Майкрософт. Канал связи может не подключаться, например, в случае отказа в соединении, в случае превышения времени ожидания TLS или в случае наличия других проблем на уровне сети.
Например, подключение может завершиться с ошибкой, если администратор ограничивает доступ к SBC только по известным IP-адресам, но при этом вы забываете IP-адреса всех центров обработки данных Microsoft Direct Routing в списке управления доступом (ACL) SBC. 

## <a name="failover-of-specific-sip-codes-received-from-the-session-border-controller-sbc"></a>Отработка отказа определенных кодов SIP, полученных от контроллера границ сеанса (SBC)

Если прямая маршрутизация получает коды ошибок SIP 4xx или 6xx в ответ на исходящий приглашение, вызов считается завершенным по умолчанию. "Исходящие" — вызов из клиента Teams в коммутируемую телефонную сеть общего пользования (КТСОП) с потоком трафика: клиент Teams — > прямая маршрутизация — > SBC > телефонной сети.

Список кодов SIP можно найти в [RFC по протоколу SIP](https://tools.ietf.org/html/rfc3261).

Предположим, что SBC ответил на входящее приглашение с кодом "408. тайм-аут запроса: сервер не может получить ответ в течение подходящего промежутка времени, например, если ему не удалось определить расположение пользователя в определенный момент времени. Клиент может повторять запрос без изменений позже.

Этот конкретный SBC может испытывать трудности при подключении к вызываемому абоненту, возможно, из-за ошибки настройки сети или других ошибок. Тем не менее, в маршруте есть еще один SBC, который может достичь вызываемого абонента.

На приведенной ниже схеме, когда пользователь выполняет звонок на номер телефона, в маршруте есть два типа SBCs, которые могут привести к появлении этого звонка. Первоначально для звонка SBC1.contoso.com выбрано, но SBC1.contoso.com не может подключиться к сети ОКТС из-за проблемы с сетью.
По умолчанию в данный момент звонок будет завершен. 
 
![Схема, показывающая, что SBC не может достичь КТСОП из-за ошибки сети](media/direct-routing-failover-response-codes1.png)

Но в маршруте есть еще один SBC, который потенциально может допустить звонок.
Если вы настроили `Set-CSOnlinePSTNGateway -Identity sbc1.contoso.com -FailoverResponseCodes "408"`параметр, второй одноранговый элемент SBC будет пытаться получить SBC2.contoso.com на следующей схеме:

![Схема, показывающая маршрут к второму SBC](media/direct-routing-failover-response-codes2.png)

Установка параметра-Фаиловерреспонсекодес и указание кода помогает настроить маршрутизацию и избежать потенциальных проблем, когда SBC не может вызвать из-за сети или других проблем.

Значения по умолчанию: 408, 503, 504

