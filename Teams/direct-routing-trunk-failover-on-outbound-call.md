---
title: Отработка отказа канала связи при исходящих звонках
ms.author: crowe
author: CarolynRowe
manager: serdars
audience: ITPro
ms.reviewer: NMuravlyannikov
ms.topic: article
ms.service: msteams
localization_priority: Normal
search.appverid: MET150
ms.collection:
- M365-voice
appliesto:
- Microsoft Teams
f1.keywords:
- NOCSH
description: Из этой темы вы узнаете, как обрабатывать отработки сбойов связи при исходяльных звонках из Teams на контроллер границы сеанса (SBC).
ms.openlocfilehash: c88394cba0a98316ac272901a6ab2972e9eaf3c8
ms.sourcegitcommit: ed3d7ebb193229cab9e0e5be3dc1c28c3f622c1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2020
ms.locfileid: "41836181"
---
# <a name="trunk-failover-on-outbound-calls"></a>Отработка отказа канала связи при исходящих звонках

В этой статье описано, как избежать отката на магистрали при исходяльных звонках — от Teams до граничного контроллера сеанса (SBC).

## <a name="failover-on-network-errors"></a>Отбой в сети

Если по какой-либо причине не удается подключение к той же самой связи, будет попросят подключение к той же самой связи из другого центра обработки данных Майкрософт. Например, при отклонении подключения, при ином времени tLS или других проблемах на уровне сети связь может быть не соединена.
Например, подключение может быть со сбой, если администратор ограничивает доступ к SBC только с хорошо известных IP-адресов, но забудет поместить IP-адреса всех центрах обработки данных Microsoft Direct Routing в список управления доступом (ACL) SBC. 

## <a name="failover-of-specific-sip-codes-received-from-the-session-border-controller-sbc"></a>Отбой определенных кодов SIP, полученных с контроллера границы сеанса (SBC)

Если direct Routing получает коды ошибок SIP с кодами 4xx или 6xx в ответ на исходяющие приглашения, вызов считается завершенным по умолчанию. Исходятая означает звонок из клиента Teams в телефонную сеть общего перейти на телефонную сеть (STN) со следующим потоком трафика: Клиент Teams -> Прямая маршрутия -> SBC -> телефонная сеть.

Список кодов SIP можно найти в [RFC SIP.](https://tools.ietf.org/html/rfc3261)

Предположим, что сервер SBC ответил на входящее приглашение с кодом "408 Запрос времени и времени: сервер не смог получить ответ в течение подходящего времени, например, если не смог определить местоположение пользователя вовремя". Клиент может повторить запрос без изменений в любой момент".

Возможно, у конкретного запроса SBC возникли сложности при подключении к звонясу, например из-за неправильной оценки сети или другой ошибки. Тем не менее, в маршруте есть еще одна SBC, которая может иметь возможность связаться с вызываемой.

На следующей схеме, когда пользователь звонит на номер телефона, в маршруте могут быть две БСК, которые могут доставить этот звонок. Изначально SBC1.contoso.com для звонка, но SBC1.contoso.com не может связаться с сетью ТСТС из-за проблемы с сетью.
По умолчанию звонок будет завершен на данный момент. 
 
![Схема, показывающая, что SBC не удается связаться с STN из-за проблемы с сетью](media/direct-routing-failover-response-codes1.png)

Но в маршруте есть еще один SBC, который может доставить звонок.
Если вы настроили параметр, будет попробована вторая SBC — SBC2.contoso.com `Set-CSOnlinePSTNGateway -Identity sbc1.contoso.com -FailoverResponseCodes "408"` на следующей схеме:

![Схема, на которой показана маршрутия ко второму SBC](media/direct-routing-failover-response-codes2.png)

Установка параметра -FailoverResponseCodes и указание кодов помогает настроить маршрутику и избежать потенциальных проблем, когда SBC не может позвонить из-за сетевых или других проблем.

Значения по умолчанию: 408, 503, 504

