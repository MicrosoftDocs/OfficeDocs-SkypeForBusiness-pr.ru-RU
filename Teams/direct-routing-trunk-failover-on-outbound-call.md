---
title: Отработка отказа канала связи при исходящих звонках
ms.author: crowe
author: CarolynRowe
manager: serdars
audience: ITPro
ms.reviewer: NMuravlyannikov
ms.topic: article
ms.service: msteams
ms.localizationpriority: medium
search.appverid: MET150
ms.collection:
- M365-voice
appliesto:
- Microsoft Teams
f1.keywords:
- NOCSH
description: Из этой темы вы узнаете, как обрабатывать отработки исходящие звонки Teams на контроллер границы сеанса (SBC).
ms.openlocfilehash: 83320e93df7cbf476d71b3b9165d50ca387292b9
ms.sourcegitcommit: 15e90083c47eb5bcb03ca80c2e83feffe67646f2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2021
ms.locfileid: "58727868"
---
# <a name="trunk-failover-on-outbound-calls"></a>Отработка отказа канала связи при исходящих звонках

В этой статье описано, как избежать отбойов связи при исходящие звонки — от Teams до SBC.

## <a name="failover-on-network-errors"></a>Отбой в сети

Если по какой-либо причине не удается соединять ту же самую связь, подключение к той же самой связи будет опробовано из другого центра обработки данных Майкрософт. Например, если соединение не подключено, если имеется время TLS или есть другие проблемы на уровне сети, связь между ними может быть не подключена.
Например, сбой подключения может произойти, если администратор ограничивает доступ к SBC только с хорошо известных IP-адресов, но забудет поместить IP-адреса всех центра обработки данных Microsoft Direct Routing в список управления доступом (ACL) SBC. 

## <a name="failover-of-specific-sip-codes-received-from-the-session-border-controller-sbc"></a>Отбой для определенных кодов SIP, полученных с контроллера границы сеанса (SBC)

Если direct Routing получает коды ошибок SIP 4xx или 6xx в ответ на исходяние приглашения, звонок считается завершенным по умолчанию. Исходят означает звонок от клиента Teams к телефонной сети общего перейти на телефонную сеть (STN) со следующим потоком трафика: клиент Teams -> Прямая маршрутная маршрутия -> SBC -> Телефонная сеть.

Список кодов SIP можно найти в [RFC протокола SIP.](https://tools.ietf.org/html/rfc3261)

Предположим, что сервер SBC ответил на входящее приглашение с кодом "408 Запросить время отклика: сервер не смог получить ответ в течение подходящего времени, например, если не смог определить местоположение пользователя вовремя." Клиент может повторить запрос без изменений в любое время".

Возможно, у этого SBC возникают сложности с подключением к вызываемой стороне, например из-за неправильной сетевой перенастройки или другой ошибки. Однако в маршруте есть еще один SBC, который может быть способен связаться с вызываемой.

На следующей схеме, когда пользователь звонит на номер телефона, в маршруте есть две УАП, которые могут доставить этот звонок. Изначально для SBC1.contoso.com выбрана возможность связи, но SBC1.contoso.com не может связаться с сетью ТССК из-за проблемы с сетью.
По умолчанию звонок будет завершен на данный момент. 
 
![Схема, показывающая, что SBC не удается связаться с STN из-за проблемы с сетью.](media/direct-routing-failover-response-codes1.png)

Но в маршруте есть еще один SBC, который может доставить звонок.
Если вы настроили параметр, будет опробовоирован второй `Set-CSOnlinePSTNGateway -Identity sbc1.contoso.com -FailoverResponseCodes "408"` SBC— SBC2.contoso.com приведенной ниже схеме.

![Схема, показывающая маршрутику на второй SBC.](media/direct-routing-failover-response-codes2.png)

Установка параметра -FailoverResponseCodes и указание кодов помогает настроить маршрутику и избежать потенциальных проблем, когда SBC не может позвонить из-за сетевых или других проблем.

Значения по умолчанию: 408, 503, 504

