---
title: Отработка отказа канала связи при исходящих звонках
ms.author: crowe
author: CarolynRowe
manager: serdars
audience: ITPro
ms.reviewer: NMuravlyannikov
ms.topic: article
ms.service: msteams
localization_priority: Normal
search.appverid: MET150
ms.collection:
- M365-voice
appliesto:
- Microsoft Teams
f1.keywords:
- NOCSH
description: В этой теме вы узнаете, как обрабатывать отработки исходящие звонки Teams на контроллер границы сеанса (SBC).
ms.openlocfilehash: c88394cba0a98316ac272901a6ab2972e9eaf3c8
ms.sourcegitcommit: ed3d7ebb193229cab9e0e5be3dc1c28c3f622c1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2020
ms.locfileid: "41836181"
---
# <a name="trunk-failover-on-outbound-calls"></a>Отработка отказа канала связи при исходящих звонках

В этой статье описано, как избежать откатов на телефоне при исходящие звонки — от Teams до пограничного контроллера сеанса (SBC).

## <a name="failover-on-network-errors"></a>Отбой в сети

Если по какой-либо причине не удается подключение к этой же связи, подключение к той же самой же связи будет опробовано из другого центра обработки данных Майкрософт. Например, если соединение не подключено, если имеется время TLS или есть другие проблемы на уровне сети, возможно, связь между ними не связана.
Например, подключение может привести к сбойу, если администратор ограничивает доступ к SBC только с хорошо известных IP-адресов, но забудет уложить IP-адреса всех центрах обработки данных Microsoft Direct Routing в список управления доступом (ACL) SBC. 

## <a name="failover-of-specific-sip-codes-received-from-the-session-border-controller-sbc"></a>Отбой для определенных кодов SIP, полученных с контроллера границы сеанса (SBC)

Если direct Routing получает коды ошибок SIP 4xx или 6xx в ответ на исходяющие приглашения, звонок считается завершенным по умолчанию. Исходят означает звонок от клиента Teams к телефонной сети общего перейти на телефонную сеть (STN) со следующим потоком трафика: клиент Teams -> Direct Routing -> SBC -> Телефонная сеть.

Список кодов SIP можно найти в [RFC протокола SIP.](https://tools.ietf.org/html/rfc3261)

Предположим, что сервер SBC ответил на входящее приглашение с кодом "408 Запросить время отклика: сервер не смог получить ответ в течение подходящего времени, например, если не смог определить местоположение пользователя вовремя." Клиент может повторить запрос без изменений в любое время".

Возможно, у этого SBC возникают сложности с подключением к вызываемой стороне, например из-за неправильной сетевой перенастройки или другой ошибки. Однако в маршруте есть еще один SBC, который может быть способен связаться с вызываемой.

На приведенной ниже схеме, когда пользователь звонит на номер телефона, в маршруте могут быть две SBCs, которые могут доставить этот звонок. Изначально SBC1.contoso.com для звонка выбрана, но SBC1.contoso.com не может связаться с сетью ТССК из-за проблемы с сетью.
По умолчанию звонок будет завершен на данный момент. 
 
![Схема, показывающая, что SBC не удается связаться с STN из-за проблемы с сетью](media/direct-routing-failover-response-codes1.png)

Но в маршруте есть еще один SBC, который может доставить звонок.
Если вы настроили параметр, будет опробовоирован второй `Set-CSOnlinePSTNGateway -Identity sbc1.contoso.com -FailoverResponseCodes "408"` SBC— SBC2.contoso.com приведенной ниже схеме.

![Схема, показывающая маршрутику на второй SBC](media/direct-routing-failover-response-codes2.png)

Установка параметра -FailoverResponseCodes и указание кодов помогает настроить маршрутику и избежать потенциальных проблем, когда SBC не может позвонить из-за сетевых или других проблем.

Значения по умолчанию: 408, 503, 504

