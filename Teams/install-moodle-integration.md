---
title: 'Интеграция Moodle с Microsoft Teams '
author: MicrosoftHeidi
ms.author: heidip
manager: serdars
ms.topic: article
ms.service: msteams
audience: admin
ms.reviewer: ''
search.appverid: MET150
description: Узнайте, как установить и настроить приложение интеграции Moodle для Microsoft Teams.
keywords: Подключаемый модуль интеграции приложения Moodle для Teams
localization_priority: Normal
f1.keywords:
- NOCSH
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
ms.openlocfilehash: 128e476447898e659961a27e071b992b6b802ebf
ms.sourcegitcommit: ed3d7ebb193229cab9e0e5be3dc1c28c3f622c1b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/06/2020
ms.locfileid: "41836619"
---
# <a name="installing-the-moodle-integration-with-microsoft-teams"></a><span data-ttu-id="949a6-104">Интеграция Moodle с Microsoft Teams </span><span class="sxs-lookup"><span data-stu-id="949a6-104">Installing the Moodle integration with Microsoft Teams</span></span>

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

<span data-ttu-id="949a6-105">[Moodle](https://moodle.org/) — самая популярная система управления обучением (LMS) с открытым кодом в мире теперь интегрируется с Microsoft Teams!</span><span class="sxs-lookup"><span data-stu-id="949a6-105">[Moodle](https://moodle.org/), the most popular and open-source Learning Management System (LMS) in the world, is now integrated with Microsoft Teams!</span></span> <span data-ttu-id="949a6-106">Эта интеграция позволяет педагогам и преподавателям совместно работать над курсами Moodle, задавать вопросы об оценках и заданиях, а также получать уведомления прямо в приложении Teams!</span><span class="sxs-lookup"><span data-stu-id="949a6-106">This integration helps educators and teachers collaborate around Moodle courses, ask questions about their grades and assignments and stay updated with notifications -- right within Teams!</span></span>

<span data-ttu-id="949a6-107">Чтобы облегчить администраторам настройку этой интеграции, мы добавили в подключаемый модуль Office 365 Moodle с открытым кодом следующие возможности:</span><span class="sxs-lookup"><span data-stu-id="949a6-107">To help IT admins easily set this integration up, we have updated our open-source Office 365 Moodle Plugin with the following capabilities:</span></span>

* <span data-ttu-id="949a6-108">Автоматическая регистрация сервера Moodle в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="949a6-108">Auto-registration of your Moodle server with Azure AD.</span></span>
* <span data-ttu-id="949a6-109">Развертывание бота-помощника Moodle в Azure одним щелчком мыши.</span><span class="sxs-lookup"><span data-stu-id="949a6-109">One-click deployment of your Moodle Assistant bot to Azure.</span></span>
* <span data-ttu-id="949a6-110">Автоматическая подготовка команд и автоматическая синхронизация их регистраций во всех или выбранных курсах Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-110">Auto-provisioning of teams and auto-synchronization of team enrollments for all or select Moodle courses.</span></span>
* <span data-ttu-id="949a6-111">Автоматическая установка вкладки Moodle и бота-помощника Moodle в каждой синхронизированной команде</span><span class="sxs-lookup"><span data-stu-id="949a6-111">Auto-installation of the Moodle tab and the Moodle Assistant bot into each synchronized team.</span></span> <span data-ttu-id="949a6-112">(ожидается в ближайшее время).</span><span class="sxs-lookup"><span data-stu-id="949a6-112">(Coming soon)</span></span>
* <span data-ttu-id="949a6-113">Публикация приложения Moodle в закрытом магазине приложений Teams одним щелчком мыши</span><span class="sxs-lookup"><span data-stu-id="949a6-113">One-click publishing of the Moodle app into your private Teams App Store.</span></span> <span data-ttu-id="949a6-114">(ожидается в ближайшее время).</span><span class="sxs-lookup"><span data-stu-id="949a6-114">(Coming soon)</span></span>

<span data-ttu-id="949a6-115">Дополнительные сведения о функциональных возможностях, обеспечиваемых этой интеграцией см. [здесь](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle).</span><span class="sxs-lookup"><span data-stu-id="949a6-115">To learn more about the functionality this integration provides, go [here](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="949a6-116">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="949a6-116">Prerequisites</span></span>

<span data-ttu-id="949a6-117">Чтобы установить и настроить это приложение, требуется следующее:</span><span class="sxs-lookup"><span data-stu-id="949a6-117">In order to install and configure this application you'll need:</span></span>

1. <span data-ttu-id="949a6-118">Учетные данные администратора Moodle</span><span class="sxs-lookup"><span data-stu-id="949a6-118">Moodle administrator credentials</span></span>
2. <span data-ttu-id="949a6-119">Учетные данные администратора Azure AD</span><span class="sxs-lookup"><span data-stu-id="949a6-119">Azure AD administrator credentials</span></span>
3. <span data-ttu-id="949a6-120">Подписка на Azure, в которой можно создавать ресурсы</span><span class="sxs-lookup"><span data-stu-id="949a6-120">An Azure subscription you can create new resources in</span></span>

## <a name="step-1-install-the-office-365-moodle-plugin"></a><span data-ttu-id="949a6-121">Шаг 1. Установка подключаемого модуля Office 365 Moodle</span><span class="sxs-lookup"><span data-stu-id="949a6-121">Step 1: Install the Office 365 Moodle Plugin</span></span>

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

<span data-ttu-id="949a6-122">Интеграция Moodle в Microsoft Teams выполняется с помощью [комплекта подключаемого модуля Office 365 Moodle](https://github.com/Microsoft/o365-moodle) с открытым кодом.</span><span class="sxs-lookup"><span data-stu-id="949a6-122">The Moodle integration in Microsoft Teams is powered by the open source [Office 365 Moodle plugin set](https://github.com/Microsoft/o365-moodle).</span></span> <span data-ttu-id="949a6-123">Чтобы установить подключаемый модуль на сервере Moodle, выполните следующее:</span><span class="sxs-lookup"><span data-stu-id="949a6-123">To install the plugin in your Moodle server:</span></span>

1. <span data-ttu-id="949a6-124">Сначала скачайте [комплект подключаемого модуля Office 365](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) и сохраните его на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="949a6-124">First, download the [Office 365 plugin set](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) and save it to your local computer.</span></span> <span data-ttu-id="949a6-125">Необходимо использовать версию 3.5 или более позднюю.</span><span class="sxs-lookup"><span data-stu-id="949a6-125">You'll need to use version 3.5 or newer.</span></span>
    * <span data-ttu-id="949a6-126">При установке подключаемого модуля local_o365 также устанавливаются подключаемые модули [auth_oidc](https://moodle.org/plugins/auth_oidc) и [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams).</span><span class="sxs-lookup"><span data-stu-id="949a6-126">Installing the local_o365 plugin will also install the [auth_oidc](https://moodle.org/plugins/auth_oidc) and [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) plugins.</span></span>
1. <span data-ttu-id="949a6-127">Войдите на сервер Moodle в качестве администратора и выберите пункт **Администрирование сайта** в левой панели навигации.</span><span class="sxs-lookup"><span data-stu-id="949a6-127">Login to your Moodle server as an administrator, and select **Site administration** from the left navigation panel.</span></span>
1. <span data-ttu-id="949a6-128">Откройте вкладку **Подключаемые модули** и щелкните **Установить подключаемые модули**.</span><span class="sxs-lookup"><span data-stu-id="949a6-128">Select the **Plugins** tab, and then click **Install plugins**.</span></span>
1. <span data-ttu-id="949a6-129">В разделе **Установить подключаемый модуль из ZIP-файла** нажмите кнопку **Выбрать файл**.</span><span class="sxs-lookup"><span data-stu-id="949a6-129">Under the **Install plugin from ZIP file** section click the **Choose a file** button.</span></span>
1. <span data-ttu-id="949a6-130">Выберите параметр **Добавление файла** в области навигации слева, перейдите к скачанному ранее файлу и нажмите кнопку **Добавить файл**.</span><span class="sxs-lookup"><span data-stu-id="949a6-130">Select the **Upload a file** options from the left navigation, browse for the file you downloaded above and click **Upload this file**.</span></span>
1. <span data-ttu-id="949a6-131">В левой области навигации снова выберите параметр **Администрирование сайта**, чтобы вернуться к панели мониторинга администратора.</span><span class="sxs-lookup"><span data-stu-id="949a6-131">Select the **Site administration** option from the left navigation panel again to return to your admin dashboard.</span></span> <span data-ttu-id="949a6-132">Прокрутите страницу до раздела **Локальные подключаемые модули** и щелкните ссылку **Интеграция с Microsoft Office 365**.</span><span class="sxs-lookup"><span data-stu-id="949a6-132">Scroll down to the **Local plugins** and click the **Microsoft Office 365 Integration** link.</span></span> <span data-ttu-id="949a6-133">Оставьте эту страницу настройки открытой в отдельной вкладке браузера, так как она потребуется в ходе этого процесса.</span><span class="sxs-lookup"><span data-stu-id="949a6-133">Keep this configuration page open in a separate browser tab as you'll be using it throughout the rest of this process.</span></span>

<span data-ttu-id="949a6-134">Дополнительные сведения об установке подключаемых модулей Moodle см. в [документации по Moodle](https://docs.moodle.org/34/en/Installing_plugins).</span><span class="sxs-lookup"><span data-stu-id="949a6-134">You can find more information on how to install Moodle plugins in the [Moodle documentation](https://docs.moodle.org/34/en/Installing_plugins).</span></span>

<span data-ttu-id="949a6-135">**Важно!** Оставьте страницу настройки подключаемого модуля Office 365 Moodle открытой в отдельной вкладке браузера, так как вы будете к ней возвращаться в ходе этого процесса.</span><span class="sxs-lookup"><span data-stu-id="949a6-135">**Important Note:** Keep your Office 365 Moodle Plugin configuration page open in a separate browser tab as you will be returning to this set of pages throughout this process.</span></span>

<span data-ttu-id="949a6-136">*У вас еще нет сайта Moodle?*</span><span class="sxs-lookup"><span data-stu-id="949a6-136">*Don't have a Moodle site already?*</span></span> <span data-ttu-id="949a6-137">Вы можете обратиться к нашему [репозиторию](https://github.com/azure/moodle) Moodle в Azure, где можно быстро развернуть экземпляр Moodle в Azure и настроить его под свои потребности.</span><span class="sxs-lookup"><span data-stu-id="949a6-137">You might want to check out our Moodle on Azure [repo](https://github.com/azure/moodle) where you can quickly deploy a Moodle instance on Azure and customize it to your needs.</span></span>

## <a name="step-2-configure-the-connection-between-the-office-365-plugin-and-azure-active-directory"></a><span data-ttu-id="949a6-138">Шаг 2. Настройка соединения между подключаемым модулем Office 365 и Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="949a6-138">Step 2: Configure the connection between the Office 365 plugin and Azure Active Directory</span></span>

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

<span data-ttu-id="949a6-139">Затем требуется зарегистрировать Moodle в качестве приложения в Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="949a6-139">Next you'll need to register Moodle as an application in your Azure Active Directory.</span></span> <span data-ttu-id="949a6-140">Мы предоставили скрипт PowerShell для выполнения этого процесса.</span><span class="sxs-lookup"><span data-stu-id="949a6-140">We've provided a PowerShell script to help you complete this process.</span></span> <span data-ttu-id="949a6-141">Скрипт PowerShell подготавливает новое приложение Azure AD для клиента Office 365, которое будет использоваться подключаемым модулем Office 365 Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-141">The PowerShell Script provisions a new Azure AD application for your Office 365 tenant, which will be used by the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="949a6-142">Скрипт подготавливает приложение для клиента Office 365, настраивая все обязательные URL-адреса ответов и разрешения для подготовленного приложения, а также возвращает AppID и ключ.</span><span class="sxs-lookup"><span data-stu-id="949a6-142">The script will provision the app for your O365 tenant, set up all the required Reply URLs and Permissions for the provisioned app and return the AppID and Key.</span></span> <span data-ttu-id="949a6-143">Вы можете использовать созданный AppID и ключ на странице настройки подключаемого модуля Office 365 Moodle, чтобы настроить сервер Moodle в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="949a6-143">You can use the generated AppID and Key in your O365 Moodle Plugin Setup Page to configure your Moodle server with Azure AD.</span></span> <span data-ttu-id="949a6-144">Подробные сведения о действиях, автоматизируемых скриптом PowerShell, см. в полной [документации для подключаемого модуля](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span><span class="sxs-lookup"><span data-stu-id="949a6-144">If you want to see the detailed manual steps that the PowerShell script is automating, you can find them in the full [documentation for the plugin](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span></span>

### <a name="moodle-tab-for-microsoft-teams-information-flow"></a><span data-ttu-id="949a6-145">Поток данных вкладки Moodle для Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="949a6-145">Moodle tab for Microsoft Teams information flow</span></span>

<img width="530px" src="media/MoodleTabInformationFlow.png" alt="Illustration of Moodle tab for Microsoft Teams information flow" title="Изображение потока данных вкладки Moodle для Microsoft Teams" />

1. <span data-ttu-id="949a6-147">На странице подключаемого модуля интеграции с Microsoft Office 365 выберите вкладку **Настройка**. </span><span class="sxs-lookup"><span data-stu-id="949a6-147">From the Microsoft Office 365 Integration plugin page slect the **Setup** tab.</span></span>
1. <span data-ttu-id="949a6-148">Нажмите кнопку **Скачать скрипт PowerShell** и сохраните его на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="949a6-148">Click the **Download PowerShell Script** button and save it to your local computer.</span></span>
1. <span data-ttu-id="949a6-149">Вам потребуется подготовить скрипт PowerShell из ZIP-файла.</span><span class="sxs-lookup"><span data-stu-id="949a6-149">You'll need to prepare the PowerShell script from the ZIP file.</span></span> <span data-ttu-id="949a6-150">Для этого:</span><span class="sxs-lookup"><span data-stu-id="949a6-150">To do so:</span></span>
    * <span data-ttu-id="949a6-151">Скачайте и извлеките файл `Moodle-AzureAD-Powershell.zip`.</span><span class="sxs-lookup"><span data-stu-id="949a6-151">Download and extract the `Moodle-AzureAD-Powershell.zip` file.</span></span>
    * <span data-ttu-id="949a6-152">Откройте извлеченную папку.</span><span class="sxs-lookup"><span data-stu-id="949a6-152">Open the extracted folder.</span></span>
    * <span data-ttu-id="949a6-153">Щелкните файл `Moodle-AzureAD-Script.ps1` правой кнопкой мыши и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="949a6-153">Right-click on the `Moodle-AzureAD-Script.ps1` file and select **Properties**.</span></span>
    * <span data-ttu-id="949a6-154">На вкладке **Общие** окна свойств, установите флажок `Unblock` рядом с атрибутом **Безопасность** в нижней части окна.</span><span class="sxs-lookup"><span data-stu-id="949a6-154">Under the **General** tab of the Properties window, check the `Unblock` box next to the **Security** attribute at the bottom.</span></span>
    * <span data-ttu-id="949a6-155">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="949a6-155">Click **OK**.</span></span>
    * <span data-ttu-id="949a6-156">Скопируйте путь к извлеченной папке.</span><span class="sxs-lookup"><span data-stu-id="949a6-156">Copy the directory path of the extracted folder.</span></span>
1. <span data-ttu-id="949a6-157">Затем запустите PowerShell от имени администратора.</span><span class="sxs-lookup"><span data-stu-id="949a6-157">Next you'll run PowerShell as an administrator:</span></span>
    * <span data-ttu-id="949a6-158">Нажмите кнопку "Пуск".</span><span class="sxs-lookup"><span data-stu-id="949a6-158">Click Start.</span></span>
    * <span data-ttu-id="949a6-159">Введите "PowerShell".</span><span class="sxs-lookup"><span data-stu-id="949a6-159">Type PowerShell.</span></span>
    * <span data-ttu-id="949a6-160">Щелкните правой кнопкой приложение Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="949a6-160">Right-click Windows PowerShell.</span></span>
    * <span data-ttu-id="949a6-161">Выберите пункт "Запуск от имени администратора".</span><span class="sxs-lookup"><span data-stu-id="949a6-161">Click "Run as Administrator".</span></span>
1. <span data-ttu-id="949a6-162">Перейдите к извлеченному каталогу, введя `cd ...\...\Moodle-AzureAD-Powershell`, где `...\...` — путь к каталогу.</span><span class="sxs-lookup"><span data-stu-id="949a6-162">Navigate to the unzipped directory by typing `cd ...\...\Moodle-AzureAD-Powershell` where `...\...` is the path to the directory.</span></span>
1. <span data-ttu-id="949a6-163">Запустите скрипт PowerShell, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="949a6-163">Execute the PowerShell script by:</span></span>
    * <span data-ttu-id="949a6-164">Введите `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span><span class="sxs-lookup"><span data-stu-id="949a6-164">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span></span>
    * <span data-ttu-id="949a6-165">Введите `.\Moodle-AzureAD-Script.ps1`.</span><span class="sxs-lookup"><span data-stu-id="949a6-165">Enter `.\Moodle-AzureAD-Script.ps1`.</span></span>
    * <span data-ttu-id="949a6-166">Войдите в свою учетную запись администратора Office 365 во всплывающем окне.</span><span class="sxs-lookup"><span data-stu-id="949a6-166">Login to your O365 Administrator account in the pop-up window.</span></span>
    * <span data-ttu-id="949a6-167">Введите имя приложения Azure AD (например,</span><span class="sxs-lookup"><span data-stu-id="949a6-167">Enter the name of the Azure AD Application (Ex.</span></span> <span data-ttu-id="949a6-168">Moodle или подключаемый модуль Moodle).</span><span class="sxs-lookup"><span data-stu-id="949a6-168">Moodle/Moodle plugin).</span></span>
    * <span data-ttu-id="949a6-169">Введите URL-адрес сервера Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-169">Enter the URL of your Moodle server.</span></span>
    * <span data-ttu-id="949a6-170">Скопируйте **идентификатор приложения** и **ключ приложения**, созданные скриптом, и сохраните их.</span><span class="sxs-lookup"><span data-stu-id="949a6-170">Copy the **Application ID** and **Application Key** generated by the script and save them.</span></span>
1. <span data-ttu-id="949a6-171">Затем вам потребуется добавить идентификатор и ключ в подключаемый модуль Office 365 Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-171">Next you'll need to add the Id and Key to the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="949a6-172">Вернитесь на страницу администрирования подключаемого модуля ("Администрирование сайта" > "Подключаемые модули" > "Интеграция с Microsoft Office 365").</span><span class="sxs-lookup"><span data-stu-id="949a6-172">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration).</span></span>
1. <span data-ttu-id="949a6-173">На вкладке **Настройка** добавьте **идентификатор приложения** и **ключ приложения**, скопированные ранее, и нажмите **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-173">On the **Setup** tab add the **Application Id** and **Application Key** you copied previously, then click **Save changes**.</span></span>
1. <span data-ttu-id="949a6-174">После обновления страницы отобразится новый раздел **Выбор метода подключения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-174">Once the page refreshes you should now see a new section **Choose connection method**.</span></span> <span data-ttu-id="949a6-175">Установите флажок **По умолчанию** и снова нажмите кнопку **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-175">Click the checkbox labeled **Default** and then click **Save changes** again.</span></span>
1. <span data-ttu-id="949a6-176">После обновления страницы отобразится еще один новый раздел **Согласие администратора и дополнительные сведения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-176">Once the page refreshes you will see another new section **Admin consent & additional information**.</span></span>
    * <span data-ttu-id="949a6-177">Щелкните ссылку **Предоставить согласие администратора**, введите учетные данные глобального администратора Office 365 и нажмите **Принять**, чтобы предоставить разрешения.</span><span class="sxs-lookup"><span data-stu-id="949a6-177">Click the **Provide Admin Consent** link, enter your Office3 365 Global Administrator credentials, then **Accept** to grant the permissions.</span></span>
    * <span data-ttu-id="949a6-178">Нажмите кнопку **Определить** рядом с полем **Клиент Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="949a6-178">Next to the **Azure AD Tenant** field click the **Detect** button.</span></span>
    * <span data-ttu-id="949a6-179">Нажмите кнопку **Определить** рядом с полем **URL-адрес OneDrive для бизнеса**.</span><span class="sxs-lookup"><span data-stu-id="949a6-179">Next to the **OneDrive for Business URL** click the **Detect** button.</span></span>
    * <span data-ttu-id="949a6-180">После заполнения полей снова нажмите кнопку **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-180">Once the fields populate, click the **Save changes** button again.</span></span>
1. <span data-ttu-id="949a6-181">Нажмите кнопку **Обновить**, чтобы проверить установку, затем нажмите **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-181">Click the **Update** button to verify the installation, then **Save changes**.</span></span>
1. <span data-ttu-id="949a6-182">После этого вам потребуется синхронизировать пользователей между сервером Moodle и Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="949a6-182">Next you'll need to synchronize users between your Moodle server and Azure Active Directory.</span></span> <span data-ttu-id="949a6-183">На этом этапе вы можете выбирать разные параметры в зависимости от вашей среды.</span><span class="sxs-lookup"><span data-stu-id="949a6-183">Depending on your environment, you may select different options during this stage.</span></span> <span data-ttu-id="949a6-184">Обратите внимание, что эта конфигурация будет применяться с каждым запуском программы cron Moodle (обычно раз в день) для обеспечения синхронизации. Чтобы приступить к работе:</span><span class="sxs-lookup"><span data-stu-id="949a6-184">Note that the configuration you set here will run with each Moodle cron run (typically once a day) to keep everything in sync. To get started:</span></span>
    * <span data-ttu-id="949a6-185">Перейдите на вкладку **Параметры синхронизации**.</span><span class="sxs-lookup"><span data-stu-id="949a6-185">Switch to the **Sync Settings tab**</span></span>
    * <span data-ttu-id="949a6-186">В разделе **Синхронизация пользователей с Azure AD** установите флажки, применяющиеся к вашей среде.</span><span class="sxs-lookup"><span data-stu-id="949a6-186">In the **Sync users with Azure AD** section, select the checkboxes that apply to your environment.</span></span> <span data-ttu-id="949a6-187">Обычно устанавливаются следующие флажки:</span><span class="sxs-lookup"><span data-stu-id="949a6-187">Typically you would select at least:</span></span>
        * <span data-ttu-id="949a6-188">Создать учетные записи в Moodle для пользователей Azure AD</span><span class="sxs-lookup"><span data-stu-id="949a6-188">Create accounts in Moodle for users in Azure AD</span></span>
        * <span data-ttu-id="949a6-189">Обновить все учетные записи в Moodle для пользователей Azure AD</span><span class="sxs-lookup"><span data-stu-id="949a6-189">Update all accounts in Moodle for users in Azure AD</span></span>
    * <span data-ttu-id="949a6-190">В разделе **Ограничение создания пользователей** можно настроить фильтр, чтобы ограничить число пользователей Azure AD, которые будут синхронизированы с Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-190">In the **User Creation Restriction** section you can setup a filter to limit the Azure AD users that will by synced to Moodle.</span></span>
    * <span data-ttu-id="949a6-191">В разделе **Сопоставление полей пользователей** можно настроить сопоставление полей профилей пользователей Moodle с Azure AD.</span><span class="sxs-lookup"><span data-stu-id="949a6-191">The **User Field Mapping** section will allow you to customize the Azure AD to Moodle User Profile field mapping.</span></span>
    * <span data-ttu-id="949a6-192">В разделе **Синхронизация команд** можно выбрать автоматическое создание групп (т. е. команд) для всех или некоторых существующих курсов Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-192">In the **Teams Sync** section you can choose to automatically create Groups (i.e. Teams) for some, or all, of your existing Moodle courses.</span></span>
1. <span data-ttu-id="949a6-193">Чтобы проверить задания cron (и выполнить их вручную, если это нужно для первого запуска), щелкните ссылку **Страница управления запланированными задачами** в разделе **Синхронизация пользователей с Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="949a6-193">To validate the cron jobs (and run them manually if you wish to for the first run) click the **Scheduled tasks management page** link in the **Sync users with Azure AD** section.</span></span> <span data-ttu-id="949a6-194">Вы будете перенаправлены на страницу **Запланированные задачи**.</span><span class="sxs-lookup"><span data-stu-id="949a6-194">This will take you to the **Scheduled Tasks** page.</span></span>
    * <span data-ttu-id="949a6-195">Прокрутите страницу вниз до задания **Синхронизация пользователей с Azure AD** и нажмите кнопку **Выполнить**.</span><span class="sxs-lookup"><span data-stu-id="949a6-195">Scroll down and find the job **Sync users with Azure AD** job and click **Run now**.</span></span>
    * <span data-ttu-id="949a6-196">Если вы решили создать группы на основе существующих курсов, вы также можете запустить задание **Создание группы пользователей в Office 365**.</span><span class="sxs-lookup"><span data-stu-id="949a6-196">If you chose to create Groups based on existing courses, you can also run the **Create user groups in Office 365** job.</span></span>
1. <span data-ttu-id="949a6-197">Вернитесь на страницу администрирования подключаемого модуля ("Администрирование сайта" > "Подключаемые модули" > "Интеграция с Microsoft Office 365") и выберите страницу **Параметры Teams**.</span><span class="sxs-lookup"><span data-stu-id="949a6-197">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** page.</span></span> <span data-ttu-id="949a6-198">Вам потребуется настроить некоторые параметры безопасности, чтобы включить интеграцию приложения Teams.</span><span class="sxs-lookup"><span data-stu-id="949a6-198">You'll need to configure some security settings to enable the Teams app integration.</span></span>
    * <span data-ttu-id="949a6-199">Чтобы включить OpenID Connect, щелкните ссылку **Управление проверкой подлинности** и щелкните значок с изображением глаза в строке **OpenId Connect**, если он затенен.</span><span class="sxs-lookup"><span data-stu-id="949a6-199">To enable OpenID Connect, click the **Manage Authentication** link, and click the eye icon on the **OpenId Connect** line if it is greyed out.</span></span>
    * <span data-ttu-id="949a6-200">После этого вам потребуется включить внедрение фреймов.</span><span class="sxs-lookup"><span data-stu-id="949a6-200">Next you'll need to enable frame embedding.</span></span> <span data-ttu-id="949a6-201">Щелкните ссылку **HTTP-безопасность** и установите флажок рядом с пунктом **Разрешить внедрение фреймов**.</span><span class="sxs-lookup"><span data-stu-id="949a6-201">Click the **HTTP Security** link, then click the checkbox next to **Allow frame embedding**.</span></span>
    * <span data-ttu-id="949a6-202">Следующим этапом является включение веб-служб, что обеспечивает поддержку функций API Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-202">The next step is to enable web services which will enable the Moodle API features.</span></span> <span data-ttu-id="949a6-203">Щелкните ссылку **Дополнительные функции** и убедитесь, что установлен флажок рядом с пунктом **Включить веб-службы**.</span><span class="sxs-lookup"><span data-stu-id="949a6-203">Click the **Advanced Features** link, then make sure the checkbox next to **Enable web services** is checked.</span></span>
    * <span data-ttu-id="949a6-204">Наконец, вам потребуется включить внешние службы для Office 365.</span><span class="sxs-lookup"><span data-stu-id="949a6-204">Finally you'll need to enabled the external services for Office 365.</span></span> <span data-ttu-id="949a6-205">Щелкните ссылку **Внешние службы** и выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="949a6-205">Click the **External services** link then:</span></span>
        * <span data-ttu-id="949a6-206">Щелкните **Изменить** в строке **Веб-службы Moodle Office 365**.</span><span class="sxs-lookup"><span data-stu-id="949a6-206">Click **Edit** on the **Moodle Office 365 Webservices** row.</span></span>
        * <span data-ttu-id="949a6-207">Установите флажок рядом с пунктом **Включено** и нажмите **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-207">Mark the checkbox next to **Enabled**, then click **Save Changes**</span></span>
    * <span data-ttu-id="949a6-208">Затем вам потребуется изменить разрешения авторизованного пользователя, чтобы позволить ему создавать маркеры веб-служб.</span><span class="sxs-lookup"><span data-stu-id="949a6-208">Next you'll need to edit your authenticated user permissions to allow them to create web service tokens.</span></span> <span data-ttu-id="949a6-209">Щелкните ссылку **Изменение роли "Авторизованный пользователь"**.</span><span class="sxs-lookup"><span data-stu-id="949a6-209">Click the **Editing role 'Authenticated user'** link.</span></span> <span data-ttu-id="949a6-210">Прокрутите страницу вниз до функции **Создание маркера веб-службы** и установите флажок **Разрешить**.</span><span class="sxs-lookup"><span data-stu-id="949a6-210">Scroll down and find the **Create a web service token** capability and mark the **Allow** checkbox.</span></span>

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a><span data-ttu-id="949a6-211">Шаг 3. Развертывание бота-помощника Moodle в Azure</span><span class="sxs-lookup"><span data-stu-id="949a6-211">Step 3: Deploy the Moodle Assistant Bot to Azure</span></span>

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

<span data-ttu-id="949a6-212">Бесплатный бот-помощник Moodle для Microsoft Teams позволяет преподавателям и учащимся отвечать на вопросы о курсах, заданиях, оценках и других сведениях в Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-212">The free Moodle Assistant Bot for Microsoft Teams helps teachers and students answer questions about their courses, assignments, grades and other information in Moodle.</span></span> <span data-ttu-id="949a6-213">Кроме того, бот отправляет уведомления Moodle для учащихся и преподавателей прямо в Teams.</span><span class="sxs-lookup"><span data-stu-id="949a6-213">The bot also sends Moodle notifications to students and teachers right within Teams.</span></span> <span data-ttu-id="949a6-214">Этот бот является проектом с открытым кодом, поддерживаемым корпорацией Майкрософт. Он [доступен на сайте GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span><span class="sxs-lookup"><span data-stu-id="949a6-214">This bot is an open source project maintained by Microsoft, and is [available on GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span></span>

> [!NOTE]
> <span data-ttu-id="949a6-215">В этом разделе вы разворачиваете ресурсы в своей подписке Azure. Все ресурсы будут настроены с использованием **бесплатного** уровня.</span><span class="sxs-lookup"><span data-stu-id="949a6-215">In this section you will deploy resources to your Azure subscription, and all resources will be configured using the **free** tier.</span></span> <span data-ttu-id="949a6-216">В зависимости от применения бота вам может потребоваться изменить масштаб этих ресурсов.</span><span class="sxs-lookup"><span data-stu-id="949a6-216">Depending on the usage of your bot, you may need to scale these resources.</span></span>
> <span data-ttu-id="949a6-217">Если вы хотите только использовать вкладку Moodle без бота, перейдите к [шагу 4](#step-4-deploy-your-microsoft-teams-app).</span><span class="sxs-lookup"><span data-stu-id="949a6-217">If you want to just use the Moodle tab without the bot, skip to [step 4](#step-4-deploy-your-microsoft-teams-app).</span></span>

### <a name="moodle-bot-information-flow"></a><span data-ttu-id="949a6-218">Поток данных бота Moodle</span><span class="sxs-lookup"><span data-stu-id="949a6-218">Moodle bot information flow</span></span>

<img width="530px" src="media/MoodleBotInformationFlow.png" alt="llustration of Moodle bot for Microsoft Teams information flow" title="Изображение потока данных бота Moodle для Microsoft Teams" />


<span data-ttu-id="949a6-220">Чтобы установить бота, сначала необходимо зарегистрировать его в [платформе удостоверений Майкрософт](https://identity.microsoft.com/Landing).</span><span class="sxs-lookup"><span data-stu-id="949a6-220">To install the bot, you'll first need to register it on the [Microsoft Identity Platform](https://identity.microsoft.com/Landing).</span></span> <span data-ttu-id="949a6-221">Это позволит боту проверять подлинность с использованием конечных точек Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="949a6-221">This allows your Bot to authenticate against your Microsoft endpoints.</span></span> <span data-ttu-id="949a6-222">Регистрация бота:</span><span class="sxs-lookup"><span data-stu-id="949a6-222">To register your bot:</span></span>

1. <span data-ttu-id="949a6-223">Вернитесь на страницу администрирования подключаемого модуля ("Администрирование сайта" > "Подключаемые модули" > "Интеграция с Microsoft Office 365") и выберите вкладку **Параметры Teams**.</span><span class="sxs-lookup"><span data-stu-id="949a6-223">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** tab.</span></span>
1. <span data-ttu-id="949a6-224">Щелкните ссылку **Портал регистрации приложений Майкрософт** и войдите с использованием идентификатора Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="949a6-224">Click the **Microsoft Application Registration Portal** link and login with your Microsoft Id.</span></span>
1. <span data-ttu-id="949a6-225">Введите имя своего приложения (например,</span><span class="sxs-lookup"><span data-stu-id="949a6-225">Enter a name for you app (Eg.</span></span> <span data-ttu-id="949a6-226">MoodleBot) и нажмите кнопку **Создать**.</span><span class="sxs-lookup"><span data-stu-id="949a6-226">MoodleBot) and click the **Create** button.</span></span>
1. <span data-ttu-id="949a6-227">Скопируйте **идентификатор приложения** и вставьте его в поле **ИД приложения бота** на странице **Параметры команды**.</span><span class="sxs-lookup"><span data-stu-id="949a6-227">Copy the **Application Id** and paste it into the **Bot Application ID** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="949a6-228">Нажмите кнопку **Создать новый пароль**.</span><span class="sxs-lookup"><span data-stu-id="949a6-228">Click the **Generate New Password** button.</span></span> <span data-ttu-id="949a6-229">Скопируйте созданный пароль и вставьте его в поле **Пароль приложения бота** на странице **Параметры команды**.</span><span class="sxs-lookup"><span data-stu-id="949a6-229">Copy the generated password and and paste it into the **Bot Application Password** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="949a6-230">Прокрутите до нижней части формы и нажмите кнопку **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-230">Scroll to the bottom of the form and click **Save Changes**.</span></span>

<span data-ttu-id="949a6-231">Теперь, когда вы создали идентификатор приложения и пароль, можно развернуть бот в Azure.</span><span class="sxs-lookup"><span data-stu-id="949a6-231">Now that you've generated your Application Id and Password, it's time to deploy your bot to Azure.</span></span> <span data-ttu-id="949a6-232">Нажмите кнопку **Развернуть в Azure** и заполните форму нужными сведениями (идентификатор приложения бота, пароль приложения бота и секрет Moodle находятся на странице **Параметры команды**, а сведения Azure находятся на странице **Настройка**).</span><span class="sxs-lookup"><span data-stu-id="949a6-232">Click on the **Deploy to Azure** button and fill out the form with the necessary information (the Bot Application Id, Bot Application Password and the Moodle Secret are on the **Team Settings** page, and the Azure information is on the **Setup** page).</span></span> <span data-ttu-id="949a6-233">После заполнения формы установите флажок, чтобы принять условия, и нажмите кнопку **Купить** (все ресурсы Azure разворачиваются в бесплатном уровне).</span><span class="sxs-lookup"><span data-stu-id="949a6-233">Once you've got the form filled out, click the check box to agree to the terms and conditions then click the **Purchase** button (all Azure resources are deployed to the free tier).</span></span>

<span data-ttu-id="949a6-234">После завершения развертывания ресурсов в Azure необходимо настроить в подключаемом модуле Office 365 Moodle его конечную точку обмена сообщениями.</span><span class="sxs-lookup"><span data-stu-id="949a6-234">Once the resources are finished deploying to Azure, you'll need to configure the Office 365 Moodle plugin with it's messaging endpoint.</span></span> <span data-ttu-id="949a6-235">Сначала вам потребуется получить конечную точку из бота в Azure.</span><span class="sxs-lookup"><span data-stu-id="949a6-235">First, you'll need to get the endpoint from you Bot in Azure.</span></span> <span data-ttu-id="949a6-236">Для этого:</span><span class="sxs-lookup"><span data-stu-id="949a6-236">To do that:</span></span>

1. <span data-ttu-id="949a6-237">Если вы еще не сделали этого, войдите на [портал Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="949a6-237">If you aren't already, log into the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="949a6-238">В области слева выберите **Группы ресурсов**.</span><span class="sxs-lookup"><span data-stu-id="949a6-238">In the left pane select **Resource groups**.</span></span>
3. <span data-ttu-id="949a6-239">В списке выберите группу ресурсов, которую вы только что использовали (или создали) при развертывании бота.</span><span class="sxs-lookup"><span data-stu-id="949a6-239">From the list select the resource group you just used (or created) while deploying your Bot.</span></span>
4. <span data-ttu-id="949a6-240">Выберите ресурс **Бот WebApp** из списка ресурсов в группе.</span><span class="sxs-lookup"><span data-stu-id="949a6-240">Select the **WebApp Bot** resource from the list of resources in the group.</span></span>
5. <span data-ttu-id="949a6-241">Скопируйте **конечную точку обмена сообщениями** из раздела **Обзор**.</span><span class="sxs-lookup"><span data-stu-id="949a6-241">Copy the **Messaging Endpoint** from the **Overview** section.</span></span>
6. <span data-ttu-id="949a6-242">В Moodle откройте страницу **Параметры команды** подключаемого модуля Office 365 Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-242">In Moodle, open the **Team Settings** page of your Office 365 Moodle Plugin.</span></span>
7. <span data-ttu-id="949a6-243">В поле **Конечная точка бота** вставьте скопированный URL-адрес и измените слово *messages* на *webhook*.</span><span class="sxs-lookup"><span data-stu-id="949a6-243">In the **Bot Endpoint** field paste the URL you just copied and change the word *messages* to *webhook*.</span></span> <span data-ttu-id="949a6-244">URL-адрес теперь должен выглядеть так: `https://botname.azurewebsites.net/api/webhook`</span><span class="sxs-lookup"><span data-stu-id="949a6-244">The URL should now look like `https://botname.azurewebsites.net/api/webhook`</span></span>
8. <span data-ttu-id="949a6-245">Нажмите кнопку **Сохранить изменения**.</span><span class="sxs-lookup"><span data-stu-id="949a6-245">Click **Save Changes**</span></span>
9. <span data-ttu-id="949a6-246">После сохранения изменений вернитесь на вкладку **Параметры команды**, нажмите кнопку **Скачать файл манифеста** и сохраните пакет манифеста на компьютере (он потребуется в следующем разделе).</span><span class="sxs-lookup"><span data-stu-id="949a6-246">Once your changes have saved, go back to the **Team Settings** tab, click the **Download manifest file** button and save the manifest package to your computer (you'll use it in the next section).</span></span>

## <a name="step-4-deploy-your-microsoft-teams-app"></a><span data-ttu-id="949a6-247">Шаг 4. Развертывание приложения Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="949a6-247">Step 4: Deploy your Microsoft Teams app</span></span>

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

<span data-ttu-id="949a6-248">Теперь, когда у вас есть бот, развернутый в Azure и настроенный для общения с сервером Moodle, можно развернуть приложение Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="949a6-248">Now that you have your Bot deployed to Azure and configured to talk to your Moodle server, it's time to deploy your Microsoft Teams app.</span></span> <span data-ttu-id="949a6-249">Для этого загрузите файл манифеста, скачанный со страницы параметров команды подключаемого модуля Office 365 Moodle на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="949a6-249">To do this you'll load the manifest file you downloaded from the Office 365 Moodle Plugin Team Settings page in the previous step.</span></span>

<span data-ttu-id="949a6-250">Перед установкой приложения вам нужно убедиться, что включены внешние приложения и загрузка неопубликованных приложений.</span><span class="sxs-lookup"><span data-stu-id="949a6-250">Before you can install the app you'll need to make sure external apps and sideloading of apps is enabled.</span></span> <span data-ttu-id="949a6-251">Для этого можно выполнить [следующие действия](https://docs.microsoft.com/en-us/MicrosoftTeams/admin-settings).</span><span class="sxs-lookup"><span data-stu-id="949a6-251">To do so you can follow [these steps](https://docs.microsoft.com/en-us/MicrosoftTeams/admin-settings).</span></span> <span data-ttu-id="949a6-252">Убедившись, что внешние приложения включены, можно выполнить указанные ниже действия, чтобы развернуть приложение.</span><span class="sxs-lookup"><span data-stu-id="949a6-252">Once you've ensured that external apps are enabled, you can follow the steps below to deploy your app.</span></span>

1. <span data-ttu-id="949a6-253">Откройте Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="949a6-253">Open Microsoft Teams.</span></span>
2. <span data-ttu-id="949a6-254">Щелкните значок **магазина** в левом нижнем углу панели навигации.</span><span class="sxs-lookup"><span data-stu-id="949a6-254">Click the **Store** icon on the lower-left of the navigation bar.</span></span>
3. <span data-ttu-id="949a6-255">Щелкните ссылку **Загрузить пользовательское приложение** в списке параметров.</span><span class="sxs-lookup"><span data-stu-id="949a6-255">Click the **Upload a custom app** link from the list of options.</span></span> <span data-ttu-id="949a6-256">*Примечание.* Если вы выполнили вход в качестве глобального администратора, вы можете загрузить приложение в магазин приложений своей организации. В противном случае вы сможете загрузить приложение только для команд, участником которых вы являетесь (загрузка неопубликованных приложений).</span><span class="sxs-lookup"><span data-stu-id="949a6-256">*Note:* If you're logged in as a global administer you'll have the option of uploading the app to your organization's app store, otherwise you'll only be able to load the app for Teams you're a part of ("sideloading").</span></span>
4. <span data-ttu-id="949a6-257">Выберите пакет `manifest.zip`, скачанный ранее, и нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="949a6-257">Select the `manifest.zip` package you downloaded previously and click **Save**.</span></span> <span data-ttu-id="949a6-258">Если вы еще не скачали пакет манифеста, это можно сделать на вкладке **Параметры команды** страницы настройки подключаемого модуля в Moodle.</span><span class="sxs-lookup"><span data-stu-id="949a6-258">If you haven't yet downloaded the manifest package, you can do so from the **Team Settings** tab of the plugin configuration page in Moodle.</span></span>

<span data-ttu-id="949a6-259">После установки приложения вы можете добавить вкладку в любой канал, к которому у вас есть доступ.</span><span class="sxs-lookup"><span data-stu-id="949a6-259">Now that you have the app installed you can add the tab to any channel that you have access to.</span></span> <span data-ttu-id="949a6-260">Для этого перейдите в канал, щелкните значок **+** и выберите приложение из списка.</span><span class="sxs-lookup"><span data-stu-id="949a6-260">To do so navigate to the channel, click the **+** symbol and select your app from the list.</span></span> <span data-ttu-id="949a6-261">Следуйте инструкциям, чтобы завершить добавление вкладки курса Moodle в канал.</span><span class="sxs-lookup"><span data-stu-id="949a6-261">Follow the prompts to finish adding your Moodle course tab to a channel.</span></span>

<span data-ttu-id="949a6-262">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="949a6-262">That's it!</span></span> <span data-ttu-id="949a6-263">Теперь вы и ваша команда можете приступить к работе с курсами Moodle непосредственно в Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="949a6-263">You and your team, can now start working with your Moodle courses directly from Microsoft Teams.</span></span>

<span data-ttu-id="949a6-264">Чтобы отправить нам запрос любой функции или отзыв, посетите нашу [страницу пользовательских предложений](https://microsoftteams.uservoice.com/forums/916759-moodle).</span><span class="sxs-lookup"><span data-stu-id="949a6-264">To share any feature requests or feedback with us, please visit our [User Voice page](https://microsoftteams.uservoice.com/forums/916759-moodle).</span></span>