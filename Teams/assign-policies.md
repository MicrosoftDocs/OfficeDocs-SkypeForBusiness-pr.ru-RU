---
title: Назначение политик вашим пользователям в Microsoft Teams
author: cichur
ms.author: v-mahoffman
manager: serdars
ms.reviewer: tomkau, saragava, ritikag, jastark
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
audience: Admin
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
ms.localizationpriority: medium
search.appverid: MET150
description: Узнайте о различных способах назначения политик пользователям в Microsoft Teams.
f1keywords:
- ms.teamsadmincenter.bulkoperations.users.edit
- ms.teamsadmincenter.bulkoperations.edit
ms.openlocfilehash: e29ee61183b0c831fc6d638bf20e6edaab050e8e
ms.sourcegitcommit: 65a10f80e5dfd67b2778e09f5f92c21ef09ce36a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2021
ms.locfileid: "60760557"
---
# <a name="assign-policies-to-your-users-in-microsoft-teams"></a>Назначение политик вашим пользователям в Microsoft Teams

Администраторы используют политики для управления функциями Teams, доступными пользователям в организации. Например, существуют политики звонков, политики собраний и политики обмена сообщениями.

В организациях есть разные типы пользователей с уникальными потребностями. Настраиваемые политики, которые вы создаете и назначаете, могут настраивать параметры политики для различных наборов пользователей с учетом этих потребностей.

Чтобы легко управлять политиками в организации, Teams предлагает несколько способов назначить политики пользователям. Назначьте политику непосредственно пользователям (по отдельности или в масштабе с помощью пакетного назначения) или группе, в которую пользователи являются участниками. Пакеты политик также можно использовать для назначения предварительно заранее задав набор политик для пользователей с похожими ролями. Выбор параметра зависит от количества политик, которые вы управляете, и от количества пользователей, которых вы назначаете. Глобальные политики (по умолчанию для всей организации) применяются к наибольшему числу пользователей в организации. Назначать политики нужно только тем пользователям, для кого требуются специализированные политики.

В этой статье описаны различные способы назначения политик пользователям и рекомендуемые сценарии использования.

## <a name="which-policy-takes-precedence"></a>Какая политика имеет приоритет?

У пользователя есть одна эффективная политика для каждого типа политики. Возможно, или даже вероятно, что пользователю напрямую назначена политика, а также он входит в одну или несколько групп, которые назначены политике того же типа. В таких сценариях какая политика имеет приоритет? Эффективная политика пользователя определяется согласно правилам приоритета.

Если пользователю непосредственно назначена политика (по отдельности или с помощью пакетного назначения), она имеет приоритет. В следующем наглядном примере эффективной политикой пользователя является политика собраний "Квадрат По квадрату", которая непосредственно назначена пользователю.

![Схема, показывающая, как непосредственно назначенная политика имеет приоритет.](media/assign-policies-example-directly-assigned.png)

Если пользователю не назначена политика заданного типа, приоритет имеет политика, назначенная группе, участником какой-либо из них является пользователь. Если пользователь входит в несколько групп, приоритет имеет [](#group-assignment-ranking) политика с наивысшим ранжированием назначения для данного типа политики.

В этом наглядном примере эффективной политикой пользователя является политика Exec Teams и HD, которая имеет наивысший уровень ранжирования по отношению к другим группам, участником которых является пользователь, и которой также назначена политика того же типа политики.  

![Схема, показывающая, как приоритет имеет политика, наследуемая от группы.](media/assign-policies-example-group.png)

Если пользователю не назначена политика напрямую или он не является участником какой-либо группы, ему предоставляется глобальная политика (по умолчанию в организации) для этого типа политики. Вот наглядный пример.

![Схема, показывающая, как глобальная политика имеет приоритет.](media/assign-policies-example-global.png)

Дополнительные узнать см. в [оке Правила приоритета.](#precedence-rules)

## <a name="ways-to-assign-policies"></a>Способы назначения политик

Ниже представлен обзор способов назначения политик пользователям и рекомендуемых сценариев для каждого из них. Выберите ссылки, чтобы узнать больше.

Прежде чем назначать политики отдельным пользователям или группам, сначала задайте глобальные (по умолчанию [в организации)](#set-the-global-policies) политики, которые будут применяться к наибольшему числу пользователей в организации.  После того как глобальные политики будут настроены, вам потребуется назначить политики только тем пользователям, для кого требуются специализированные политики.

|Сделайте это  |Если...  | Используя...
|---------|---------|----|
|[Назначение политики отдельным пользователям](#assign-a-policy-to-individual-users)    | Вы только начинаете Teams и только начинаете работу или вам нужно назначить одну или несколько политик небольшому числу пользователей. |Командлеты Microsoft Teams центра администрирования или PowerShell в модуле Teams PowerShell
|[Назначение политики группе](#assign-a-policy-to-a-group) |Назначать политики на основе участия пользователя в группах. Например, назначьте политику всем пользователям в группе безопасности или списке рассылки.| Командлеты Microsoft Teams центра администрирования или PowerShell в модуле Teams PowerShell|
|[Назначение политики для пакета пользователей](#assign-a-policy-to-a-batch-of-users)   | Назначьте политики большому набору пользователей. Например, назначьте политику сотням или тысячам пользователей организации за один раз. |Командлеты Microsoft Teams центра администрирования или PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики пользователям](#assign-a-policy-package-to-users)  |Назначьте несколько политик определенным наборам пользователей организации с одинаковыми или похожими ролями. Например, назначьте пакет политики образования (преподавательский) преподавателям в вашем учебном за учебных заведениях, чтобы предоставить им полный доступ к чатам, звонкам и собраниям. Назначьте пакет политики для образования (учащемуся дополнительного учебного заведения) дополнительным учащимся, чтобы ограничить определенные возможности, например частные вызовы.  |Командлеты Microsoft Teams центра администрирования или PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики группе](#assign-a-policy-package-to-a-group) (в закрытой предварительной версии)   |Назначьте несколько политик группе пользователей в организации с одинаковыми или похожими ролями. Например, назначьте пакет политики всем пользователям в группе безопасности или списке рассылки. |Центр Microsoft Teams (скоро) или командлеты PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики пакету пользователей](#assign-a-policy-package-to-a-batch-of-users)|Назначьте несколько политик для пакета пользователей организации с одинаковыми или похожими ролями. Например, назначьте пакет политики для образования (преподаватель) всем преподавателям в учебном замещаемом наборе с помощью пакетного задания, чтобы предоставить им полный доступ к чатам, звонкам и собраниям. Назначьте пакет политики для образования (учащемуся дополнительного учебного заведения) пакету дополнительных учащихся, чтобы ограничить определенные возможности, например частные вызовы.|Командлеты PowerShell в модуле Teams PowerShell|

## <a name="set-the-global-policies"></a>Настройка глобальных политик

Выполните эти действия, чтобы настроить глобальные политики (по умолчанию в организации) для каждого типа политики.

### <a name="using-the-microsoft-teams-admin-center"></a>С помощью Центра администрирования Microsoft Teams

1. В левой области навигации центра администрирования Microsoft Teams перейдите на страницу политики для типа политики, который вы хотите обновить. Например, политики **Teams** Teams, политики собраний собраний, политики обмена сообщениями или политики  >     >      >  **голосовых звонков.**
2. Выберите **глобальную политику (по** умолчанию в организации), чтобы просмотреть текущие параметры.
3. Обновив политику, выберите **применить**.

### <a name="using-powershell"></a>С помощью PowerShell

Чтобы настроить глобальные политики с помощью PowerShell, используйте глобальный идентификатор.  Сначала просмотрите текущую глобальную политику, чтобы определить, какой параметр вы хотите изменить.

```powershell
Get-CsTeamsMessagingPolicy -Identity Global
 
Identity                      : Global
Description                   :
AllowUrlPreviews              : True
AllowOwnerDeleteMessage       : False
AllowUserEditMessage          : True
AllowUserDeleteMessage        : True
AllowUserChat                 : True
AllowRemoveUser               : True
AllowGiphy                    : True
GiphyRatingType               : Moderate
AllowMemes                    : True
AllowImmersiveReader          : True
AllowStickers                 : True
AllowUserTranslation          : False
ReadReceiptsEnabledType       : UserPreference
AllowPriorityMessages         : True
ChannelsInChatListEnabledType : DisabledUserOverride
AudioMessageEnabledType       : ChatsAndChannels
Expand (20 lines) Collapse 
```

Затем при необходимости обновим глобальную политику.  Вам нужно указать только значения для параметров, которые вы хотите изменить.

```powershell
Set-CsTeamsMessagingPolicy -Identity Global -AllowUserEditMessage $false
```

## <a name="assign-a-policy-to-individual-users"></a>Назначение политики отдельным пользователям

Чтобы назначить политику отдельному пользователю или небольшому числу пользователей одновременно, выполните указанные здесь действия.

### <a name="use-the-microsoft-teams-admin-center"></a>Использование центра Microsoft Teams администрирования

Чтобы назначить политику пользователю:

1. В левой области навигации центра Microsoft Teams перейдите **в** меню Пользователи и выберите пользователя.
2. Выберите пользователя, щелкнув слева от его имени и выбрав изменить **параметры**.
3. Выберите политику, которая вы хотите назначить, и выберите **применить**.

Кроме того, можно сделать следующее:

1. В левой области навигации центра администрирования Microsoft Teams перейдите на страницу политики.
2. Выберите политику, которая вы хотите назначить, щелкнув слева от ее имени.
3. Выберите **Управление пользователями**.
4. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.
5. Завершив добавление пользователей, выберите **Применить**.

### <a name="use-powershell"></a>Использование PowerShell

У каждого типа политики есть собственный набор cmdlets для управления. Используйте для назначения политики тот или иной `Grant-` тип. Например, используйте его для назначения пользователям `Grant-CsTeamsMeetingPolicy` политики Teams собраний. Эти командлеты включены в модуль Teams PowerShell и задокументированы в Skype для бизнеса [командлета](/powershell/skype/intro?view=skype-ps&preserve-view=true).

Скачайте и установите [общедоступный Teams PowerShell](https://www.powershellgallery.com/packages/MicrosoftTeams/) (если вы еще не сделали этого), а затем запустите следующую версию, чтобы подключиться:

> [!NOTE]
> Соединитель Skype для бизнеса Online в настоящее время является частью последнего модуля Teams PowerShell.
>
> Если вы используете последнюю версию [Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams/)вам не нужно устанавливать Skype для бизнеса Online Connector.

```powershell
# When using Teams PowerShell Module

Import-Module MicrosoftTeams
$credential = Get-Credential
Connect-MicrosoftTeams -Credential $credential
```

В этом примере мы назначим политику собраний Teams "Политика собраний учащихся" пользователю с именем Reda.

```powershell
Grant-CsTeamsMeetingPolicy -Identity reda@contoso.com -PolicyName "Student Meeting Policy"
```

Подробнее об этом можно узнать в [документе Управление политиками с помощью PowerShell.](teams-powershell-managing-teams.md#manage-policies-via-powershell)

## <a name="assign-a-policy-to-a-group"></a>Назначение политики группе

Назначение политик группам позволяет назначить политику группе пользователей, например группе безопасности или списку рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение политик группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами.

При назначении политики она сразу же назначается группе. Однако распространение назначения политики на участников группы выполняется в фоновом режиме и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе, а также когда участники добавляются в группу или удаляются из нее.

Назначения групповой политики распространяются только на пользователей, которые являются прямыми участниками группы. Назначения не распространяются на участников вложенных групп.

### <a name="what-you-need-to-know-about-policy-assignment-to-groups"></a>Что необходимо знать о назначении политик группам

Перед началом работы важно разобраться в правилах приоритета и ранжирования заданий групп.

#### <a name="precedence-rules"></a>Правила приоритета

Для данного типа политики эффективная политика пользователя определяется следующим образом:

- Политика, которая непосредственно назначена пользователю, имеет приоритет над любой другой политикой того же типа, которая назначена группе. Другими словами, если пользователю непосредственно назначена политика заданного типа, он не наследует политику того же типа от группы. Это также означает, что если пользователю назначена политика того или иного типа, необходимо удалить ее у пользователя, прежде чем он сможет наследовать политику того же типа от группы.

- Если пользователю не назначена политика, а он входит в несколько групп и каждой группе назначена политика одного и того же типа, пользователь наследует политику назначения группы с наивысшим рейтингом.

- Если пользователь не входит в группы, для каких-либо групп назначена политика, к этому типу политики применяется глобальная политика (по умолчанию в организации).

Эффективная политика пользователя обновляется в соответствии с этими правилами:

- при добавлении пользователя в группу, которая назначена политике, или удален из нее.
- политика не назначена группе.
- Политика, которая непосредственно назначена пользователю, удаляется.

#### <a name="group-assignment-ranking"></a>Ранжирование заданий группы

При назначении группе политики указывается ранжирование для назначения группы. Он используется для определения политики, которая должна наследоваться пользователем как эффективная политика, если пользователь входит в несколько групп и каждой группе назначена политика одного типа.

Ранжирование заданий группы является относительно других назначений группы того же типа. Например, если вы назначаете политику звонков двум группам, установите для ранжирования одно задание 1, а для другого — 2, причем 1 является самым высоким. Ранжирование назначений групп показывает, какое членство в группах является более важным или релевантным, чем другие группы, касающиеся наследования.

Например, у вас есть две группы: "Сотрудники магазинов" и "Руководители магазинов". Обеим группам назначена политика Teams звонков, политика звонков сотрудников магазина и политика звонков диспетчеров магазинов соответственно. Для руководителя магазина, который относится к обеим группам, его роль руководителя больше релевантна, чем роль сотрудника, поэтому политика звонков, назначенная группе "Руководители магазинов", должна иметь более высокий рейтинг.

|Группы |Teams политики звонков  |Rank (Ранг)|
|---------|---------|---|
|Руководители магазинов   |Политика звонков диспетчеров магазинов         |1|
|Сотрудники магазина    |Политика звонков сотрудников магазина      |2|

Если не указать ранжирование, назначение политики будет присвоено наименьшее ранжирование.

### <a name="in-the-teams-admin-center"></a>В центре Teams администрирования

> [!NOTE]
> В настоящее время назначение политик группам, использующим Центр администрирования Microsoft Teams, доступно только для политик Teams звонков, политики парков звонков Teams, политики Teams, политики трансляций Teams, политики Teams собраний и политики Teams сообщений. Для других типов политик используйте PowerShell.

1. В левой области навигации центра Microsoft Teams администрирования перейдите на страницу типа политики. Например, перейдите к **политике**  >  **собраний собраний**.

2. Выберите **вкладку Назначение групповой** политики.

3. Выберите **Добавить группу,**  а затем в области Назначение политики группе сделайте следующее:
    1. Найщите и добавьте группу, для нее нужно назначить политику.
    2. Задание ранжирования для задания группы.
    3. Выберите политику, которую вы хотите назначить.
    4. Выберите **Применить**.

Чтобы удалить назначение групповой  политики, на вкладке Назначение групповой политики страницы политики выберите назначение группы и выберите **удалить**.

Чтобы изменить ранжирование назначения группы, необходимо сначала удалить назначение групповой политики. Затем, следуя этим шагам, назначьте политику группе.

### <a name="use-the-powershell-option"></a>Использование параметра PowerShell

> [!NOTE]
> В настоящее время назначения политик группам, использующим PowerShell, доступны не для Teams типов политик. Список поддерживаемых типов политик см. в списке [New-CsGroupPolicyAssignment.](/powershell/module/teams/new-csgrouppolicyassignment)

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к Microsoft Teams PowerShell

Пошаговую инструкцию см. в [Teams PowerShell.](teams-powershell-install.md)

#### <a name="assign-a-policy-to-a-group-of-users"></a>Назначение политики группе пользователей

Чтобы назначить политику группе, используйте для этого [cmdlet New-CsGroupPolicyAssignment.](/powershell/module/teams/new-csgrouppolicyassignment) Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты.

В этом примере группе назначена политика Teams собраний с именем Политика собраний для менеджеров розничной торговли с присвоением заданиям ранжирования 1.

```powershell
New-CsGroupPolicyAssignment -GroupId d8ebfa45-0f28-4d2d-9bcc-b158a49e2d17 -PolicyType TeamsMeetingPolicy -PolicyName "Retail Managers Meeting Policy" -Rank 1
```

#### <a name="get-policy-assignments-for-a-group"></a>Получить назначения политик для группы

Чтобы получить все политики, которые назначены группе, воспользуйтесь [cmdlet Get-CsGroupPolicyAssignment.](/powershell/module/teams/get-csgrouppolicyassignment) Обратите внимание, что группы всегда указаны по их групповому ИД, даже если для назначения политики использовался SIP-адрес или адрес электронной почты.

В этом примере мы извлекаем все политики, которые назначены определенной группе.

```powershell
Get-CsGroupPolicyAssignment -GroupId e050ce51-54bc-45b7-b3e6-c00343d31274
```

В этом примере возвращаются все группы, для Teams политики собраний.

```powershell
Get-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy
```

#### <a name="remove-a-policy-from-a-group"></a>Удаление политики из группы

Чтобы удалить политику из группы, используйте [cmdlet Remove-CsGroupPolicyAssignment.](/powershell/module/teams/remove-csgrouppolicyassignment) При этом обновляются приоритеты других политик того же типа, которые имеют более низкий рейтинг. Например, если удалить политику со ранжированием 2, политики с ранжированием 3 и 4 будут обновлены с учетом их нового ранжирования. В следующих двух таблицах приводится пример.

Вот список назначений и приоритетов политики для Teams собраний.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Западная область     |Политика западного региона         |2         |
|Отдел    |Политика деления         |3         |
|Дочерней компании   |Политика дочернего подразделения        |4         |

Если удалить политику западного региона из группы "Запад", назначения и приоритеты политики будут обновлены следующим образом.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Отдел    |Политика деления         |2         |
|Дочерней компании   |Политика дочернего подразделения        |3        |

В этом примере мы удаляем политику Teams собраний из группы.

```powershell
Remove-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy -GroupId f985e013-0826-40bb-8c94-e5f367076044
```

#### <a name="change-a-policy-assignment-for-a-group"></a>Изменение назначения политики для группы

> [!NOTE]
> В ближайшее время появится [cmdlet Set-CsGroupPolicyAssignment.](/powershell/module/teams/set-csgrouppolicyassignment) Тем временем, чтобы изменить назначение групповой политики, вы можете удалить текущее назначение политики из группы, а затем добавить новое назначение политики.

После назначения группе политики можно изменить назначение политики этой группы с помощью cmdlet [Set-CsGroupPolicyAssignment:](/powershell/module/teams/set-csgrouppolicyassignment)

- Изменение ранжирования
- Изменение политики для заданного типа политики
- Изменение политики для заданного типа политики и ранжирования

В этом примере мы меняем политику Teams в группе на политику SupportCallPark и ранжирование заданий на 3.

```powershell
Set-CsGroupPolicyAssignment -GroupId 566b8d39-5c5c-4aaa-bc07-4f36278a1b38 -PolicyType TeamsMeetingPolicy -PolicyName SupportCallPark -Rank 3
```

#### <a name="change-the-effective-policy-for-a-user"></a>Изменение эффективной политики для пользователя

Вот пример того, как изменить эффективную политику для пользователя, которому назначена политика напрямую.

Во-первых, для получения сведений о политиках трансляции собраний, связанных с пользователем, используется Teams [Get-CsUserPolicyAssignment.](/powershell/module/teams/get-csuserpolicyassignment) ```PolicySource```

```powershell
Get-CsUserPolicyAssignment -Identity daniel@contoso.com -PolicyType TeamsMeetingBroadcastPolicy | select -ExpandProperty PolicySource
```

Выходные данные показывают, что пользователю непосредственно назначена политика Teams трансляции собрания с названием "События сотрудника", которая имеет приоритет над политикой "Мероприятия поставщиков", которая назначена группе, которой он принадлежит.

```console
AssignmentType PolicyName         Reference
-------------- ----------         ---------
Direct         Employee Events
Group          Vendor Live Events 566b8d39-5c5c-4aaa-bc07-4f36278a1b38
```

Теперь мы удалим политику "События сотрудников" для пользователя. Это означает, что пользователю больше не назначена политика Teams трансляций собраний, и наследует политику "Мероприятия поставщиков", назначенную группе, которой принадлежит пользователь.

Для этого воспользуйтесь следующим командлетом Skype для бизнеса PowerShell.

```powershell
Grant-CsTeamsMeetingBroadcastPolicy -Identity daniel@contoso.com -PolicyName $null
```

Используйте следующий командлет в модуле Teams PowerShell, чтобы сделать это в масштабе, хотя назначение пакетной политики $users список пользователей, которые вы указали.

```powershell
New-CsBatchPolicyAssignmentOperation -OperationName "Assigning null at bulk" -PolicyType TeamsMeetingBroadcastPolicy -PolicyName $null -Identity $users  
```

## <a name="assign-a-policy-to-a-batch-of-users"></a>Назначение политики для пакета пользователей

### <a name="use-the-admin-center"></a>Использование Центра администрирования

Чтобы массово назначить политику пользователям:

1. В левой области навигации центра администрирования Microsoft Teams выберите **Пользователи**.

2. Найщите пользователей, для них нужно назначить политику, или отфильтруем представление, чтобы отфильтровать нужных пользователей.

3. В столбце **&#x2713;** (галочка) выберите пользователей. Чтобы выбрать всех пользователей, щелкните &#x2713; (галочку) в верхней части таблицы.

4. Выберите **Изменить параметры**, внесите нужные изменения и выберите **Применить**.

Чтобы просмотреть состояние назначения политики, на баннере, который  появляется в  верхней части страницы Пользователи после выбора применить для отправки задания политики, выберите журнал **действий**. Или в левой области навигации Центра администрирования Microsoft Teams перейдите в панель **мониторинга,** а затем в журнале действий **выберите** **Просмотреть сведения**. В журнале действий показаны назначения политик более чем 20 пользователям через центр администрирования Microsoft Teams за последние 30 дней. Дополнительные данные см. в [журнале действий.](activity-log.md)

### <a name="use-powershell-method"></a>Использование метода PowerShell

> [!NOTE]
> В настоящее время назначение пакетной политики с помощью PowerShell доступно не для Teams типов политик. Список поддерживаемых типов политик см. в списке [New-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/new-csbatchpolicyassignmentoperation)

При назначении пакетной политики вы можете назначать политику большому набору пользователей одновременно, не пользуясь сценарием. Для отправки пакета пользователей и политики, которую вы хотите назначить, используется cmdlet [New-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/new-csbatchpolicyassignmentoperation) Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем можно использовать для отслеживания хода выполнения и состояния заданий в пакете с помощью [get-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/get-csbatchpolicyassignmentoperation)

Укажите пользователей по их ИД объекта или SIP-адресу. SIP-адрес пользователя часто имеет то же значение, что и имя директора-пользователя (UPN) или адрес электронной почты, но это не обязательно. Если имя пользователя указано с помощью его имя-пользователя или электронной почты, но его значение отличается от SIP-адреса, назначение политики для него не удастся. Если пакет содержит дубликатов пользователей, они будут удалены из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете.

Пакет может содержать до 5 000 пользователей. Для получения наилучших результатов не от отправки нескольких пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

#### <a name="install-and-connect-to-the-teams-powershell-module"></a>Установка и подключение к Teams PowerShell

Чтобы установить модуль [Microsoft Teams PowerShell, запустите следующую следующую Microsoft Teams.](https://www.powershellgallery.com/packages/MicrosoftTeams) Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams начать сеанс, Teams выполнить следующее:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте в учетные данные администратора.

#### <a name="install-and-connect-to-the-azure-ad-powershell-for-graph-module-optional"></a>Установка и подключение к Azure AD PowerShell для Graph (необязательно)

Кроме того, может потребоваться скачать и установить [модуль Azure AD PowerShell](/powershell/azure/active-directory/install-adv2) для Graph (если вы еще не сделали этого) и подключиться к Azure AD, чтобы получить список пользователей в организации.

Чтобы подключиться к Azure AD, запустите следующую службу:

```powershell
Connect-AzureAD
```

В окне запроса войтесь в учетные данные администратора, которые использовались для подключения к Teams.

#### <a name="assign-a-setup-policy-to-a-batch-of-users"></a>Назначение политики установки для пакета пользователей

В этом примере с помощью нового [CsBatchPolicyAssignmentOperation](/powershell/module/teams/new-csbatchpolicyassignmentoperation) назначим политику настройки приложений с названием Политика настройки приложений для отдела кадров пакету пользователей, перечисленных в Users_ids.text file.

```powershell
$users_ids = Get-Content .\users_ids.txt
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsAppSetupPolicy -PolicyName "HR App Setup Policy" -Identity $users_ids -OperationName "Example 1 batch"
```

В этом примере мы подключаемся к Azure AD, чтобы получить набор пользователей, а затем назначим политику обмена сообщениями "Новая политика обмена сообщениями о приеме на работу" пакету пользователей, указанному с помощью их SIP-адреса.

```powershell
Connect-AzureAD
$users = Get-AzureADUser
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMessagingPolicy -PolicyName "New Hire Messaging Policy" -Identity $users.SipProxyAddress -OperationName "Example 2 batch"
```

#### <a name="get-the-status-of-a-batch-assignment"></a>Получить состояние пакета назначения

Чтобы получить состояние пакета назначения, где OperationId — это код операции, возвращаемый этим cmdlet для заданного пакета, запустите `New-CsBatchPolicyAssignmentOperation` следующую операцию:

```powershell
$Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если выходные данные показывают, что произошла ошибка, запустите следующую, чтобы получить дополнительные сведения об ошибках, которые находятся в `UserState` свойстве.

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/get-csbatchpolicyassignmentoperation)

## <a name="assign-a-policy-package-to-users"></a>Назначение пакета политики пользователям

Пакет политики в Teams — это набор предопределевших политик и параметров политики, которые можно назначить пользователям с одинаковыми или похожими ролями в организации. Каждый пакет политики предназначен для роли пользователя и содержит стандартные политики и параметры политики, которые поддерживают типичные для нее действия. Некоторые примеры пакетов политики: пакет для образования (преподаватель) и пакет для медицинского обслуживания (медицинского работника). Дополнительные узнать см. в [Teams.](manage-policy-packages.md)

### <a name="assign-a-policy-package-to-one-user"></a>Назначение пакета политики одному пользователю

1. В левой области навигации центра администрирования Microsoft Teams перейдите **в** меню Пользователи и выберите пользователя.

2. На странице пользователя выберите Политики **,** а затем рядом с пакетом **политики** выберите **Изменить**.

3. В **области Назначение пакета политики** выберите пакет, который вы хотите назначить, и выберите **сохранить**.

### <a name="assign-a-policy-package-to-multiple-users"></a>Назначение пакета политики нескольким пользователям

1. В левой области навигации Центра администрирования Microsoft Teams перейдите в пакеты политики **,** а затем выберите пакет политики, который вы хотите назначить, щелкнув слева от имени пакета.

2. Выберите **Управление пользователями**.

3. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.

4. Завершив добавление пользователей, выберите **Сохранить**.

## <a name="assign-a-policy-package-to-a-group"></a>Назначение пакета политики группе

Назначение пакетов политики группам позволяет назначать несколько политик группе пользователей, например группе безопасности или группе рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение пакета политики группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами.

При назначении пакета политики он сразу же назначается группе. Однако распространение назначения политики на участников группы выполняется в фоновом режиме и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе, а также когда участники добавляются в группу или удаляются из нее.

> [!IMPORTANT]
> Перед началом работы важно разобраться [](#precedence-rules) в правилах приоритета и ранжирования [заданий групп.](#group-assignment-ranking) Ознакомьтесь с понятиями в [](#what-you-need-to-know-about-policy-assignment-to-groups) статье Что необходимо знать о назначении политик группам ранее в этой статье?

### <a name="assign-a-policy-package-to-a-group-of-users-in-the-admin-center"></a>Назначение пакета политики группе пользователей в Центре администрирования

1. Войдите в Центр администрирования Teams.
2. На левой странице навигации перейдите на страницу пакета политики.
3. Выберите вкладку Назначение пакета группы.
4. Выберите **Добавить группу,** а затем в области Назначение пакета политики группе сделайте следующее:

   - Найщите и добавьте группу, для нее нужно назначить пакет политики.

2. На левой странице навигации перейдите на страницу пакета политики.

3. Выберите вкладку Назначение групповой политики.

4. Выберите **Добавить группу,** а затем в области Назначение пакета политики группе сделайте следующее:

    1. Найщите и добавьте группу, для нее нужно назначить пакет политики.
    
    1. Выберите пакет политики.
    
    1. Заведите ранжирование для каждого типа политики.
    
    1. Выберите **Применить**.
    
    ![показывает назначение групповой политики.](media/group-pkg-assignment.png)

5. Чтобы управлять ранжированием для определенного типа политики, перейдите на страницу политики.

6. Чтобы перена назначение пакета политики группе, сначала удалите назначение групповой политики. Затем следуйте этим шагам, чтобы назначить пакет политики группе.

### <a name="work-with-powershell"></a>Работа с PowerShell

#### <a name="get-the-teams-powershell-module"></a>Получить модуль Teams PowerShell

Пошаговую инструкцию см. в [Teams PowerShell.](teams-powershell-install.md)

#### <a name="assign-a-policy-package-to-a-group-of-users"></a>Назначение пакета политики группе пользователей

Чтобы назначить группе пакет политики, используйте [cmdlet Grant-CsGroupPolicyPackageAssignment.](/powershell/module/teams/grant-csgrouppolicypackageassignment) Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты. При назначении пакета политики укажите ранжирование [назначений](#group-assignment-ranking) группы для каждого типа политики в пакете политики.

В этом примере пакет политики Education_Teacher группе со ранжированием заданий 1 для TeamsAppSetupPolicy и TeamsMeetingBroadcastPolicy и ранжированием 2 для TeamsMeetingPolicy.

```powershell
Grant-CsGroupPolicyPackageAssignment -GroupId "dae90bb4-120f-4a3e-a15d-30f142e79f69" -PackageName "Education_Teacher" -PolicyRankings "TeamsAppSetupPolicy, 1", "TeamsMeetingBroadcastPolicy, 1", "TeamsMeetingPolicy, 2"
```

## <a name="assign-a-policy-package-to-a-batch-of-users"></a>Назначение пакета политики пакету пользователей

При назначении пакетного пакета политики вы можете одновременно назначить пакет политики большому набору пользователей, не пользуясь сценарием. С помощью [нового CsBatchPolicyAssignmentOperation](/powershell/module/teams/new-csbatchpolicyassignmentoperation) можно отправить пакет пользователей и пакет политики, который вы хотите назначить. Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем можно использовать для отслеживания хода выполнения и состояния заданий в пакете с помощью [cmdlet Get-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/get-csbatchpolicyassignmentoperation)

Укажите пользователей по их ИД объекта или SIP-адресу. SIP-адрес пользователя часто имеет то же значение, что и имя пользователя (UPN) или адрес электронной почты, но это не обязательно. Если имя пользователя указано с помощью его имя-пользователя или электронной почты, но его значение отличается от SIP-адреса, назначение политики для него не удастся. Если пакет содержит дубликатов пользователей, они будут удалены из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете.

Пакет содержит до 5000 пользователей. Для получения наилучших результатов не от отправки нескольких пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

### <a name="use-the-teams-powershell-module"></a>Использование модуля Teams PowerShell

Чтобы установить модуль [PowerShell Microsoft Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams) запустите следующую: Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams и начать сеанс, запустите следующую:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте в учетные данные администратора.

### <a name="assign-policy-packages-to-a-batch-of-users"></a>Назначение пакетов политики для пакета пользователей

В этом примере для назначения пакета политики пакету пользователей используется Education_PrimaryStudent [New-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/new-csbatchpolicyassignmentoperation)

```powershell
New-CsBatchPolicyPackageAssignmentOperation -Identity 1bc0b35f-095a-4a37-a24c-c4b6049816ab,user1@econtoso.com,user2@contoso.com -PackageName Education_PrimaryStudent
```

### <a name="see-the-status-of-a-batch-assignment"></a>См. состояние пакета назначения

Чтобы получить состояние пакета назначения, где OperationId — это код операции, возвращаемый этим cmdlet для заданного пакета, запустите `New-CsBatchPolicyAssignmentOperation` следующую операцию:

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если выходные данные показывают, что произошла ошибка, запустите следующую, чтобы получить дополнительные сведения об ошибках, которые находятся в `UserState` свойстве.

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation.](/powershell/module/teams/get-csbatchpolicyassignmentoperation)

## <a name="related-topics"></a>Статьи по теме

[Обзор PowerShell в Teams](teams-powershell-overview.md)
