---
title: Назначение политик вашим пользователям в Microsoft Teams
author: lanachin
ms.author: v-lanac
manager: serdars
ms.reviewer: tomkau, saragava, ritikag, jastark
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
audience: Admin
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
localization_priority: Normal
search.appverid: MET150
description: Узнайте о различных способах назначения политик пользователям в Microsoft Teams.
f1keywords:
- ms.teamsadmincenter.bulkoperations.users.edit
- ms.teamsadmincenter.bulkoperations.edit
ms.openlocfilehash: ada58a9abf07e606f91d48b7ac71ba06d4c1496a
ms.sourcegitcommit: b282acc1633c2d62bbff0ea77b6b647775ae6dfe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "49085703"
---
# <a name="assign-policies-to-your-users-in-microsoft-teams"></a>Назначение политик вашим пользователям в Microsoft Teams

Администраторы используют политики для управления функциями Teams, доступными пользователям в организации. Например, есть политики звонков, политики собраний и политики обмена сообщениями.

В организациях есть различные типы пользователей с уникальными потребностями и настраиваемые политики, которые вы создаете и назначаете, позволяя настраивать параметры политики для разных наборов пользователей в зависимости от этих потребностей.

Чтобы упростить управление политиками в организации, Teams предлагает несколько способов назначить политики пользователям. Политику можно назначать непосредственно пользователям (по отдельности или в масштабе с помощью пакетного назначения) или группе, в которую они в являются. Вы также можете использовать пакеты политик для назначения предустановленного пакета политик пользователям в организации с похожими ролями. Выбор варианта зависит от количества политик, которые вы управляете, и от количества пользователей, которых вы назначаете. Назначив глобальные политики (по умолчанию для всей организации), которые будут применяться к наибольшему числу пользователей в организации, достаточно назначить политики только тем пользователям, для кого требуются специализированные политики.

В этой статье описаны различные способы назначения политик пользователям и рекомендуемые сценарии использования.

## <a name="which-policy-takes-precedence"></a>Какая политика имеет приоритет?

У пользователя есть одна эффективная политика для каждого типа политики. Вполне возможно и даже вероятно, что пользователю напрямую назначена политика, а также она входит в одну или несколько групп, политика того же типа. Какая политика имеет приоритет в подобных сценариях?  Эффективная политика пользователя определяется согласно правилам приоритета.

Если пользователю непосредственно назначена политика (по отдельности или через пакетное назначение), она имеет приоритет. В следующем примере эффективной политикой пользователя является политика собраний По квадрату1, которая непосредственно назначена пользователю.

![Схема, показывающая, как приоритет имеет непосредственно назначенная политика](media/assign-policies-example-directly-assigned.png)

Если пользователю не назначена непосредственно политика заданного типа, приоритет получает политика, назначенная группе, в которую входит пользователь. Если пользователь входит в несколько групп, приоритет имеет [](#group-assignment-ranking) политика с наивысшим ранжированием назначений для данного типа политики.

В этом примере эффективной политикой пользователя является политика Exec Teams и HD с наивысшим ранжированием назначений по сравнению с другими группами, в которые входит пользователь, и которым назначена политика того же типа политики.  

![Схема, показывающая, как политика, наследуемая от группы, имеет приоритет](media/assign-policies-example-group.png)

Если пользователю не назначена политика напрямую или он не входит в какие-либо группы, ему предоставляется глобальная политика (по умолчанию в организации). Приведем пример.

![Схема, показывающая приоритет глобальной политики](media/assign-policies-example-global.png)

Дополнительные узнать см. в [правилах приоритета.](#precedence-rules)

## <a name="ways-to-assign-policies"></a>Способы назначения политик

Ниже представлен обзор способов назначения политик пользователям и рекомендуемых сценариев для каждого из них. Щелкните ссылки, чтобы узнать больше.

Прежде чем назначать политики отдельным пользователям или группам, начните с настройки глобальных (по умолчанию [в организации)](#set-the-global-policies) политик, которые будут применяться к наибольшему числу пользователей в организации.  После того как будут настроены глобальные политики, вам потребуется назначить политики только тем пользователям, для кого требуются специализированные политики.

|Рекомендации  |Если...  | Использование...
|---------|---------|----|
|[Назначение политики отдельным пользователям](#assign-a-policy-to-individual-users)    | Вы только начали работу в Teams или вам нужно назначить лишь одну или несколько политик небольшому количеству пользователей. |Центр администрирования Microsoft Teams или командлеты PowerShell в модуле Skype для бизнеса Online PowerShell
|[Назначение политики группе](#assign-a-policy-to-a-group) |Необходимо назначить политики, основанные на членстве пользователя в группах. Например, вы хотите назначить политику всем пользователям в группе безопасности или списке рассылки.| Центр администрирования Microsoft Teams или командлеты PowerShell в модуле Teams PowerShell|
|[Назначение политики для пакета пользователей](#assign-a-policy-to-a-batch-of-users)   | Политики необходимо назначать большим наборам пользователей. Например, вы хотите назначить политику одновременно сотням или тысячам пользователей в организации.  |Центр администрирования Microsoft Teams или командлеты PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики пользователям](#assign-a-policy-package-to-users)  | Необходимо назначить несколько политик определенным наборам пользователей с одинаковыми или похожими ролями. Например, назначьте пакет политики "Образование (преподаватель)" преподавателям в вашем учебном за учебных заведениях, чтобы предоставить им полный доступ к чатам, звонкам и собраниям, а также к пакету политики "Образование (дополнительное учебное заведения)", чтобы ограничить некоторые возможности, такие как частные вызовы.  |Центр администрирования Microsoft Teams или командлеты PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики группе (в](#assign-a-policy-package-to-a-group) режиме закрытой предварительной версии)   |Группе пользователей с одинаковыми или похожими ролями необходимо назначить несколько политик. Например, вы хотите назначить пакет политики всем пользователям в группе безопасности или списке рассылки. |Центр администрирования Microsoft Teams (скоро появится) или командлеты PowerShell в модуле Teams PowerShell|
| [Назначение пакета политики пакету пользователей](#assign-a-policy-package-to-a-batch-of-users)|Необходимо назначить несколько политик для пакета пользователей в организации с одинаковыми или похожими ролями. Например, назначьте пакет политики "Образование (преподаватель)" всем преподавателям в учебном за учебных заведениях с помощью пакетного задания, чтобы предоставить им полный доступ к чатам, звонкам и собраниям, и назначьте пакет политики "Образование (дополнительное учебное заведения)" пакету дополнительных учащихся, чтобы ограничить некоторые возможности, такие как частные вызовы.|Командлеты PowerShell в модуле Teams PowerShell|


## <a name="set-the-global-policies"></a>Настройка глобальных политик

Выполните эти действия, чтобы настроить глобальные политики (по умолчанию для всей организации) для каждого типа политики.

### <a name="using-the-microsoft-teams-admin-center"></a>С помощью Центра администрирования Microsoft Teams

1. В левой области навигации Центра администрирования Microsoft Teams перейдите на страницу политики для типа политики, который вы хотите обновить. Например, политики **Teams,** политики собраний для собраний, политики обмена сообщениями или политики  >     >   **голосовых**   >  **звонков.**
2. Выберите **глобальную политику (по умолчанию** для всей организации), чтобы просмотреть текущие параметры.
3. Обновив политику, выберите **"Применить".**

### <a name="using-powershell"></a>С помощью PowerShell

Чтобы настроить глобальные политики с помощью PowerShell, используйте глобальный идентификатор.  Для начала просмотрите текущую глобальную политику, чтобы определить, какой параметр вы хотите изменить.

```powershell
Get-CsTeamsMessagingPolicy -Identity Global
 
Identity                      : Global
Description                   :
AllowUrlPreviews              : True
AllowOwnerDeleteMessage       : False
AllowUserEditMessage          : True
AllowUserDeleteMessage        : True
AllowUserChat                 : True
AllowRemoveUser               : True
AllowGiphy                    : True
GiphyRatingType               : Moderate
AllowMemes                    : True
AllowImmersiveReader          : True
AllowStickers                 : True
AllowUserTranslation          : False
ReadReceiptsEnabledType       : UserPreference
AllowPriorityMessages         : True
ChannelsInChatListEnabledType : DisabledUserOverride
AudioMessageEnabledType       : ChatsAndChannels
Expand (20 lines) Collapse 
```

Затем при необходимости обновим глобальную политику.  Вам нужно только указать значения для параметров, которые вы хотите изменить. 
 
```powershell
Set-CsTeamsMessagingPolicy -Identity Global -AllowUserEditMessage $false
```

## <a name="assign-a-policy-to-individual-users"></a>Назначение политики отдельным пользователям

Выполните эти действия, чтобы назначить политику отдельному пользователю или небольшому числу пользователей одновременно.

### <a name="using-the-microsoft-teams-admin-center"></a>С помощью Центра администрирования Microsoft Teams

Чтобы назначить политику пользователю:

1. В Центре администрирования Microsoft Teams в области навигации слева перейдите в раздел **Пользователи**, затем щелкните пользователя.
2. Выберите пользователя, щелкнув слева от его имени, затем нажмите кнопку **Изменить параметры**.
3. Выберите политику, которая вы хотите назначить, и нажмите кнопку **"Применить".**

Кроме того, вы можете сделать следующее:

1. В левой области навигации Центра администрирования Microsoft Teams перейдите на страницу политики.
2. Выберите политику, которая вы хотите назначить, щелкнув слева от ее имени.
3. Выберите **Управление пользователями**.
4. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.
5. Завершив добавление пользователей, выберите **"Применить".**

### <a name="using-powershell"></a>С помощью PowerShell

У каждого типа политики есть собственный набор cmdlets для управления. Используйте для назначения политики тот или иной тип ```Grant-``` политики с помощью cmdlet. Например, используйте ```Grant-CsTeamsMeetingPolicy``` командлет для назначения пользователям политики собраний Teams. Эти командлеты включены в модуль Skype для бизнеса Online PowerShell и задокументированы в справочнике по [командлетам Skype для бизнеса.](https://docs.microsoft.com/powershell/skype/intro?view=skype-ps)

 Скачайте и установите модуль Skype для бизнеса [Online PowerShell](https://www.microsoft.com/download/details.aspx?id=39366) (если вы еще этого не сделали), а затем запустите следующую, чтобы подключиться к Skype для бизнеса Online и начать сеанс:

> [!NOTE]
> Соединитель Skype для бизнеса Online сейчас входит в состав последнего модуля Teams PowerShell.
>
> Если вы используете последний общедоступный выпуск [Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams/)вам не нужно устанавливать соединитель Skype для бизнеса Online.

```powershell
Import-Module -Name MicrosoftTeams
$Cred = Get-Credential
$CSSession = New-CsOnlineSession -Credential $Cred
Import-PSSession -Session $CSSession
```

В этом примере мы назначаем политику собраний Teams "Политика собраний учащихся" пользователю Reda.

```powershell
Grant-CsTeamsMeetingPolicy -Identity reda@contoso.com -PolicyName "Student Meeting Policy"
```

Для получения дополнительных информации [ознакомьтесь с управлением политиками с помощью PowerShell.](teams-powershell-managing-teams.md#manage-policies-via-powershell)

## <a name="assign-a-policy-to-a-group"></a>Назначение политики группе

Назначение политик группам позволяет назначить политику группе пользователей, например группе безопасности или списку рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение политик группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами.

Назначенная политика сразу же назначается группе. Однако имейте в виду, что распространение назначения политики на участников группы выполняется в качестве фоновой операции и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе или участники добавляются в нее или удаляются из нее.

Назначения групповой политики распространяются только на пользователей, которые являются прямыми участниками группы. Назначения не распространяются на членов вложенных групп.

### <a name="what-you-need-to-know-about-policy-assignment-to-groups"></a>Что необходимо знать о назначении политик группам

Прежде чем начать, важно разобраться в правилах приоритета и ранжирования заданий групп.

#### <a name="precedence-rules"></a>Правила приоритета

Для данного типа политики эффективная политика пользователя определяется в соответствии со следующими данными:

- Политика, которая непосредственно назначена пользователю, имеет приоритет над любой другой политикой того же типа, которая назначена группе. Другими словами, если пользователю непосредственно назначена политика заданного типа, он не наследует политику того же типа от группы. Это также означает, что если пользователю назначена политика заданного типа, необходимо удалить ее, прежде чем он сможет наследовать политику того же типа из группы.
- Если пользователю не назначена политика напрямую и он входит в несколько групп и каждой группе назначена политика одного и того же типа, то пользователь наследует политику назначения группы с наивысшим рейтингом.
- Если пользователь не входит в какие-либо группы, для каких-либо групп назначена политика, к этому типу политики применяется глобальная политика (по умолчанию в организации).

При добавлении пользователя в группу, назначенной политике или удалении из нее, при этом политика не назначена группе, а политика, которая непосредственно назначена пользователю, удаляется.

#### <a name="group-assignment-ranking"></a>Ранжирование назначений групп
 
При назначении политики группе вы указываете ранжирование для назначения группы. Этот способ используется для определения политики, которая должна наследоваться пользователем как эффективная политика, если пользователь входит в несколько групп и каждой группе назначена политика одного типа.

Ранжирование групповых заданий относительно назначений других групп того же типа. Например, если политика звонков назначается двум группам, узначьте ранжирование одному заданию 1, а другому — 2, причем 1 — самый высокий. Ранжирование назначений групп показывает, какие из них более важны или релевантны, чем другие группы в отношении наследования.
 
Например, у вас есть две группы: "Сотрудники магазинов" и "Руководители магазинов". Обе группы имеют политику звонков Teams, политику звонков сотрудников магазина и политику звонков диспетчеров магазинов соответственно. Руководителю магазина, который относится к обеим группам, роль руководителя должна быть больше релевантной, чем роль сотрудника, поэтому политика звонков, назначенная группе "Руководители магазинов", должна иметь более высокий рейтинг.

|Группа |Название политики звонков Teams  |Rank (Ранг)|
|---------|---------|---|
|Руководители магазинов   |Политика звонков для руководителей магазинов         |1|
|Сотрудники магазина    |Политика звонков сотрудников магазина      |2|

Если не указать ранжирование, назначение политики будет присвоено наименьшему ранжирование. 

### <a name="using-the-microsoft-teams-admin-center"></a>С помощью Центра администрирования Microsoft Teams

> [!NOTE]
> В настоящее время назначение политик группам с помощью Центра администрирования Microsoft Teams доступно только для политик звонков Teams, политики в парке звонков Teams, политики Teams, политики трансляций Teams, политики собраний Teams и политики обмена сообщениями Teams. Для других типов политик используйте PowerShell.

1. В левой области навигации Центра администрирования Microsoft Teams перейдите на страницу типа политики. Например, перейдите к **политикам**  >  **собраний собраний.**
2. Выберите **вкладку назначения групповой политики.**
3. Выберите **"Добавить группу",** а затем в области "Назначение политики группе" сделайте следующее: 
    1. Найщите и добавьте группу, для нее нужно назначить политику.
    2. Задание ранжирования для группового назначения.
    3. Выберите политику, которую вы хотите назначить. 
    4. Выберите **"Применить".**

Чтобы удалить назначение групповой  политики, на вкладке назначения групповой политики на странице политики выберите назначение группы и выберите **"Удалить".**

Чтобы изменить ранжирование для группового назначения, необходимо сначала удалить назначение групповой политики. Затем следуйте этим шагам, чтобы назначить политику группе.

### <a name="using-powershell"></a>С помощью PowerShell

> [!NOTE]
> В настоящее время назначение политик группам с помощью PowerShell доступно не для всех типов политик Teams. Список поддерживаемых типов политик см. в списке [New-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/new-csgrouppolicyassignment)

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модуле Microsoft Teams PowerShell

Пошаговую инструкцию см. в [руководстве по установке Teams PowerShell.](teams-powershell-install.md)

#### <a name="assign-a-policy-to-a-group-of-users"></a>Назначение политики группе пользователей

Для назначения политики группе используется [cmdlet New-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/new-csgrouppolicyassignment) Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты.

В этом примере мы назначаем политику собраний Teams "Политика собраний розничных менеджеров" группе со ранжированием заданий 1.

```powershell
New-CsGroupPolicyAssignment -GroupId d8ebfa45-0f28-4d2d-9bcc-b158a49e2d17 -PolicyType TeamsMeetingPolicy -PolicyName "Retail Managers Meeting Policy" -Rank 1
```

#### <a name="get-policy-assignments-for-a-group"></a>Назначение политик для группы

Для получения всех политик, которые назначены группе, используйте [cmdlet Get-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/get-csgrouppolicyassignment) Обратите внимание, что группы всегда перечисляются по их ИД, даже если для назначения политики использовался ее SIP-адрес или адрес электронной почты.

В этом примере мы извлекаем все политики, которые назначены определенной группе.

```powershell
Get-CsGroupPolicyAssignment -GroupId e050ce51-54bc-45b7-b3e6-c00343d31274
```

В этом примере возвращаются все группы, которые имеют политику собраний Teams.

```powershell
Get-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy
```

#### <a name="remove-a-policy-from-a-group"></a>Удаление политики из группы

Чтобы удалить [политику из группы, используйте cmdlet Remove-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/remove-csgrouppolicyassignment) При этом приоритеты других политик того же типа, которые имеют более низкий рейтинг, обновляются. Например, если удалить политику со ранжированием 2, политики с ранжированием 3 и 4 будут обновлены с учетом нового ранжирования. В следующих двух таблицах приводится пример.

Вот список назначений и приоритетов политики собраний Teams.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Западная область     |Политика западного региона         |2         |
|Деление    |Политика деления         |3         |
|Дочернее подразделение   |Политика дочернего подразделения        |4         |

Если удалить политику западного региона из группы "Запад региона", назначения и приоритеты политики обновляются следующим образом.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Деление    |Политика деления         |2         |
|Дочернее подразделение   |Политика дочернего подразделения        |3        |

В этом примере мы удаляем политику собраний Teams из группы.

```powershell
Remove-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy -GroupId f985e013-0826-40bb-8c94-e5f367076044
```

#### <a name="change-a-policy-assignment-for-a-group"></a>Изменение назначения политики для группы

> [!NOTE]
> В [ближайшее время появится cmdlet Set-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/set-csgrouppolicyassignment) Тем временем, чтобы изменить назначение групповой политики, вы можете удалить текущее назначение политики из группы, а затем добавить новое назначение политики.

После назначения политики группе вы можете изменить [](https://docs.microsoft.com/powershell/module/teams/set-csgrouppolicyassignment) назначение политики этой группы с помощью следующим образом:

- Изменение ранжирования
- Изменение политики для заданного типа политики
- Изменение политики для заданного типа политики и ранжирования

В этом примере мы меняем политику в парке вызовов Teams на политику SupportCallPark и ранжирование назначений на 3.

```powershell
Set-CsGroupPolicyAssignment -GroupId 566b8d39-5c5c-4aaa-bc07-4f36278a1b38 -PolicyType TeamsMeetingPolicy -PolicyName SupportCallPark -Rank 3
```

#### <a name="change-the-effective-policy-for-a-user"></a>Изменение эффективной политики для пользователя

Вот пример изменения эффективной политики для пользователя, которому непосредственно назначена политика.

Во-первых, мы используем командлет [Get-CsUserPolicyAssignment](https://docs.microsoft.com/powershell/module/teams/get-csuserpolicyassignment) вместе с параметром, чтобы получить сведения о политиках трансляции собраний Teams, связанных ```PolicySource``` с пользователем. 

```powershell
Get-CsUserPolicyAssignment -Identity daniel@contoso.com -PolicyType TeamsMeetingBroadcastPolicy | select -ExpandProperty PolicySource
```

В выходных данных видно, что пользователю напрямую назначена политика трансляции собраний Teams "События сотрудника", которая имеет приоритет над политикой "Мероприятия Поставщика Live Events", назначенной группе, которой принадлежит пользователь.

```console
AssignmentType PolicyName         Reference
-------------- ----------         ---------
Direct         Employee Events
Group          Vendor Live Events 566b8d39-5c5c-4aaa-bc07-4f36278a1b38
```

Теперь мы удалим политику событий сотрудников для пользователя. Это означает, что пользователю больше не назначена прямая политика трансляции собраний Teams, и он наследует политику "Поставщик Live Events", назначенную группе, которой принадлежит пользователь. 

Для этого используйте следующий командлет в модуле Skype для бизнеса PowerShell:

```powershell
Grant-CsTeamsMeetingBroadcastPolicy -Identity daniel@contoso.com -PolicyName $null
```

Вы можете использовать следующий командлет в модуле Teams PowerShell, чтобы выполнять эти задачи в масштабе, хотя назначение пакетной политики $users список пользователей, которые вы указали.

```powershell
New-CsBatchPolicyAssignmentOperation -OperationName "Assigning null at bulk" -PolicyType TeamsMeetingBroadcastPolicy -PolicyName $null -Identity $users  
```

## <a name="assign-a-policy-to-a-batch-of-users"></a>Назначение политики для пакета пользователей

### <a name="using-the-microsoft-teams-admin-center"></a>С помощью Центра администрирования Microsoft Teams

Чтобы массово назначить политику пользователям:

1. В левой области навигации Центра администрирования Microsoft Teams выберите **"Пользователи".**
2. Назначьте политику пользователям или отфильтруем представление, чтобы отфильтровать нужных пользователей.
3. В столбце **&#x2713;** (галочка) выберите пользователей. Чтобы выбрать всех пользователей, щелкните &#x2713; (галочку) в верхней части таблицы.
4. Щелкните **Изменить настройки**, внесите нужные изменения и нажмите **Применить**.

Чтобы просмотреть состояние назначения политики, на баннере, который  появляется в  верхней части страницы "Пользователи" после нажатия кнопки "Применить", щелкните "Журнал **действий".** Или на панели навигации слева в Центре администрирования Microsoft Teams перейдите на панель **мониторинга,** а затем в журнале действий щелкните "Просмотреть **сведения".** В журнале действий показаны назначения политик более чем 20 пользователям через Центр администрирования Microsoft Teams за последние 30 дней. Дополнительные данные см. в [журнале действий.](activity-log.md)

### <a name="using-powershell"></a>С помощью PowerShell

> [!NOTE]
> В настоящее время пакетное назначение политики с помощью PowerShell доступно не для всех типов политик Teams. Список поддерживаемых типов политик см. в [new-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation)
 
При назначении пакетной политики вы можете назначать политику большому набору пользователей одновременно, не пользуясь сценарием. Для отправки пакета пользователей и политики, которую вы хотите назначить, используется cmdlet [New-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем с помощью cmdlet [Get-CsBatchPolicyAssignmentOperation](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation) можно отслеживать ход выполнения и состояние назначений в пакете.

Вы можете указать пользователей по их ИД объекта или SIP-адресу. Обратите внимание, что SIP-адрес пользователя часто имеет то же значение, что и имя директора-пользователя (UPN) или адрес электронной почты, но это не требуется. Если имя пользователя указано с помощью upN или электронной почты, но его значение отличается от SIP-адреса, назначение политики для пользователя не удастся. Если пакет включает дубликатов пользователей, они будут удалены из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете. 

Пакет может содержать до 5 000 пользователей. Для получения наилучших результатов не от отправьте несколько пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модуле Microsoft Teams PowerShell

Чтобы установить модуль [Microsoft Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams)запустите следующую команду: Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams и начать сеанс, запустите следующую команду:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте учетные данные администратора.

#### <a name="install-and-connect-to-the-azure-ad-powershell-for-graph-module-optional"></a>Установка и подключение к модуле Azure AD PowerShell для Graph (необязательно)

Вы также можете скачать и установить модуль [Azure AD PowerShell](https://docs.microsoft.com/powershell/azure/active-directory/install-adv2) для Graph (если еще не сделали этого) и подключиться к Azure AD, чтобы получить список пользователей в организации.

Чтобы подключиться к Azure AD, запустите следующую службу:

```powershell
Connect-AzureAD
```

Когда вам будет предложено, вопишите с помощью учетных данных администратора, которые вы использовали для подключения к Teams.

#### <a name="assign-a-policy-to-a-batch-of-users"></a>Назначение политики для пакета пользователей

В этом примере с помощью нового [csBatchPolicyAssignmentOperation](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) назначим политику установки приложений с именем "Политика настройки приложений для управления персоналом" пакету пользователей, указанных в Users_ids.text файле.

```powershell
$user_ids = Get-Content .\users_ids.txt
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsAppSetupPolicy -PolicyName "HR App Setup Policy" -Identity $users_ids -OperationName "Example 1 batch"
```

В этом примере мы подключаемся к Azure AD, чтобы получить набор пользователей, а затем назначим политику обмена сообщениями с именем "Новая политика для обмена сообщениями о приеме на работу" пакету пользователей, заданным с помощью их SIP-адреса.

```powershell
Connect-AzureAD
$users = Get-AzureADUser
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMessagingPolicy -PolicyName "New Hire Messaging Policy" -Identity $users.SipProxyAddress -OperationName "Example 2 batch"
```

#### <a name="get-the-status-of-a-batch-assignment"></a>Состояние пакетного назначения

Чтобы получить состояние пакета назначения, где OperationId — это код операции, возвращаемой этим cmdlet для данного пакета, запустите ```New-CsBatchPolicyAssignmentOperation``` следующую операцию:

```powershell
$Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если в выходных данных показана ошибка, запустите следующую, чтобы получить дополнительные сведения об ошибках, которые находятся в ```UserState``` свойстве:

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation)

## <a name="assign-a-policy-package-to-users"></a>Назначение пакета политики пользователям

Пакет политики в Teams — это набор предопределельных политик и параметров политики, которые можно назначать пользователям с одинаковыми или похожими ролями в организации. Каждый пакет политики предназначен для роли пользователя и содержит предопределные политики и параметры политики, которые поддерживают типичные для нее действия. Примерами пакетов политики могут быть пакеты для образовательных учреждений (для преподавателей) и медицинских учреждений (клинические работники). Дополнительные узнать см. в [подмносях "Управление пакетами политики в Teams".](manage-policy-packages.md)

### <a name="assign-a-policy-package-to-one-user"></a>Назначение пакета политики одному пользователю

1. В Центре администрирования Microsoft Teams в области навигации слева перейдите в раздел **Пользователи**, затем щелкните пользователя.
2. На странице пользователя щелкните **"Политики",** а затем рядом с пакетом политики **выберите**"Изменить". 
3. В области **назначения пакета политики** выберите пакет, который вы хотите назначить, и нажмите кнопку **"Сохранить".**

### <a name="assign-a-policy-package-to-multiple-users"></a>Назначение пакета политики нескольким пользователям

1. В левой области навигации Центра администрирования Microsoft Teams перейдите к пакетам **политики,** а затем выберите пакет политики, который вы хотите назначить, щелкнув слева от его имени.
2. Щелкните **"Управление пользователями".**
3. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите кнопку **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.
4. Завершив добавление пользователей, нажмите кнопку **"Сохранить".**

## <a name="assign-a-policy-package-to-a-group"></a>Назначение пакета политики группе

**Эта функция доступна в закрытой ознакомительной версии**

Назначение пакетов политики группам позволяет назначать несколько политик группе пользователей, например группе безопасности или группе рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение пакетов политики группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами. 

Когда вы назначаете пакет политики, он сразу же назначается группе. Однако имейте в виду, что распространение назначения политики на участников группы выполняется в качестве фоновой операции и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе или участники добавляются в нее или удаляются из нее.

> [!IMPORTANT]
> Прежде чем начать, важно разобраться [](#precedence-rules) в правилах приоритета и ранжирования [заданий групп.](#group-assignment-ranking) Убедитесь, что вы читаете и понимаете понятия, которые необходимо знать о назначении политик группам ранее в этой статье. [](#what-you-need-to-know-about-policy-assignment-to-groups)

### <a name="using-the-microsoft-teams-admin-center-coming-soon"></a>Использование Центра администрирования Microsoft Teams (скоро появится)

Назначение пакетов политики группам в Центре администрирования Microsoft Teams будет в ближайшее время. Последние обновления вы можете посмотреть здесь.

### <a name="using-powershell"></a>С помощью PowerShell

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модуле Microsoft Teams PowerShell

Пошаговую инструкцию см. в [руководстве по установке Teams PowerShell.](teams-powershell-install.md)

#### <a name="assign-a-policy-package-to-a-group-of-users"></a>Назначение пакета политики группе пользователей

Для назначения пакета политики группе используется cmdlet [Grant-CsGroupPolicyPackageAssignment.](https://docs.microsoft.com/powershell/module/teams/grant-csgrouppolicypackageassignment) Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты. При назначении пакета политики [](#group-assignment-ranking) укажите ранжирование назначений группы для каждого типа политики в пакете политики. 

В этом примере пакет политики Education_Teacher назначается группе со ранжированием заданий 1 для TeamsAppSetupPolicy и TeamsMeetingBroadcastPolicy и 2 для TeamsMeetingPolicy.

```powershell
Grant-CsGroupPolicyPackageAssignment -GroupId "dae90bb4-120f-4a3e-a15d-30f142e79f69" -PackageName "Education_Teacher" -PolicyRankings "TeamsAppSetupPolicy, 1", "TeamsMeetingBroadcastPolicy, 1", "TeamsMeetingPolicy, 2"
```

## <a name="assign-a-policy-package-to-a-batch-of-users"></a>Назначение пакета политики пакету пользователей

При назначении пакетов пакетов политики вы можете назначать пакет политики большому набору пользователей одновременно, не пользуясь сценарием. Для отправки пакета пользователей и пакета политики, который вы хотите назначить, используется cmdlet [New-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем с помощью cmdlet [Get-CsBatchPolicyAssignmentOperation](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation) можно отслеживать ход выполнения и состояние назначений в пакете.

Вы можете указать пользователей по их ИД объекта или SIP-адресу. Обратите внимание, что SIP-адрес пользователя часто имеет то же значение, что и имя директора-пользователя (UPN) или адрес электронной почты, но это не требуется. Если имя пользователя указано с помощью upN или электронной почты, но его значение отличается от SIP-адреса, назначение политики для пользователя не удастся. Если пакет включает дубликатов пользователей, они будут удалены из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете. 

Пакет может содержать до 5 000 пользователей. Для получения наилучших результатов не от отправьте несколько пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модуле Microsoft Teams PowerShell

Запустите следующую команду, чтобы установить [модуль Microsoft Teams PowerShell](https://www.powershellgallery.com/packages/MicrosoftTeams) (если вы еще этого не сделали). Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams и начать сеанс, запустите следующую команду:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте учетные данные администратора.

### <a name="assign-a-policy-package-to-a-batch-of-users"></a>Назначение пакета политики пакету пользователей

В этом примере с помощью Education_PrimaryStudent пакета политики [New-CsBatchPolicyAssignmentOperation](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) назначается пакет политики Education_PrimaryStudent пакету пользователей.

```powershell
New-CsBatchPolicyPackageAssignmentOperation -Identity 1bc0b35f-095a-4a37-a24c-c4b6049816ab,user1@econtoso.com,user2@contoso.com -PackageName Education_PrimaryStudent
```

### <a name="get-the-status-of-a-batch-assignment"></a>Состояние пакетного назначения

Чтобы получить состояние пакета назначения, где OperationId — это код операции, возвращаемой этим cmdlet для данного пакета, запустите ```New-CsBatchPolicyAssignmentOperation``` следующую операцию:

```powershell
$Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если в выходных данных показана ошибка, запустите следующую, чтобы получить дополнительные сведения об ошибках, которые находятся в ```UserState``` свойстве:

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation) 

## <a name="related-topics"></a>Статьи по теме

[Обзор PowerShell в Teams](teams-powershell-overview.md)
