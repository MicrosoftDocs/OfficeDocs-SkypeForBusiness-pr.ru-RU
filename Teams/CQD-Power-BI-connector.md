---
title: Установка Power BI Соединителя для использования шаблонов запросов CQD
ms.author: serdars
author: SerdarSoysal
manager: serdars
ms.reviewer: siunies
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
ms.collection:
- M365-voice
search.appverid: MET150
audience: Admin
appliesto:
- Microsoft Teams
ms.localizationpriority: medium
description: Установите Power BI Connector для использования шаблонов запросов панели мониторинга качества  звонка
ms.openlocfilehash: 474edeca9e694e38e1503074fc45c8bcdaca3483
ms.sourcegitcommit: f0eaaf67b4fdce87d5c01b456c506c1435714ced
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/16/2022
ms.locfileid: "62852502"
---
# <a name="install-microsoft-call-quality-connector-for-power-bi-to-use-call-quality-dashboard-query-templates"></a>Установка соединителя качества звонка (Майкрософт Power BI для использования шаблонов запросов на панель мониторинга качества  звонка

Прежде чем использовать шаблоны запросов Power BI (PBIX-файлы) для панели мониторинга качества звонка (CQD) Microsoft Teams), необходимо установить соединитель Качества звонка (Майкрософт) для Power BI, используя файл *MicrosoftCallQuality.pqx*, включенный в скачанную [загрузку](https://github.com/MicrosoftDocs/OfficeDocs-SkypeForBusiness/blob/live/Teams/downloads/CQD-Power-BI-query-templates.zip?raw=true).

Сведения [об этих шаблонах Power BI использовать для анализа данных CQD](CQD-Power-BI-query-templates.md) для Teams.

Убедитесь, что у вас есть права [доступа к CQD-данным](./turning-on-and-using-call-quality-dashboard.md#assign-admin-roles-for-access-to-cqd), чтобы Power BI отчетов.

> [!NOTE]
> Соединитель качества звонка (Майкрософт) поддерживает directQuery только в Power BI; Режим импорта не поддерживается. 

## <a name="installation"></a>Установка

Процесс установки пользовательского соединителя и настройки безопасности для его использования подробно описан в Power BI [документа](/power-bi/desktop-connector-extensibility). Для простоты краткое объяснение:

1. Проверьте, есть ли на компьютере *\[папка Documents\]\\ Power BI Desktop\\ Custom Connectors*. Если нет, создайте эту папку. <sup>1</sup>

2. Скачайте файл соединитела (*\*MEZ**\*- или PQX-файл*) и поместите его в каталог *Настраиваемые соединитетели*.

3. **Если это *\*MEZ-файл* ,** вам также потребуется настроить параметры безопасности, как описано в документации по настройке [пользовательского соединитела](/power-bi/desktop-connector-extensibility#data-extension-security).

Если выпущена новая версия соединитела Microsoft Call Quality, замените старый файл соединитела в каталоге Настраиваемые *соединитетели* новым файлом.

## <a name="setup"></a>Установка

Чтобы создать отчет и выполнить запросы, необходимо сначала подключиться к источнику данных CQD. Чтобы подключиться, выполните следующие действия:

1. На вкладке Главная Power BI Desktop кнопку *Получить данные*.

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector1-resize.png)

2. На *этом этапе* должно появиться окно Получить данные. Перейдите *в веб-службы*, выберите *Microsoft Call Quality (бета-версия)* и *нажмите* Подключение.

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector2-resize.png)

3. Вам будет предложено войти далее. Используйте те же учетные данные, что и для панели мониторинга качества звонка. <sup>2</sup>

4. В следующем запросе будет предложено выбрать один из двух режимов *подключения к данным*. Выберите *DirectQuery и* нажмите *ОК*.

5. Наконец, вам будет предложено в итоге от показана вся модель данных для панели мониторинга качества звонка. На этом этапе не будут видны никакие данные, только модель данных для CQD. Чтобы *завершить настройку* , выберите загрузить.

6. На этом Power BI загрузит модель данных в правую часть окна. В противном случае страница останется пустой, а запросы не будут загружены по умолчанию. Чтобы создать **запрос и** вернуть данные, перезапрос см. ниже.

Если какие-либо из шагов в ходе настройки не были четкими, более подробное описание процесса можно найти в [кратком](/power-bi/desktop-quickstart-connect-to-data) кратком описании: Подключение к данным в Power BI Desktop.

## <a name="building-queries"></a>Запросы на создание

После завершения настройки вы увидите названия нескольких сотен измерений и мер, загруженных *в области* Поля. Создать фактические запросы на этом сайте очень просто: достаточно выбрать необходимые измерения и меры, а затем перетащить их на страницу. Вот более подробное объяснение с простым примером:

1. В области Визуализации выберите визуализацию, которая *вам нужна.* На странице должна появиться пустая версия визуализации. В этом примере мы будем использовать визуализацию *Таблица* .

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector3-resize.png)

2. Определите, какие измерения и меры (обозначаются символом агрегирования по имени), которые вы хотите использовать в запросе, а затем выберите их вручную и перетащите в черную визуализацию. Кроме того, перетащите их в *поле Значения* под вариантами визуализации.

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector4-resize2.png)

    > [!IMPORTANT]
    > Для выполнения любого запроса необходима информационная панель качества звонка. Неудача добавления меры в запрос приведет к сбою запроса.

3. Затем выберите нужные размеры и перетащите их в область Фильтры этого визуального поля в области *Фильтры*. Соединителя качества звонка (Майкрософт) в настоящее время поддерживает базовую  фильтрацию *(выбор* значений из списка возможных значений *измерений*), расширенный фильтр (вручную укажите значения и операнды для фильтрации, как по аналогии с панелью мониторинга качества звонка)  и относительную фильтрацию *дат (доступно* только для измерений Время окончания и Время начала). Фильтрация по верхнему *n* не поддерживается панелью мониторинга качества звонка.

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector5-resize.png)

    > [!IMPORTANT]
    > Фильтры поддерживаются только при применении к измерениям. Фильтрация по значениям измерений не поддерживается на панели мониторинга качества звонка.

4. Наконец, на *вкладке Формат* в области *Визуализации выберите* стиль и формат запроса.

    > [!NOTE]
    > Для запуска запросов на панель мониторинга качества звонка требуется хотя бы один показатель. Если запрос не загружается, убедитесь, что в запрос включена мера.

## <a name="creating-a-drillthrough-report"></a>Создание отчета drillthrough

[Drillthrough в Power BI](/power-bi/desktop-drillthrough) позволяет создавать отчеты, которые можно быстро фильтровать, используя значения других отчетов в качестве контекста. После того как вы узнаете, как создать свой первый запрос с помощью соединитетеля качества звонка (Майкрософт), процесс drillthrough будет еще проще.

1. Создайте еще одну страницу отчета, а затем добавьте на нее запросы.

2. Выберите измерение, используемое в качестве фильтра drillthrough, и перетащите его в поле *Drillthrough (Drillthrough* ) в области *Visualizations* (Визуализации).

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector6-resize.png)

3. **Ну вот\!** Теперь любой другой запрос на другой странице, использующей это измерение, теперь может пролиться на эту страницу, автоматически применив значение измерения drillthrough в качестве фильтра.

    ![Снимок экрана: Power BI Connector.](media/CQD-power-bi-connector7-resize.png)

В отличие от панели мониторинга качества Power BI поддерживает непо последовательное дрели. Если запрос содержит необходимое измерение, он может перебираться на любую другую страницу.

### <a name="best-practice"></a>Лучшие методики

Запросы на качество звонка (Майкрософт) должны быть разработаны с учетом функций drillthrough. Вместо того чтобы загружать сразу все данные, а затем нарезку фильтрами, начните с более общих запросов с низкой емкостью и отфильтруйте данные до запросов с высокой емкостью. Например, при попытке диагностировать подсети, в которых чаще всего возникает проблема с качеством, необходимо сначала определить регионы и страны, в которых возникла проблема, а затем идентифицировать подсети в этом регионе или стране. Шаблоны соединители "Качество звонка" разработаны таким образом, чтобы действовать в качестве примера.

## <a name="limitations"></a>Ограничения

Несмотря на использование Power BI, не все функции Power BI поддерживаются соединитетелем качества звонка (Майкрософт) либо из-за ограничений модели данных панели мониторинга качества  звонка, либо для соединитеров DirectQuery в целом. В списке ниже приведены некоторые более интересные ограничения Соединитела, но этот список не следует считать исчерпывающим:

1. **Вычисляемая г. —** Соединители DirectQuery в целом имеют ограниченную поддержку вычисляемых столбцов в Power BI. Некоторые вычисляемые столбцы могут работать с соединитетелем, так как они являются исключениями. Как правило, вычисляются столбцы не работают.

2. **Агрегаты —** Модель данных панели мониторинга качества звонка построена на модели куба, то есть агрегаты уже поддерживаются в виде мер. Попытка вручную добавить агрегаты для разных измерений или изменить тип агрегирования меры не будет работать с соединитетелем, и обычно это приведет к ошибке.

3. **Настраиваемые визуальные эффекты —** Хотя соединитектор качества звонка (Майкрософт) работает с разнообразными визуальными эффектами, мы не можем гарантировать совместимость со всеми визуальными эффектами. Многие настраиваемые визуальные эффекты зависят от использования вычисляемого столбца или импортируемых данных, ни одна из которых не поддерживается соединительами DirectQuery.

4. **Ссылки на кэшные** данные — Power BI в настоящее время не поддерживает ссылки на кэшные данные от соединитела DirectQuery. Любая попытка ссылки на результаты запроса приведет к новому запросу.

5. **Относительная фильтрация данных —** Поддерживается соединитетелем Качества звонка (Майкрософт), но только с измерениями Время начала и *Время* окончания. Измерение *Date* может быть очевидным для относительной фильтрации дат, но *date* не сохраняется как объект даты и поэтому не поддерживает относительную фильтрацию дат в Power BI.

6. **Запросы только для измерений—** В настоящее время не поддерживаются соединитетелем качества звонка (Майкрософт). При создании визуализации с тремя или более измерениями без измерений данные столбца транспонются. Чтобы избежать этого, всегда включите в визуализации хотя бы одно измерение (например, "Месяц год"). Эта проблема будет решена в предстоящем выпуске соединительной соединительной связи "Качество звонка Майкрософт" для Power BI.

7. **облако сообщества для государственных организаций (GCC)** — для клиентов в среде GCC качество звонка (Майкрософт) будет работать только Power BI Desktop звонка. Соединителю качества звонка (Майкрософт) в настоящее время не соответствует служба Power BI для GCC клиентов.

Большинство из этих проблем являются ограничениями на разработку соединительные линии DirectQuery в Power BI или являются фундаментальными для модели данных CQD.

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="im-trying-to-use-the-date-column-as-a-date-slicer-as-soon-as-i-convert-the-data-type-of-this-column-to-date-i-get-this-error"></a>Я пытаюсь использовать столбец Дата в качестве среза даты. Как только я преобразую тип данных этого столбца в "Дата", я получаю сообщение об ошибке

> **Не удалось загрузить** данные для этого визуального выражения: ошибка OLE DB или ODBC: [Expression.Error] Не удалось сложить выражение с источником данных. Попробуйте более простое выражение.

Срезы дат не поддерживаются соединителом качества звонка (Майкрософт). Чтобы указать диапазон дат, применим к отчету два фильтра, указав меньший и большей даты.

Кроме того, если даты, которые вы хотите просмотреть, являются последними, применим относительный фильтр дат, чтобы отфильтровать только данные за последние N дней,недель/месяцев.


### <a name="when-i-add-certain-dimensions-to-my-reports-the-visual-immediately-returns-couldnt-load-the-data-for-this-visual-removing-the-dimension-fixes-the-visual----what-is-happening"></a>При добавлении определенных измерений в отчеты сразу же возвращается сообщение "Не удалось загрузить данные **для этого визуального изображения"**. Удаление измерения устраняет проблему с визуальным аспектом — что происходит?

Это известная проблема соединитела Microsoft Call Quality. любое измерение, которое является целым числом, будет отображаться в Power BI в качестве "агрегированного" столбца, в котором Power BI попытается вывести итоговую сумму по умолчанию (как правило, "Сумма"). В некоторых случаях такое поведение приводит к успешному суммингу значений, даже если результат не является полезным, так как "сумма" измерения, например Second Wi-Fi Channel, не имеет смысла. В других случаях это действие суммирует ошибку и приводит к ошибкам на визуальном поле.

Чтобы обойти эту проблему, сначала удаляйте измерение из визуального изображения. Выберите измерение в списке "Поля", перейдите на вкладку "Инструменты для столбцов" на ленте, откройте меню "Сводка" и выберите пункт Не **суммировать**. Теперь измерение можно снова добавить в визуальное поле.


## <a name="error-codes"></a>Коды ошибок

Так как соединителю качества звонка (Майкрософт) для Power BI меньше ограничений, чем в веб-приложении с точки зрения типов запросов, которые можно создать, иногда при создании запросов может возникнуть ряд ошибок. Если вы получили сообщение об ошибке типа "CQDError. RunQuery — ошибка выполнения запроса" со ссылкой на список ниже с номером ErrorType, предоставленным для устранения возможной проблемы с запросом. Ниже ются наиболее распространенные коды типов ошибок, которые могут возникнуть с соединитетелем CQD Power BI.

- **Ошибка Тип ошибки 1. Ошибка структуры запроса:** Ошибка структуры запроса обычно вызвана тем, что соединителю не удается построить правильно отформатированный запрос. Чаще всего это происходит при использовании неподсвеченных функций, как указано в указанных выше ограничениях. Убедитесь, что для этого запроса не используется вычисляемый столбец или визуальный эффект.

  - **Тип ошибки 2. Ошибка создания запроса:** Ошибка при создании запроса вызвана тем, что соединитектор качества звонка (Майкрософт) не может правильно оценить запрос, который вы создаете. Чаще всего это происходит при использовании неподсвеченных функций, как указано в указанных выше ограничениях. Убедитесь, что для этого запроса не используется вычисляемый столбец или визуальный эффект.

  - **Тип ошибки 5. Время выполнения:** Время выполнения запроса достигло максимального возможного времени выполнения, прежде чем он отсроет. Попробуйте добавить другие фильтры в запрос, чтобы ограничить область его действия. Сужение диапазона данных часто является наиболее эффективным способом достижения этой цели.

  - **Тип ошибки 7. Ошибка "Нет измерений":** Запросы панели мониторинга качества  звонка требуют меры для работы. Убедитесь, что запрос содержит меру. Меры в соединиторе качества звонка (Майкрософт) обозначаются символом агрегирования (sum) перед их именем.

Если вы столкнулись с дополнительными ошибками вне этой области, сообщите об этом группе мониторинга качества  звонка, чтобы мы могли помочь устранить проблему и при необходимости обновить документацию.

## <a name="footnotes"></a>Сноски

**<sup>1</sup>** Некоторые процессы и приложения (например, OneDrive) могут привести к изменению корневой папки Документы; убедитесь, что *каталог Power BI Desktop\\ Настройки* соединителенцев находится в текущей корневой папке Документы.

**<sup>2</sup>** Учетные данные для входа, которые вы используете для панели мониторинга  качества звонка, не должны быть одинаковыми учетными данными, которые вы используете для входа в само Power BI Desktop приложения.

## <a name="frequently-asked-questions"></a>Вопросы и ответы

### <a name="when-will-the-power-bi-connector-be-updated-from-beta-status"></a>Когда соедините Power BI будет обновлен с состоянием "Бета"?

Несмотря на тег beta, microsoft Call Quality (Beta) connector for Power BI is the first 'release' version of the connector and has officially securitysigned by the Power BI team to reflect this. На момент первоначального выпуска соединитела группа Power BI не могла предоставить поддержку и более широкую сертификацию, но была готова проверить безопасность, подлинность и общий уровень функциональности соединитера качества звонка (Майкрософт). В ближайшее время мы планируем вложить средства в Power BI качество звонка Майкрософт.

### <a name="why-does-the-connector-seem-slower-compared-to-call-quality-dashboard-in-the-browser-what-can-i-do-to-improve-performance"></a>Почему соединитектор выглядит медленнее по сравнению с панелью мониторинга качества звонка в браузере? Что можно сделать для повышения производительности?

Производительность запросов для различных шаблонов на самом деле одинаковы как в браузере, так и в соединители.  Как и любое другое приложение, Power BI добавляет к производительности проверку подлинности и время отрисовки. Кроме того, разница заключается в количестве одновременно запускаемого запроса. Так как в версии панели мониторинга качества звонка в браузере были менее хорошо разработанные параметры визуализации и наглядной визуализации, большинство наших отчетов оказались доступны только для загрузки 2–3 запросов за раз. С другой стороны, в шаблонах соединителок часто отображается более 20 одновременно запросов. Если вы хотите создавать отчеты, которые так же адаптивны, как и старые, попробуйте создать отчеты не более чем с 2–3 запросами на вкладку.

Дополнительные сведения см. в следующих статьях:

- [Руководство по оптимизации для Power BI](/power-bi/guidance/power-bi-optimization)
- [Руководство по модели DirectQuery](/power-bi/guidance/directquery-model-guidance)

### <a name="i-find-that-i-routinely-run-into-the-10000-row-limit-when-running-queries-how-can-i-get-the-connector-to-return-more-than-10000-rows"></a>Я постоянно нажимаю на ограничение в 10 000 строк при запуске запросов. Как получить соединителя более 10 000 строк?

Ограничение в 10 000 строк фактически указывается в конце API и предназначено для существенного повышения производительности и снижения риска ошибок выполнения запросов, связанных с низким уровнем памяти.

Вместо того чтобы пытаться увеличить количество строк результатов, лучше изменить структуру отчетов в соответствии с лучшими методиками соединителя. Шаблоны, которые мы включили, предназначены для демонстрации этих лучших методик. По возможности начните с общих градиторий с более низкими масштабами, такими как "Месяц", "Год", "Дата", "Регион", "Страна" и т. д. После этого вы сможете отсверлить все более емкие размеры. Хорошим примером этого процесса является Location-Enhanced отчеты helpdesk и Location-Enhanced.



## <a name="related-topics"></a>Статьи по теме

[Используйте Power BI для анализа данных CQD для Teams](CQD-Power-BI-query-templates.md)
