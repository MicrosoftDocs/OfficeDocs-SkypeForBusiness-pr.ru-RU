---
title: Назначение политик большим наборам пользователей в учебном заведении
author: lanachin
ms.author: v-lanac
manager: serdars
ms.reviewer: saragava,karsmith
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
audience: Admin
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
localization_priority: Normal
search.appverid: MET150
description: В этой статье рассказывается о том, как использовать назначение пакетной политики для крупных наборов пользователей в обучающем учреждении для удаленной школы (теле-учебного заведения).
f1keywords: ''
ms.openlocfilehash: 5e3ee25bf4fadea595fc224b2944a12c279f9c59
ms.sourcegitcommit: 92a278c0145798266ecbe052e645b2259bcbd62d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "42892279"
---
# <a name="assign-policies-to-large-sets-of-users-in-your-school"></a>Назначение политик большим наборам пользователей в учебном заведении

Нужно ли предоставлять учащимся и преподавателям доступ к различным функциям в Microsoft Teams? Вы можете быстро идентифицировать пользователей в своей организации по типу лицензии и назначить им соответствующую политику. В этом учебнике показано, как использовать [назначение пакетной политики](assign-policies.md#assign-a-policy-to-a-batch-of-users) для назначения пользователям политики собраний для массовой рассылки.

Помните, что в Teams пользователи автоматически получают глобальную политику (по умолчанию на уровне Организации) для типа политики Teams, если вы не создали и не назначаете пользовательскую политику. Поскольку заполнение учащихся часто является большим набором пользователей, и они часто получают наиболее строгие параметры, мы рекомендуем сделать следующее:

- Измените и примените глобальную политику (по умолчанию на уровне Организации), чтобы ограничить возможности для учащихся. 
- Создание настраиваемой политики, которая позволяет выполнять базовые функции, такие как личное чат и планирование собраний, а также назначать политику сотрудникам и преподавателям.

Имейте в виду, что глобальная политика будет применяться ко всем пользователям в вашем учебном заведении, пока не будет создана пользовательская политика, и вы сможете назначить ее вашим сотрудникам и преподавателям.

В этом учебнике учащиеся получат глобальную политику собраний, и мы используем PowerShell для назначения настраиваемой политики собраний с именем Едукатормитингполици для сотрудников и преподавателей в массовом режиме. Предполагается, что вы изменили глобальную политику для настройки параметров собрания для учащихся и создали специальную политику, которая определяет процесс собрания для персонала и преподавателей.

![Снимок экрана: страница "политики собрания" в центре администрирования Teams](media/edu-batch-policy-assignment.png)

Выполните указанные ниже действия, чтобы назначить пользовательские политики собраний сотрудникам и преподавателям в массовом режиме.

## <a name="connect-to-the-azure-ad-powershell-for-graph-module-and-the-teams-powershell-module"></a>Соединение с модулем Azure AD PowerShell для Graph и модулем Teams PowerShell

Перед выполнением действий, описанных в этой статье, необходимо установить и подключить модуль Azure AD PowerShell для Graph (для идентификации пользователей по назначенным им лицензиям) и модуль Microsoft Teams PowerShell (для назначения политик этим пользователям).

### <a name="install-and-connect-to-the-azure-ad-powershell-for-graph-module"></a>Установка и подключение к модулю Azure AD PowerShell для Graph

Откройте командную команду Windows PowerShell с повышенными привилегиями (запустите Windows PowerShell от имени администратора), а затем выполните указанные ниже действия, чтобы установить модуль Azure Active Directory PowerShell для Graph.

```powershell
Install-Module -Name AzureAD
```

Выполните указанные ниже действия, чтобы подключиться к Azure AD.

```powershell
Connect-AzureAD
```

Когда вам будет предложено, войдите в систему с помощью учетных данных администратора.

Дополнительные сведения можно найти в разделе [подключение с помощью модуля Azure Active Directory PowerShell для Graph](https://docs.microsoft.com/office365/enterprise/powershell/connect-to-office-365-powershell#connect-with-the-azure-active-directory-powershell-for-graph-module).

### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модулю Microsoft Teams PowerShell

Выполните указанные ниже действия, чтобы установить [модуль PowerShell Microsoft Teams](https://www.powershellgallery.com/packages/MicrosoftTeams). Убедитесь, что вы установили версию 1.0.5 или более поздней версии.

```powershell
Install-Module -Name MicrosoftTeams
```

Выполните указанные ниже действия, чтобы подключиться к Teams и начать сеанс.

```powershell
Connect-MicrosoftTeams
```
Когда вам будет предложено, войдите в систему с помощью учетных данных администратора, используемых для подключения к Azure AD.

## <a name="identify-your-users"></a>Определение пользователей

Сначала выполните указанные ниже действия, чтобы идентифицировать сотрудников и преподавателей по типу лицензии. В этой статье рассказывается о том, какие SKU используются в вашей организации. Затем вы можете идентифицировать сотрудников и преподавателей, которым назначены номера SKU факультета.

```powershell
Get-AzureAdSubscribedSku | Select-Object -Property SkuPartNumber,SkuId
```

Возвращаемое значение.

```
SkuPartNumber      SkuId
-------------      -----
M365EDU_A5_FACULTY e97c048c-37a4-45fb-ab50-922fbf07a370
M365EDU_A5_STUDENT 46c119d4-0379-4a9d-85e4-97c66d3f909e
```

В этом примере вывод показывает, что лицензия факультета Скуид — "e97c048c-37a4-45fb-AB50-922fbf07a370".

> [!NOTE]
> Список материалов для образования и номер SKU можно найти в [справочнике по образованию SKU](sku-reference-edu.md).

Затем выполните указанные ниже действия, чтобы идентифицировать пользователей, у которых есть лицензия, и собирать их вместе.

```powershell
$faculty = Get-AzureADUser -All $true | Where-Object {($_.assignedLicenses).SkuId -contains "e97c048c-37a4-45fb-ab50-922fbf07a370"}
```

## <a name="assign-a-policy-in-bulk"></a>Массовое назначение политики

Теперь пользователям можно назначать соответствующие политики. Максимальное количество пользователей, которым можно назначить или обновлять политики, составляет 20 000 за один раз. Например, если у вас более 20 000 сотрудников и преподавателей, вам нужно будет отправить несколько пакетов.

> [!IMPORTANT]
> В настоящее время мы рекомендуем назначать политики в пакетах пользователей 5 000 за один раз. В это время вы можете столкнуться с задержкой во время обработки. Чтобы свести к минимуму влияние этих увеличенных времен обработки, мы рекомендуем вам отправлять меньшие размеры пакета до 5 000 пользователей и отправлять каждый пакет только после того, как вы закончите предыдущий. Вы также можете отправлять пакеты за пределы обычных рабочих часов.

Выполните указанные ниже действия, чтобы назначить политику собраний с именем Едукатормитингполици вашим сотрудникам и преподавателям.

```powershell
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMeetingPolicy -PolicyName EducatorMeetingPolicy -Identity $faculty.ObjectId
```

> [!NOTE]
> Чтобы назначить другой тип политики в массовом режиме, например Теамсмессагингполици, необходимо изменить ```PolicyType``` политику, которую вы назначаете, и ```PolicyName``` присвоить ей имя политики.

## <a name="get-the-status-of-a-bulk-assignment"></a>Получение состояния массового назначения

Каждое массовое назначение возвращает идентификатор операции, который можно использовать для отслеживания хода выполнения назначений политики или определения возможных сбоев. Например, выполните указанные ниже действия.

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId 3964004e-caa8-4eb4-b0d2-7dd2c8173c8c | fl
```

Чтобы просмотреть состояние назначения каждого пользователя в пакетной операции, выполните указанные ниже действия. Сведения о каждом пользователе находятся в ```UserState``` свойстве.

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId 3964004e-caa8-4eb4-b0d2-7dd2c8173c8c | Select -ExpandProperty UserState
```

## <a name="assign-a-policy-in-bulk-if-you-have-more-than-20000-users"></a>Назначение политики в массовом режиме, если у вас более 20 000 пользователей

Сначала выполните указанные ниже действия, чтобы узнать, сколько у вас сотрудников и преподавателей.

```powershell
$faculty.count
```

Вместо того чтобы предоставлять весь список идентификаторов пользователей, выполните указанные ниже действия, чтобы указать первые 20 000, а затем следующие 20 000 и т. д.

```powershell
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMeetingPolicy -PolicyName EducatorMeetingPolicy -Identity $faculty[0..19999].ObjectId
```

Вы можете изменить диапазон идентификаторов пользователей, пока не дойдете до полного списка пользователей. Например, введите ```$faculty[0..19999``` первый пакет, который используется ```$faculty[20000..39999``` для второго пакета, введите ```$faculty[40000..59999``` третий пакет и т. д.

## <a name="get-the-policies-assigned-to-a-user"></a>Получение политик, назначенных пользователю

Выполните указанные ниже действия, чтобы просмотреть все политики, назначенные определенному пользователю. В следующем примере показано, как получить политики, назначенные hannah@contoso.com.

```powershell
Get-CsUserPolicyAssignment -Identity hannah@contoso.com
```

## <a name="faq"></a>Вопросы и ответы

**Я хочу убедиться, что все пользователи, которые являются студентами, сотрудниками и преподавателями, автоматически получают лицензии. Как это можно сделать?**

Группа разработчиков Teams работает над тем, чтобы поддерживать назначение политик группам безопасности. В это время вы сможете создавать группы для учащихся и преподавателей, а затем соответствующие политики для этих групп. Обратите внимание на то, что явные назначения пользователей (например, политики, назначенные с помощью этого учебника) переопределяют политики, наследуемые от группы. Если эта функция поддерживается, мы предоставляем дополнительные инструкции по использованию назначения политики для групп и обновления пользователей, чтобы убедиться, что они получают унаследованные групповые политики.

**Я не знаком с оболочкой PowerShell для Teams. Где можно найти дополнительные сведения?**

Ознакомьтесь со статьей [Общие сведения о Teams PowerShell](teams-powershell-overview.md).

## <a name="related-topics"></a>Статьи по теме

- [Назначение политик пользователям](assign-policies.md)
- [New-Ксбатчполициассигнментоператион](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation)
- [Get-Ксбатчполициассигнментоператион](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation)
- [Get-Ксусерполициассигнмент](https://docs.microsoft.com/powershell/module/teams/get-csuserpolicyassignment)