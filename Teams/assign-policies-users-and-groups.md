---
title: Назначение политик пользователям и группам
author: KarliStites
ms.author: kastites
ms.reviewer: tomkau, saragava, ritikag, jastark
manager: serdars
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
audience: Admin
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
ms.localizationpriority: medium
search.appverid: MET150
description: Узнайте о различных способах назначения политик пользователям и группам в Microsoft Teams.
f1keywords:
- ms.teamsadmincenter.bulkoperations.users.edit
- ms.teamsadmincenter.bulkoperations.edit
ms.openlocfilehash: 82fa6f1469b0ffc65ec95d057c5e944728209078
ms.sourcegitcommit: b878c57b8e822913b7aac8c105f476bc4ebfcd7d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2022
ms.locfileid: "63761943"
---
# <a name="assign-policies-to-users-and-groups"></a>Назначение политик пользователям и группам

В этой статье рассматриваются различные способы назначения политик пользователям и группам в Microsoft Teams. Перед чтением обязательно прочитайте статью Назначение политик в Teams [- начало работы](policy-assignment-overview.md).

## <a name="assign-a-policy-to-individual-users"></a>Назначение политики отдельным пользователям

Чтобы назначить политику отдельному пользователю или небольшому числу пользователей одновременно, выполните указанные здесь действия.

### <a name="use-the-microsoft-teams-admin-center"></a>Использование центра Microsoft Teams администрирования

Чтобы назначить политику пользователю:

1. В левой области навигации центра [администрирования Microsoft Teams](https://admin.teams.microsoft.com) перейдите в меню **ПользователиУправляемые** >  пользователями.
2. Выберите пользователя, щелкнув слева от его имени и выбрав изменить **параметры**.
3. Выберите политику, которая вы хотите назначить, и **выберите применить.**

![Назначьте политику пользователю в центре Teams администрирования.](media/assign-policy-user.png)

> [!NOTE]
> Чтобы отоименить специальную политику пользователя, можно установить для каждой политики значение Глобальная (по умолчанию в **организации).**

Чтобы назначить политику пользователю, также можно сделать следующее:

1. В левой области навигации центра администрирования Microsoft Teams перейдите на страницу политики.
2. Выберите политику, которая будет назначаться, щелкнув слева от ее имени.
3. Выберите **Управление пользователями**.
4. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.
5. Завершив добавление пользователей, **выберите Применить.**

![Назначьте политику пользователю в Центре администрирования Teams помощью второго метода.](media/assign-policy-user2.png)

### <a name="use-powershell"></a>Использование PowerShell

У каждого типа политики есть собственный набор cmdlets для управления. Используйте для `Grant-` назначения политики тот или иной тип. Например, используйте его `Grant-CsTeamsMeetingPolicy` для назначения пользователям политики Teams собраний. Эти командлеты включены в модуль Teams PowerShell и задокументированы в Skype для бизнеса [командлета](/powershell/skype).

 Скачайте и установите [общедоступный Teams PowerShell](https://www.powershellgallery.com/packages/MicrosoftTeams/) (если вы еще не сделали этого), а затем запустите следующую версию, чтобы подключиться:

> [!NOTE]
> Соединитель Skype для бизнеса Online в настоящее время является частью последнего модуля Teams PowerShell.
>
> Если вы используете последнюю версию [Teams PowerShell](https://www.powershellgallery.com/packages/MicrosoftTeams/), вам не нужно устанавливать Skype для бизнеса Online Connector.

```powershell
  # When using Teams PowerShell Module

   Import-Module MicrosoftTeams
   $credential = Get-Credential
   Connect-MicrosoftTeams -Credential $credential
```

В этом примере мы назначим Teams собраний с именем Политика собраний учащихся пользователю с именем Reda.

```powershell
Grant-CsTeamsMeetingPolicy -Identity reda@contoso.com -PolicyName "Student Meeting Policy"
```

Подробнее об этом можно узнать в [документе Управление политиками с помощью PowerShell](teams-powershell-managing-teams.md#manage-policies-via-powershell).

## <a name="assign-a-policy-to-a-group"></a>Назначение политики группе

Назначение политик группам позволяет назначить политику группе пользователей, например группе безопасности, организационной группе или списку рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение политик группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами.

При назначении политики она сразу же назначается группе. Однако распространение назначения политики на участников группы выполняется в фоновом режиме и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе, а участники добавляются в нее или удаляются из нее.

Назначения групповой политики распространяются только на пользователей, которые являются прямыми участниками группы. Назначения не распространяются на участников вложенных групп.

### <a name="what-you-need-to-know-about-policy-assignment-to-groups"></a>Что необходимо знать о назначении политик группам

Перед началом работы важно разобраться в правилах приоритета и ранжирования заданий групп.

#### <a name="precedence-rules"></a>Правила приоритета

Для данного типа политики эффективная политика пользователя определяется следующим образом:

- Политика, которая непосредственно назначена пользователю, имеет приоритет над любой другой политикой того же типа, которая назначена группе. Другими словами, если пользователю непосредственно назначена политика того или иного типа, он не наследует политику того же типа от группы. Это также означает, что если пользователю назначена политика того или иного типа, вам придется удалить ее у пользователя, прежде чем он сможет наследовать политику того же типа из группы.
- Если пользователю не назначена политика, а он входит в несколько групп и каждой группе назначена политика одного и того же типа, пользователь наследует политику назначения группы с наивысшим рейтингом.
- Если пользователь не входит в группы, для каких-либо групп назначена политика, к этому типу политики применяется глобальная политика (по умолчанию в организации).

Эффективная политика пользователя обновляется в соответствии с этими правилами:

- при добавлении пользователя в группу, назначенной политике, или его удалении из нее.
- политика не назначена группе.
- Политика, которая непосредственно назначена пользователю, удаляется.

#### <a name="group-assignment-ranking"></a>Ранжирование заданий группы

При назначении группе политики указывается ранжирование для назначения группы. Он используется для определения политики, которая должна наследоваться пользователем как эффективная политика, если пользователь входит в несколько групп и каждой группе назначена политика одного типа.

Ранжирование заданий группы является относительным по отношению к другим групповым назначениям того же типа. Например, если вы назначаете политику звонков двум группам, установите для ранжирования одно задание 1, а для другого — 2, причем 1 является самым высоким. Ранжирование назначений групп показывает, какое членство в группах является более важным или релевантным, чем другие группы в отношении наследования.

Например, у вас есть две группы: "Сотрудники магазинов" и "Руководители магазинов". Обеим группам назначена политика Teams звонков, политика звонков сотрудников магазинов и политика звонков диспетчеров магазинов соответственно. Для руководителя магазина, который относится к обеим группам, его роль руководителя больше релевантна, чем роль сотрудника, поэтому политика звонков, назначенная группе "Руководители магазинов", должна иметь более высокий рейтинг.

|Группы |Teams политики звонков  |Rank (Ранг)|
|---------|---------|---|
|Руководители магазинов   |Политика звонков диспетчеров магазинов         |1|
|Сотрудники магазина    |Политика звонков сотрудников магазина      |2|

Если не указать ранжирование, назначение политики будет присвоено наименьшее ранжирование.

### <a name="in-the-teams-admin-center"></a>В центре Teams администрирования

> [!NOTE]
> В настоящее время назначение политик группам, использующим Центр администрирования Microsoft Teams, доступно только для политик Teams звонков, политики парков звонков Teams, политики Teams, политики трансляций Teams, политики собраний Teams и политики Teams сообщений. Для других типов политик используйте PowerShell.

1. В левой области навигации центра администрирования Microsoft Teams перейдите на страницу типа политики. Например, перейдите к **политике** >  собрания **.**
2. Выберите **вкладку Назначение групповой** политики.
3. Выберите **добавить группу**, а затем в области **Назначение** политики группе сделайте следующее:
    1. Найщите и добавьте группу, для нее нужно назначить политику.
    2. Задание ранжирования для задания группы.
    3. Выберите политику, которую вы хотите назначить.
    4. Выберите **Применить**.
    
![Назначьте политику группе в Центре Teams администрирования.](media/assign-policy-group.png)

Чтобы удалить назначение групповой политики, на вкладке Назначение групповой политики страницы политики выберите назначение группы, а затем выберите **Удалить**.

Чтобы изменить ранжирование назначения группы, необходимо сначала удалить назначение групповой политики. Затем, следуя этим шагам, назначьте политику группе.

### <a name="use-the-powershell-option"></a>Использование параметра PowerShell

> [!NOTE]
> В настоящее время назначения политик группам, использующим PowerShell, доступны не для Teams типов политик. Список поддерживаемых типов политик см. в списке [New-CsGroupPolicyAssignment](/powershell/module/teams/new-csgrouppolicyassignment) .

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к Microsoft Teams PowerShell

Пошаговую инструкцию см. в [Teams PowerShell](teams-powershell-install.md).

#### <a name="assign-a-policy-to-a-group-of-users"></a>Назначение политики группе пользователей

Чтобы [назначить группу политику, воспользуйтесь cmdlet New-CsGroupPolicyAssignment](/powershell/module/teams/new-csgrouppolicyassignment) . Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты.

В этом примере группе со ранжированием заданий 1 назначается политика собраний Teams "Менеджеры розничной торговли".

```powershell
New-CsGroupPolicyAssignment -GroupId d8ebfa45-0f28-4d2d-9bcc-b158a49e2d17 -PolicyType TeamsMeetingPolicy -PolicyName "Retail Managers Meeting Policy" -Rank 1
```

#### <a name="get-policy-assignments-for-a-group"></a>Получить назначения политик для группы

Чтобы получить все политики, которые назначены группе, воспользуйтесь [cmdlet Get-CsGroupPolicyAssignment](/powershell/module/teams/get-csgrouppolicyassignment) . Обратите внимание, что группы всегда указаны по их групповому ИД, даже если для назначения политики использовался SIP-адрес или адрес электронной почты.

В этом примере мы извлекаем все политики, которые назначены определенной группе.

```powershell
Get-CsGroupPolicyAssignment -GroupId e050ce51-54bc-45b7-b3e6-c00343d31274
```

В этом примере мы возвращаем все группы, для Teams собраний.

```powershell
Get-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy
```

#### <a name="remove-a-policy-from-a-group"></a>Удаление политики из группы

Чтобы удалить [политику из группы, используйте cmdlet Remove-CsGroupPolicyAssignment](/powershell/module/teams/remove-csgrouppolicyassignment) . При этом обновляются приоритеты других политик того же типа, которые имеют более низкий рейтинг. Например, если удалить политику со ранжированием 2, политики с ранжированием 3 и 4 будут обновлены с учетом их нового ранжирования. В следующих двух таблицах приводится пример.

Вот список назначений и приоритетов политики для Teams собраний.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Западная область     |Политика западного региона         |2         |
|Отдел    |Политика деления         |3         |
|Дочерней компании   |Политика дочернего подразделения        |4         |

Если удалить политику западного региона из группы "Запад", назначения и приоритеты политики будут обновлены следующим образом.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Отдел    |Политика деления         |2         |
|Дочерней компании   |Политика дочернего подразделения        |3        |

В этом примере мы удаляем политику Teams собраний из группы.

```powershell
Remove-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy -GroupId f985e013-0826-40bb-8c94-e5f367076044
```

#### <a name="change-a-policy-assignment-for-a-group"></a>Изменение назначения политики для группы

> [!NOTE]
> В [ближайшее время появится cmdlet Set-CsGroupPolicyAssignment](/powershell/module/teams/set-csgrouppolicyassignment) . Тем временем, чтобы изменить назначение групповой политики, вы можете удалить текущее назначение политики из группы, а затем добавить новое назначение политики.

После назначения группе политики можно изменить назначение политики этой группы с помощью cmdlet [Set-CsGroupPolicyAssignment](/powershell/module/teams/set-csgrouppolicyassignment) :

- Изменение ранжирования
- Изменение политики для заданного типа политики
- Изменение политики для заданного типа политики и ранжирования

В этом примере мы меняем политику группы Teams на политику SupportCallPark и ранжирование заданий на 3.

```powershell
Set-CsGroupPolicyAssignment -GroupId 566b8d39-5c5c-4aaa-bc07-4f36278a1b38 -PolicyType TeamsMeetingPolicy -PolicyName SupportCallPark -Rank 3
```

#### <a name="change-the-effective-policy-for-a-user"></a>Изменение эффективной политики для пользователя

Вот пример того, как изменить эффективную политику для пользователя, которому назначена политика напрямую.

Во-первых, мы используем вместе с параметром [get-CsUserPolicyAssignment](/powershell/module/teams/get-csuserpolicyassignment) `PolicySource` сведения о политиках Teams трансляции собраний, связанных с пользователем.

```powershell
Get-CsUserPolicyAssignment -Identity daniel@contoso.com -PolicyType TeamsMeetingBroadcastPolicy | select -ExpandProperty PolicySource
```

Выходные данные показывают, что пользователю напрямую назначена политика Teams трансляций собраний с названием "События сотрудника", которая имеет приоритет над политикой "Мероприятия поставщиков", назначенной группе, которой он принадлежит.

```console
AssignmentType PolicyName         Reference
-------------- ----------         ---------
Direct         Employee Events
Group          Vendor Live Events 566b8d39-5c5c-4aaa-bc07-4f36278a1b38
```

Теперь мы удалим политику "События сотрудников" для пользователя. Это означает, что пользователю больше не назначена политика Teams трансляций собраний, и наследует политику "Мероприятия поставщиков", назначенную группе, которой принадлежит пользователь.

Для этого воспользуйтесь следующим командлетом Skype для бизнеса PowerShell.

```powershell
Grant-CsTeamsMeetingBroadcastPolicy -Identity daniel@contoso.com -PolicyName $null
```

Используйте следующий командлет в модуле Teams PowerShell, чтобы сделать это в масштабе, хотя назначение пакетной политики$users где $users список пользователей, которые вы указали.

```powershell
New-CsBatchPolicyAssignmentOperation -OperationName "Assigning null at bulk" -PolicyType TeamsMeetingBroadcastPolicy -PolicyName $null -Identity $users  
```

## <a name="assign-a-policy-to-a-batch-of-users"></a>Назначение политики для пакета пользователей

### <a name="use-the-admin-center"></a>Использование Центра администрирования

Чтобы массово назначить политику пользователям:

1. В левой области навигации центра Microsoft Teams выберите **Пользователи**.
2. Найщите пользователей, для них нужно назначить политику, или отфильтруем представление, чтобы отфильтровать нужных пользователей.
3. В столбце **&#x2713;** (галочка) выберите пользователей. Чтобы выбрать всех пользователей, щелкните &#x2713; (галочку) в верхней части таблицы.
4. Выберите **Изменить параметры**, внесите нужные изменения и **выберите применить.**

Чтобы просмотреть состояние назначения политики, в баннере, который появляется в верхней части страницы Пользователи после  выбора применить для отправки  задания политики, выберите **журнал действий**. Кроме того, в левой области навигации центра администрирования Microsoft Teams панели **мониторинга, а** затем в журнале действий выберите **Просмотреть сведения**. В журнале действий показаны назначения политик более чем 20 пользователям через Microsoft Teams за последние 30 дней. Дополнительные данные см. в записи просмотра заданий политики [в журнале действий](activity-log.md).

### <a name="use-powershell-method"></a>Использование метода PowerShell

> [!NOTE]
> В настоящее время назначение пакетной политики с помощью PowerShell доступно не для Teams типов политик. Список поддерживаемых типов политик см. в списке [New-CsBatchPolicyAssignmentOperation](/powershell/module/teams/new-csbatchpolicyassignmentoperation) .

При назначении пакетной политики вы можете назначать политику большому набору пользователей одновременно, не пользуясь сценарием. Для отправки пакета пользователей и политики, которую вы хотите назначить, используется cmdlet [New-CsBatchPolicyAssignmentOperation](/powershell/module/teams/new-csbatchpolicyassignmentoperation) . Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем можно использовать для отслеживания хода выполнения и состояния заданий в пакете [с помощью cmdlet Get-CsBatchPolicyAssignmentOperation](/powershell/module/teams/get-csbatchpolicyassignmentoperation) .

Укажите пользователей по их ИД объекта или SIP-адресу. SIP-адрес пользователя часто имеет то же значение, что и имя директора-пользователя (UPN) или адрес электронной почты, но это не обязательно. Если имя пользователя указано с помощью его имя-пользователя или электронной почты, но его значение отличается от SIP-адреса, назначение политики для него не удастся. Если пакет содержит дубликатов пользователей, они будут удалены из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете.

Пакет может содержать до 5 000 пользователей. Для получения наилучших результатов не от отправьте несколько пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

#### <a name="install-and-connect-to-the-teams-powershell-module"></a>Установка и подключение к Teams PowerShell

Чтобы установить модуль [Microsoft Teams PowerShell, запустите следующую:](https://www.powershellgallery.com/packages/MicrosoftTeams) Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams и начать сеанс, запустите следующую:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте в учетные данные администратора.

#### <a name="install-and-connect-to-the-azure-ad-powershell-for-graph-module-optional"></a>Установка и подключение к Azure AD PowerShell для Graph (необязательно)

Кроме того, может потребоваться скачать и установить [модуль Azure AD PowerShell для Graph](/powershell/azure/active-directory/install-adv2) (если вы еще не сделали этого) и подключиться к Azure AD, чтобы получить список пользователей в организации.

Чтобы подключиться к Azure AD, запустите следующую службу:

```powershell
Connect-AzureAD
```

В окне запроса войтесь в учетные данные администратора, которые использовались для подключения к Teams.

#### <a name="assign-a-setup-policy-to-a-batch-of-users"></a>Назначение политики установки для пакета пользователей

В этом примере с помощью нового [CsBatchPolicyAssignmentOperation](/powershell/module/teams/new-csbatchpolicyassignmentoperation) назначим политику настройки приложений с названием Политика настройки приложений для отдела кадров пакету пользователей, перечисленных в users_ids.text file.

```powershell
$user_ids = Get-Content .\users_ids.txt
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsAppSetupPolicy -PolicyName "HR App Setup Policy" -Identity $user_ids -OperationName "Example 1 batch"
```

В этом примере мы подключаемся к Azure AD, чтобы получить набор пользователей, а затем назначим политику обмена сообщениями "Новая политика обмена сообщениями о приеме на работу" пакету пользователей, указанному с помощью их SIP-адреса.

```powershell
Connect-AzureAD
$users = Get-AzureADUser
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMessagingPolicy -PolicyName "New Hire Messaging Policy" -Identity $users.SipProxyAddress -OperationName "Example 2 batch"
```

#### <a name="get-the-status-of-a-batch-assignment"></a>Получить состояние пакета назначения

Чтобы получить состояние пакета назначения, где OperationId `New-CsBatchPolicyAssignmentOperation` — это код операции, возвращаемой этим cmdlet для заданного пакета, запустите следующую операцию:

```powershell
$Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если выходные данные показывают, что произошла ошибка, запустите следующую, чтобы получить дополнительные сведения об ошибках, которые находятся в свойстве `UserState` .

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation](/powershell/module/teams/get-csbatchpolicyassignmentoperation).

## <a name="related-topics"></a>Статьи по теме

- [Управление Teams политиками](manage-teams-with-policies.md)
- [Обзор PowerShell в Teams](teams-powershell-overview.md)
- [Назначение политик в Teams — начало работы](policy-assignment-overview.md)
