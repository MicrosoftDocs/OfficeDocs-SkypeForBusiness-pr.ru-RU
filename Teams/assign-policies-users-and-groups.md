---
title: Назначение политик пользователям и группам
author: KarliStites
ms.author: kastites
ms.reviewer: tomkau, saragava, ritikag, jastark
manager: serdars
ms.topic: article
ms.tgt.pltfrm: cloud
ms.service: msteams
audience: Admin
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
localization_priority: Normal
search.appverid: MET150
description: Узнайте о различных способах назначения политик пользователям и группам в Microsoft Teams.
f1keywords:
- ms.teamsadmincenter.bulkoperations.users.edit
- ms.teamsadmincenter.bulkoperations.edit
ms.openlocfilehash: 6b0db8c3da93e561bf374b32d08750d705ded8a2
ms.sourcegitcommit: 2bb8556650120b4f7cf509d8ff93d7e4d058829b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "51574353"
---
# <a name="assign-policies-to-users-and-groups"></a>Назначение политик пользователям и группам

В этой статье рассматриваются различные способы назначения политик пользователям и группам в Microsoft Teams. Прежде чем читать, прочитайте статью ["Назначение политик в Teams — начало работы".](policy-assignment-overview.md)

## <a name="assign-a-policy-to-individual-users"></a>Назначение политики отдельным пользователям

Выполните эти действия, чтобы назначить политику отдельному пользователю или небольшому числу пользователей одновременно.

### <a name="use-the-microsoft-teams-admin-center"></a>Использование Центра администрирования Microsoft Teams

Чтобы назначить политику пользователю:

1. В левой области навигации Центра администрирования Microsoft Teams перейдите в меню **"Пользователи"** и выберите пользователя.
2. Выберите пользователя, щелкнув слева от его имени и выбрав "Изменить **параметры".**
3. Выберите политику, а затем выберите **"Применить".**

![Назначение политики пользователю в Центре администрирования Teams](media/assign-policy-user.png)

Кроме того, вы можете сделать следующее:

1. В левой области навигации Центра администрирования Microsoft Teams перейдите на страницу политики.
2. Выберите политику, которая вы хотите назначить, щелкнув слева от ее имени.
3. Выберите **Управление пользователями**.
4. В области **Управление пользователями** выполните поиск по отображаемому имени или по имени пользователя, выберите имя и нажмите **Добавить**. Повторите это действие для каждого пользователя, которого нужно добавить.
5. Завершив добавление пользователей, выберите **"Применить".**

![Назначение политики пользователю в Центре администрирования Teams с помощью второго метода](media/assign-policy-user2.png)

### <a name="use-powershell"></a>Использование PowerShell

У каждого типа политики есть собственный набор cmdlets для управления. Используйте для назначения политики тот или иной тип ```Grant-``` политики с помощью cmdlet. Например, используйте ```Grant-CsTeamsMeetingPolicy``` командлет для назначения пользователям политики собраний Teams. Эти командлеты включены в модуль Teams PowerShell и задокументированы в справочнике по [командлету Skype для бизнеса.](https://docs.microsoft.com/powershell/skype)

 Скачайте и установите общедоступный выпуск [Teams PowerShell](https://www.powershellgallery.com/packages/MicrosoftTeams/) (если еще не сделали этого), а затем запустите следующую команду, чтобы подключиться:

> [!NOTE]
> Соединитель Skype для бизнеса Online сейчас входит в состав последнего модуля Teams PowerShell.
>
> Если вы используете последний общедоступный выпуск [Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams/)вам не нужно устанавливать соединитель Skype для бизнеса Online.

```powershell
  # When using Teams PowerShell Module

   Import-Module MicrosoftTeams
   $credential = Get-Credential
   Connect-MicrosoftTeams -Credential $credential
```

В этом примере мы назначаем политику собраний Teams "Политика собраний учащихся" пользователю Reda.

```powershell
Grant-CsTeamsMeetingPolicy -Identity reda@contoso.com -PolicyName "Student Meeting Policy"
```

Для получения дополнительных информации [ознакомьтесь с управлением политиками с помощью PowerShell.](teams-powershell-managing-teams.md#manage-policies-via-powershell)

## <a name="assign-a-policy-to-a-group"></a>Назначение политики группе

Назначение политик группам позволяет назначить политику группе пользователей, например группе безопасности или списку рассылки. Назначение политики распространяется на участников группы в соответствии с правилами очередности. При добавлении или удалении участников группы, назначения политик для них обновляются соответствующим образом.

Назначение политик группам рекомендуется для групп до 50 000 пользователей, но оно также будет работать с более крупными группами.

Назначенная политика сразу же назначается группе. Однако распространение назначения политики на участников группы выполняется в фоновом режиме и может занять некоторое время в зависимости от размера группы. То же самое происходит, если политика не назначена группе, а также когда участники добавляются в группу или удаляются из нее.

Назначения групповой политики распространяются только на пользователей, которые являются прямыми участниками группы. Назначения не распространяются на участников вложенных групп.

### <a name="what-you-need-to-know-about-policy-assignment-to-groups"></a>Что нужно знать о назначении политик группам

Прежде чем начать, важно разобраться в правилах приоритета и ранжирования заданий групп.

#### <a name="precedence-rules"></a>Правила приоритета

Для данного типа политики эффективная политика пользователя определяется в соответствии со следующими данными:

- Политика, которая непосредственно назначена пользователю, имеет приоритет над любой другой политикой того же типа, которая назначена группе. Другими словами, если пользователю непосредственно назначена политика заданного типа, он не наследует политику того же типа от группы. Это также означает, что если пользователю назначена политика заданного типа, необходимо удалить ее, прежде чем он сможет наследовать политику того же типа из группы.
- Если пользователю не назначена политика напрямую и он входит в несколько групп и каждой группе назначена политика одного и того же типа, то пользователь наследует политику назначения группы с наивысшим рейтингом.
- Если пользователь не входит в группы, для каких-либо групп назначена политика, к этому типу политики применяется глобальная политика (по умолчанию в организации).

Эффективная политика пользователя обновляется в соответствии с этими правилами:

- при добавлении пользователя в группу, которая назначена политике, или удален из нее.
- политика не назначена группе.
- Политика, которая непосредственно назначена пользователю, будет удалена.

#### <a name="group-assignment-ranking"></a>Ранжирование назначений групп

При назначении политики группе вы указываете ранжирование для назначения группы. Он используется для определения политики, которая должна наследоваться пользователем как эффективная политика, если пользователь входит в несколько групп и каждой группе назначена политика одного типа.

Ранжирование групповых заданий относительно назначений других групп того же типа. Например, если политика звонков назначается двум группам, узначьте ранжирование одному заданию 1, а другому — 2, причем 1 — самый высокий. Ранжирование назначений групп показывает, какие из них более важны или релевантны, чем другие группы в отношении наследования.

Например, у вас есть две группы: "Сотрудники магазинов" и "Руководители магазинов". Обе группы имеют политику звонков Teams, политику звонков сотрудников магазина и политику звонков диспетчеров магазинов соответственно. Для руководителя магазина, который относится к обеим группам, его роль руководителя больше релевантна, чем его роль в качестве сотрудника, поэтому политика звонков, назначенная группе "Руководители магазинов", должна иметь более высокий рейтинг.

|Группа |Название политики звонков Teams  |Rank (Ранг)|
|---------|---------|---|
|Руководители магазинов   |Политика звонков для руководителей магазинов         |1|
|Сотрудники магазина    |Политика звонков сотрудников магазина      |2|

Если не указать ранжирование, назначение политики будет присвоено наименьшему ранжирование.

### <a name="in-the-teams-admin-center"></a>В Центре администрирования Teams

> [!NOTE]
> В настоящее время назначение политик группам с помощью Центра администрирования Microsoft Teams доступно только для политик звонков Teams, политики в парке звонков Teams, политики Teams, политики трансляций Teams, политики собраний Teams и политики обмена сообщениями Teams. Для других типов политик используйте PowerShell.

1. В левой области навигации Центра администрирования Microsoft Teams перейдите на страницу типа политики. Например, перейдите к **политикам**  >  **собраний собраний.**
2. Выберите **вкладку назначения групповой политики.**
3. Выберите **"Добавить группу",** а затем в области "Назначение политики группе" сделайте следующее: 
    1. Наищите и добавьте группу, для нее нужно назначить политику.
    2. Задание ранжирования для группового назначения.
    3. Выберите политику, которую вы хотите назначить.
    4. Выберите **"Применить".**
    
![Назначение политики группе в Центре администрирования Teams](media/assign-policy-group.png)

Чтобы удалить назначение групповой  политики, на вкладке назначения групповой политики на странице политики выберите назначение группы и выберите **"Удалить".**

Чтобы изменить ранжирование для группового назначения, необходимо сначала удалить назначение групповой политики. Затем следуйте этим шагам, чтобы назначить политику группе.

### <a name="use-the-powershell-option"></a>Использование параметра PowerShell

> [!NOTE]
> В настоящее время назначение политик группам с помощью PowerShell доступно не для всех типов политик Teams. Список поддерживаемых типов политик см. в списке [New-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/new-csgrouppolicyassignment)

#### <a name="install-and-connect-to-the-microsoft-teams-powershell-module"></a>Установка и подключение к модуле Microsoft Teams PowerShell

Пошаговую инструкцию см. в [руководстве по установке Teams PowerShell.](teams-powershell-install.md)

#### <a name="assign-a-policy-to-a-group-of-users"></a>Назначение политики группе пользователей

Чтобы назначить политику группе, [используйте cmdlet New-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/new-csgrouppolicyassignment) Группу можно указать с помощью ИД объекта, SIP-адреса или адреса электронной почты.

В этом примере мы назначаем политику собраний Teams "Политика собраний розничных менеджеров" группе со ранжированием заданий 1.

```powershell
New-CsGroupPolicyAssignment -GroupId d8ebfa45-0f28-4d2d-9bcc-b158a49e2d17 -PolicyType TeamsMeetingPolicy -PolicyName "Retail Managers Meeting Policy" -Rank 1
```

#### <a name="get-policy-assignments-for-a-group"></a>Получать назначения политик для группы

Для получения всех политик, которые назначены группе, используйте [cmdlet Get-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/get-csgrouppolicyassignment) Обратите внимание, что группы всегда перечисляются по их ИД, даже если для назначения политики использовался ее SIP-адрес или адрес электронной почты.

В этом примере мы извлекаем все политики, которые назначены определенной группе.

```powershell
Get-CsGroupPolicyAssignment -GroupId e050ce51-54bc-45b7-b3e6-c00343d31274
```

В этом примере возвращаются все группы, которые имеют политику собраний Teams.

```powershell
Get-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy
```

#### <a name="remove-a-policy-from-a-group"></a>Удаление политики из группы

Чтобы удалить политику из группы, [используйте cmdlet Remove-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/remove-csgrouppolicyassignment) При этом приоритеты других политик того же типа, которые имеют более низкий рейтинг, обновляются. Например, если удалить политику со ранжированием 2, политики с ранжированием 3 и 4 будут обновлены с учетом нового ранжирования. В следующих двух таблицах приводится пример.

Вот список назначений и приоритетов политики собраний Teams.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Западная область     |Политика западного региона         |2         |
|Деление    |Политика деления         |3         |
|Дочернее подразделение   |Политика дочернего подразделения        |4         |

Если удалить политику западного региона из группы "Запад региона", назначения и приоритеты политики обновляются следующим образом.

|Имя группы  |Название политики  |Rank (Ранг)|
|---------|---------|---------|
|Продажи    |Политика продаж       | 1        |
|Деление    |Политика деления         |2         |
|Дочернее подразделение   |Политика дочернего подразделения        |3        |

В этом примере мы удаляем политику собраний Teams из группы.

```powershell
Remove-CsGroupPolicyAssignment -PolicyType TeamsMeetingPolicy -GroupId f985e013-0826-40bb-8c94-e5f367076044
```

#### <a name="change-a-policy-assignment-for-a-group"></a>Изменение назначения политики для группы

> [!NOTE]
> В [ближайшее время появится cmdlet Set-CsGroupPolicyAssignment.](https://docs.microsoft.com/powershell/module/teams/set-csgrouppolicyassignment) Тем временем, чтобы изменить назначение групповой политики, вы можете удалить текущее назначение политики из группы, а затем добавить новое назначение политики.

После назначения политики группе вы можете изменить [](https://docs.microsoft.com/powershell/module/teams/set-csgrouppolicyassignment) назначение политики этой группы с помощью следующим образом:

- Изменение ранжирования
- Изменение политики для заданного типа политики
- Изменение политики для заданного типа политики и ранжирования

В этом примере мы меняем политику парка вызовов Teams на политику SupportCallPark и ранжирование назначений на 3.

```powershell
Set-CsGroupPolicyAssignment -GroupId 566b8d39-5c5c-4aaa-bc07-4f36278a1b38 -PolicyType TeamsMeetingPolicy -PolicyName SupportCallPark -Rank 3
```

#### <a name="change-the-effective-policy-for-a-user"></a>Изменение эффективной политики для пользователя

Вот пример изменения эффективной политики для пользователя, которому непосредственно назначена политика.

Во-первых, мы используем командлет [Get-CsUserPolicyAssignment](https://docs.microsoft.com/powershell/module/teams/get-csuserpolicyassignment) вместе с параметром, чтобы получить сведения о политиках трансляции собраний Teams, связанных ```PolicySource``` с пользователем.

```powershell
Get-CsUserPolicyAssignment -Identity daniel@contoso.com -PolicyType TeamsMeetingBroadcastPolicy | select -ExpandProperty PolicySource
```

В выходных данных видно, что пользователю напрямую назначена политика трансляции собраний Teams "События сотрудника", которая имеет приоритет над политикой "Мероприятия в жизни поставщика", назначенной группе, которой принадлежит пользователь.

```console
AssignmentType PolicyName         Reference
-------------- ----------         ---------
Direct         Employee Events
Group          Vendor Live Events 566b8d39-5c5c-4aaa-bc07-4f36278a1b38
```

Теперь мы удалим политику событий сотрудников для пользователя. Это означает, что пользователю больше не назначена прямая политика трансляции собраний Teams, и он наследует политику "Поставщик Live Events", назначенную группе, которой принадлежит пользователь.

Для этого используйте следующий командлет в модуле Skype для бизнеса PowerShell:

```powershell
Grant-CsTeamsMeetingBroadcastPolicy -Identity daniel@contoso.com -PolicyName $null
```

Используйте следующий командлет в модуле Teams PowerShell, чтобы выполнять это в масштабе, хотя назначение пакетной политики$users где $users — это список пользователей, которых вы указали.

```powershell
New-CsBatchPolicyAssignmentOperation -OperationName "Assigning null at bulk" -PolicyType TeamsMeetingBroadcastPolicy -PolicyName $null -Identity $users  
```

## <a name="assign-a-policy-to-a-batch-of-users"></a>Назначение политики для пакета пользователей

### <a name="use-the-admin-center"></a>Использование Центра администрирования

Чтобы массово назначить политику пользователям:

1. В левой области навигации Центра администрирования Microsoft Teams выберите **"Пользователи".**
2. Назначьте политику пользователям или отфильтруем представление, чтобы отфильтровать их.
3. В столбце **&#x2713;** (галочка) выберите пользователей. Чтобы выбрать всех пользователей, щелкните &#x2713; (галочку) в верхней части таблицы.
4. Выберите **"Изменить параметры",** внесите нужные изменения и выберите "Применить". 

Чтобы просмотреть состояние назначения политики, в верхней части  страницы "Пользователи"  в верхней части страницы "Пользователи" выберите "Применить" для отправки задания политики, а затем выберите журнал **действий.** Или на панели навигации слева в Центре администрирования Microsoft Teams перейдите на панель **мониторинга,** а затем в журнале действий выберите "Просмотреть **сведения".** В журнале действий показаны назначения политик более чем 20 пользователям через Центр администрирования Microsoft Teams за последние 30 дней. Дополнительные данные см. в [журнале действий.](activity-log.md)

### <a name="use-powershell-method"></a>Использование метода PowerShell

> [!NOTE]
> В настоящее время пакетное назначение политики с помощью PowerShell доступно не для всех типов политик Teams. Список поддерживаемых типов политик см. в [new-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation)

При назначении пакетной политики вы можете назначать политику большому набору пользователей одновременно, не пользуясь сценарием. Для отправки пакета пользователей и политики, которую вы хотите назначить, используется cmdlet [New-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) Задания будут обрабатываться в фоновом режиме, а для каждого пакета будет создан идентификатор операции. Затем можно использовать для отслеживания хода выполнения и состояния назначений в пакете с помощью выполнения и выполнения задач [Get-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation)

Укажите пользователей по их ИД объекта или SIP-адресу. SIP-адрес пользователя часто имеет то же значение, что и имя директора-пользователя (UPN) или адрес электронной почты, но это не требуется. Если имя пользователя указано с помощью upN или электронной почты, но его значение отличается от SIP-адреса, назначение политики для пользователя не удастся. Если пакет включает дублирующихся пользователей, повторяющиеся записи удаляются из пакета до обработки, а состояние будет предоставлено только для уникальных пользователей, оставшихся в пакете.

Пакет может содержать до 5 000 пользователей. Для получения наилучших результатов не от отправьте несколько пакетов за один раз. Разрешить обработку пакетов перед отправкой дополнительных пакетов.

#### <a name="install-and-connect-to-the-teams-powershell-module"></a>Установка модуля Teams PowerShell и подключение к его окне

Чтобы установить модуль [Microsoft Teams PowerShell,](https://www.powershellgallery.com/packages/MicrosoftTeams)запустите следующую команду: Установите версию 1.0.5 или более поздней.

```powershell
Install-Module -Name MicrosoftTeams
```

Чтобы подключиться к Teams и начать сеанс, запустите следующую команду:

```powershell
Connect-MicrosoftTeams
```

Когда вам будет предложено, войте учетные данные администратора.

#### <a name="install-and-connect-to-the-azure-ad-powershell-for-graph-module-optional"></a>Установка и подключение к модуле Azure AD PowerShell для Graph (необязательно)

Вы также можете скачать и установить модуль [Azure AD PowerShell](https://docs.microsoft.com/powershell/azure/active-directory/install-adv2) для Graph (если еще не сделали этого) и подключиться к Azure AD, чтобы получить список пользователей в организации.

Чтобы подключиться к Azure AD, запустите следующую службу:

```powershell
Connect-AzureAD
```

Когда вам будет предложено, вопишите с помощью учетных данных администратора, которые вы использовали для подключения к Teams.

#### <a name="assign-a-setup-policy-to-a-batch-of-users"></a>Назначение политики установки для пакета пользователей

В этом примере с помощью нового [csBatchPolicyAssignmentOperation](https://docs.microsoft.com/powershell/module/teams/new-csbatchpolicyassignmentoperation) назначим политику установки приложений с именем "Политика настройки приложений для управления персоналом" пакету пользователей, указанных в Users_ids.text файле.

```powershell
$user_ids = Get-Content .\users_ids.txt
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsAppSetupPolicy -PolicyName "HR App Setup Policy" -Identity $users_ids -OperationName "Example 1 batch"
```

В этом примере мы подключаемся к Azure AD, чтобы получить коллекцию пользователей, а затем назначаем политику обмена сообщениями с именем "Новая политика для обмена сообщениями о приеме на работу" пакету пользователей, заданным с помощью их SIP-адреса.

```powershell
Connect-AzureAD
$users = Get-AzureADUser
New-CsBatchPolicyAssignmentOperation -PolicyType TeamsMessagingPolicy -PolicyName "New Hire Messaging Policy" -Identity $users.SipProxyAddress -OperationName "Example 2 batch"
```

#### <a name="get-the-status-of-a-batch-assignment"></a>Состояние пакетного назначения

Чтобы получить состояние пакета назначения, где OperationId — это код операции, возвращаемой этим cmdlet для данного пакета, запустите ```New-CsBatchPolicyAssignmentOperation``` следующую операцию:

```powershell
$Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | fl
```

Если в результате будет показана ошибка, запустите следующую статью, чтобы получить дополнительные сведения об ошибках, которые находятся в ```UserState``` свойстве.

```powershell
Get-CsBatchPolicyAssignmentOperation -OperationId f985e013-0826-40bb-8c94-e5f367076044 | Select -ExpandProperty UserState
```

Подробнее см. в [get-CsBatchPolicyAssignmentOperation.](https://docs.microsoft.com/powershell/module/teams/get-csbatchpolicyassignmentoperation)

## <a name="related-topics"></a>Статьи по теме

- [Управление teams с помощью политик](manage-teams-with-policies.md)
- [Обзор PowerShell в Teams](teams-powershell-overview.md)
- [Назначение политик в Teams — начало работы](policy-assignment-overview.md)
