---
title: Подготовка Microsoft Teams в масштабе для сотрудников без компьютеров
author: MicrosoftHeidi
ms.author: heidip
manager: serdars
ms.topic: reference
ms.service: msteams
audience: admin
ms.reviewer: keschm
description: Руководство по использованию сценариев для развертывания или подготовки Microsoft Teams для сотрудников без компьютеров.
ms.localizationpriority: high
search.appverid: MET150
f1.keywords:
- NOCSH
ms.collection:
- M365-collaboration
- Teams_ITAdmin_RemoteWorkers
- remotework
appliesto:
- Microsoft Teams
ms.openlocfilehash: 0237ff7d32a677eab1efd8b804b7dc00ca5e4184
ms.sourcegitcommit: 15e90083c47eb5bcb03ca80c2e83feffe67646f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2021
ms.locfileid: "58733438"
---
# <a name="how-to-provision-teams-at-scale-for-frontline-workers"></a>Как подготовить Teams в масштабе для сотрудников без компьютеров

Нужно ли вам быстро подключить большое количество пользователей к Microsoft Teams и настроить для них оптимизированный интерфейс? Вы можете быстро предоставить удостоверения, подготовить группы и назначить все соответствующие политики для управления взаимодействием с конечным пользователем, выполнив следующие инструкции.

В этом пошаговом руководстве вы узнаете, как:

- Создайте большое количество пользователей.
- Создайте большое количество команд и настройте соответствующие каналы.
- Назначьте лицензирование в масштабе.
- Создайте соответствующие политики обмена сообщениями Teams, политики установки приложений и политики разрешений приложений.
- Применяйте эти политики к пользователям в масштабе.
- Назначьте большое количество пользователей в назначенную команду.

> [!NOTE]
> Если вы ознакомились с этой информацией и хотите обратиться за помощью или у вас возникли вопросы, [**нажмите здесь**](https://forms.office.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbRyMDv-1voW9MqL7zkQ11DzBUREZaU1E0WEk5T0NYS0NDSkFMSDROUUdYMC4u), чтобы связаться со службой поддержки White Glove.

## <a name="prerequisites"></a>Необходимые компоненты

Загрузите ресурсы с [этого места](https://aka.ms/flwteamsscale).

> [!IMPORTANT]
> Сценарии в приведенной выше ссылке предоставлены Microsoft как есть и должны быть изменены в соответствии с вашими индивидуальными потребностями.

## <a name="technical-requirements"></a>Технические требования

- У вашего арендатора должно быть соответствующее количество доступных лицензий, включая Microsoft Teams. Если у вас еще нет этих лицензий, попробуйте воспользоваться бесплатной пробной подпиской на [Teams Exploratory](teams-exploratory.md).
- Пользователю, выполняющему эти действия, должны быть назначены следующие роли: глобальный администратор, администратор пользователя и администратор службы команд в Azure AD.
- Пользователь должен иметь права на установку и настройку программного обеспечения на своем локальном компьютере.

## <a name="step-by-step-process-overview"></a>Пошаговый обзор процесса

1. **Настройка среды**
    1. Загрузите из репозитория GitHub, содержащего примеры скриптов PowerShell и документацию
    1. Настройте локальную среду
    1. Настройка учетных данных
    1. Настройка модулей PowerShell и переменных среды
1. **Создание и настройка команд**
    1. Создание команд
    1. Шаги по созданию команд
    1. Создать каналы для команд
1. **Создание политик Teams**
    1. Создание политик сообщений Teams
    1. Создание политик настройки приложения для Teams
    1. Создание политик разрешений приложений для Teams
1. **Пользователи и группы безопасности**
    1. Создать пользователей и группы безопасности
    1. Назначение лицензирования пользователям через групповое лицензирование
1. **Назначение пользователей и политик**
    1. Назначение пользователей командам
    1. Назначение политик Teams пользователям
    1. Необязательно: преобразование типа членства в группе
1. **Протестируйте и подтвердите**
    1. Вход в Teams с помощью тестового пользователя
    1. Поиск ошибок
    1. Обработка ошибок
1. **Дополнительные материалы**

## <a name="set-up-your-environment"></a>Настройка среды

Следующие шаги позволят вам настроить вашу среду:

### <a name="download-from-the-github-repository-containing-sample-powershell-scripts-and-documentation"></a>Загрузите из репозитория GitHub, содержащего примеры скриптов PowerShell и документацию

Прежде чем вы сможете продолжить, вам нужно скачать скрипты в [этом месте](https://aka.ms/flwteamsscale).

### <a name="configure-the-local-environment"></a>Настройте локальную среду

Установка локальных переменных среды позволяет запускать скрипты, на которые есть ссылки, используя относительные пути. RootPath - это корень того места, где вы клонировали этот репозиторий, а tenantName имеет вид **yourTenant.onmicrosoft.com** (https не должен быть включен).

1. Откройте сеанс PowerShell и перейдите в папку сценариев внутри клонированного репозитория git.
1. Запустите скрипт. \ SetConfig.ps1 -tenantName [ваше имя клиента] -rootPath "полный путь к корню git-репозитория".

Например:. \SetConfig.ps1 -имя_пользователя contoso.onmicrosoft.com -rootPath "C:\data\source\FLWTeamsScale"

### <a name="set-up-credentials"></a>Настройка учетных данных

> [!IMPORTANT]
> Способ управления учетными данными в этих сценариях может не подходить для вашего использования, и их легко изменить в соответствии с вашими требованиями. Всегда следуйте стандартам и практикам вашей компании для обеспечения безопасности учетных записей и управляемых идентификаторов.

Сценарии используют учетные данные, которые хранятся в виде файлов XML в папке $ ENV:LOCALAPPDATA\keys, то есть в папке AppData\Local. Вспомогательная функция **Set-Creds** в модуле **BulkAddFunctions.psm1** должна быть вызвана для установки учетных данных, используемых для запуска этих сценариев. Этот метод устраняет необходимость аутентификации на всех различных конечных точках службы при сохранении учетных данных в локальном хранилище. Внутри каждого скрипта соответствующие учетные данные считываются с помощью вспомогательной функции **Get-Creds**, и эти учетные данные используются для подключения к различным службам.

Когда вы вызываете **Set-Creds**, вам предлагается указать имя файла XML, которое будет записано в $ENV:LOCALAPPDATA\keys. У вас могут быть разные учетные данные для разных служб. Например, у вас могут быть разные учетные данные для MicrosoftTeams, AzureAD и MSonline, и в этом случае вы можете запускать **Set-Creds** более одного раза, сохраняя каждый файл учетных данных со своим осмысленным именем.

Примеры: Set-Creds msol-cred.xml Set-Creds azuread-cred.xml Set-Creds commands-cred.xml

Запустите скрипт **SetCreds.ps1**, чтобы сохранить свои учетные данные. Вам будет предложено «Выполнение операции« Export-Clixml »...» и введите «Y» для подтверждения.

> [!NOTE]
> Учетная запись, используемая для учетных данных, не может требовать многофакторной аутентификации (MFA).

Вот пример того, как различные скрипты используют сохраненные учетные данные для аутентификации:

```azurepowershell
# Connect to MicrosoftTeams
$teams_cred = Get-Creds teams-cred.xml
Connect-MicrosoftTeams -Credential $teams_cred
```

### <a name="configure-powershell-modules-and-environmental-variables"></a>Настройка модулей PowerShell и переменных среды

Вам потребуется установить и подключиться к нескольким модулям PowerShell, включая Azure AD, MSAL, MSCloudUtils и MicrosoftTeams.

1. Найдите **ConfigurePowerShellModules.ps1** в папке сценариев в хранилище.
1. В PowerShell запустите сценарий **ConfigurePowerShellModules.ps1**.

## <a name="create-and-set-up-teams"></a>Создание и настройка команд

Чтобы общаться и взаимодействовать с сотрудниками без компьютеров, вам сначала необходимо создать ряд команд и добавить стандартные каналы в эти команды, что рассматривается ниже.

### <a name="create-teams"></a>Создание команд

Команды - это совокупность людей, контента и инструментов в вашей организации. Для большинства организаций с сотрудниками без компьютеров рекомендуется привязать команду к физическому месту. Например, команда для каждого из следующих:

- Магазин
- Центр распространения
- Завод
- Больница
- Продуктовый магазин

*Обсуждение передового опыта*: При проектировании своих команд важно учитывать [ограничения и спецификации Teams](limits-specifications-teams.md). Для небольших организаций можно использовать команду всей организации, чтобы упростить общение и дополнить структуру физического местоположения. Для других - структурированное физическое местоположение. Соглашение об именах групп помогает корпоративным коммуникациям с одновременной публикацией нескольких групп. Например, вы можете выполнить поиск и перекрестную публикацию во всех командах, указав в названии США, чтобы охватить все места в США. Более подробную информацию о кросс-постинге можно найти [здесь](https://support.office.com/article/cross-post-a-channel-conversation-in-teams-9c1252a3-67ef-498e-a7c1-dd7147b3d295).

#### <a name="steps-to-create-teams"></a>Шаги по созданию команд

1. Найдите файл **TeamsInformation.csv** в папке данных в хранилище.
1. Обновите информацию в файле **TeamsInformation.csv**, указав конкретные данные вашей организации. Имейте в виду наши лучшие практики выше.
1. Найдите скрипт **CreateTeams.ps1**.
1. В PowerShell запустите сценарий **CreateTeams.ps1**.

### <a name="create-channels-for-teams"></a>Создать каналы для команд

Каналы - это выделенные разделы внутри команды, позволяющие организовать беседы по определенной теме, проекту, дисциплине и т. д. Каждая команда автоматически получает общий канал, но оттуда вы можете настроить свою структуру в соответствии с потребностями вашего бизнеса. Например, ваша дополнительная структура канала может включать:

- **Производство** - Безопасность, Линия 1, Линия 2, Корпоративные коммуникации, Обучение
- **Продуктовый магазин** - Пекарня, Продукты, Мясо, Корпоративные коммуникации, Обучение
- **Здравоохранение** - медсестры, врачи, отделение интенсивной терапии 1, отделение интенсивной терапии 2
- **Гостиничный бизнес** - Рецепция, Техническое обслуживание, Уборка номеров, Услуги по парковке машин и багажа, Корпоративные коммуникации, Обучение
- **Розничная торговля** - фронт магазина, магазин, корпоративные коммуникации, обучение

> [!NOTE]
> Каналы не должны рассматриваться как граница безопасности. Они являются средством организации ваших работников в целях сотрудничества.

*Обсуждение передового опыта*: При проектировании структуры канала важно сохранять простоту, особенно если вы ищете много пользователей. Не поддавайтесь желанию создавать каналы для каждой ситуации, роли или темы, чтобы минимизировать потребность в обучении. Выберите 3-5 каналов максимум, чтобы начать. Дополнительные каналы могут быть легко созданы по мере необходимости. На самом деле, пока можно использовать только общий канал!

#### <a name="steps-to-create-channels-for-teams"></a>Шаги по созданию каналов для Teams

1. Найдите файл **TeamsChannels.csv** в папке сценариев в хранилище.
1. Обновите файл **TeamsChannels.csv** с указанием конкретной информации вашей организации. Имейте в виду наши лучшие практики выше.
1. Найдите скрипт **CreateTeamsChannels.ps1** в папке скриптов в хранилище.
1. В PowerShell запустите скрипт **CreateTeamsChannels.ps1**.

## <a name="create-teams-policies"></a>Создание политик Teams

Как администратор, вы можете использовать групповые политики в Microsoft Teams для управления тем, что видят и могут пользователи вашей организации. Например, вы можете контролировать, какие приложения прикрепляются к левой направляющей на вашем рабочем столе или в веб-браузере, или к нижней панели на мобильных устройствах, чтобы упростить работу конечного пользователя при подключении большого количества пользователей. Некоторые из этих политик могут быть созданы с помощью PowerShell, а другие должны быть созданы вручную в Центре администрирования Teams.

*Обсуждение рекомендаций*. Для каждой из следующих политик мы решили создать две политики: одну для сотрудников без компьютеров и одну для руководителей без компьютеров. Вы можете создать столько, сколько захотите. Для большинства клиентов два - хорошее место для начала, даже если изначально вы задали одинаковые настройки для каждой группы. По мере того, как ваш опыт работы с Teams будет расти, вы можете еще больше разграничить их опыт, и наличие двух отдельных уже созданных политик может упростить эту задачу.

### <a name="create-teams-messaging-policies"></a>Создание политик обмена сообщениями Teams

Политики обмена сообщениями используются, чтобы определять, какие функции обмена сообщениями в чате или канале доступны для пользователей в Microsoft Teams.

*Обсуждение рекомендаций*. Хотя вы можете использовать глобальную политику по умолчанию, создаваемую автоматически, мы решили создать настраиваемую политику, используя описанные ниже шаги, чтобы предоставить более закрытые, простые и дифференцированные возможности для руководителей без компьютеров и сотрудников без компьютеров.

#### <a name="steps-to-create-teams-messaging-policies"></a>Шаги для создания политик обмена сообщениями Teams

1. Найдите файл **TeamsMessagingPolicies.csv** в папке сценариев в хранилище.
1. Обновите файл **TeamsMessagingPolicies.csv**, указав конкретные данные вашей организации. Дополнительную информацию о некоторых из различных опций можно найти [здесь](./messaging-policies-in-teams.md#messaging-policy-settings).
1. Найдите сценарий **CreateTeamsMessagePolicies.ps1** в папке сценариев в хранилище.
1. В PowerShell запустите сценарий **CreateTeamsMessagePolicies.ps1**.

### <a name="create-teams-app-setup-policies"></a>Создание политик настройки приложения для Teams

Как администратор, вы можете использовать политики установки приложений для следующих целей:

- Настройте Teams, чтобы выделить приложения, которые наиболее важны для ваших пользователей. Вы выбираете приложения для закрепления и устанавливаете порядок, в котором они появляются. Закрепление приложений позволяет вам демонстрировать приложения, которые нужны пользователям в вашей организации, в том числе созданные третьими лицами или разработчиками в вашей организации.
- Контроль, могут ли пользователи прикреплять приложения к Teams.

Приложения закрепляются на панели приложений. Эта панель находится сбоку классического клиента Teams и внизу мобильных клиентов Teams (iOS и Android).

|Классический клиент Teams  |         |Мобильный клиент Teams  |
|---------|---------|---------|
|![Снимок экрана настольного клиента Teams с приложениями, прикрепленными к панели приложений.](media/flw-teams-desktop-client.png)         |         |![Снимок экрана мобильного клиента Teams с приложениями, прикрепленными к нижней панели.](media/flw-teams-mobile-client.png) |

*Обсуждение передового опыта*: Вы управляете политиками настройки приложений в центре администрирования Microsoft Teams. Они не могут быть созданы с помощью PowerShell. Вы можете использовать глобальную политику (по умолчанию для всей организации) или создавать собственные политики и назначать их пользователям. Пользователи в вашей организации будут автоматически назначены глобальной политике, если вы не создадите и не назначите пользовательскую политику. Для наших целей мы создаем две новые политики для сотрудников без компьютеров и руководителей без компьютеров, чтобы предоставить им более простой и удобный интерфейс для облегчения одновременного внедрения большого количества пользователей. Вы можете настроить взаимодействие с потребностями своего бизнеса.

#### <a name="create-the-frontline-manager-app-setup-policy"></a>Создание политики настройки приложения для руководителя без компьютера

Следующие параметры могут быть настроены в соответствии с потребностями вашего бизнеса. Мы выбрали некоторые рекомендуемые варианты, основанные на передовых методах и для упрощения адаптации новых пользователей в масштабе. Дополнительные сведения см. [здесь](teams-app-setup-policies.md).

1. В левой части панели администрирования Microsoft Teams перейдите в раздел  **Приложения Teams** > **Политики установки**.
2. Нажмите  **Добавить**.  
3. Введите имя и описание для политики. Например: политика настройки приложения для руководителя без компьютера.
    :::image type="content" source="media/flw-flm-app-setup-policy.png" alt-text="Снимок экрана примера имени и описания политики настройки приложения для руководителя без компьютера.":::

4. Отключить **Загрузить пользовательские приложения**.
5. Отключите **Разрешить закрепление пользователя**.
    :::image type="content" source="media/flw-allow-user-pinning.png" alt-text="Снимок экрана параметра Разрешить закрепление пользователей.":::

6. Если его еще нет в списке, добавьте приложение **Смены**. Для получения дополнительной информации о приложении "Смены", нажмите [здесь](expand-teams-across-your-org/shifts/manage-the-shifts-app-for-your-organization-in-teams.md).
    :::image type="content" source="media/flw-add-pinned-apps.png" alt-text="Снимок экрана добавления закрепленных приложений с кнопкой Добавить для приложения Смены":::

7. Удалите "Вызов", если он появляется. Удаление этой функции не отключит ее для пользователя, но предотвратит ее появление на панели приложений, чтобы упростить работу конечного пользователя.
8. Расположите приложения в следующем порядке, чтобы определить их порядок на панели приложений команд, а затем нажмите  **Сохранить**.

    - Действие
    - Чат
    - Команды
    - Календарь
    - Смены

    :::image type="content" source="media/flw-manager-pinned-apps.png" alt-text="Снимок экрана приложений для руководителей без компьютера, перечисленные по порядку.":::

#### <a name="create-the-frontline-worker-app-setup-policy"></a>Создание политики настройки приложения для сотрудника без компьютера

Следующие параметры могут быть настроены в соответствии с потребностями вашего бизнеса. Мы выбрали некоторые рекомендуемые варианты, основанные на передовых методах и для упрощения адаптации новых пользователей в масштабе. Дополнительные сведения см. [здесь](teams-app-setup-policies.md).

1. В левой части панели администрирования Microsoft Teams перейдите в раздел  **Приложения Teams** > **Политики установки**.
2. Нажмите  **Добавить**.
3. Введите имя и описание для политики. Например, политика настройки приложения для сотрудника без компьютера.
    :::image type="content" source="media/flw-flw-app-setup-policy.png" alt-text="Снимок экрана примера имени и описания политики настройки приложения для сотрудника без компьютера.":::

4. Отключить **Загрузить пользовательские приложения**.
5. Отключите **Разрешить закрепление пользователя**.
    :::image type="content" source="media/flw-allow-user-pinning.png" alt-text="Снимок экрана параметра Разрешить закрепление пользователей.":::

6. Если его еще нет в списке, добавьте приложение **Смены**. Для получения дополнительной информации о приложении "Смены", нажмите [здесь](expand-teams-across-your-org/shifts/manage-the-shifts-app-for-your-organization-in-teams.md).

    :::image type="content" source="media/flw-add-pinned-apps.png" alt-text="Снимок экрана добавления закрепленных приложений с кнопкой Добавить для приложения Смены":::

7. Удалите "Встречи" и "Звонки", если они появляются. Удаление этих функций не отключит их для пользователя, но предотвратит их появление на панели приложений, чтобы упростить работу конечного пользователя.
8. Расположите приложения в следующем порядке, чтобы определить их порядок на панели приложений команд, а затем нажмите  **Сохранить**.
    - Действие
    - Чат
    - Teams
    - Смены

    :::image type="content" source="media/flw-worker-pinned-apps.png" alt-text="Снимок экрана приложений для сотрудников без компьютера, перечисленные по порядку.":::

### <a name="create-teams-app-permission-policies"></a>Создание политик разрешений приложений для Teams

Как администратор, вы можете использовать политики разрешений приложений, чтобы контролировать, какие приложения доступны пользователям Microsoft Teams в вашей организации. Вы можете разрешить или заблокировать все приложения или определенные приложения, опубликованные Microsoft, сторонними организациями и вашей организацией. Когда вы блокируете приложение, пользователи, имеющие эту политику, не могут установить ее из магазина приложений Teams. Вы должны быть глобальным администратором или администратором службы Teams, чтобы управлять этими политиками.

*Обсуждение передового опыта*: Вы управляете политиками настройки приложений в центре администрирования Microsoft Teams. Они не могут быть созданы с помощью PowerShell. Вы можете использовать глобальную политику (по умолчанию для всей организации) или создавать собственные политики и назначать их пользователям. Пользователи вашей организации автоматически получают глобальную политику, если вы не создали и не назначили настраиваемую политику. Для наших целей мы создаем две новые политики для сотрудников и руководителей без компьютеров, чтобы предоставить безопасный и более удобный интерфейс для облегчения одновременного внедрения большого количества пользователей. Вы можете, конечно, выбрать, чтобы настроить опыт в соответствии с потребностями вашего бизнеса.

#### <a name="create-the-frontline-manager-app-permission-policy"></a>Создание политики разрешений приложения для руководителя без компьютера

Следующие параметры могут быть настроены в соответствии с потребностями вашего бизнеса. Это некоторые рекомендуемые варианты, основанные на передовых практиках, которые могут облегчить адаптацию новых пользователей в масштабе. Дополнительные сведения см. [здесь](teams-app-permission-policies.md).

1. В левой части панели администрирования Microsoft Teams перейдите к разделу  **приложения Teams** > **Политика разрешений**.
2. Нажмите  **Добавить**.

    :::image type="content" source="media/flw-add-app-permission-policy.png" alt-text="Снимок экрана страницы Добавление политики разрешений приложения.":::

3. Введите имя и описание для политики. Например, политика разрешений приложения для руководителя без компьютера.
4. В  **Microsoft Apps** выберите **Разрешить все приложения**.
5. В  **сторонних приложениях** выберите **Разрешить все приложения**.
6. В **настраиваемых приложениях** выберите **Разрешить все приложения**.
7. Нажмите  **Сохранить**.

#### <a name="create-the-frontline-worker-app-permission-policy"></a>Создание политики разрешений приложения для сотрудника без компьютера

Следующие параметры могут быть настроены в соответствии с потребностями вашего бизнеса. Это некоторые рекомендуемые варианты, основанные на передовых практиках, которые могут облегчить адаптацию новых пользователей в масштабе. Дополнительные сведения см. [здесь](teams-app-permission-policies.md).

1. В левой части панели администрирования Microsoft Teams перейдите к разделу  **приложения Teams** > **Политика разрешений**.
2. Нажмите  **Добавить**.

    :::image type="content" source="media/flw-add-app-permission-policy.png" alt-text="Снимок экрана страницы Добавление политики разрешений приложения.":::

3. Введите имя и описание для политики. Например, политика разрешений приложения для сотрудника без компьютера.
4. В  **Microsoft Apps** выберите **Разрешить все приложения**.
5. В  **сторонних приложениях** выберите **Заблокировать все приложения**.
6. В **настраиваемых приложениях** выберите **Разрешить все приложения**.
7. Нажмите  **Сохранить**.

## <a name="users-and-security-groups"></a>Пользователи и группы безопасности

### <a name="create-users-and-security-groups"></a>Создать пользователей и группы безопасности

Для работы с большим количеством пользователей в Teams сначала необходимо создать пользователей в Azure AD. Есть много способов обеспечить большое количество пользователей, но мы собираемся подчеркнуть следующее:

- Если эти пользователи уже существуют в одной из следующих систем управления персоналом, используйте следующие ссылки для настройки обеспечения пользователей:
  - Факторы успеха SAP - [Учебное пособие: настройте SAP SuccessFactors для обеспечения доступа пользователей Active Directory](/azure/active-directory/saas-apps/sap-successfactors-inbound-provisioning-tutorial).
  - Рабочий день - [Учебное пособие: настройка рабочего дня для автоматической подготовки пользователей](/azure/active-directory/saas-apps/workday-inbound-tutorial).
- Если у вас есть информация о пользователе в других системах, выполните следующие действия.

Для более эффективного управления этими пользователями в масштабе необходимо создать две группы безопасности для сотрудников без компьютеров и руководителей без компьютеров, а также подготовить этих пользователей непосредственно в группах безопасности, выполнив следующие действия.

1. Найдите файл **Users.csv** в папке сценариев в хранилище.
1. Обновите файл **Users.csv** с указанием конкретной информации вашей организации.
    1. По умолчанию предоставленный нами скрипт создает пользователя с временным паролем, который необходимо изменить при первом входе в систему. Если вы не хотите использовать пароль по умолчанию, отредактируйте скрипт **CreateUsers.ps1**, чтобы он соответствовал вашим требованиям.
    1. Обязательно обновите поле SecurityGroup, чтобы оно отражало соответствующее имя, созданное ранее.
1. Найдите файл **SecurityGroups.csv** в папке сценариев в хранилище.
1. Обновите файл **SecurityGroups.csv**, указав информацию о конкретной группе безопасности вашей организации.
    1. Обязательно обновите поля **MessagePolicy**, **AppPermissionPolicy** и **AppSetupPolicy**, чтобы они соответствовали соответствующим политикам, созданным ранее.
    1. Обязательно обновите поле **LicensePlan**, чтобы отразить лицензирование, которое вы намереваетесь предоставить каждому из этих пользователей. Для получения дополнительной информации об названиях продуктов и идентификаторах планов обслуживания просмотрите документацию [здесь](/azure/active-directory/users-groups-roles/licensing-service-plan-reference).
1. В PowerShell запустите скрипт **CreateUsers.ps1** из ресурсов.

### <a name="assign-licensing-to-users-via-group-based-licensing"></a>Назначение лицензирования пользователям через групповое лицензирование

Платные облачные службы Майкрософт, такие как Microsoft 365, Office 365, Enterprise Mobility + Security, Dynamics 365 и другие подобные продукты, требуют лицензий. Эти лицензии назначаются каждому пользователю, которому необходим доступ к этим услугам. Для управления лицензиями администраторы используют один из порталов управления (Office или Azure) и командлеты PowerShell. Azure Active Directory (Azure AD) является базовой инфраструктурой, которая поддерживает управление удостоверениями для всех облачных служб Microsoft. Azure AD хранит информацию о состояниях назначения лицензии для пользователей.

Чтобы включить лицензирование в масштабе, Azure AD теперь включает групповое лицензирование, и по этой причине мы создали группы безопасности ранее в этой статье. Вы можете назначить одну или несколько лицензий на продукты группе. Azure AD обеспечит назначение лицензий всем участникам этой группы. Всем новым участникам, присоединившимся к группе, назначаются соответствующие лицензии. Лицензии удаляются из участников, которые покидают группу. Такое управление лицензированием устраняет необходимость автоматизации управления лицензиями с помощью PowerShell для отражения изменений в организации и структуре подразделений для каждого пользователя.

## <a name="assign-users-and-policies"></a>Назначение пользователей и политик

### <a name="assign-users-to-teams"></a>Назначение пользователей командам

Теперь, когда вы создали пользователей и создали команды, пришло время поместить всех пользователей в соответствующие команды.

1. Найдите файл **Users.csv** в папке данных в хранилище и убедитесь, что у вас есть точное сопоставление с командами в этом файле.
1. Из PowerShell запустите сценарий **AssignUserstoTeams.ps1** из папки сценариев в хранилище.

### <a name="assign-teams-policies-to-users"></a>Назначение политик Teams пользователям

Теперь, когда вы создали пользователей и политики для изменения их опыта в Teams, пришло время назначить эти политики нужным пользователям.

1. Найдите файл **SecurityGroups.csv** в папке данных в репозитории и убедитесь, что у вас есть точное сопоставление политик с группами.
1. Из PowerShell запустите сценарий **AssignPoliciestoUsers.ps1** из папки сценариев в хранилище.

### <a name="optional-convert-group-membership-type"></a>Необязательно: преобразование типа членства в группе

> [!NOTE]
> Этот шаг предназначен для людей, у которых есть Azure AD P1 или выше.

Получив лицензию на Azure AD P1 или выше, вы можете использовать динамическое членство в группе вместо назначенного членства. Сценарии, которые создали Teams, также создали группы Office с типом членства Assigned, что означает, что их члены должны быть явно добавлены.

Используя динамическое членство, правила пишутся, чтобы определить, является ли кто-то членом команды или нет.

> [!NOTE]
> При запуске этого сценария текущее членство в группе будет удалено (кроме ее владельцев), и новые участники будут добавлены при выполнении задания синхронизации членства.

1. Найдите файл **migrateGroups.csv** в папке данных в хранилище.
1. Обновите CSV-файл **migrateGroups.csv**, указав группы, которые будут перенесены, а также правило динамического членства.
1. Найдите файл **ConvertGroupMembershipType.ps1** в папке сценариев в хранилище.
1. Из PowerShell запустите скрипт **ConvertGroupMembershipType.ps1**

## <a name="test-and-validate"></a>Протестируйте и подтвердите

### <a name="sign-in-to-teams-with-a-test-user"></a>Вход в Teams с помощью тестового пользователя

Теперь, когда вы выполнили все шаги, пришло время проверить работу, которую вы выполнили.

1. Созданный пользователь будет иметь исходный пароль, который находится в CreateUsers.ps1, и он должен изменить его при первом входе в систему.
1. Убедитесь, что внешний вид Teams - это то, что вы ожидали. Если нет, просмотрите разделы **Создание политик Teams** и **Назначение политик Teams пользователям**.
1. Убедитесь, что пользователь находится в правильной команде. Если нет, просмотрите разделы **Создание и настройка пользователей** и **Назначение пользователей в команды**.

> [!NOTE]
> Если управление подготовкой сотрудника без компьютера осуществляется через вашу группу управления идентификацией и доступом, вам нужно будет следовать процессу по предоставлению сотруднику его учетных данных.

### <a name="check-for-errors"></a>Поиск ошибок

При запуске более ранних сценариев ошибки или исключения были записаны в файл .csv, расположенный в папке журналов в вашей копии хранилища. Этот файл может быть использован для расследования любых проблем, которые могли возникнуть.

Примером исключения может быть, если вы пытаетесь создать команду, которая уже существует в вашем арендаторе.

1. Найдите папку **Logs** и просмотрите любой файл .csv, который она может содержать. Если исключений нет, вы можете не найти файл исключений здесь.

### <a name="error-handling"></a>Обработка ошибок

В этих примерах сценариев реализована минимальная обработка ошибок. Существуют блоки try / catch, и при их срабатывании мы сохраняем ошибку в переменной в блоке catch. Дополнительная обработка ошибок должна быть реализована в соответствии с вашими предпочтениями.

## <a name="further-reading"></a>Дополнительные материалы

- [Создание канала команды (PowerShell)](/powershell/module/teams/new-teamchannel?view=teams-ps)
- [Новая политика обмена сообщениями группы (PowerShell)](/powershell/module/skype/new-csteamsmessagingpolicy?view=skype-ps)
- [Назначение политик вашим пользователям в Microsoft Teams](assign-policies.md#install-and-connect-to-the-microsoft-teams-powershell-module)
- [Назначение лицензий и учетных записей пользователей с помощью Office 365 PowerShell](/office365/enterprise/powershell/assign-licenses-to-user-accounts-with-office-365-powershell)
